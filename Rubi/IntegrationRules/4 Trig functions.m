
(* ::Section:: *)
(* 4 Trig functions *)

(* ::Subsection::Closed:: *)
(* 4.1.0.1 (a sin)^m (b trg)^n *)
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := Int[DeactivateTrig[u, x], x] /; SimplifyFlag && FunctionOfTrigOfLinearQ[u, x], Int[u_, x_Symbol] := Int[DeactivateTrig[u, x], x] /; FunctionOfTrigOfLinearQ[u, x]]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*cos[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (a*Sin[e + f*x])^(m + 1)*((b*Cos[e + f*x])^(n + 1)/(a*b*f*(m + 1))) /; FreeQ[{a, b, e, f, m, n}, x] && EqQ[m + n + 2, 0] && NeQ[m, -1]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*cos[(e_.) + (f_.)*(x_)]^(n_.), x_Symbol] := (1/(a*f))*Subst[Int[x^m*(1 - x^2/a^2)^((n - 1)/2), x], x, a*Sin[e + f*x]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n - 1)/2] &&  !(IntegerQ[(m - 1)/2] && LtQ[0, m, n])
Int[((a_.)*cos[(e_.) + (f_.)*(x_)])^(m_.)*sin[(e_.) + (f_.)*(x_)]^(n_.), x_Symbol] := (-(a*f)^(-1))*Subst[Int[x^m*(1 - x^2/a^2)^((n - 1)/2), x], x, a*Cos[e + f*x]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n - 1)/2] &&  !(IntegerQ[(m - 1)/2] && GtQ[m, 0] && LeQ[m, n])
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*cos[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-a)*(a*Sin[e + f*x])^(m - 1)*((b*Cos[e + f*x])^(n + 1)/(b*f*(n + 1))) + a^2*((m - 1)/(b^2*(n + 1)))*Int[(a*Sin[e + f*x])^(m - 2)*(b*Cos[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[m, 1] && LtQ[n, -1] && (IntegersQ[2*m, 2*n] || EqQ[m + n, 0])
Int[((a_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*(a*Cos[e + f*x])^(m - 1)*((b*Sin[e + f*x])^(n + 1)/(b*f*(n + 1))) + a^2*((m - 1)/(b^2*(n + 1)))*Int[(a*Cos[e + f*x])^(m - 2)*(b*Sin[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[m, 1] && LtQ[n, -1] && (IntegersQ[2*m, 2*n] || EqQ[m + n, 0])
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*cos[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-a)*(b*Cos[e + f*x])^(n + 1)*((a*Sin[e + f*x])^(m - 1)/(b*f*(m + n))) + a^2*((m - 1)/(m + n))*Int[(b*Cos[e + f*x])^n*(a*Sin[e + f*x])^(m - 2), x] /; FreeQ[{a, b, e, f, n}, x] && GtQ[m, 1] && NeQ[m + n, 0] && IntegersQ[2*m, 2*n]
Int[((a_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*(b*Sin[e + f*x])^(n + 1)*((a*Cos[e + f*x])^(m - 1)/(b*f*(m + n))) + a^2*((m - 1)/(m + n))*Int[(b*Sin[e + f*x])^n*(a*Cos[e + f*x])^(m - 2), x] /; FreeQ[{a, b, e, f, n}, x] && GtQ[m, 1] && NeQ[m + n, 0] && IntegersQ[2*m, 2*n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*cos[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (b*Cos[e + f*x])^(n + 1)*((a*Sin[e + f*x])^(m + 1)/(a*b*f*(m + 1))) + ((m + n + 2)/(a^2*(m + 1)))*Int[(b*Cos[e + f*x])^n*(a*Sin[e + f*x])^(m + 2), x] /; FreeQ[{a, b, e, f, n}, x] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[((a_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-(b*Sin[e + f*x])^(n + 1))*((a*Cos[e + f*x])^(m + 1)/(a*b*f*(m + 1))) + ((m + n + 2)/(a^2*(m + 1)))*Int[(b*Sin[e + f*x])^n*(a*Cos[e + f*x])^(m + 2), x] /; FreeQ[{a, b, e, f, n}, x] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[Sqrt[(a_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(b_.)*cos[(e_.) + (f_.)*(x_)]], x_Symbol] := Sqrt[a*Sin[e + f*x]]*(Sqrt[b*Cos[e + f*x]]/Sqrt[Sin[2*e + 2*f*x]])*Int[Sqrt[Sin[2*e + 2*f*x]], x] /; FreeQ[{a, b, e, f}, x]
Int[1/(Sqrt[(a_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(b_.)*cos[(e_.) + (f_.)*(x_)]]), x_Symbol] := (Sqrt[Sin[2*e + 2*f*x]]/(Sqrt[a*Sin[e + f*x]]*Sqrt[b*Cos[e + f*x]]))*Int[1/Sqrt[Sin[2*e + 2*f*x]], x] /; FreeQ[{a, b, e, f}, x]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*cos[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := With[{k = Denominator[m]}, k*a*(b/f)*Subst[Int[x^(k*(m + 1) - 1)/(a^2 + b^2*x^(2*k)), x], x, (a*Sin[e + f*x])^(1/k)/(b*Cos[e + f*x])^(1/k)]] /; FreeQ[{a, b, e, f}, x] && EqQ[m + n, 0] && GtQ[m, 0] && LtQ[m, 1]
Int[((a_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := With[{k = Denominator[m]}, (-k)*a*(b/f)*Subst[Int[x^(k*(m + 1) - 1)/(a^2 + b^2*x^(2*k)), x], x, (a*Cos[e + f*x])^(1/k)/(b*Sin[e + f*x])^(1/k)]] /; FreeQ[{a, b, e, f}, x] && EqQ[m + n, 0] && GtQ[m, 0] && LtQ[m, 1]
Int[((a_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b^(2*IntPart[(n - 1)/2] + 1))*(b*Sin[e + f*x])^(2*FracPart[(n - 1)/2])*((a*Cos[e + f*x])^(m + 1)/(a*f*(m + 1)*(Sin[e + f*x]^2)^FracPart[(n - 1)/2]))*Hypergeometric2F1[(1 + m)/2, (1 - n)/2, (3 + m)/2, Cos[e + f*x]^2] /; FreeQ[{a, b, e, f, m, n}, x] && SimplerQ[n, m]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*cos[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b^(2*IntPart[(n - 1)/2] + 1)*(b*Cos[e + f*x])^(2*FracPart[(n - 1)/2])*((a*Sin[e + f*x])^(m + 1)/(a*f*(m + 1)*(Cos[e + f*x]^2)^FracPart[(n - 1)/2]))*Hypergeometric2F1[(1 + m)/2, (1 - n)/2, (3 + m)/2, Sin[e + f*x]^2] /; FreeQ[{a, b, e, f, m, n}, x]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := b*(a*Sin[e + f*x])^(m + 1)*((b*Sec[e + f*x])^(n - 1)/(a*f*(m + 1))) /; FreeQ[{a, b, e, f, m, n}, x] && EqQ[m - n + 2, 0] && NeQ[m, -1]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*b*(a*Sin[e + f*x])^(m - 1)*((b*Sec[e + f*x])^(n - 1)/(f*(n - 1))) - a^2*b^2*((m - 1)/(n - 1))*Int[(a*Sin[e + f*x])^(m - 2)*(b*Sec[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[n, 1] && GtQ[m, 1] && IntegersQ[2*m, 2*n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Sin[e + f*x])^(m + 1)*((b*Sec[e + f*x])^(n + 1)/(a*b*f*(m - n))) - ((n + 1)/(b^2*(m - n)))*Int[(a*Sin[e + f*x])^m*(b*Sec[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f, m}, x] && GtQ[n, 1] && IntegersQ[2*m, 2*n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Sin[e + f*x])^(m + 1)*((b*Sec[e + f*x])^(n + 1)/(a*b*f*(m + 1))) - ((n + 1)/(a^2*b^2*(m + 1)))*Int[(a*Sin[e + f*x])^(m + 2)*(b*Sec[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && LtQ[n, -1] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Sin[e + f*x])^(m + 1)*((b*Sec[e + f*x])^(n + 1)/(a*b*f*(m - n))) - ((n + 1)/(b^2*(m - n)))*Int[(a*Sin[e + f*x])^m*(b*Sec[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f, m}, x] && LtQ[n, -1] && NeQ[m - n, 0] && IntegersQ[2*m, 2*n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-a)*b*(a*Sin[e + f*x])^(m - 1)*((b*Sec[e + f*x])^(n - 1)/(f*(m - n))) + a^2*((m - 1)/(m - n))*Int[(a*Sin[e + f*x])^(m - 2)*(b*Sec[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && GtQ[m, 1] && NeQ[m - n, 0] && IntegersQ[2*m, 2*n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(a*Sin[e + f*x])^(m + 1)*((b*Sec[e + f*x])^(n - 1)/(a*f*(m + 1))) + ((m - n + 2)/(a^2*(m + 1)))*Int[(a*Sin[e + f*x])^(m + 2)*(b*Sec[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (b*Cos[e + f*x])^n*(b*Sec[e + f*x])^n*Int[(a*Sin[e + f*x])^m/(b*Cos[e + f*x])^n, x] /; FreeQ[{a, b, e, f, m, n}, x] && IntegerQ[m - 1/2] && IntegerQ[n - 1/2]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (1/b^2)*(b*Cos[e + f*x])^(n + 1)*(b*Sec[e + f*x])^(n + 1)*Int[(a*Sin[e + f*x])^m/(b*Cos[e + f*x])^n, x] /; FreeQ[{a, b, e, f, m, n}, x] &&  !IntegerQ[m] &&  !IntegerQ[n] && LtQ[n, 1]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b^2*(b*Cos[e + f*x])^(n - 1)*(b*Sec[e + f*x])^(n - 1)*Int[(a*Sin[e + f*x])^m/(b*Cos[e + f*x])^n, x] /; FreeQ[{a, b, e, f, m, n}, x] &&  !IntegerQ[m] &&  !IntegerQ[n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*b)^IntPart[n]*(a*Sin[e + f*x])^FracPart[n]*(b*Csc[e + f*x])^FracPart[n]*Int[(a*Sin[e + f*x])^(m - n), x] /; FreeQ[{a, b, e, f, m, n}, x] &&  !IntegerQ[m] &&  !IntegerQ[n]

(* ::Subsection::Closed:: *)
(* 4.1.0.2 (a trg)^m (b tan)^n *)
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b)*(a*Sin[e + f*x])^m*((b*Tan[e + f*x])^(n - 1)/(f*m)) /; FreeQ[{a, b, e, f, m, n}, x] && EqQ[m + n - 1, 0]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*tan[(e_.) + (f_.)*(x_)]^(n_.), x_Symbol] := (-f^(-1))*Subst[Int[(1 - x^2)^((m + n - 1)/2)/x^n, x], x, Cos[e + f*x]] /; FreeQ[{e, f}, x] && IntegersQ[m, n, (m + n - 1)/2]
Int[sin[(e_.) + (f_.)*(x_)]^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, b*(ff/f)*Subst[Int[(ff*x)^(m + n)/(b^2 + ff^2*x^2)^(m/2 + 1), x], x, b*(Tan[e + f*x]/ff)]] /; FreeQ[{b, e, f, n}, x] && IntegerQ[m/2]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*tan[(e_.) + (f_.)*(x_)]^(n_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (ff/f)*Subst[Int[(ff*x)^(m + n)/(a^2 - ff^2*x^2)^((n + 1)/2), x], x, a*(Sin[e + f*x]/ff)]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n + 1)/2]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(a*Sin[e + f*x])^(m + 2)*((b*Tan[e + f*x])^(n - 1)/(a^2*f*(n - 1))) - b^2*((m + 2)/(a^2*(n - 1)))*Int[(a*Sin[e + f*x])^(m + 2)*(b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[n, 1] && (LtQ[m, -1] || (EqQ[m, -1] && EqQ[n, 3/2])) && IntegersQ[2*m, 2*n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(a*Sin[e + f*x])^m*((b*Tan[e + f*x])^(n - 1)/(f*(n - 1))) - b^2*((m + n - 1)/(n - 1))*Int[(a*Sin[e + f*x])^m*(b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f, m}, x] && GtQ[n, 1] && IntegersQ[2*m, 2*n] &&  !(GtQ[m, 1] &&  !IntegerQ[(m - 1)/2])
Int[Sqrt[(a_.)*sin[(e_.) + (f_.)*(x_)]]/((b_.)*tan[(e_.) + (f_.)*(x_)])^(3/2), x_Symbol] := 2*(Sqrt[a*Sin[e + f*x]]/(b*f*Sqrt[b*Tan[e + f*x]])) + (a^2/b^2)*Int[Sqrt[b*Tan[e + f*x]]/(a*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, e, f}, x]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Sin[e + f*x])^m*((b*Tan[e + f*x])^(n + 1)/(b*f*m)) - a^2*((n + 1)/(b^2*m))*Int[(a*Sin[e + f*x])^(m - 2)*(b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && LtQ[n, -1] && GtQ[m, 1] && IntegersQ[2*m, 2*n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Sin[e + f*x])^m*((b*Tan[e + f*x])^(n + 1)/(b*f*(m + n + 1))) - ((n + 1)/(b^2*(m + n + 1)))*Int[(a*Sin[e + f*x])^m*(b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f, m}, x] && LtQ[n, -1] && NeQ[m + n + 1, 0] && IntegersQ[2*m, 2*n] &&  !(EqQ[n, -3/2] && EqQ[m, 1])
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (-b)*(a*Sin[e + f*x])^m*((b*Tan[e + f*x])^(n - 1)/(f*m)) + a^2*((m + n - 1)/m)*Int[(a*Sin[e + f*x])^(m - 2)*(b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && (GtQ[m, 1] || (EqQ[m, 1] && EqQ[n, 1/2])) && IntegersQ[2*m, 2*n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := b*(a*Sin[e + f*x])^(m + 2)*((b*Tan[e + f*x])^(n - 1)/(a^2*f*(m + n + 1))) + ((m + 2)/(a^2*(m + n + 1)))*Int[(a*Sin[e + f*x])^(m + 2)*(b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && LtQ[m, -1] && NeQ[m + n + 1, 0] && IntegersQ[2*m, 2*n]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*tan[(e_.) + (f_.)*(x_)]^(n_), x_Symbol] := (1/a^n)*Int[(a*Sin[e + f*x])^(m + n)/Cos[e + f*x]^n, x] /; FreeQ[{a, e, f, m}, x] && IntegerQ[n] &&  !IntegerQ[m]
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Cos[e + f*x]^n*((b*Tan[e + f*x])^n/(a*Sin[e + f*x])^n)*Int[(a*Sin[e + f*x])^(m + n)/Cos[e + f*x]^n, x] /; FreeQ[{a, b, e, f, m, n}, x] &&  !IntegerQ[n] && (ILtQ[m, 0] || (EqQ[m, 1] && EqQ[n, -2^(-1)]) || IntegersQ[m - 1/2, n - 1/2])
Int[((a_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*Cos[e + f*x]^(n + 1)*((b*Tan[e + f*x])^(n + 1)/(b*(a*Sin[e + f*x])^(n + 1)))*Int[(a*Sin[e + f*x])^(m + n)/Cos[e + f*x]^n, x] /; FreeQ[{a, b, e, f, m, n}, x] &&  !IntegerQ[n]
Int[((a_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Cos[e + f*x])^FracPart[m]*(Sec[e + f*x]/a)^FracPart[m]*Int[(b*Tan[e + f*x])^n/(Sec[e + f*x]/a)^m, x] /; FreeQ[{a, b, e, f, m, n}, x] &&  !IntegerQ[m] &&  !IntegerQ[n]
Int[((a_.)*cot[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Cot[e + f*x])^m*(b*Tan[e + f*x])^m*Int[(b*Tan[e + f*x])^(n - m), x] /; FreeQ[{a, b, e, f, m, n}, x] &&  !IntegerQ[m] &&  !IntegerQ[n]
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (-(a*Sec[e + f*x])^m)*((b*Tan[e + f*x])^(n + 1)/(b*f*m)) /; FreeQ[{a, b, e, f, m, n}, x] && EqQ[m + n + 1, 0]
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (a/f)*Subst[Int[(a*x)^(m - 1)*(-1 + x^2)^((n - 1)/2), x], x, Sec[e + f*x]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n - 1)/2] &&  !(IntegerQ[m/2] && LtQ[0, m, n + 1])
Int[sec[(e_.) + (f_.)*(x_)]^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (1/f)*Subst[Int[(b*x)^n*(1 + x^2)^(m/2 - 1), x], x, Tan[e + f*x]] /; FreeQ[{b, e, f, n}, x] && IntegerQ[m/2] &&  !(IntegerQ[(n - 1)/2] && LtQ[0, n, m - 1])
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^2*(a*Sec[e + f*x])^(m - 2)*((b*Tan[e + f*x])^(n + 1)/(b*f*(n + 1))) - a^2*((m - 2)/(b^2*(n + 1)))*Int[(a*Sec[e + f*x])^(m - 2)*(b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && LtQ[n, -1] && (GtQ[m, 1] || (EqQ[m, 1] && EqQ[n, -3/2])) && IntegersQ[2*m, 2*n]
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Sec[e + f*x])^m*((b*Tan[e + f*x])^(n + 1)/(b*f*(n + 1))) - ((m + n + 1)/(b^2*(n + 1)))*Int[(a*Sec[e + f*x])^m*(b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f, m}, x] && LtQ[n, -1] && IntegersQ[2*m, 2*n]
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(a*Sec[e + f*x])^m*((b*Tan[e + f*x])^(n - 1)/(f*m)) - b^2*((n - 1)/(a^2*m))*Int[(a*Sec[e + f*x])^(m + 2)*(b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[n, 1] && (LtQ[m, -1] || (EqQ[m, -1] && EqQ[n, 3/2])) && IntegersQ[2*m, 2*n]
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(a*Sec[e + f*x])^m*((b*Tan[e + f*x])^(n - 1)/(f*(m + n - 1))) - b^2*((n - 1)/(m + n - 1))*Int[(a*Sec[e + f*x])^m*(b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f, m}, x] && GtQ[n, 1] && NeQ[m + n - 1, 0] && IntegersQ[2*m, 2*n]
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-(a*Sec[e + f*x])^m)*((b*Tan[e + f*x])^(n + 1)/(b*f*m)) + ((m + n + 1)/(a^2*m))*Int[(a*Sec[e + f*x])^(m + 2)*(b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && (LtQ[m, -1] || (EqQ[m, -1] && EqQ[n, -2^(-1)])) && IntegersQ[2*m, 2*n]
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^2*(a*Sec[e + f*x])^(m - 2)*((b*Tan[e + f*x])^(n + 1)/(b*f*(m + n - 1))) + a^2*((m - 2)/(m + n - 1))*Int[(a*Sec[e + f*x])^(m - 2)*(b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && (GtQ[m, 1] || (EqQ[m, 1] && EqQ[n, 1/2])) && NeQ[m + n - 1, 0] && IntegersQ[2*m, 2*n]
Int[sec[(e_.) + (f_.)*(x_)]/Sqrt[(b_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := (Sqrt[Sin[e + f*x]]/(Sqrt[Cos[e + f*x]]*Sqrt[b*Tan[e + f*x]]))*Int[1/(Sqrt[Cos[e + f*x]]*Sqrt[Sin[e + f*x]]), x] /; FreeQ[{b, e, f}, x]
Int[Sqrt[(b_.)*tan[(e_.) + (f_.)*(x_)]]/sec[(e_.) + (f_.)*(x_)], x_Symbol] := Sqrt[Cos[e + f*x]]*(Sqrt[b*Tan[e + f*x]]/Sqrt[Sin[e + f*x]])*Int[Sqrt[Cos[e + f*x]]*Sqrt[Sin[e + f*x]], x] /; FreeQ[{b, e, f}, x]
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^(m + n)*((b*Tan[e + f*x])^n/((a*Sec[e + f*x])^n*(b*Sin[e + f*x])^n))*Int[(b*Sin[e + f*x])^n/Cos[e + f*x]^(m + n), x] /; FreeQ[{a, b, e, f, m, n}, x] && IntegerQ[n + 1/2] && IntegerQ[m + 1/2]
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Sec[e + f*x])^m*(b*Tan[e + f*x])^(n + 1)*((Cos[e + f*x]^2)^((m + n + 1)/2)/(b*f*(n + 1)))*Hypergeometric2F1[(n + 1)/2, (m + n + 1)/2, (n + 3)/2, Sin[e + f*x]^2] /; FreeQ[{a, b, e, f, m, n}, x] &&  !IntegerQ[(n - 1)/2] &&  !IntegerQ[m/2]
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Csc[e + f*x])^FracPart[m]*(Sin[e + f*x]/a)^FracPart[m]*Int[(b*Tan[e + f*x])^n/(Sin[e + f*x]/a)^m, x] /; FreeQ[{a, b, e, f, m, n}, x] &&  !IntegerQ[m] &&  !IntegerQ[n]

(* ::Subsection::Closed:: *)
(* 4.1.0.3 (a csc)^m (b sec)^n *)
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*b*(a*Csc[e + f*x])^(m - 1)*((b*Sec[e + f*x])^(n - 1)/(f*(n - 1))) /; FreeQ[{a, b, e, f, m, n}, x] && EqQ[m + n - 2, 0] && NeQ[n, 1]
Int[csc[(e_.) + (f_.)*(x_)]^(m_.)*sec[(e_.) + (f_.)*(x_)]^(n_.), x_Symbol] := (1/f)*Subst[Int[(1 + x^2)^((m + n)/2 - 1)/x^m, x], x, Tan[e + f*x]] /; FreeQ[{e, f}, x] && IntegersQ[m, n, (m + n)/2]
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*sec[(e_.) + (f_.)*(x_)]^(n_.), x_Symbol] := (-(f*a^n)^(-1))*Subst[Int[x^(m + n - 1)/(-1 + x^2/a^2)^((n + 1)/2), x], x, a*Csc[e + f*x]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n + 1)/2] &&  !(IntegerQ[(m + 1)/2] && LtQ[0, m, n])
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_)*csc[(e_.) + (f_.)*(x_)]^(n_.), x_Symbol] := (1/(f*a^n))*Subst[Int[x^(m + n - 1)/(-1 + x^2/a^2)^((n + 1)/2), x], x, a*Sec[e + f*x]] /; FreeQ[{a, e, f, m}, x] && IntegerQ[(n + 1)/2] &&  !(IntegerQ[(m + 1)/2] && LtQ[0, m, n])
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-a)*(a*Csc[e + f*x])^(m - 1)*((b*Sec[e + f*x])^(n + 1)/(f*b*(m - 1))) + a^2*((n + 1)/(b^2*(m - 1)))*Int[(a*Csc[e + f*x])^(m - 2)*(b*Sec[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[m, 1] && LtQ[n, -1] && IntegersQ[2*m, 2*n]
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(a*Csc[e + f*x])^(m + 1)*((b*Sec[e + f*x])^(n - 1)/(f*a*(n - 1))) + b^2*((m + 1)/(a^2*(n - 1)))*Int[(a*Csc[e + f*x])^(m + 2)*(b*Sec[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f}, x] && GtQ[n, 1] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (-a)*b*(a*Csc[e + f*x])^(m - 1)*((b*Sec[e + f*x])^(n - 1)/(f*(m - 1))) + a^2*((m + n - 2)/(m - 1))*Int[(a*Csc[e + f*x])^(m - 2)*(b*Sec[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && GtQ[m, 1] && IntegersQ[2*m, 2*n] &&  !GtQ[n, m]
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*b*(a*Csc[e + f*x])^(m - 1)*((b*Sec[e + f*x])^(n - 1)/(f*(n - 1))) + b^2*((m + n - 2)/(n - 1))*Int[(a*Csc[e + f*x])^m*(b*Sec[e + f*x])^(n - 2), x] /; FreeQ[{a, b, e, f, m}, x] && GtQ[n, 1] && IntegersQ[2*m, 2*n]
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := b*(a*Csc[e + f*x])^(m + 1)*((b*Sec[e + f*x])^(n - 1)/(a*f*(m + n))) + ((m + 1)/(a^2*(m + n)))*Int[(a*Csc[e + f*x])^(m + 2)*(b*Sec[e + f*x])^n, x] /; FreeQ[{a, b, e, f, n}, x] && LtQ[m, -1] && NeQ[m + n, 0] && IntegersQ[2*m, 2*n]
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-a)*(a*Csc[e + f*x])^(m - 1)*((b*Sec[e + f*x])^(n + 1)/(b*f*(m + n))) + ((n + 1)/(b^2*(m + n)))*Int[(a*Csc[e + f*x])^m*(b*Sec[e + f*x])^(n + 2), x] /; FreeQ[{a, b, e, f, m}, x] && LtQ[n, -1] && NeQ[m + n, 0] && IntegersQ[2*m, 2*n]
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Csc[e + f*x])^m*((b*Sec[e + f*x])^n/Tan[e + f*x]^n)*Int[Tan[e + f*x]^n, x] /; FreeQ[{a, b, e, f, m, n}, x] &&  !IntegerQ[n] && EqQ[m + n, 0]
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a*Csc[e + f*x])^m*(b*Sec[e + f*x])^n*(a*Sin[e + f*x])^m*(b*Cos[e + f*x])^n*Int[1/((a*Sin[e + f*x])^m*(b*Cos[e + f*x])^n), x] /; FreeQ[{a, b, e, f, m, n}, x] && IntegerQ[m - 1/2] && IntegerQ[n - 1/2]
Int[((a_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a^2/b^2)*(a*Csc[e + f*x])^(m - 1)*(b*Sec[e + f*x])^(n + 1)*(a*Sin[e + f*x])^(m - 1)*(b*Cos[e + f*x])^(n + 1)*Int[1/((a*Sin[e + f*x])^m*(b*Cos[e + f*x])^n), x] /; FreeQ[{a, b, e, f, m, n}, x] &&  !SimplerQ[-m, -n]
Int[((a_.)*sec[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a^2/b^2)*(a*Sec[e + f*x])^(m - 1)*(b*Csc[e + f*x])^(n + 1)*(a*Cos[e + f*x])^(m - 1)*(b*Sin[e + f*x])^(n + 1)*Int[1/((a*Cos[e + f*x])^m*(b*Sin[e + f*x])^n), x] /; FreeQ[{a, b, e, f, m, n}, x]

(* ::Subsection::Closed:: *)
(* 4.1.10 (c+d x)^m (a+b sin)^n *)
Int[((c_.) + (d_.)*(x_))^(m_.)*sin[(e_.) + (f_.)*(x_)], x_Symbol] := (-(c + d*x)^m)*(Cos[e + f*x]/f) + d*(m/f)*Int[(c + d*x)^(m - 1)*Cos[e + f*x], x] /; FreeQ[{c, d, e, f}, x] && GtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_)*sin[(e_.) + (f_.)*(x_)], x_Symbol] := (c + d*x)^(m + 1)*(Sin[e + f*x]/(d*(m + 1))) - (f/(d*(m + 1)))*Int[(c + d*x)^(m + 1)*Cos[e + f*x], x] /; FreeQ[{c, d, e, f}, x] && LtQ[m, -1]
Int[sin[(e_.) + (f_.)*(Complex[0, fz_])*(x_)]/((c_.) + (d_.)*(x_)), x_Symbol] := I*(SinhIntegral[c*f*(fz/d) + f*fz*x]/d) /; FreeQ[{c, d, e, f, fz}, x] && EqQ[d*e - c*f*fz*I, 0]
Int[sin[(e_.) + (f_.)*(x_)]/((c_.) + (d_.)*(x_)), x_Symbol] := SinIntegral[e + f*x]/d /; FreeQ[{c, d, e, f}, x] && EqQ[d*e - c*f, 0]
Int[sin[(e_.) + (f_.)*(Complex[0, fz_])*(x_)]/((c_.) + (d_.)*(x_)), x_Symbol] := CoshIntegral[(-c)*f*(fz/d) - f*fz*x]/d /; FreeQ[{c, d, e, f, fz}, x] && EqQ[d*(e - Pi/2) - c*f*fz*I, 0] && NegQ[c*f*(fz/d), 0]
Int[sin[(e_.) + (f_.)*(Complex[0, fz_])*(x_)]/((c_.) + (d_.)*(x_)), x_Symbol] := CoshIntegral[c*f*(fz/d) + f*fz*x]/d /; FreeQ[{c, d, e, f, fz}, x] && EqQ[d*(e - Pi/2) - c*f*fz*I, 0]
Int[sin[(e_.) + (f_.)*(x_)]/((c_.) + (d_.)*(x_)), x_Symbol] := CosIntegral[e - Pi/2 + f*x]/d /; FreeQ[{c, d, e, f}, x] && EqQ[d*(e - Pi/2) - c*f, 0]
Int[sin[(e_.) + (f_.)*(x_)]/((c_.) + (d_.)*(x_)), x_Symbol] := Cos[(d*e - c*f)/d]*Int[Sin[c*(f/d) + f*x]/(c + d*x), x] + Sin[(d*e - c*f)/d]*Int[Cos[c*(f/d) + f*x]/(c + d*x), x] /; FreeQ[{c, d, e, f}, x] && NeQ[d*e - c*f, 0]
Int[sin[(e_.) + Pi/2 + (f_.)*(x_)]/Sqrt[(c_.) + (d_.)*(x_)], x_Symbol] := (2/d)*Subst[Int[Cos[f*(x^2/d)], x], x, Sqrt[c + d*x]] /; FreeQ[{c, d, e, f}, x] && ComplexFreeQ[f] && EqQ[d*e - c*f, 0]
Int[sin[(e_.) + (f_.)*(x_)]/Sqrt[(c_.) + (d_.)*(x_)], x_Symbol] := (2/d)*Subst[Int[Sin[f*(x^2/d)], x], x, Sqrt[c + d*x]] /; FreeQ[{c, d, e, f}, x] && ComplexFreeQ[f] && EqQ[d*e - c*f, 0]
Int[sin[(e_.) + (f_.)*(x_)]/Sqrt[(c_.) + (d_.)*(x_)], x_Symbol] := Cos[(d*e - c*f)/d]*Int[Sin[c*(f/d) + f*x]/Sqrt[c + d*x], x] + Sin[(d*e - c*f)/d]*Int[Cos[c*(f/d) + f*x]/Sqrt[c + d*x], x] /; FreeQ[{c, d, e, f}, x] && ComplexFreeQ[f] && NeQ[d*e - c*f, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*sin[(e_.) + (k_.)*Pi + (f_.)*(x_)], x_Symbol] := (I/2)*Int[(c + d*x)^m/(E^(I*k*Pi)*E^(I*(e + f*x))), x] - (I/2)*Int[(c + d*x)^m*E^(I*k*Pi)*E^(I*(e + f*x)), x] /; FreeQ[{c, d, e, f, m}, x] && IntegerQ[2*k]
Int[((c_.) + (d_.)*(x_))^(m_.)*sin[(e_.) + (f_.)*(x_)], x_Symbol] := (I/2)*Int[(c + d*x)^m/E^(I*(e + f*x)), x] - (I/2)*Int[(c + d*x)^m*E^(I*(e + f*x)), x] /; FreeQ[{c, d, e, f, m}, x]
Int[((c_.) + (d_.)*(x_))^(m_.)*sin[(e_.) + (f_.)*((x_)/2)]^2, x_Symbol] := (1/2)*Int[(c + d*x)^m, x] - (1/2)*Int[(c + d*x)^m*Cos[2*e + f*x], x] /; FreeQ[{c, d, e, f, m}, x]
Int[((c_.) + (d_.)*(x_))*((b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d*((b*Sin[e + f*x])^n/(f^2*n^2)) - b*(c + d*x)*Cos[e + f*x]*((b*Sin[e + f*x])^(n - 1)/(f*n)) + b^2*((n - 1)/n)*Int[(c + d*x)*(b*Sin[e + f*x])^(n - 2), x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1]
Int[((c_.) + (d_.)*(x_))^(m_)*((b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d*m*(c + d*x)^(m - 1)*((b*Sin[e + f*x])^n/(f^2*n^2)) - b*(c + d*x)^m*Cos[e + f*x]*((b*Sin[e + f*x])^(n - 1)/(f*n)) + b^2*((n - 1)/n)*Int[(c + d*x)^m*(b*Sin[e + f*x])^(n - 2), x] - d^2*m*((m - 1)/(f^2*n^2))*Int[(c + d*x)^(m - 2)*(b*Sin[e + f*x])^n, x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1] && GtQ[m, 1]
Int[((c_.) + (d_.)*(x_))^(m_)*sin[(e_.) + (f_.)*(x_)]^(n_), x_Symbol] := Int[ExpandTrigReduce[(c + d*x)^m, Sin[e + f*x]^n, x], x] /; FreeQ[{c, d, e, f, m}, x] && IGtQ[n, 1] && ( !RationalQ[m] || (GeQ[m, -1] && LtQ[m, 1]))
Int[((c_.) + (d_.)*(x_))^(m_)*sin[(e_.) + (f_.)*(x_)]^(n_), x_Symbol] := (c + d*x)^(m + 1)*(Sin[e + f*x]^n/(d*(m + 1))) - f*(n/(d*(m + 1)))*Int[ExpandTrigReduce[(c + d*x)^(m + 1), Cos[e + f*x]*Sin[e + f*x]^(n - 1), x], x] /; FreeQ[{c, d, e, f, m}, x] && IGtQ[n, 1] && GeQ[m, -2] && LtQ[m, -1]
Int[((c_.) + (d_.)*(x_))^(m_)*((b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (c + d*x)^(m + 1)*((b*Sin[e + f*x])^n/(d*(m + 1))) - b*f*n*(c + d*x)^(m + 2)*Cos[e + f*x]*((b*Sin[e + f*x])^(n - 1)/(d^2*(m + 1)*(m + 2))) - f^2*(n^2/(d^2*(m + 1)*(m + 2)))*Int[(c + d*x)^(m + 2)*(b*Sin[e + f*x])^n, x] + b^2*f^2*n*((n - 1)/(d^2*(m + 1)*(m + 2)))*Int[(c + d*x)^(m + 2)*(b*Sin[e + f*x])^(n - 2), x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1] && LtQ[m, -2]
Int[((c_.) + (d_.)*(x_))*((b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (c + d*x)*Cos[e + f*x]*((b*Sin[e + f*x])^(n + 1)/(b*f*(n + 1))) - d*((b*Sin[e + f*x])^(n + 2)/(b^2*f^2*(n + 1)*(n + 2))) + ((n + 2)/(b^2*(n + 1)))*Int[(c + d*x)*(b*Sin[e + f*x])^(n + 2), x] /; FreeQ[{b, c, d, e, f}, x] && LtQ[n, -1] && NeQ[n, -2]
Int[((c_.) + (d_.)*(x_))^(m_.)*((b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (c + d*x)^m*Cos[e + f*x]*((b*Sin[e + f*x])^(n + 1)/(b*f*(n + 1))) - d*m*(c + d*x)^(m - 1)*((b*Sin[e + f*x])^(n + 2)/(b^2*f^2*(n + 1)*(n + 2))) + ((n + 2)/(b^2*(n + 1)))*Int[(c + d*x)^m*(b*Sin[e + f*x])^(n + 2), x] + d^2*m*((m - 1)/(b^2*f^2*(n + 1)*(n + 2)))*Int[(c + d*x)^(m - 2)*(b*Sin[e + f*x])^(n + 2), x] /; FreeQ[{b, c, d, e, f}, x] && LtQ[n, -1] && NeQ[n, -2] && GtQ[m, 1]
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, (a + b*Sin[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[n, 0] && (EqQ[n, 1] || IGtQ[m, 0] || NeQ[a^2 - b^2, 0])
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (2*a)^n*Int[(c + d*x)^m*Sin[(1/2)*(e + Pi*(a/(2*b))) + f*(x/2)]^(2*n), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[n] && (GtQ[n, 0] || IGtQ[m, 0])
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (2*a)^IntPart[n]*((a + b*Sin[e + f*x])^FracPart[n]/Sin[e/2 + a*(Pi/(4*b)) + f*(x/2)]^(2*FracPart[n]))*Int[(c + d*x)^m*Sin[e/2 + a*(Pi/(4*b)) + f*(x/2)]^(2*n), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[n + 1/2] && (GtQ[n, 0] || IGtQ[m, 0])
Int[((c_.) + (d_.)*(x_))^(m_.)/((a_) + (b_.)*sin[(e_.) + (k_.)*Pi + (f_.)*(Complex[0, fz_])*(x_)]), x_Symbol] := 2*Int[((c + d*x)^m*(E^((-I)*e + f*fz*x)/(b + (2*a*E^((-I)*e + f*fz*x))/E^(I*Pi*(k - 1/2)) - (b*E^(2*((-I)*e + f*fz*x)))/E^(2*I*k*Pi))))/E^(I*Pi*(k - 1/2)), x] /; FreeQ[{a, b, c, d, e, f, fz}, x] && IntegerQ[2*k] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)/((a_) + (b_.)*sin[(e_.) + (k_.)*Pi + (f_.)*(x_)]), x_Symbol] := 2*Int[(c + d*x)^m*E^(I*Pi*(k - 1/2))*(E^(I*(e + f*x))/(b + 2*a*E^(I*Pi*(k - 1/2))*E^(I*(e + f*x)) - b*E^(2*I*k*Pi)*E^(2*I*(e + f*x)))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IntegerQ[2*k] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)/((a_) + (b_.)*sin[(e_.) + (f_.)*(Complex[0, fz_])*(x_)]), x_Symbol] := 2*Int[(c + d*x)^m*(E^((-I)*e + f*fz*x)/((-I)*b + 2*a*E^((-I)*e + f*fz*x) + I*b*E^(2*((-I)*e + f*fz*x)))), x] /; FreeQ[{a, b, c, d, e, f, fz}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := 2*Int[(c + d*x)^m*(E^(I*(e + f*x))/(I*b + 2*a*E^(I*(e + f*x)) - I*b*E^(2*I*(e + f*x)))), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^2, x_Symbol] := b*(c + d*x)^m*(Cos[e + f*x]/(f*(a^2 - b^2)*(a + b*Sin[e + f*x]))) + (a/(a^2 - b^2))*Int[(c + d*x)^m/(a + b*Sin[e + f*x]), x] - b*d*(m/(f*(a^2 - b^2)))*Int[(c + d*x)^(m - 1)*(Cos[e + f*x]/(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b)*(c + d*x)^m*Cos[e + f*x]*((a + b*Sin[e + f*x])^(n + 1)/(f*(n + 1)*(a^2 - b^2))) + (a/(a^2 - b^2))*Int[(c + d*x)^m*(a + b*Sin[e + f*x])^(n + 1), x] + b*d*(m/(f*(n + 1)*(a^2 - b^2)))*Int[(c + d*x)^(m - 1)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(n + 1), x] - b*((n + 2)/((n + 1)*(a^2 - b^2)))*Int[(c + d*x)^m*Sin[e + f*x]*(a + b*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 - b^2, 0] && ILtQ[n, -2] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Unintegrable[(c + d*x)^m*(a + b*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[(u_)^(m_.)*((a_.) + (b_.)*Sin[v_])^(n_.), x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Sin[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] &&  !LinearMatchQ[{u, v}, x]
Int[(u_)^(m_.)*((a_.) + (b_.)*Cos[v_])^(n_.), x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Cos[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] &&  !LinearMatchQ[{u, v}, x]

(* ::Subsection::Closed:: *)
(* 4.1.1.1 (a+b sin)^n *)
Int[sin[(c_.) + (d_.)*(x_)]^(n_), x_Symbol] := (-d^(-1))*Subst[Int[Expand[(1 - x^2)^((n - 1)/2), x], x], x, Cos[c + d*x]] /; FreeQ[{c, d}, x] && IGtQ[(n - 1)/2, 0]
Int[sin[(c_.) + (d_.)*((x_)/2)]^2, x_Symbol] := x/2 - Sin[2*c + d*x]/(2*d) /; FreeQ[{c, d}, x]
Int[((b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-b)*Cos[c + d*x]*((b*Sin[c + d*x])^(n - 1)/(d*n)) + b^2*((n - 1)/n)*Int[(b*Sin[c + d*x])^(n - 2), x] /; FreeQ[{b, c, d}, x] && GtQ[n, 1] && IntegerQ[2*n]
Int[((b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Cos[c + d*x]*((b*Sin[c + d*x])^(n + 1)/(b*d*(n + 1))) + ((n + 2)/(b^2*(n + 1)))*Int[(b*Sin[c + d*x])^(n + 2), x] /; FreeQ[{b, c, d}, x] && LtQ[n, -1] && IntegerQ[2*n]
Int[sin[(c_.) + Pi/2 + (d_.)*(x_)], x_Symbol] := Sin[c + d*x]/d /; FreeQ[{c, d}, x]
Int[sin[(c_.) + (d_.)*(x_)], x_Symbol] := -(Cos[c + d*x]/d) /; FreeQ[{c, d}, x]
Int[Sqrt[sin[(c_.) + (d_.)*(x_)]], x_Symbol] := (2/d)*EllipticE[(1/2)*(c - Pi/2 + d*x), 2] /; FreeQ[{c, d}, x]
Int[Sqrt[(b_)*sin[(c_.) + (d_.)*(x_)]], x_Symbol] := (Sqrt[b*Sin[c + d*x]]/Sqrt[Sin[c + d*x]])*Int[Sqrt[Sin[c + d*x]], x] /; FreeQ[{b, c, d}, x]
Int[1/Sqrt[sin[(c_.) + (d_.)*(x_)]], x_Symbol] := (2/d)*EllipticF[(1/2)*(c - Pi/2 + d*x), 2] /; FreeQ[{c, d}, x]
Int[1/Sqrt[(b_)*sin[(c_.) + (d_.)*(x_)]], x_Symbol] := (Sqrt[Sin[c + d*x]]/Sqrt[b*Sin[c + d*x]])*Int[1/Sqrt[Sin[c + d*x]], x] /; FreeQ[{b, c, d}, x]
Int[((b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Cos[c + d*x]*((b*Sin[c + d*x])^(n + 1)/(b*d*(n + 1)*Sqrt[Cos[c + d*x]^2]))*Hypergeometric2F1[1/2, (n + 1)/2, (n + 3)/2, Sin[c + d*x]^2] /; FreeQ[{b, c, d, n}, x] &&  !IntegerQ[2*n]
Int[((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)])^2, x_Symbol] := (2*a^2 + b^2)*(x/2) - 2*a*b*(Cos[c + d*x]/d) - b^2*Cos[c + d*x]*(Sin[c + d*x]/(2*d)) /; FreeQ[{a, b, c, d}, x]
Int[((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Int[ExpandTrig[(a + b*sin[c + d*x])^n, x], x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 - b^2, 0] && IGtQ[n, 0]
Int[Sqrt[(a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]], x_Symbol] := -2*b*(Cos[c + d*x]/(d*Sqrt[a + b*Sin[c + d*x]])) /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-b)*Cos[c + d*x]*((a + b*Sin[c + d*x])^(n - 1)/(d*n)) + a*((2*n - 1)/n)*Int[(a + b*Sin[c + d*x])^(n - 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0] && IGtQ[n - 1/2, 0]
Int[1/((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]), x_Symbol] := -(Cos[c + d*x]/(d*(b + a*Sin[c + d*x]))) /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0]
Int[1/Sqrt[(a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]], x_Symbol] := (-2/d)*Subst[Int[1/(2*a - x^2), x], x, b*(Cos[c + d*x]/Sqrt[a + b*Sin[c + d*x]])] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := b*Cos[c + d*x]*((a + b*Sin[c + d*x])^n/(a*d*(2*n + 1))) + ((n + 1)/(a*(2*n + 1)))*Int[(a + b*Sin[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0] && LtQ[n, -1] && IntegerQ[2*n]
Int[((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-2^(n + 1/2))*a^(n - 1/2)*b*(Cos[c + d*x]/(d*Sqrt[a + b*Sin[c + d*x]]))*Hypergeometric2F1[1/2, 1/2 - n, 3/2, (1/2)*(1 - b*(Sin[c + d*x]/a))] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[2*n] && GtQ[a, 0]
Int[((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := a^IntPart[n]*((a + b*Sin[c + d*x])^FracPart[n]/(1 + (b/a)*Sin[c + d*x])^FracPart[n])*Int[(1 + (b/a)*Sin[c + d*x])^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[2*n] &&  !GtQ[a, 0]
Int[Sqrt[(a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]], x_Symbol] := 2*(Sqrt[a + b]/d)*EllipticE[(1/2)*(c - Pi/2 + d*x), 2*(b/(a + b))] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[a + b, 0]
Int[Sqrt[(a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]], x_Symbol] := 2*(Sqrt[a - b]/d)*EllipticE[(1/2)*(c + Pi/2 + d*x), -2*(b/(a - b))] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[a - b, 0]
Int[Sqrt[(a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]], x_Symbol] := (Sqrt[a + b*Sin[c + d*x]]/Sqrt[(a + b*Sin[c + d*x])/(a + b)])*Int[Sqrt[a/(a + b) + (b/(a + b))*Sin[c + d*x]], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] &&  !GtQ[a + b, 0]
Int[((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-b)*Cos[c + d*x]*((a + b*Sin[c + d*x])^(n - 1)/(d*n)) + (1/n)*Int[(a + b*Sin[c + d*x])^(n - 2)*Simp[a^2*n + b^2*(n - 1) + a*b*(2*n - 1)*Sin[c + d*x], x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 1] && IntegerQ[2*n]
Int[1/((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]), x_Symbol] := With[{q = Rt[a^2 - b^2, 2]}, x/q + (2/(d*q))*ArcTan[b*(Cos[c + d*x]/(a + q + b*Sin[c + d*x]))]] /; FreeQ[{a, b, c, d}, x] && GtQ[a^2 - b^2, 0] && PosQ[a]
Int[1/((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]), x_Symbol] := With[{q = Rt[a^2 - b^2, 2]}, -(x/q) - (2/(d*q))*ArcTan[b*(Cos[c + d*x]/(a - q + b*Sin[c + d*x]))]] /; FreeQ[{a, b, c, d}, x] && GtQ[a^2 - b^2, 0] && NegQ[a]
Int[1/((a_) + (b_.)*sin[(c_.) + Pi/2 + (d_.)*(x_)]), x_Symbol] := With[{e = FreeFactors[Tan[(c + d*x)/2], x]}, 2*(e/d)*Subst[Int[1/(a + b + (a - b)*e^2*x^2), x], x, Tan[(c + d*x)/2]/e]] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[1/((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]), x_Symbol] := With[{e = FreeFactors[Tan[(c + d*x)/2], x]}, 2*(e/d)*Subst[Int[1/(a + 2*b*e*x + a*e^2*x^2), x], x, Tan[(c + d*x)/2]/e]] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[1/Sqrt[(a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]], x_Symbol] := (2/(d*Sqrt[a + b]))*EllipticF[(1/2)*(c - Pi/2 + d*x), 2*(b/(a + b))] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[a + b, 0]
Int[1/Sqrt[(a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]], x_Symbol] := (2/(d*Sqrt[a - b]))*EllipticF[(1/2)*(c + Pi/2 + d*x), -2*(b/(a - b))] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[a - b, 0]
Int[1/Sqrt[(a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]], x_Symbol] := (Sqrt[(a + b*Sin[c + d*x])/(a + b)]/Sqrt[a + b*Sin[c + d*x]])*Int[1/Sqrt[a/(a + b) + (b/(a + b))*Sin[c + d*x]], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] &&  !GtQ[a + b, 0]
Int[((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-b)*Cos[c + d*x]*((a + b*Sin[c + d*x])^(n + 1)/(d*(n + 1)*(a^2 - b^2))) + (1/((n + 1)*(a^2 - b^2)))*Int[(a + b*Sin[c + d*x])^(n + 1)*Simp[a*(n + 1) - b*(n + 2)*Sin[c + d*x], x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && LtQ[n, -1] && IntegerQ[2*n]
Int[((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (Cos[c + d*x]/(d*Sqrt[1 + Sin[c + d*x]]*Sqrt[1 - Sin[c + d*x]]))*Subst[Int[(a + b*x)^n/(Sqrt[1 + x]*Sqrt[1 - x]), x], x, Sin[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 - b^2, 0] &&  !IntegerQ[2*n]
Int[((a_) + (b_.)*sin[(c_.) + (d_.)*(x_)]*cos[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Int[(a + b*(Sin[2*c + 2*d*x]/2))^n, x] /; FreeQ[{a, b, c, d, n}, x]

(* ::Subsection::Closed:: *)
(* 4.1.11 (e x)^m (a+b x^n)^p sin *)
Int[((a_) + (b_.)*(x_)^(n_))^(p_.)*Sin[(c_.) + (d_.)*(x_)], x_Symbol] := Int[ExpandIntegrand[Sin[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 0]
Int[((a_) + (b_.)*(x_)^(n_))^(p_.)*Cos[(c_.) + (d_.)*(x_)], x_Symbol] := Int[ExpandIntegrand[Cos[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 0]
Int[((a_) + (b_.)*(x_)^(n_))^(p_)*Sin[(c_.) + (d_.)*(x_)], x_Symbol] := x^(-n + 1)*(a + b*x^n)^(p + 1)*(Sin[c + d*x]/(b*n*(p + 1))) - ((-n + 1)/(b*n*(p + 1)))*Int[((a + b*x^n)^(p + 1)*Sin[c + d*x])/x^n, x] - (d/(b*n*(p + 1)))*Int[x^(-n + 1)*(a + b*x^n)^(p + 1)*Cos[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, -1] && IGtQ[n, 2]
Int[((a_) + (b_.)*(x_)^(n_))^(p_)*Cos[(c_.) + (d_.)*(x_)], x_Symbol] := x^(-n + 1)*(a + b*x^n)^(p + 1)*(Cos[c + d*x]/(b*n*(p + 1))) - ((-n + 1)/(b*n*(p + 1)))*Int[((a + b*x^n)^(p + 1)*Cos[c + d*x])/x^n, x] + (d/(b*n*(p + 1)))*Int[x^(-n + 1)*(a + b*x^n)^(p + 1)*Sin[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, -1] && IGtQ[n, 2]
Int[((a_) + (b_.)*(x_)^(n_))^(p_)*Sin[(c_.) + (d_.)*(x_)], x_Symbol] := Int[ExpandIntegrand[Sin[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1])
Int[((a_) + (b_.)*(x_)^(n_))^(p_)*Cos[(c_.) + (d_.)*(x_)], x_Symbol] := Int[ExpandIntegrand[Cos[c + d*x], (a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1])
Int[((a_) + (b_.)*(x_)^(n_))^(p_)*Sin[(c_.) + (d_.)*(x_)], x_Symbol] := Int[x^(n*p)*(b + a/x^n)^p*Sin[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[((a_) + (b_.)*(x_)^(n_))^(p_)*Cos[(c_.) + (d_.)*(x_)], x_Symbol] := Int[x^(n*p)*(b + a/x^n)^p*Cos[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[((a_) + (b_.)*(x_)^(n_))^(p_)*Sin[(c_.) + (d_.)*(x_)], x_Symbol] := Unintegrable[(a + b*x^n)^p*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[((a_) + (b_.)*(x_)^(n_))^(p_)*Cos[(c_.) + (d_.)*(x_)], x_Symbol] := Unintegrable[(a + b*x^n)^p*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[((e_.)*(x_))^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_.)*Sin[(c_.) + (d_.)*(x_)], x_Symbol] := Int[ExpandIntegrand[Sin[c + d*x], (e*x)^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[((e_.)*(x_))^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_.)*Cos[(c_.) + (d_.)*(x_)], x_Symbol] := Int[ExpandIntegrand[Cos[c + d*x], (e*x)^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[((e_.)*(x_))^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_)*Sin[(c_.) + (d_.)*(x_)], x_Symbol] := e^m*(a + b*x^n)^(p + 1)*(Sin[c + d*x]/(b*n*(p + 1))) - d*(e^m/(b*n*(p + 1)))*Int[(a + b*x^n)^(p + 1)*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && ILtQ[p, -1] && EqQ[m, n - 1] && (IntegerQ[n] || GtQ[e, 0])
Int[((e_.)*(x_))^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_)*Cos[(c_.) + (d_.)*(x_)], x_Symbol] := e^m*(a + b*x^n)^(p + 1)*(Cos[c + d*x]/(b*n*(p + 1))) + d*(e^m/(b*n*(p + 1)))*Int[(a + b*x^n)^(p + 1)*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && ILtQ[p, -1] && EqQ[m, n - 1] && (IntegerQ[n] || GtQ[e, 0])
Int[(x_)^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_)*Sin[(c_.) + (d_.)*(x_)], x_Symbol] := x^(m - n + 1)*(a + b*x^n)^(p + 1)*(Sin[c + d*x]/(b*n*(p + 1))) - ((m - n + 1)/(b*n*(p + 1)))*Int[x^(m - n)*(a + b*x^n)^(p + 1)*Sin[c + d*x], x] - (d/(b*n*(p + 1)))*Int[x^(m - n + 1)*(a + b*x^n)^(p + 1)*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, -1] && IGtQ[n, 0] && (GtQ[m - n + 1, 0] || GtQ[n, 2]) && RationalQ[m]
Int[(x_)^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_)*Cos[(c_.) + (d_.)*(x_)], x_Symbol] := x^(m - n + 1)*(a + b*x^n)^(p + 1)*(Cos[c + d*x]/(b*n*(p + 1))) - ((m - n + 1)/(b*n*(p + 1)))*Int[x^(m - n)*(a + b*x^n)^(p + 1)*Cos[c + d*x], x] + (d/(b*n*(p + 1)))*Int[x^(m - n + 1)*(a + b*x^n)^(p + 1)*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, -1] && IGtQ[n, 0] && (GtQ[m - n + 1, 0] || GtQ[n, 2]) && RationalQ[m]
Int[(x_)^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_)*Sin[(c_.) + (d_.)*(x_)], x_Symbol] := Int[ExpandIntegrand[Sin[c + d*x], x^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, 0] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1]) && IntegerQ[m]
Int[(x_)^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_)*Cos[(c_.) + (d_.)*(x_)], x_Symbol] := Int[ExpandIntegrand[Cos[c + d*x], x^m*(a + b*x^n)^p, x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, 0] && IGtQ[n, 0] && (EqQ[n, 2] || EqQ[p, -1]) && IntegerQ[m]
Int[(x_)^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_)*Sin[(c_.) + (d_.)*(x_)], x_Symbol] := Int[x^(m + n*p)*(b + a/x^n)^p*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[(x_)^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_)*Cos[(c_.) + (d_.)*(x_)], x_Symbol] := Int[x^(m + n*p)*(b + a/x^n)^p*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, m}, x] && ILtQ[p, 0] && ILtQ[n, 0]
Int[((e_.)*(x_))^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_.)*Sin[(c_.) + (d_.)*(x_)], x_Symbol] := Unintegrable[(e*x)^m*(a + b*x^n)^p*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[((e_.)*(x_))^(m_.)*((a_) + (b_.)*(x_)^(n_))^(p_.)*Cos[(c_.) + (d_.)*(x_)], x_Symbol] := Unintegrable[(e*x)^m*(a + b*x^n)^p*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]

(* ::Subsection::Closed:: *)
(* 4.1.12 (e x)^m (a+b sin(c+d x^n))^p *)
Int[Sin[(d_.)*((e_.) + (f_.)*(x_))^2], x_Symbol] := (Sqrt[Pi/2]/(f*Rt[d, 2]))*FresnelS[Sqrt[2/Pi]*Rt[d, 2]*(e + f*x)] /; FreeQ[{d, e, f}, x]
Int[Cos[(d_.)*((e_.) + (f_.)*(x_))^2], x_Symbol] := (Sqrt[Pi/2]/(f*Rt[d, 2]))*FresnelC[Sqrt[2/Pi]*Rt[d, 2]*(e + f*x)] /; FreeQ[{d, e, f}, x]
Int[Sin[(c_) + (d_.)*((e_.) + (f_.)*(x_))^2], x_Symbol] := Sin[c]*Int[Cos[d*(e + f*x)^2], x] + Cos[c]*Int[Sin[d*(e + f*x)^2], x] /; FreeQ[{c, d, e, f}, x]
Int[Cos[(c_) + (d_.)*((e_.) + (f_.)*(x_))^2], x_Symbol] := Cos[c]*Int[Cos[d*(e + f*x)^2], x] - Sin[c]*Int[Sin[d*(e + f*x)^2], x] /; FreeQ[{c, d, e, f}, x]
Int[Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)], x_Symbol] := (I/2)*Int[E^((-c)*I - d*I*(e + f*x)^n), x] - (I/2)*Int[E^(c*I + d*I*(e + f*x)^n), x] /; FreeQ[{c, d, e, f}, x] && IGtQ[n, 2]
Int[Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)], x_Symbol] := (1/2)*Int[E^((-c)*I - d*I*(e + f*x)^n), x] + (1/2)*Int[E^(c*I + d*I*(e + f*x)^n), x] /; FreeQ[{c, d, e, f}, x] && IGtQ[n, 2]
Int[((a_.) + (b_.)*Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_), x_Symbol] := Int[ExpandTrigReduce[(a + b*Sin[c + d*(e + f*x)^n])^p, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 1] && IGtQ[n, 1]
Int[((a_.) + (b_.)*Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_), x_Symbol] := Int[ExpandTrigReduce[(a + b*Cos[c + d*(e + f*x)^n])^p, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 1] && IGtQ[n, 1]
Int[((a_.) + (b_.)*Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := (-f^(-1))*Subst[Int[(a + b*Sin[c + d/x^n])^p/x^2, x], x, 1/(e + f*x)] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && ILtQ[n, 0] && EqQ[n, -2]
Int[((a_.) + (b_.)*Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := (-f^(-1))*Subst[Int[(a + b*Cos[c + d/x^n])^p/x^2, x], x, 1/(e + f*x)] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && ILtQ[n, 0] && EqQ[n, -2]
Int[((a_.) + (b_.)*Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := (1/(n*f))*Subst[Int[x^(1/n - 1)*(a + b*Sin[c + d*x])^p, x], x, (e + f*x)^n] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IntegerQ[1/n]
Int[((a_.) + (b_.)*Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := (1/(n*f))*Subst[Int[x^(1/n - 1)*(a + b*Cos[c + d*x])^p, x], x, (e + f*x)^n] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IntegerQ[1/n]
Int[((a_.) + (b_.)*Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := Module[{k = Denominator[n]}, (k/f)*Subst[Int[x^(k - 1)*(a + b*Sin[c + d*x^(k*n)])^p, x], x, (e + f*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && FractionQ[n]
Int[((a_.) + (b_.)*Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := Module[{k = Denominator[n]}, (k/f)*Subst[Int[x^(k - 1)*(a + b*Cos[c + d*x^(k*n)])^p, x], x, (e + f*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && FractionQ[n]
Int[Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)], x_Symbol] := (I/2)*Int[E^((-c)*I - d*I*(e + f*x)^n), x] - (I/2)*Int[E^(c*I + d*I*(e + f*x)^n), x] /; FreeQ[{c, d, e, f, n}, x]
Int[Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)], x_Symbol] := (1/2)*Int[E^((-c)*I - d*I*(e + f*x)^n), x] + (1/2)*Int[E^(c*I + d*I*(e + f*x)^n), x] /; FreeQ[{c, d, e, f, n}, x]
Int[((a_.) + (b_.)*Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_), x_Symbol] := Int[ExpandTrigReduce[(a + b*Sin[c + d*(e + f*x)^n])^p, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[p, 1]
Int[((a_.) + (b_.)*Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_), x_Symbol] := Int[ExpandTrigReduce[(a + b*Cos[c + d*(e + f*x)^n])^p, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[p, 1]
Int[((a_.) + (b_.)*Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_), x_Symbol] := Unintegrable[(a + b*Sin[c + d*(e + f*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, n, p}, x]
Int[((a_.) + (b_.)*Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_), x_Symbol] := Unintegrable[(a + b*Cos[c + d*(e + f*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, n, p}, x]
Int[((a_.) + (b_.)*Sin[(c_.) + (d_.)*(u_)^(n_)])^(p_.), x_Symbol] := Int[(a + b*Sin[c + d*ExpandToSum[u, x]^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] &&  !LinearMatchQ[u, x]
Int[((a_.) + (b_.)*Cos[(c_.) + (d_.)*(u_)^(n_)])^(p_.), x_Symbol] := Int[(a + b*Cos[c + d*ExpandToSum[u, x]^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] &&  !LinearMatchQ[u, x]
Int[((a_.) + (b_.)*Sin[u_])^(p_.), x_Symbol] := Int[(a + b*Sin[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[((a_.) + (b_.)*Cos[u_])^(p_.), x_Symbol] := Int[(a + b*Cos[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[Sin[(d_.)*(x_)^(n_)]/(x_), x_Symbol] := SinIntegral[d*x^n]/n /; FreeQ[{d, n}, x]
Int[Cos[(d_.)*(x_)^(n_)]/(x_), x_Symbol] := CosIntegral[d*x^n]/n /; FreeQ[{d, n}, x]
Int[Sin[(c_) + (d_.)*(x_)^(n_)]/(x_), x_Symbol] := Sin[c]*Int[Cos[d*x^n]/x, x] + Cos[c]*Int[Sin[d*x^n]/x, x] /; FreeQ[{c, d, n}, x]
Int[Cos[(c_) + (d_.)*(x_)^(n_)]/(x_), x_Symbol] := Cos[c]*Int[Cos[d*x^n]/x, x] - Sin[c]*Int[Sin[d*x^n]/x, x] /; FreeQ[{c, d, n}, x]
Int[(x_)^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/n)*Subst[Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Sin[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]] && (EqQ[p, 1] || EqQ[m, n - 1] || (IntegerQ[p] && GtQ[Simplify[(m + 1)/n], 0]))
Int[(x_)^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/n)*Subst[Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Cos[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]] && (EqQ[p, 1] || EqQ[m, n - 1] || (IntegerQ[p] && GtQ[Simplify[(m + 1)/n], 0]))
Int[((e_)*(x_))^(m_)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := e^IntPart[m]*((e*x)^FracPart[m]/x^FracPart[m])*Int[x^m*(a + b*Sin[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[((e_)*(x_))^(m_)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := e^IntPart[m]*((e*x)^FracPart[m]/x^FracPart[m])*Int[x^m*(a + b*Cos[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && IntegerQ[Simplify[(m + 1)/n]]
Int[(x_)^(m_.)*Sin[(a_.) + (b_.)*(x_)^(n_)], x_Symbol] := (2/n)*Subst[Int[Sin[a + b*x^2], x], x, x^(n/2)] /; FreeQ[{a, b, m, n}, x] && EqQ[m, n/2 - 1]
Int[(x_)^(m_.)*Cos[(a_.) + (b_.)*(x_)^(n_)], x_Symbol] := (2/n)*Subst[Int[Cos[a + b*x^2], x], x, x^(n/2)] /; FreeQ[{a, b, m, n}, x] && EqQ[m, n/2 - 1]
Int[((e_.)*(x_))^(m_.)*Sin[(c_.) + (d_.)*(x_)^(n_)], x_Symbol] := (-e^(n - 1))*(e*x)^(m - n + 1)*(Cos[c + d*x^n]/(d*n)) + e^n*((m - n + 1)/(d*n))*Int[(e*x)^(m - n)*Cos[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[n, m + 1]
Int[((e_.)*(x_))^(m_.)*Cos[(c_.) + (d_.)*(x_)^(n_)], x_Symbol] := e^(n - 1)*(e*x)^(m - n + 1)*(Sin[c + d*x^n]/(d*n)) - e^n*((m - n + 1)/(d*n))*Int[(e*x)^(m - n)*Sin[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[n, m + 1]
Int[((e_.)*(x_))^(m_)*Sin[(c_.) + (d_.)*(x_)^(n_)], x_Symbol] := (e*x)^(m + 1)*(Sin[c + d*x^n]/(e*(m + 1))) - d*(n/(e^n*(m + 1)))*Int[(e*x)^(m + n)*Cos[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[m, -1]
Int[((e_.)*(x_))^(m_)*Cos[(c_.) + (d_.)*(x_)^(n_)], x_Symbol] := (e*x)^(m + 1)*(Cos[c + d*x^n]/(e*(m + 1))) + d*(n/(e^n*(m + 1)))*Int[(e*x)^(m + n)*Sin[c + d*x^n], x] /; FreeQ[{c, d, e}, x] && IGtQ[n, 0] && LtQ[m, -1]
Int[((e_.)*(x_))^(m_.)*Sin[(c_.) + (d_.)*(x_)^(n_)], x_Symbol] := (I/2)*Int[(e*x)^m*E^((-c)*I - d*I*x^n), x] - (I/2)*Int[(e*x)^m*E^(c*I + d*I*x^n), x] /; FreeQ[{c, d, e, m}, x] && IGtQ[n, 0]
Int[((e_.)*(x_))^(m_.)*Cos[(c_.) + (d_.)*(x_)^(n_)], x_Symbol] := (1/2)*Int[(e*x)^m*E^((-c)*I - d*I*x^n), x] + (1/2)*Int[(e*x)^m*E^(c*I + d*I*x^n), x] /; FreeQ[{c, d, e, m}, x] && IGtQ[n, 0]
Int[(x_)^(m_.)*Sin[(a_.) + (b_.)*((x_)^(n_)/2)]^2, x_Symbol] := (1/2)*Int[x^m, x] - (1/2)*Int[x^m*Cos[2*a + b*x^n], x] /; FreeQ[{a, b, m, n}, x]
Int[(x_)^(m_.)*Cos[(a_.) + (b_.)*((x_)^(n_)/2)]^2, x_Symbol] := (1/2)*Int[x^m, x] + (1/2)*Int[x^m*Cos[2*a + b*x^n], x] /; FreeQ[{a, b, m, n}, x]
Int[(x_)^(m_.)*Sin[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := x^(m + 1)*(Sin[a + b*x^n]^p/(m + 1)) - b*n*(p/(m + 1))*Int[Sin[a + b*x^n]^(p - 1)*Cos[a + b*x^n], x] /; FreeQ[{a, b}, x] && IGtQ[p, 1] && EqQ[m + n, 0] && NeQ[n, 1] && IntegerQ[n]
Int[(x_)^(m_.)*Cos[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := x^(m + 1)*(Cos[a + b*x^n]^p/(m + 1)) + b*n*(p/(m + 1))*Int[Cos[a + b*x^n]^(p - 1)*Sin[a + b*x^n], x] /; FreeQ[{a, b}, x] && IGtQ[p, 1] && EqQ[m + n, 0] && NeQ[n, 1] && IntegerQ[n]
Int[(x_)^(m_.)*Sin[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := n*(Sin[a + b*x^n]^p/(b^2*n^2*p^2)) - x^n*Cos[a + b*x^n]*(Sin[a + b*x^n]^(p - 1)/(b*n*p)) + ((p - 1)/p)*Int[x^m*Sin[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1, 0] && GtQ[p, 1]
Int[(x_)^(m_.)*Cos[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := n*(Cos[a + b*x^n]^p/(b^2*n^2*p^2)) + x^n*Sin[a + b*x^n]*(Cos[a + b*x^n]^(p - 1)/(b*n*p)) + ((p - 1)/p)*Int[x^m*Cos[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1, 0] && GtQ[p, 1]
Int[(x_)^(m_.)*Sin[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := (m - n + 1)*x^(m - 2*n + 1)*(Sin[a + b*x^n]^p/(b^2*n^2*p^2)) - x^(m - n + 1)*Cos[a + b*x^n]*(Sin[a + b*x^n]^(p - 1)/(b*n*p)) + ((p - 1)/p)*Int[x^m*Sin[a + b*x^n]^(p - 2), x] - (m - n + 1)*((m - 2*n + 1)/(b^2*n^2*p^2))*Int[x^(m - 2*n)*Sin[a + b*x^n]^p, x] /; FreeQ[{a, b}, x] && GtQ[p, 1] && IGtQ[n, 0] && IGtQ[m, 2*n - 1]
Int[(x_)^(m_.)*Cos[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := (m - n + 1)*x^(m - 2*n + 1)*(Cos[a + b*x^n]^p/(b^2*n^2*p^2)) + x^(m - n + 1)*Sin[a + b*x^n]*(Cos[a + b*x^n]^(p - 1)/(b*n*p)) + ((p - 1)/p)*Int[x^m*Cos[a + b*x^n]^(p - 2), x] - (m - n + 1)*((m - 2*n + 1)/(b^2*n^2*p^2))*Int[x^(m - 2*n)*Cos[a + b*x^n]^p, x] /; FreeQ[{a, b}, x] && GtQ[p, 1] && IGtQ[n, 0] && IGtQ[m, 2*n - 1]
Int[(x_)^(m_.)*Sin[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := x^(m + 1)*(Sin[a + b*x^n]^p/(m + 1)) - b*n*p*x^(m + n + 1)*Cos[a + b*x^n]*(Sin[a + b*x^n]^(p - 1)/((m + 1)*(m + n + 1))) - b^2*n^2*(p^2/((m + 1)*(m + n + 1)))*Int[x^(m + 2*n)*Sin[a + b*x^n]^p, x] + b^2*n^2*p*((p - 1)/((m + 1)*(m + n + 1)))*Int[x^(m + 2*n)*Sin[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b}, x] && GtQ[p, 1] && IGtQ[n, 0] && ILtQ[m, -2*n + 1] && NeQ[m + n + 1, 0]
Int[(x_)^(m_.)*Cos[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := x^(m + 1)*(Cos[a + b*x^n]^p/(m + 1)) + b*n*p*x^(m + n + 1)*Sin[a + b*x^n]*(Cos[a + b*x^n]^(p - 1)/((m + 1)*(m + n + 1))) - b^2*n^2*(p^2/((m + 1)*(m + n + 1)))*Int[x^(m + 2*n)*Cos[a + b*x^n]^p, x] + b^2*n^2*p*((p - 1)/((m + 1)*(m + n + 1)))*Int[x^(m + 2*n)*Cos[a + b*x^n]^(p - 2), x] /; FreeQ[{a, b}, x] && GtQ[p, 1] && IGtQ[n, 0] && ILtQ[m, -2*n + 1] && NeQ[m + n + 1, 0]
Int[((e_.)*(x_))^(m_)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := With[{k = Denominator[m]}, (k/e)*Subst[Int[x^(k*(m + 1) - 1)*(a + b*Sin[c + d*(x^(k*n)/e^n)])^p, x], x, (e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[p] && IGtQ[n, 0] && FractionQ[m]
Int[((e_.)*(x_))^(m_)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := With[{k = Denominator[m]}, (k/e)*Subst[Int[x^(k*(m + 1) - 1)*(a + b*Cos[c + d*(x^(k*n)/e^n)])^p, x], x, (e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[p] && IGtQ[n, 0] && FractionQ[m]
Int[((e_.)*(x_))^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_), x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Sin[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[p, 1] && IGtQ[n, 0]
Int[((e_.)*(x_))^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_), x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Cos[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[p, 1] && IGtQ[n, 0]
Int[(x_)^(m_.)*Sin[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := x^n*Cos[a + b*x^n]*(Sin[a + b*x^n]^(p + 1)/(b*n*(p + 1))) - n*(Sin[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2))) + ((p + 2)/(p + 1))*Int[x^m*Sin[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1, 0] && LtQ[p, -1] && NeQ[p, -2]
Int[(x_)^(m_.)*Cos[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := (-x^n)*Sin[a + b*x^n]*(Cos[a + b*x^n]^(p + 1)/(b*n*(p + 1))) - n*(Cos[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2))) + ((p + 2)/(p + 1))*Int[x^m*Cos[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b, m, n}, x] && EqQ[m - 2*n + 1, 0] && LtQ[p, -1] && NeQ[p, -2]
Int[(x_)^(m_.)*Sin[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := x^(m - n + 1)*Cos[a + b*x^n]*(Sin[a + b*x^n]^(p + 1)/(b*n*(p + 1))) - (m - n + 1)*x^(m - 2*n + 1)*(Sin[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2))) + ((p + 2)/(p + 1))*Int[x^m*Sin[a + b*x^n]^(p + 2), x] + (m - n + 1)*((m - 2*n + 1)/(b^2*n^2*(p + 1)*(p + 2)))*Int[x^(m - 2*n)*Sin[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b}, x] && LtQ[p, -1] && NeQ[p, -2] && IGtQ[n, 0] && IGtQ[m, 2*n - 1]
Int[(x_)^(m_.)*Cos[(a_.) + (b_.)*(x_)^(n_)]^(p_), x_Symbol] := (-x^(m - n + 1))*Sin[a + b*x^n]*(Cos[a + b*x^n]^(p + 1)/(b*n*(p + 1))) - (m - n + 1)*x^(m - 2*n + 1)*(Cos[a + b*x^n]^(p + 2)/(b^2*n^2*(p + 1)*(p + 2))) + ((p + 2)/(p + 1))*Int[x^m*Cos[a + b*x^n]^(p + 2), x] + (m - n + 1)*((m - 2*n + 1)/(b^2*n^2*(p + 1)*(p + 2)))*Int[x^(m - 2*n)*Cos[a + b*x^n]^(p + 2), x] /; FreeQ[{a, b}, x] && LtQ[p, -1] && NeQ[p, -2] && IGtQ[n, 0] && IGtQ[m, 2*n - 1]
Int[(x_)^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := -Subst[Int[(a + b*Sin[c + d/x^n])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0] && ILtQ[n, 0] && IntegerQ[m] && EqQ[n, -2]
Int[(x_)^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := -Subst[Int[(a + b*Cos[c + d/x^n])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d}, x] && IGtQ[p, 0] && ILtQ[n, 0] && IntegerQ[m] && EqQ[n, -2]
Int[((e_.)*(x_))^(m_)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := With[{k = Denominator[m]}, (-(k/e))*Subst[Int[(a + b*Sin[c + d/(e^n*x^(k*n))])^p/x^(k*(m + 1) + 1), x], x, 1/(e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && ILtQ[n, 0] && FractionQ[m]
Int[((e_.)*(x_))^(m_)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := With[{k = Denominator[m]}, (-(k/e))*Subst[Int[(a + b*Cos[c + d/(e^n*x^(k*n))])^p/x^(k*(m + 1) + 1), x], x, 1/(e*x)^(1/k)]] /; FreeQ[{a, b, c, d, e}, x] && IGtQ[p, 0] && ILtQ[n, 0] && FractionQ[m]
Int[((e_.)*(x_))^(m_)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (-(e*x)^m)*(x^(-1))^m*Subst[Int[(a + b*Sin[c + d/x^n])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[p, 0] && ILtQ[n, 0] &&  !RationalQ[m]
Int[((e_.)*(x_))^(m_)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (-(e*x)^m)*(x^(-1))^m*Subst[Int[(a + b*Cos[c + d/x^n])^p/x^(m + 2), x], x, 1/x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[p, 0] && ILtQ[n, 0] &&  !RationalQ[m]
Int[(x_)^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Module[{k = Denominator[n]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*Sin[c + d*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, m}, x] && IntegerQ[p] && FractionQ[n]
Int[(x_)^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Module[{k = Denominator[n]}, k*Subst[Int[x^(k*(m + 1) - 1)*(a + b*Cos[c + d*x^(k*n)])^p, x], x, x^(1/k)]] /; FreeQ[{a, b, c, d, m}, x] && IntegerQ[p] && FractionQ[n]
Int[((e_)*(x_))^(m_)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := e^IntPart[m]*((e*x)^FracPart[m]/x^FracPart[m])*Int[x^m*(a + b*Sin[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m}, x] && IntegerQ[p] && FractionQ[n]
Int[((e_)*(x_))^(m_)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := e^IntPart[m]*((e*x)^FracPart[m]/x^FracPart[m])*Int[x^m*(a + b*Cos[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m}, x] && IntegerQ[p] && FractionQ[n]
Int[(x_)^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/(m + 1))*Subst[Int[(a + b*Sin[c + d*x^Simplify[n/(m + 1)]])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, c, d, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] &&  !IntegerQ[n]
Int[(x_)^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/(m + 1))*Subst[Int[(a + b*Cos[c + d*x^Simplify[n/(m + 1)]])^p, x], x, x^(m + 1)] /; FreeQ[{a, b, c, d, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] &&  !IntegerQ[n]
Int[((e_)*(x_))^(m_)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := e^IntPart[m]*((e*x)^FracPart[m]/x^FracPart[m])*Int[x^m*(a + b*Sin[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] &&  !IntegerQ[n]
Int[((e_)*(x_))^(m_)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := e^IntPart[m]*((e*x)^FracPart[m]/x^FracPart[m])*Int[x^m*(a + b*Cos[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IntegerQ[p] && NeQ[m, -1] && IGtQ[Simplify[n/(m + 1)], 0] &&  !IntegerQ[n]
Int[((e_.)*(x_))^(m_.)*Sin[(c_.) + (d_.)*(x_)^(n_)], x_Symbol] := (I/2)*Int[(e*x)^m*E^((-c)*I - d*I*x^n), x] - (I/2)*Int[(e*x)^m*E^(c*I + d*I*x^n), x] /; FreeQ[{c, d, e, m, n}, x]
Int[((e_.)*(x_))^(m_.)*Cos[(c_.) + (d_.)*(x_)^(n_)], x_Symbol] := (1/2)*Int[(e*x)^m*E^((-c)*I - d*I*x^n), x] + (1/2)*Int[(e*x)^m*E^(c*I + d*I*x^n), x] /; FreeQ[{c, d, e, m, n}, x]
Int[((e_.)*(x_))^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_), x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Sin[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[((e_.)*(x_))^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_), x_Symbol] := Int[ExpandTrigReduce[(e*x)^m, (a + b*Cos[c + d*x^n])^p, x], x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 0]
Int[((e_.)*(x_))^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Unintegrable[(e*x)^m*(a + b*Sin[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[((e_.)*(x_))^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Unintegrable[(e*x)^m*(a + b*Cos[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[((e_)*(x_))^(m_.)*((a_.) + (b_.)*Sin[u_])^(p_.), x_Symbol] := Int[(e*x)^m*(a + b*Sin[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[((e_)*(x_))^(m_.)*((a_.) + (b_.)*Cos[u_])^(p_.), x_Symbol] := Int[(e*x)^m*(a + b*Cos[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[((g_.) + (h_.)*(x_))^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := (1/(n*f))*Subst[Int[ExpandIntegrand[(a + b*Sin[c + d*x])^p, x^(1/n - 1)*(g - e*(h/f) + h*(x^(1/n)/f))^m, x], x], x, (e + f*x)^n] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IGtQ[p, 0] && IntegerQ[1/n]
Int[((g_.) + (h_.)*(x_))^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := (1/(n*f))*Subst[Int[ExpandIntegrand[(a + b*Cos[c + d*x])^p, x^(1/n - 1)*(g - e*(h/f) + h*(x^(1/n)/f))^m, x], x], x, (e + f*x)^n] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IGtQ[p, 0] && IntegerQ[1/n]
Int[((g_.) + (h_.)*(x_))^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := Module[{k = If[FractionQ[n], Denominator[n], 1]}, (k/f^(m + 1))*Subst[Int[ExpandIntegrand[(a + b*Sin[c + d*x^(k*n)])^p, x^(k - 1)*(f*g - e*h + h*x^k)^m, x], x], x, (e + f*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IGtQ[p, 0] && IGtQ[m, 0]
Int[((g_.) + (h_.)*(x_))^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := Module[{k = If[FractionQ[n], Denominator[n], 1]}, (k/f^(m + 1))*Subst[Int[ExpandIntegrand[(a + b*Cos[c + d*x^(k*n)])^p, x^(k - 1)*(f*g - e*h + h*x^k)^m, x], x], x, (e + f*x)^(1/k)]] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && IGtQ[p, 0] && IGtQ[m, 0]
Int[((g_.) + (h_.)*(x_))^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := (1/f)*Subst[Int[(h*(x/f))^m*(a + b*Sin[c + d*x^n])^p, x], x, e + f*x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IGtQ[p, 0] && EqQ[f*g - e*h, 0]
Int[((g_.) + (h_.)*(x_))^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := (1/f)*Subst[Int[(h*(x/f))^m*(a + b*Cos[c + d*x^n])^p, x], x, e + f*x] /; FreeQ[{a, b, c, d, e, f, g, h, m}, x] && IGtQ[p, 0] && EqQ[f*g - e*h, 0]
Int[((g_.) + (h_.)*(x_))^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := Unintegrable[(g + h*x)^m*(a + b*Sin[c + d*(e + f*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p}, x]
Int[((g_.) + (h_.)*(x_))^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*((e_.) + (f_.)*(x_))^(n_)])^(p_.), x_Symbol] := Unintegrable[(g + h*x)^m*(a + b*Cos[c + d*(e + f*x)^n])^p, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, p}, x]
Int[(v_)^(m_.)*((a_.) + (b_.)*Sin[(c_.) + (d_.)*(u_)^(n_)])^(p_.), x_Symbol] := Int[ExpandToSum[v, x]^m*(a + b*Sin[c + d*ExpandToSum[u, x]^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && LinearQ[u, x] && LinearQ[v, x] &&  !(LinearMatchQ[u, x] && LinearMatchQ[v, x])
Int[(v_)^(m_.)*((a_.) + (b_.)*Cos[(c_.) + (d_.)*(u_)^(n_)])^(p_.), x_Symbol] := Int[ExpandToSum[v, x]^m*(a + b*Cos[c + d*ExpandToSum[u, x]^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x] && LinearQ[u, x] && LinearQ[v, x] &&  !(LinearMatchQ[u, x] && LinearMatchQ[v, x])
Int[(x_)^(m_.)*Sin[(a_.) + (b_.)*(x_)^(n_.)]^(p_.)*Cos[(a_.) + (b_.)*(x_)^(n_.)], x_Symbol] := Sin[a + b*x^n]^(p + 1)/(b*n*(p + 1)) /; FreeQ[{a, b, m, n, p}, x] && EqQ[m, n - 1] && NeQ[p, -1]
Int[(x_)^(m_.)*Cos[(a_.) + (b_.)*(x_)^(n_.)]^(p_.)*Sin[(a_.) + (b_.)*(x_)^(n_.)], x_Symbol] := -(Cos[a + b*x^n]^(p + 1)/(b*n*(p + 1))) /; FreeQ[{a, b, m, n, p}, x] && EqQ[m, n - 1] && NeQ[p, -1]
Int[(x_)^(m_.)*Sin[(a_.) + (b_.)*(x_)^(n_.)]^(p_.)*Cos[(a_.) + (b_.)*(x_)^(n_.)], x_Symbol] := x^(m - n + 1)*(Sin[a + b*x^n]^(p + 1)/(b*n*(p + 1))) - ((m - n + 1)/(b*n*(p + 1)))*Int[x^(m - n)*Sin[a + b*x^n]^(p + 1), x] /; FreeQ[{a, b, p}, x] && LtQ[0, n, m + 1] && NeQ[p, -1]
Int[(x_)^(m_.)*Cos[(a_.) + (b_.)*(x_)^(n_.)]^(p_.)*Sin[(a_.) + (b_.)*(x_)^(n_.)], x_Symbol] := (-x^(m - n + 1))*(Cos[a + b*x^n]^(p + 1)/(b*n*(p + 1))) + ((m - n + 1)/(b*n*(p + 1)))*Int[x^(m - n)*Cos[a + b*x^n]^(p + 1), x] /; FreeQ[{a, b, p}, x] && LtQ[0, n, m + 1] && NeQ[p, -1]

(* ::Subsection::Closed:: *)
(* 4.1.1.2 (g cos)^p (a+b sin)^m *)
Int[cos[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := (1/(b^p*f))*Subst[Int[(a + x)^(m + (p - 1)/2)*(a - x)^((p - 1)/2), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && IntegerQ[(p - 1)/2] && EqQ[a^2 - b^2, 0] && (GeQ[p, -1] ||  !IntegerQ[m + 1/2])
Int[cos[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := (1/(b^p*f))*Subst[Int[(a + x)^m*(b^2 - x^2)^((p - 1)/2), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && IntegerQ[(p - 1)/2] && NeQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b)*((g*Cos[e + f*x])^(p + 1)/(f*g*(p + 1))) + a*Int[(g*Cos[e + f*x])^p, x] /; FreeQ[{a, b, e, f, g, p}, x] && (IntegerQ[2*p] || NeQ[a^2 - b^2, 0])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (a/g)^(2*m)*Int[(g*Cos[e + f*x])^(2*m + p)/(a - b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && LtQ[p, -1] && GeQ[2*m + p, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(a*f*g*m)) /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && EqQ[Simplify[m + p + 1], 0] &&  !ILtQ[p, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(a*f*g*Simplify[2*m + p + 1])) + (Simplify[m + p + 1]/(a*Simplify[2*m + p + 1]))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && ILtQ[Simplify[m + p + 1], 0] && NeQ[2*m + p + 1, 0] &&  !IGtQ[m, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^(m - 1)/(f*g*(m - 1))) /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && EqQ[2*m + p - 1, 0] && NeQ[m, 1]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-b)*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^(m - 1)/(f*g*(m + p))) + a*((2*m + p - 1)/(m + p))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[Simplify[(2*m + p - 1)/2], 0] && NeQ[m + p, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-b)*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(a*f*g*(p + 1))) + a*((m + p + 1)/(g^2*(p + 1)))*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 0] && LeQ[p, -2*m] && IntegersQ[m + 1/2, 2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := -2*b*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^(m - 1)/(f*g*(p + 1))) + b^2*((2*m + p - 1)/(g^2*(p + 1)))*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 2), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 1] && LtQ[p, -1] && IntegersQ[2*m, 2*p]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/Sqrt[(g_.)*cos[(e_.) + (f_.)*(x_)]], x_Symbol] := a*Sqrt[1 + Cos[e + f*x]]*(Sqrt[a + b*Sin[e + f*x]]/(a + a*Cos[e + f*x] + b*Sin[e + f*x]))*Int[Sqrt[1 + Cos[e + f*x]]/Sqrt[g*Cos[e + f*x]], x] + b*Sqrt[1 + Cos[e + f*x]]*(Sqrt[a + b*Sin[e + f*x]]/(a + a*Cos[e + f*x] + b*Sin[e + f*x]))*Int[Sin[e + f*x]/(Sqrt[g*Cos[e + f*x]]*Sqrt[1 + Cos[e + f*x]]), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-b)*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^(m - 1)/(f*g*(m + p))) + a*((2*m + p - 1)/(m + p))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 0] && NeQ[m + p, 0] && IntegersQ[2*m, 2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + p))) + g^2*((p - 1)/(a*(m + p)))*Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[p, 1] && (GtQ[m, -2] || EqQ[2*m + p + 1, 0] || (EqQ[m, -2] && IntegerQ[p])) && NeQ[m + p, 0] && IntegersQ[2*m, 2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := 2*g*(g*Cos[e + f*x])^(p - 1)*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(2*m + p + 1))) + g^2*((p - 1)/(b^2*(2*m + p + 1)))*Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^(m + 2), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && LeQ[m, -2] && GtQ[p, 1] && NeQ[2*m + p + 1, 0] &&  !ILtQ[m + p + 1, 0] && IntegersQ[2*m, 2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(a*f*g*(2*m + p + 1))) + ((m + p + 1)/(a*(2*m + p + 1)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && NeQ[2*m + p + 1, 0] && IntegersQ[2*m, 2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := g*((g*Cos[e + f*x])^(p - 1)/(b*f*(p - 1))) + (g^2/a)*Int[(g*Cos[e + f*x])^(p - 2), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && GtQ[p, 1] && IntegerQ[2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := b*((g*Cos[e + f*x])^(p + 1)/(a*f*g*(p - 1)*(a + b*Sin[e + f*x]))) + (p/(a*(p - 1)))*Int[(g*Cos[e + f*x])^p, x] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] &&  !GeQ[p, 1] && IntegerQ[2*p]
Int[Sqrt[(g_.)*cos[(e_.) + (f_.)*(x_)]]/Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := g*Sqrt[1 + Cos[e + f*x]]*(Sqrt[a + b*Sin[e + f*x]]/(a + a*Cos[e + f*x] + b*Sin[e + f*x]))*Int[Sqrt[1 + Cos[e + f*x]]/Sqrt[g*Cos[e + f*x]], x] - g*Sqrt[1 + Cos[e + f*x]]*(Sqrt[a + b*Sin[e + f*x]]/(b + b*Cos[e + f*x] + a*Sin[e + f*x]))*Int[Sin[e + f*x]/(Sqrt[g*Cos[e + f*x]]*Sqrt[1 + Cos[e + f*x]]), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(3/2)/Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := g*Sqrt[g*Cos[e + f*x]]*(Sqrt[a + b*Sin[e + f*x]]/(b*f)) + (g^2/(2*a))*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[g*Cos[e + f*x]], x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)/Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*b*((g*Cos[e + f*x])^(p + 1)/(f*g*(2*p - 1)*(a + b*Sin[e + f*x])^(3/2))) + 2*a*((p - 2)/(2*p - 1))*Int[(g*Cos[e + f*x])^p/(a + b*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && GtQ[p, 2] && IntegerQ[2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)/Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := (-b)*((g*Cos[e + f*x])^(p + 1)/(a*f*g*(p + 1)*Sqrt[a + b*Sin[e + f*x]])) + a*((2*p + 1)/(2*g^2*(p + 1)))*Int[(g*Cos[e + f*x])^(p + 2)/(a + b*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, e, f, g}, x] && EqQ[a^2 - b^2, 0] && LtQ[p, -1] && IntegerQ[2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := a^m*((g*Cos[e + f*x])^(p + 1)/(f*g*(1 + Sin[e + f*x])^((p + 1)/2)*(1 - Sin[e + f*x])^((p + 1)/2)))*Subst[Int[(1 + (b/a)*x)^(m + (p - 1)/2)*(1 - (b/a)*x)^((p - 1)/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := a^2*((g*Cos[e + f*x])^(p + 1)/(f*g*(a + b*Sin[e + f*x])^((p + 1)/2)*(a - b*Sin[e + f*x])^((p + 1)/2)))*Subst[Int[(a + b*x)^(m + (p - 1)/2)*(a - b*x)^((p - 1)/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-(g*Cos[e + f*x])^(p + 1))*(a + b*Sin[e + f*x])^m*(Sin[e + f*x]/(f*g*(p + 1))) + (1/(g^2*(p + 1)))*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 1)*(a*(p + 2) + b*(m + p + 2)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && LtQ[0, m, 1] && LtQ[p, -1] && (IntegersQ[2*m, 2*p] || IntegerQ[m])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-(g*Cos[e + f*x])^(p + 1))*(a + b*Sin[e + f*x])^(m - 1)*((b + a*Sin[e + f*x])/(f*g*(p + 1))) + (1/(g^2*(p + 1)))*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 2)*(b^2*(m - 1) + a^2*(p + 2) + a*b*(m + p + 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 1] && LtQ[p, -1] && (IntegersQ[2*m, 2*p] || IntegerQ[m])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-b)*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^(m - 1)/(f*g*(m + p))) + (1/(m + p))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m - 2)*(b^2*(m - 1) + a^2*(m + p) + a*b*(2*m + p - 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 1] && NeQ[m + p, 0] && (IntegersQ[2*m, 2*p] || IntegerQ[m])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 1))) + g^2*((p - 1)/(b*(m + 1)))*Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^(m + 1)*Sin[e + f*x], x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[p, 1] && IntegersQ[2*m, 2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-b)*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^(m + 1)/(f*g*(a^2 - b^2)*(m + 1))) + (1/((a^2 - b^2)*(m + 1)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1)*(a*(m + 1) - b*(m + p + 2)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegersQ[2*m, 2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + p))) + g^2*((p - 1)/(b*(m + p)))*Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^m*(b + a*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, m}, x] && NeQ[a^2 - b^2, 0] && GtQ[p, 1] && NeQ[m + p, 0] && IntegersQ[2*m, 2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m + 1)*((b - a*Sin[e + f*x])/(f*g*(a^2 - b^2)*(p + 1))) + (1/(g^2*(a^2 - b^2)*(p + 1)))*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^m*(a^2*(p + 2) - b^2*(m + p + 2) + a*b*(m + p + 3)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, m}, x] && NeQ[a^2 - b^2, 0] && LtQ[p, -1] && IntegersQ[2*m, 2*p]
Int[1/(Sqrt[(g_.)*cos[(e_.) + (f_.)*(x_)]]*Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := 2*Sqrt[2]*Sqrt[g*Cos[e + f*x]]*(Sqrt[(a + b*Sin[e + f*x])/((a - b)*(1 - Sin[e + f*x]))]/(f*g*Sqrt[a + b*Sin[e + f*x]]*Sqrt[(1 + Cos[e + f*x] + Sin[e + f*x])/(1 + Cos[e + f*x] - Sin[e + f*x])]))*Subst[Int[1/Sqrt[1 + (a + b)*(x^4/(a - b))], x], x, Sqrt[(1 + Cos[e + f*x] + Sin[e + f*x])/(1 + Cos[e + f*x] - Sin[e + f*x])]] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*(1 - Sin[e + f*x])*(a + b*Sin[e + f*x])^(m + 1)*(((-(a - b))*((1 - Sin[e + f*x])/((a + b)*(1 + Sin[e + f*x]))))^(m/2)/(f*(a + b)*(m + 1)))*Hypergeometric2F1[m + 1, m/2 + 1, m + 2, 2*((a + b*Sin[e + f*x])/((a + b)*(1 + Sin[e + f*x])))] /; FreeQ[{a, b, e, f, g, m, p}, x] && NeQ[a^2 - b^2, 0] && EqQ[m + p + 1, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^(m + 1)/(f*g*(a - b)*(p + 1))) + (a/(g^2*(a - b)))*Int[(g*Cos[e + f*x])^(p + 2)*((a + b*Sin[e + f*x])^m/(1 - Sin[e + f*x])), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && NeQ[a^2 - b^2, 0] && EqQ[m + p + 2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^(m + 1)/(f*g*(a - b)*(p + 1))) - b*((m + p + 2)/(g^2*(a - b)*(p + 1)))*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^m, x] + (a/(g^2*(a - b)))*Int[(g*Cos[e + f*x])^(p + 2)*((a + b*Sin[e + f*x])^m/(1 - Sin[e + f*x])), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m + p + 2, 0]
Int[Sqrt[(g_.)*cos[(e_.) + (f_.)*(x_)]]/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := With[{q = Rt[-a^2 + b^2, 2]}, a*(g/(2*b))*Int[1/(Sqrt[g*Cos[e + f*x]]*(q + b*Cos[e + f*x])), x] - a*(g/(2*b))*Int[1/(Sqrt[g*Cos[e + f*x]]*(q - b*Cos[e + f*x])), x] + b*(g/f)*Subst[Int[Sqrt[x]/(g^2*(a^2 - b^2) + b^2*x^2), x], x, g*Cos[e + f*x]]] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[1/(Sqrt[(g_.)*cos[(e_.) + (f_.)*(x_)]]*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := With[{q = Rt[-a^2 + b^2, 2]}, (-(a/(2*q)))*Int[1/(Sqrt[g*Cos[e + f*x]]*(q + b*Cos[e + f*x])), x] - (a/(2*q))*Int[1/(Sqrt[g*Cos[e + f*x]]*(q - b*Cos[e + f*x])), x] + b*(g/f)*Subst[Int[1/(Sqrt[x]*(g^2*(a^2 - b^2) + b^2*x^2)), x], x, g*Cos[e + f*x]]] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + p)*((-b)*((1 - Sin[e + f*x])/(a + b*Sin[e + f*x])))^((p - 1)/2)*(b*((1 + Sin[e + f*x])/(a + b*Sin[e + f*x])))^((p - 1)/2)))*AppellF1[-p - m, (1 - p)/2, (1 - p)/2, 1 - p - m, (a + b)/(a + b*Sin[e + f*x]), (a - b)/(a + b*Sin[e + f*x])] /; FreeQ[{a, b, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m, 0] &&  !IGtQ[m + p + 1, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := g*((g*Cos[e + f*x])^(p - 1)/(f*(1 - (a + b*Sin[e + f*x])/(a - b))^((p - 1)/2)*(1 - (a + b*Sin[e + f*x])/(a + b))^((p - 1)/2)))*Subst[Int[(-(b/(a - b)) - b*(x/(a - b)))^((p - 1)/2)*(b/(a + b) - b*(x/(a + b)))^((p - 1)/2)*(a + b*x)^m, x], x, Sin[e + f*x]] /; FreeQ[{a, b, e, f, g, m, p}, x] && NeQ[a^2 - b^2, 0] &&  !IGtQ[m, 0]
Int[((g_.)*sec[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := g^(2*IntPart[p])*(g*Cos[e + f*x])^FracPart[p]*(g*Sec[e + f*x])^FracPart[p]*Int[(a + b*Sin[e + f*x])^m/(g*Cos[e + f*x])^p, x] /; FreeQ[{a, b, e, f, g, m, p}, x] &&  !IntegerQ[p]

(* ::Subsection::Closed:: *)
(* 4.1.13 (d+e x)^m sin(a+b x+c x^2)^n *)
Int[Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := Int[Sin[(b + 2*c*x)^2/(4*c)], x] /; FreeQ[{a, b, c}, x] && EqQ[b^2 - 4*a*c, 0]
Int[Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := Int[Cos[(b + 2*c*x)^2/(4*c)], x] /; FreeQ[{a, b, c}, x] && EqQ[b^2 - 4*a*c, 0]
Int[Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := Cos[(b^2 - 4*a*c)/(4*c)]*Int[Sin[(b + 2*c*x)^2/(4*c)], x] - Sin[(b^2 - 4*a*c)/(4*c)]*Int[Cos[(b + 2*c*x)^2/(4*c)], x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0]
Int[Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := Cos[(b^2 - 4*a*c)/(4*c)]*Int[Cos[(b + 2*c*x)^2/(4*c)], x] + Sin[(b^2 - 4*a*c)/(4*c)]*Int[Sin[(b + 2*c*x)^2/(4*c)], x] /; FreeQ[{a, b, c}, x] && NeQ[b^2 - 4*a*c, 0]
Int[Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_), x_Symbol] := Int[ExpandTrigReduce[Sin[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[n, 1]
Int[Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_), x_Symbol] := Int[ExpandTrigReduce[Cos[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c}, x] && IGtQ[n, 1]
Int[Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_.), x_Symbol] := Unintegrable[Sin[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, n}, x]
Int[Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_.), x_Symbol] := Unintegrable[Cos[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, n}, x]
Int[Sin[v_]^(n_.), x_Symbol] := Int[Sin[ExpandToSum[v, x]]^n, x] /; IGtQ[n, 0] && QuadraticQ[v, x] &&  !QuadraticMatchQ[v, x]
Int[Cos[v_]^(n_.), x_Symbol] := Int[Cos[ExpandToSum[v, x]]^n, x] /; IGtQ[n, 0] && QuadraticQ[v, x] &&  !QuadraticMatchQ[v, x]
Int[((d_) + (e_.)*(x_))*Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := (-e)*(Cos[a + b*x + c*x^2]/(2*c)) /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0]
Int[((d_) + (e_.)*(x_))*Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := e*(Sin[a + b*x + c*x^2]/(2*c)) /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0]
Int[((d_.) + (e_.)*(x_))^(m_)*Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := (-e)*(d + e*x)^(m - 1)*(Cos[a + b*x + c*x^2]/(2*c)) + e^2*((m - 1)/(2*c))*Int[(d + e*x)^(m - 2)*Cos[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0] && GtQ[m, 1]
Int[((d_.) + (e_.)*(x_))^(m_)*Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := e*(d + e*x)^(m - 1)*(Sin[a + b*x + c*x^2]/(2*c)) - e^2*((m - 1)/(2*c))*Int[(d + e*x)^(m - 2)*Sin[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0] && GtQ[m, 1]
Int[((d_.) + (e_.)*(x_))^(m_)*Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := (d + e*x)^(m + 1)*(Sin[a + b*x + c*x^2]/(e*(m + 1))) - 2*(c/(e^2*(m + 1)))*Int[(d + e*x)^(m + 2)*Cos[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0] && LtQ[m, -1]
Int[((d_.) + (e_.)*(x_))^(m_)*Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := (d + e*x)^(m + 1)*(Cos[a + b*x + c*x^2]/(e*(m + 1))) + 2*(c/(e^2*(m + 1)))*Int[(d + e*x)^(m + 2)*Sin[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0] && LtQ[m, -1]
Int[((d_.) + (e_.)*(x_))*Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := (-e)*(Cos[a + b*x + c*x^2]/(2*c)) + ((2*c*d - b*e)/(2*c))*Int[Sin[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0]
Int[((d_.) + (e_.)*(x_))*Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := e*(Sin[a + b*x + c*x^2]/(2*c)) + ((2*c*d - b*e)/(2*c))*Int[Cos[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0]
Int[((d_.) + (e_.)*(x_))^(m_)*Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := (-e)*(d + e*x)^(m - 1)*(Cos[a + b*x + c*x^2]/(2*c)) - ((b*e - 2*c*d)/(2*c))*Int[(d + e*x)^(m - 1)*Sin[a + b*x + c*x^2], x] + e^2*((m - 1)/(2*c))*Int[(d + e*x)^(m - 2)*Cos[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0] && GtQ[m, 1]
Int[((d_.) + (e_.)*(x_))^(m_)*Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := e*(d + e*x)^(m - 1)*(Sin[a + b*x + c*x^2]/(2*c)) - ((b*e - 2*c*d)/(2*c))*Int[(d + e*x)^(m - 1)*Cos[a + b*x + c*x^2], x] - e^2*((m - 1)/(2*c))*Int[(d + e*x)^(m - 2)*Sin[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0] && GtQ[m, 1]
Int[((d_.) + (e_.)*(x_))^(m_)*Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := (d + e*x)^(m + 1)*(Sin[a + b*x + c*x^2]/(e*(m + 1))) - ((b*e - 2*c*d)/(e^2*(m + 1)))*Int[(d + e*x)^(m + 1)*Cos[a + b*x + c*x^2], x] - 2*(c/(e^2*(m + 1)))*Int[(d + e*x)^(m + 2)*Cos[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0] && LtQ[m, -1]
Int[((d_.) + (e_.)*(x_))^(m_)*Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := (d + e*x)^(m + 1)*(Cos[a + b*x + c*x^2]/(e*(m + 1))) + ((b*e - 2*c*d)/(e^2*(m + 1)))*Int[(d + e*x)^(m + 1)*Sin[a + b*x + c*x^2], x] + 2*(c/(e^2*(m + 1)))*Int[(d + e*x)^(m + 2)*Sin[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b*e - 2*c*d, 0] && LtQ[m, -1]
Int[((d_.) + (e_.)*(x_))^(m_.)*Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_), x_Symbol] := Int[ExpandTrigReduce[(d + e*x)^m, Sin[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 1]
Int[((d_.) + (e_.)*(x_))^(m_.)*Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_), x_Symbol] := Int[ExpandTrigReduce[(d + e*x)^m, Cos[a + b*x + c*x^2]^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 1]
Int[((d_.) + (e_.)*(x_))^(m_.)*Sin[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_.), x_Symbol] := Unintegrable[(d + e*x)^m*Sin[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[((d_.) + (e_.)*(x_))^(m_.)*Cos[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_.), x_Symbol] := Unintegrable[(d + e*x)^m*Cos[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[(u_)^(m_.)*Sin[v_]^(n_.), x_Symbol] := Int[ExpandToSum[u, x]^m*Sin[ExpandToSum[v, x]]^n, x] /; FreeQ[m, x] && IGtQ[n, 0] && LinearQ[u, x] && QuadraticQ[v, x] &&  !(LinearMatchQ[u, x] && QuadraticMatchQ[v, x])
Int[(u_)^(m_.)*Cos[v_]^(n_.), x_Symbol] := Int[ExpandToSum[u, x]^m*Cos[ExpandToSum[v, x]]^n, x] /; FreeQ[m, x] && IGtQ[n, 0] && LinearQ[u, x] && QuadraticQ[v, x] &&  !(LinearMatchQ[u, x] && QuadraticMatchQ[v, x])

(* ::Subsection::Closed:: *)
(* 4.1.1.3 (g tan)^p (a+b sin)^m *)
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_.)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (1/a)*Int[Sec[e + f*x]^2*(g*Tan[e + f*x])^p, x] - (1/(b*g))*Int[Sec[e + f*x]*(g*Tan[e + f*x])^(p + 1), x] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] && NeQ[p, -1]
Int[tan[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := (1/f)*Subst[Int[x^p*((a + x)^(m - (p + 1)/2)/(a - x)^((p + 1)/2)), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[(p + 1)/2]
Int[tan[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := a^p*Int[Sin[e + f*x]^p/(a - b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[m, p] && EqQ[p, 2*m]
Int[tan[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := a^p*Int[ExpandIntegrand[Sin[e + f*x]^p*((a + b*Sin[e + f*x])^(m - p/2)/(a - b*Sin[e + f*x])^(p/2)), x], x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[m, p/2] && (LtQ[p, 0] || GtQ[m - p/2, 0])
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := Int[ExpandIntegrand[(g*Tan[e + f*x])^p, (a + b*Sin[e + f*x])^m, x], x] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := a^(2*m)*Int[ExpandIntegrand[(g*Tan[e + f*x])^p/Sec[e + f*x]^m, (a*Sec[e + f*x] - b*Tan[e + f*x])^(-m), x], x] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] && ILtQ[m, 0]
Int[tan[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := b*((a + b*Sin[e + f*x])^m/(a*f*(2*m - 1)*Cos[e + f*x])) - (1/(a^2*(2*m - 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*((a*m - b*(2*m - 1)*Sin[e + f*x])/Cos[e + f*x]^2), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m] && LtQ[m, 0]
Int[tan[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := -((a + b*Sin[e + f*x])^(m + 1)/(b*f*m*Cos[e + f*x])) + (1/(b*m))*Int[(a + b*Sin[e + f*x])^m*((b*(m + 1) + a*Sin[e + f*x])/Cos[e + f*x]^2), x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m] &&  !LtQ[m, 0]
Int[tan[(e_.) + (f_.)*(x_)]^4*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Int[(a + b*Sin[e + f*x])^m, x] - Int[(a + b*Sin[e + f*x])^m*((1 - 2*Sin[e + f*x]^2)/Cos[e + f*x]^4), x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)/tan[(e_.) + (f_.)*(x_)]^2, x_Symbol] := -((a + b*Sin[e + f*x])^(m + 1)/(a*f*Tan[e + f*x])) + (1/b^2)*Int[(a + b*Sin[e + f*x])^(m + 1)*((b*m - a*(m + 1)*Sin[e + f*x])/Sin[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2] && LtQ[m, -1]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)/tan[(e_.) + (f_.)*(x_)]^2, x_Symbol] := -((a + b*Sin[e + f*x])^m/(f*Tan[e + f*x])) + (1/a)*Int[(a + b*Sin[e + f*x])^m*((b*m - a*(m + 1)*Sin[e + f*x])/Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2] &&  !LtQ[m, -1]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)/tan[(e_.) + (f_.)*(x_)]^4, x_Symbol] := (-2/(a*b))*Int[(a + b*Sin[e + f*x])^(m + 2)/Sin[e + f*x]^3, x] + (1/a^2)*Int[(a + b*Sin[e + f*x])^(m + 2)*((1 + Sin[e + f*x]^2)/Sin[e + f*x]^4), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2] && LtQ[m, -1]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)/tan[(e_.) + (f_.)*(x_)]^4, x_Symbol] := Int[(a + b*Sin[e + f*x])^m, x] + Int[(a + b*Sin[e + f*x])^m*((1 - 2*Sin[e + f*x]^2)/Sin[e + f*x]^4), x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2] &&  !LtQ[m, -1]
Int[tan[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Sqrt[a + b*Sin[e + f*x]]*(Sqrt[a - b*Sin[e + f*x]]/(b*f*Cos[e + f*x]))*Subst[Int[x^p*((a + x)^(m - (p + 1)/2)/(a - x)^((p + 1)/2)), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m] && IntegerQ[p/2]
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (g*Tan[e + f*x])^(p + 1)*(a - b*Sin[e + f*x])^((p + 1)/2)*((a + b*Sin[e + f*x])^((p + 1)/2)/(f*g*(b*Sin[e + f*x])^(p + 1)))*Subst[Int[x^p*((a + x)^(m - (p + 1)/2)/(a - x)^((p + 1)/2)), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m] &&  !IntegerQ[p]
Int[tan[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := (1/f)*Subst[Int[(x^p*(a + x)^m)/(b^2 - x^2)^((p + 1)/2), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[(p + 1)/2]
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := Int[ExpandIntegrand[(g*Tan[e + f*x])^p, (a + b*Sin[e + f*x])^m, x], x] /; FreeQ[{a, b, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)/tan[(e_.) + (f_.)*(x_)]^2, x_Symbol] := Int[(a + b*Sin[e + f*x])^m*((1 - Sin[e + f*x]^2)/Sin[e + f*x]^2), x] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)/tan[(e_.) + (f_.)*(x_)]^4, x_Symbol] := (-Cos[e + f*x])*((a + b*Sin[e + f*x])^(m + 1)/(3*a*f*Sin[e + f*x]^3)) - (3*a^2 + b^2*(m - 2))*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(3*a^2*b*f*(m + 1)*Sin[e + f*x]^2)) - (1/(3*a^2*b*(m + 1)))*Int[((a + b*Sin[e + f*x])^(m + 1)/Sin[e + f*x]^3)*Simp[6*a^2 - b^2*(m - 1)*(m - 2) + a*b*(m + 1)*Sin[e + f*x] - (3*a^2 - b^2*m*(m - 2))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegerQ[2*m]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)/tan[(e_.) + (f_.)*(x_)]^4, x_Symbol] := (-Cos[e + f*x])*((a + b*Sin[e + f*x])^(m + 1)/(3*a*f*Sin[e + f*x]^3)) - b*(m - 2)*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(6*a^2*f*Sin[e + f*x]^2)) - (1/(6*a^2))*Int[((a + b*Sin[e + f*x])^m/Sin[e + f*x]^2)*Simp[8*a^2 - b^2*(m - 1)*(m - 2) + a*b*m*Sin[e + f*x] - (6*a^2 - b^2*m*(m - 2))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0] &&  !LtQ[m, -1] && IntegerQ[2*m]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)/tan[(e_.) + (f_.)*(x_)]^6, x_Symbol] := (-Cos[e + f*x])*((a + b*Sin[e + f*x])^(m + 1)/(5*a*f*Sin[e + f*x]^5)) - b*(m - 4)*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(20*a^2*f*Sin[e + f*x]^4)) + a*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b^2*f*m*(m - 1)*Sin[e + f*x]^3)) + Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*m*Sin[e + f*x]^2)) + (1/(20*a^2*b^2*m*(m - 1)))*Int[((a + b*Sin[e + f*x])^m/Sin[e + f*x]^4)*Simp[60*a^4 - 44*a^2*b^2*(m - 1)*m + b^4*m*(m - 1)*(m - 3)*(m - 4) + a*b*m*(20*a^2 - b^2*m*(m - 1))*Sin[e + f*x] - (40*a^4 + b^4*m*(m - 1)*(m - 2)*(m - 4) - 20*a^2*b^2*(m - 1)*(2*m + 1))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0] && NeQ[m, 1] && IntegerQ[2*m]
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (a/(a^2 - b^2))*Int[(g*Tan[e + f*x])^p/Sin[e + f*x]^2, x] - b*(g/(a^2 - b^2))*Int[(g*Tan[e + f*x])^(p - 1)/Cos[e + f*x], x] - a^2*(g^2/(a^2 - b^2))*Int[(g*Tan[e + f*x])^(p - 2)/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*p] && GtQ[p, 1]
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (1/a)*Int[(g*Tan[e + f*x])^p/Cos[e + f*x]^2, x] - (b/(a^2*g))*Int[(g*Tan[e + f*x])^(p + 1)/Cos[e + f*x], x] - ((a^2 - b^2)/(a^2*g^2))*Int[(g*Tan[e + f*x])^(p + 2)/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*p] && LtQ[p, -1]
Int[Sqrt[(g_.)*tan[(e_.) + (f_.)*(x_)]]/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := Sqrt[Cos[e + f*x]]*(Sqrt[g*Tan[e + f*x]]/Sqrt[Sin[e + f*x]])*Int[Sqrt[Sin[e + f*x]]/(Sqrt[Cos[e + f*x]]*(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[1/(Sqrt[(g_)*tan[(e_.) + (f_.)*(x_)]]*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (Sqrt[Sin[e + f*x]]/(Sqrt[Cos[e + f*x]]*Sqrt[g*Tan[e + f*x]]))*Int[Sqrt[Cos[e + f*x]]/(Sqrt[Sin[e + f*x]]*(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[tan[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Int[ExpandIntegrand[Sin[e + f*x]^p*((a + b*Sin[e + f*x])^m/(1 - Sin[e + f*x]^2)^(p/2)), x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[m, p/2]
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := Unintegrable[(g*Tan[e + f*x])^p*(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, e, f, g, m, p}, x]
Int[((g_.)*cot[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := g^(2*IntPart[p])*(g*Cot[e + f*x])^FracPart[p]*(g*Tan[e + f*x])^FracPart[p]*Int[(a + b*Sin[e + f*x])^m/(g*Tan[e + f*x])^p, x] /; FreeQ[{a, b, e, f, g, m, p}, x] &&  !IntegerQ[p]

(* ::Subsection::Closed:: *)
(* 4.1.2.1 (a+b sin)^m (c+d sin)^n *)
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (2*a*c + b*d)*(x/2) - (b*c + a*d)*(Cos[e + f*x]/f) - b*d*Cos[e + f*x]*(Sin[e + f*x]/(2*f)) /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])/((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := b*(x/d) - ((b*c - a*d)/d)*Int[1/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^m*c^m*Int[Cos[e + f*x]^(2*m)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] &&  !(IntegerQ[n] && ((LtQ[m, 0] && GtQ[n, 0]) || LtQ[0, n, m] || LtQ[m, n, 0]))
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := a*c*(Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]))*Int[Cos[e + f*x]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := -2*b*Cos[e + f*x]*((c + d*Sin[e + f*x])^n/(f*(2*n + 1)*Sqrt[a + b*Sin[e + f*x]])) /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[n, -2^(-1)]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := -2*b*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^n/(f*(2*n + 1))) - b*((2*m - 1)/(d*(2*n + 1)))*Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[m - 1/2, 0] && LtQ[n, -1] &&  !(ILtQ[m + n, 0] && GtQ[2*m + n + 1, 0])
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^n/(f*(m + n))) + a*((2*m - 1)/(m + n))*Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[m - 1/2, 0] &&  !LtQ[n, -1] &&  !(IGtQ[n - 1/2, 0] && LtQ[n, m]) &&  !(ILtQ[m + n, 0] && GtQ[2*m + n + 1, 0])
Int[1/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]))*Int[1/Cos[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(a*f*(2*m + 1))) /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && NeQ[m, -2^(-1)]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(a*f*(2*m + 1))) + ((m + n + 1)/(a*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && ILtQ[Simplify[m + n + 1], 0] && NeQ[m, -2^(-1)] && (SumSimplerQ[m, 1] ||  !SumSimplerQ[n, 1])
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(a*f*(2*m + 1))) + ((m + n + 1)/(a*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] &&  !LtQ[m, n, -1] && IntegersQ[2*m, 2*n]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^IntPart[m]*c^IntPart[m]*(a + b*Sin[e + f*x])^FracPart[m]*((c + d*Sin[e + f*x])^FracPart[m]/Cos[e + f*x]^(2*FracPart[m]))*Int[Cos[e + f*x]^(2*m)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && (FractionQ[m] ||  !FractionQ[n])
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^2/((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b^2)*(Cos[e + f*x]/(d*f)) + (1/d)*Int[Simp[a^2*d - b*(b*c - 2*a*d)*Sin[e + f*x], x]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[1/(((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (b/(b*c - a*d))*Int[1/(a + b*Sin[e + f*x]), x] - (d/(b*c - a*d))*Int[1/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := c*Int[(b*Sin[e + f*x])^m, x] + (d/b)*Int[(b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{b, c, d, e, f, m}, x]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-d)*Cos[e + f*x]*((a + b*Sin[e + f*x])^m/(f*(m + 1))) /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[a*d*m + b*c*(m + 1), 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (b*c - a*d)*Cos[e + f*x]*((a + b*Sin[e + f*x])^m/(a*f*(2*m + 1))) + ((a*d*m + b*c*(m + 1))/(a*b*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-d)*Cos[e + f*x]*((a + b*Sin[e + f*x])^m/(f*(m + 1))) + ((a*d*m + b*c*(m + 1))/(b*(m + 1)))*Int[(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)]
Int[((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])/Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := ((b*c - a*d)/b)*Int[1/Sqrt[a + b*Sin[e + f*x]], x] + (d/b)*Int[Sqrt[a + b*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-d)*Cos[e + f*x]*((a + b*Sin[e + f*x])^m/(f*(m + 1))) + (1/(m + 1))*Int[(a + b*Sin[e + f*x])^(m - 1)*Simp[b*d*m + a*c*(m + 1) + (a*d*m + b*c*(m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && IntegerQ[2*m]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(b*c - a*d))*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(f*(m + 1)*(a^2 - b^2))) + (1/((m + 1)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[(a*c - b*d)*(m + 1) - (b*c - a*d)*(m + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegerQ[2*m]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := c*(Cos[e + f*x]/(f*Sqrt[1 + Sin[e + f*x]]*Sqrt[1 - Sin[e + f*x]]))*Subst[Int[(a + b*x)^m*(Sqrt[1 + (d/c)*x]/Sqrt[1 - (d/c)*x]), x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] &&  !IntegerQ[2*m] && EqQ[c^2 - d^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := ((b*c - a*d)/b)*Int[(a + b*Sin[e + f*x])^m, x] + (d/b)*Int[(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[ExpandTrig[(a + b*sin[e + f*x])^m*(d*sin[e + f*x])^n, x], x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0] && RationalQ[n]
Int[sin[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := b*Cos[e + f*x]*((a + b*Sin[e + f*x])^m/(a*f*(2*m + 1))) - (1/(a^2*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(a*m - b*(2*m + 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)]
Int[sin[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-Cos[e + f*x])*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2))) + (1/(b*(m + 2)))*Int[(a + b*Sin[e + f*x])^m*(b*(m + 1) - a*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^2, x_Symbol] := (b*c - a*d)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])/(a*f*(2*m + 1))) + (1/(a*b*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[a*c*d*(m - 1) + b*(d^2 + c^2*(m + 1)) + d*(a*d*(m - 1) + b*c*(m + 2))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^2, x_Symbol] := (-d^2)*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2))) + (1/(b*(m + 2)))*Int[(a + b*Sin[e + f*x])^m*Simp[b*(d^2*(m + 1) + c^2*(m + 2)) - d*(a*d - 2*b*c*(m + 2))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -1]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b^2)*(b*c - a*d)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 2)*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(b*c + a*d))) + (b^2/(d*(n + 1)*(b*c + a*d)))*Int[(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^(n + 1)*Simp[a*c*(m - 2) - b*d*(m - 2*n - 4) - (b*c*(m - 1) - a*d*(m + 2*n + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1] && LtQ[n, -1] && (IntegersQ[2*m, 2*n] || IntegerQ[m + 1/2] || (IntegerQ[m] && EqQ[c, 0]))
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b^2)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 2)*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n))) + (1/(d*(m + n)))*Int[(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^n*Simp[a*b*c*(m - 2) + b^2*d*(n + 1) + a^2*d*(m + n) - b*(b*c*(m - 1) - a*d*(3*m + 2*n - 2))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1] &&  !LtQ[n, -1] && (IntegersQ[2*m, 2*n] || IntegerQ[m + 1/2] || (IntegerQ[m] && EqQ[c, 0]))
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(a*f*(2*m + 1))) - (1/(a*b*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 1)*Simp[a*d*n - b*c*(m + 1) - b*d*(m + n + 1)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && LtQ[0, n, 1] && (IntegersQ[2*m, 2*n] || (IntegerQ[m] && EqQ[c, 0]))
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (b*c - a*d)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n - 1)/(a*f*(2*m + 1))) + (1/(a*b*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 2)*Simp[b*(c^2*(m + 1) + d^2*(n - 1)) + a*c*d*(m - n + 1) + d*(a*d*(m - n + 1) + b*c*(m + n))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && GtQ[n, 1] && (IntegersQ[2*m, 2*n] || (IntegerQ[m] && EqQ[c, 0]))
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b^2*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(a*f*(2*m + 1)*(b*c - a*d))) + (1/(a*(2*m + 1)*(b*c - a*d)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n*Simp[b*c*(m + 1) - a*d*(2*m + n + 2) + b*d*(m + n + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] &&  !GtQ[n, 0] && (IntegersQ[2*m, 2*n] || (IntegerQ[m] && EqQ[c, 0]))
Int[((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(b*c - a*d))*Cos[e + f*x]*((c + d*Sin[e + f*x])^(n - 1)/(a*f*(a + b*Sin[e + f*x]))) - (d/(a*b))*Int[(c + d*Sin[e + f*x])^(n - 2)*Simp[b*d*(n - 1) - a*c*n + (b*c*(n - 1) - a*d*n)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[n, 1] && (IntegerQ[2*n] || EqQ[c, 0])
Int[((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b^2)*Cos[e + f*x]*((c + d*Sin[e + f*x])^(n + 1)/(a*f*(b*c - a*d)*(a + b*Sin[e + f*x]))) + (d/(a*(b*c - a*d)))*Int[(c + d*Sin[e + f*x])^n*(a*n - b*(n + 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[n, 0] && (IntegerQ[2*n] || EqQ[c, 0])
Int[((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b)*Cos[e + f*x]*((c + d*Sin[e + f*x])^n/(a*f*(a + b*Sin[e + f*x]))) + d*(n/(a*b))*Int[(c + d*Sin[e + f*x])^(n - 1)*(a - b*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && (IntegerQ[2*n] || EqQ[c, 0])
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := -2*b*Cos[e + f*x]*((c + d*Sin[e + f*x])^n/(f*(2*n + 1)*Sqrt[a + b*Sin[e + f*x]])) + 2*n*((b*c + a*d)/(b*(2*n + 1)))*Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[n, 0] && IntegerQ[2*n]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(3/2), x_Symbol] := -2*b^2*(Cos[e + f*x]/(f*(b*c + a*d)*Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]])) /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (b*c - a*d)*Cos[e + f*x]*((c + d*Sin[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 - d^2)*Sqrt[a + b*Sin[e + f*x]])) + (2*n + 3)*((b*c - a*d)/(2*b*(n + 1)*(c^2 - d^2)))*Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[n, -1] && NeQ[2*n + 3, 0] && IntegerQ[2*n]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := -2*(b/f)*Subst[Int[1/(b*c + a*d - d*x^2), x], x, b*(Cos[e + f*x]/Sqrt[a + b*Sin[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := (-2/f)*Subst[Int[1/Sqrt[1 - x^2/a], x], x, b*(Cos[e + f*x]/Sqrt[a + b*Sin[e + f*x]])] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && EqQ[d, a/b]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*(b/f)*Subst[Int[1/(b + d*x^2), x], x, b*(Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^2*(Cos[e + f*x]/(f*Sqrt[a + b*Sin[e + f*x]]*Sqrt[a - b*Sin[e + f*x]]))*Subst[Int[(c + d*x)^n/Sqrt[a - b*x], x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] &&  !IntegerQ[2*n]
Int[Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]/Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := (d/b)*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + ((b*c - a*d)/b)*Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*d*Cos[e + f*x]*((c + d*Sin[e + f*x])^(n - 1)/(f*(2*n - 1)*Sqrt[a + b*Sin[e + f*x]])) - (1/(b*(2*n - 1)))*Int[((c + d*Sin[e + f*x])^(n - 2)/Sqrt[a + b*Sin[e + f*x]])*Simp[a*c*d - b*(2*d^2*(n - 1) + c^2*(2*n - 1)) + d*(a*d - b*c*(4*n - 3))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[n, 1] && IntegerQ[2*n]
Int[((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := (-d)*Cos[e + f*x]*((c + d*Sin[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 - d^2)*Sqrt[a + b*Sin[e + f*x]])) - (1/(2*b*(n + 1)*(c^2 - d^2)))*Int[(c + d*Sin[e + f*x])^(n + 1)*(Simp[a*d - 2*b*c*(n + 1) + b*d*(2*n + 3)*Sin[e + f*x], x]/Sqrt[a + b*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[n, -1] && IntegerQ[2*n]
Int[1/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (b/(b*c - a*d))*Int[1/Sqrt[a + b*Sin[e + f*x]], x] - (d/(b*c - a*d))*Int[Sqrt[a + b*Sin[e + f*x]]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (-(Sqrt[2]/(Sqrt[a]*f)))*Subst[Int[1/Sqrt[1 - x^2], x], x, b*(Cos[e + f*x]/(a + b*Sin[e + f*x]))] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && EqQ[d, a/b] && GtQ[a, 0]
Int[1/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*(a/f)*Subst[Int[1/(2*b^2 - (a*c - b*d)*x^2), x], x, b*(Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-d)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n - 1)/(f*(m + n))) + (1/(b*(m + n)))*Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^(n - 2)*Simp[d*(a*c*m + b*d*(n - 1)) + b*c^2*(m + n) + d*(a*d*m + b*c*(m + 2*n - 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[n, 1] && IntegerQ[n]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^m*(Cos[e + f*x]/(f*Sqrt[1 + Sin[e + f*x]]*Sqrt[1 - Sin[e + f*x]]))*Subst[Int[(1 + (b/a)*x)^(m - 1/2)*((c + d*x)^n/Sqrt[1 - (b/a)*x]), x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && IntegerQ[m]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b)*(d/b)^n*(Cos[e + f*x]/(f*Sqrt[a + b*Sin[e + f*x]]*Sqrt[a - b*Sin[e + f*x]]))*Subst[Int[(a - x)^n*((2*a - x)^(m - 1/2)/Sqrt[x]), x], x, a - b*Sin[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m] && GtQ[a, 0] && GtQ[d/b, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (d/b)^IntPart[n]*((d*Sin[e + f*x])^FracPart[n]/(b*Sin[e + f*x])^FracPart[n])*Int[(a + b*Sin[e + f*x])^m*(b*Sin[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m] && GtQ[a, 0] &&  !GtQ[d/b, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^IntPart[m]*((a + b*Sin[e + f*x])^FracPart[m]/(1 + (b/a)*Sin[e + f*x])^FracPart[m])*Int[(1 + (b/a)*Sin[e + f*x])^m*(d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m] &&  !GtQ[a, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^2*(Cos[e + f*x]/(f*Sqrt[a + b*Sin[e + f*x]]*Sqrt[a - b*Sin[e + f*x]]))*Subst[Int[(a + b*x)^(m - 1/2)*((c + d*x)^n/Sqrt[a - b*x]), x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] &&  !IntegerQ[m]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^2, x_Symbol] := 2*c*(d/b)*Int[(b*Sin[e + f*x])^(m + 1), x] + Int[(b*Sin[e + f*x])^m*(c^2 + d^2*Sin[e + f*x]^2), x] /; FreeQ[{b, c, d, e, f, m}, x]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^2, x_Symbol] := (-(b^2*c^2 - 2*a*b*c*d + a^2*d^2))*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 - b^2))) - (1/(b*(m + 1)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[b*(m + 1)*(2*b*c*d - a*(c^2 + d^2)) + (a^2*d^2 - 2*a*b*c*d*(m + 2) + b^2*(d^2*(m + 1) + c^2*(m + 2)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^2, x_Symbol] := (-d^2)*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2))) + (1/(b*(m + 2)))*Int[(a + b*Sin[e + f*x])^m*Simp[b*(d^2*(m + 1) + c^2*(m + 2)) - d*(a*d - 2*b*c*(m + 2))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] &&  !LtQ[m, -1]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-(b^2*c^2 - 2*a*b*c*d + a^2*d^2))*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 2)*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2))) + (1/(d*(n + 1)*(c^2 - d^2)))*Int[(a + b*Sin[e + f*x])^(m - 3)*(c + d*Sin[e + f*x])^(n + 1)*Simp[b*(m - 2)*(b*c - a*d)^2 + a*d*(n + 1)*(c*(a^2 + b^2) - 2*a*b*d) + (b*(n + 1)*(a*b*c^2 + c*d*(a^2 + b^2) - 3*a*b*d^2) - a*(n + 2)*(b*c - a*d)^2)*Sin[e + f*x] + b*(b^2*(c^2 - d^2) - m*(b*c - a*d)^2 + d*n*(2*a*b*c - d*(a^2 + b^2)))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 2] && LtQ[n, -1] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b^2)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 2)*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n))) + (1/(d*(m + n)))*Int[(a + b*Sin[e + f*x])^(m - 3)*(c + d*Sin[e + f*x])^n*Simp[a^3*d*(m + n) + b^2*(b*c*(m - 2) + a*d*(n + 1)) - b*(a*b*c - b^2*d*(m + n - 1) - 3*a^2*d*(m + n))*Sin[e + f*x] - b^2*(b*c*(m - 1) - a*d*(3*m + 2*n - 2))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 2] && (IntegerQ[m] || IntegersQ[2*m, 2*n]) &&  !(IGtQ[n, 2] && ( !IntegerQ[m] || (EqQ[a, 0] && NeQ[c, 0])))
Int[Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2), x_Symbol] := -2*a*d*(Cos[e + f*x]/(f*(a^2 - b^2)*Sqrt[a + b*Sin[e + f*x]]*Sqrt[d*Sin[e + f*x]])) - (d^2/(a^2 - b^2))*Int[Sqrt[a + b*Sin[e + f*x]]/(d*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]/((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2), x_Symbol] := ((c - d)/(a - b))*Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] - ((b*c - a*d)/(a - b))*Int[(1 + Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((c + d*Sin[e + f*x])^n/(f*(m + 1)*(a^2 - b^2))) + (1/((m + 1)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 1)*Simp[a*c*(m + 1) + b*d*n + (a*d*(m + 1) - b*c*(m + 2))*Sin[e + f*x] - b*d*(m + n + 2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && LtQ[0, n, 1] && IntegersQ[2*m, 2*n]
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2), x_Symbol] := (d/b)*Int[Sqrt[d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] - a*(d/b)*Int[Sqrt[d*Sin[e + f*x]]/(a + b*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)/((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2), x_Symbol] := (d^2/b^2)*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + ((b*c - a*d)/b^2)*Int[Simp[b*c + a*d + 2*b*d*Sin[e + f*x], x]/((a + b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-(b*c - a*d))*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((c + d*Sin[e + f*x])^(n - 1)/(f*(m + 1)*(a^2 - b^2))) + (1/((m + 1)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 2)*Simp[c*(a*c - b*d)*(m + 1) + d*(b*c - a*d)*(n - 1) + (d*(a*c - b*d)*(m + 1) - c*(b*c - a*d)*(m + 2))*Sin[e + f*x] - d*(b*c - a*d)*(m + n + 1)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && LtQ[1, n, 2] && IntegersQ[2*m, 2*n]
Int[1/(((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := 2*b*(Cos[e + f*x]/(f*(a^2 - b^2)*Sqrt[a + b*Sin[e + f*x]]*Sqrt[d*Sin[e + f*x]])) + (d/(a^2 - b^2))*Int[(b + a*Sin[e + f*x])/(Sqrt[a + b*Sin[e + f*x]]*(d*Sin[e + f*x])^(3/2)), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[1/(((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (1/(a - b))*Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] - (b/(a - b))*Int[(1 + Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b^2)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((c + d*Sin[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 - b^2))) + (1/((m + 1)*(b*c - a*d)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n*Simp[a*(b*c - a*d)*(m + 1) + b^2*d*(m + n + 2) - (b^2*c + b*(b*c - a*d)*(m + 1))*Sin[e + f*x] - b^2*d*(m + n + 3)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && IntegersQ[2*m, 2*n] && ((EqQ[a, 0] && IntegerQ[m] &&  !IntegerQ[n]) ||  !(IntegerQ[2*n] && LtQ[n, -1] && ((IntegerQ[n] &&  !IntegerQ[m]) || EqQ[a, 0])))
Int[Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]/((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (d/b)*Int[1/Sqrt[c + d*Sin[e + f*x]], x] + ((b*c - a*d)/b)*Int[1/((a + b*Sin[e + f*x])*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)/((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (b/d)*Int[Sqrt[a + b*Sin[e + f*x]], x] - ((b*c - a*d)/d)*Int[Sqrt[a + b*Sin[e + f*x]]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])*Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (2/(f*(a + b)*Sqrt[c + d]))*EllipticPi[2*(b/(a + b)), (1/2)*(e - Pi/2 + f*x), 2*(d/(c + d))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[c + d, 0]
Int[1/(((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])*Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (2/(f*(a - b)*Sqrt[c - d]))*EllipticPi[-2*(b/(a - b)), (1/2)*(e + Pi/2 + f*x), -2*(d/(c - d))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[c - d, 0]
Int[1/(((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])*Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (Sqrt[(c + d*Sin[e + f*x])/(c + d)]/Sqrt[c + d*Sin[e + f*x]])*Int[1/((a + b*Sin[e + f*x])*Sqrt[c/(c + d) + (d/(c + d))*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] &&  !GtQ[c + d, 0]
Int[Sqrt[(b_.)*sin[(e_.) + (f_.)*(x_)]]/Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := 2*c*Rt[b*(c + d), 2]*Tan[e + f*x]*Sqrt[1 + Csc[e + f*x]]*(Sqrt[1 - Csc[e + f*x]]/(d*f*Sqrt[c^2 - d^2]))*EllipticPi[(c + d)/d, ArcSin[Sqrt[c + d*Sin[e + f*x]]/(Sqrt[b*Sin[e + f*x]]*Rt[(c + d)/b, 2])], -((c + d)/(c - d))] /; FreeQ[{b, c, d, e, f}, x] && GtQ[c^2 - d^2, 0] && PosQ[(c + d)/b] && GtQ[c^2, 0]
Int[Sqrt[(b_.)*sin[(e_.) + (f_.)*(x_)]]/Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := 2*b*(Tan[e + f*x]/(d*f))*Rt[(c + d)/b, 2]*Sqrt[c*((1 + Csc[e + f*x])/(c - d))]*Sqrt[c*((1 - Csc[e + f*x])/(c + d))]*EllipticPi[(c + d)/d, ArcSin[Sqrt[c + d*Sin[e + f*x]]/(Sqrt[b*Sin[e + f*x]]*Rt[(c + d)/b, 2])], -((c + d)/(c - d))] /; FreeQ[{b, c, d, e, f}, x] && NeQ[c^2 - d^2, 0] && PosQ[(c + d)/b]
Int[Sqrt[(b_.)*sin[(e_.) + (f_.)*(x_)]]/Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := (Sqrt[b*Sin[e + f*x]]/Sqrt[(-b)*Sin[e + f*x]])*Int[Sqrt[(-b)*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] /; FreeQ[{b, c, d, e, f}, x] && NeQ[c^2 - d^2, 0] && NegQ[(c + d)/b]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := 2*((a + b*Sin[e + f*x])/(d*f*Rt[(a + b)/(c + d), 2]*Cos[e + f*x]))*Sqrt[(b*c - a*d)*((1 + Sin[e + f*x])/((c - d)*(a + b*Sin[e + f*x])))]*Sqrt[(-(b*c - a*d))*((1 - Sin[e + f*x])/((c + d)*(a + b*Sin[e + f*x])))]*EllipticPi[b*((c + d)/(d*(a + b))), ArcSin[Rt[(a + b)/(c + d), 2]*(Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]])], (a - b)*((c + d)/((a + b)*(c - d)))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && PosQ[(a + b)/(c + d)]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := (Sqrt[-c - d*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]])*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[-c - d*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && NegQ[(a + b)/(c + d)]
Int[1/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*(d/(f*Sqrt[a + b*d]))*EllipticF[ArcSin[Cos[e + f*x]/(1 + d*Sin[e + f*x])], -((a - b*d)/(a + b*d))] /; FreeQ[{a, b, d, e, f}, x] && LtQ[a^2 - b^2, 0] && EqQ[d^2, 1] && GtQ[b*d, 0]
Int[1/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (Sqrt[Sign[b]*Sin[e + f*x]]/Sqrt[d*Sin[e + f*x]])*Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[Sign[b]*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f}, x] && LtQ[a^2 - b^2, 0] && GtQ[b^2] &&  !(EqQ[d^2, 1] && GtQ[b*d, 0])
Int[1/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*Sqrt[a^2]*(Sqrt[-Cot[e + f*x]^2]/(a*f*Sqrt[a^2 - b^2]*Cot[e + f*x]))*Rt[(a + b)/d, 2]*EllipticF[ArcSin[Sqrt[a + b*Sin[e + f*x]]/(Sqrt[d*Sin[e + f*x]]*Rt[(a + b)/d, 2])], -((a + b)/(a - b))] /; FreeQ[{a, b, d, e, f}, x] && GtQ[a^2 - b^2, 0] && PosQ[(a + b)/d] && GtQ[a^2, 0]
Int[1/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*(Tan[e + f*x]/(a*f))*Rt[(a + b)/d, 2]*Sqrt[a*((1 - Csc[e + f*x])/(a + b))]*Sqrt[a*((1 + Csc[e + f*x])/(a - b))]*EllipticF[ArcSin[Sqrt[a + b*Sin[e + f*x]]/(Sqrt[d*Sin[e + f*x]]*Rt[(a + b)/d, 2])], -((a + b)/(a - b))] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && PosQ[(a + b)/d]
Int[1/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (Sqrt[(-d)*Sin[e + f*x]]/Sqrt[d*Sin[e + f*x]])*Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[(-d)*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && NegQ[(a + b)/d]
Int[1/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := 2*((c + d*Sin[e + f*x])/(f*(b*c - a*d)*Rt[(c + d)/(a + b), 2]*Cos[e + f*x]))*Sqrt[(b*c - a*d)*((1 - Sin[e + f*x])/((a + b)*(c + d*Sin[e + f*x])))]*Sqrt[(-(b*c - a*d))*((1 + Sin[e + f*x])/((a - b)*(c + d*Sin[e + f*x])))]*EllipticF[ArcSin[Rt[(c + d)/(a + b), 2]*(Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]])], (a + b)*((c - d)/((a - b)*(c + d)))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && PosQ[(c + d)/(a + b)]
Int[1/(Sqrt[(a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (Sqrt[-a - b*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]])*Int[1/(Sqrt[-a - b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && NegQ[(c + d)/(a + b)]
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)/Sqrt[(a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)]], x_Symbol] := (-a)*(d/(2*b))*Int[Sqrt[d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] + (d/(2*b))*Int[Sqrt[d*Sin[e + f*x]]*((a + 2*b*Sin[e + f*x])/Sqrt[a + b*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^n/(f*(m + n))) + (1/(d*(m + n)))*Int[(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^(n - 1)*Simp[a^2*c*d*(m + n) + b*d*(b*c*(m - 1) + a*d*n) + (a*d*(2*b*c + a*d)*(m + n) - b*d*(a*c - b*d*(m + n - 1)))*Sin[e + f*x] + b*d*(b*c*n + a*d*(2*m + n - 1))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[0, m, 2] && LtQ[-1, n, 2] && NeQ[m + n, 0] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (b/d)*Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1), x] - ((b*c - a*d)/d)*Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && IGtQ[m, 0]
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := a*Int[(d*Sin[e + f*x])^n/(a^2 - b^2*Sin[e + f*x]^2), x] - (b/d)*Int[(d*Sin[e + f*x])^(n + 1)/(a^2 - b^2*Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[ExpandTrig[(d*sin[e + f*x])^n*(1/((a - b*sin[e + f*x])^m/(a^2 - b^2*sin[e + f*x]^2)^m)), x], x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m, -1]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Unintegrable[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(p_))^(n_), x_Symbol] := c^IntPart[n]*((c*(d*Sin[e + f*x])^p)^FracPart[n]/(d*Sin[e + f*x])^(p*FracPart[n]))*Int[(a + b*Sin[e + f*x])^m*(d*Sin[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[n]
Int[((a_.) + (b_.)*cos[(e_.) + (f_.)*(x_)])^(m_.)*((c_.)*((d_.)*cos[(e_.) + (f_.)*(x_)])^(p_))^(n_), x_Symbol] := c^IntPart[n]*((c*(d*Cos[e + f*x])^p)^FracPart[n]/(d*Cos[e + f*x])^(p*FracPart[n]))*Int[(a + b*Cos[e + f*x])^m*(d*Cos[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[n]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[(a + b*Sin[e + f*x])^m*((d + c*Sin[e + f*x])^n/Sin[e + f*x]^n), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IntegerQ[n]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[(b + a*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^n/Csc[e + f*x]^m), x] /; FreeQ[{a, b, c, d, e, f, n}, x] &&  !IntegerQ[n] && IntegerQ[m]
Int[((a_) + (b_.)*cos[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[(b + a*Sec[e + f*x])^m*((c + d*Sec[e + f*x])^n/Sec[e + f*x]^m), x] /; FreeQ[{a, b, c, d, e, f, n}, x] &&  !IntegerQ[n] && IntegerQ[m]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Sin[e + f*x]^n*((c + d*Csc[e + f*x])^n/(d + c*Sin[e + f*x])^n)*Int[(a + b*Sin[e + f*x])^m*((d + c*Sin[e + f*x])^n/Sin[e + f*x]^n), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] &&  !IntegerQ[n] &&  !IntegerQ[m]
Int[((a_) + (b_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Cos[e + f*x]^n*((c + d*Sec[e + f*x])^n/(d + c*Cos[e + f*x])^n)*Int[(a + b*Cos[e + f*x])^m*((d + c*Cos[e + f*x])^n/Cos[e + f*x]^n), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] &&  !IntegerQ[n] &&  !IntegerQ[m]

(* ::Subsection::Closed:: *)
(* 4.1.2.2 (g cos)^p (a+b sin)^m (c+d sin)^n *)
Int[cos[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (1/(b*f))*Subst[Int[(a + x)^m*(c + (d/b)*x)^n, x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := a*Int[Cos[e + f*x]^p*(d*Sin[e + f*x])^n, x] + (b/d)*Int[Cos[e + f*x]^p*(d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, n, p}, x] && IntegerQ[(p - 1)/2] && IntegerQ[n] && ((LtQ[p, 0] && NeQ[a^2 - b^2, 0]) || LtQ[0, n, p - 1] || LtQ[p + 1, -n, 2*p + 1])
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*(((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/a)*Int[Cos[e + f*x]^(p - 2)*(d*Sin[e + f*x])^n, x] - (1/(b*d))*Int[Cos[e + f*x]^(p - 2)*(d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, n, p}, x] && IntegerQ[(p - 1)/2] && EqQ[a^2 - b^2, 0] && IntegerQ[n] && (LtQ[0, n, (p + 1)/2] || (LeQ[p, -n] && LtQ[-n, 2*p - 3]) || (GtQ[n, 0] && LeQ[n, -p]))
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (1/(b^p*f))*Subst[Int[(a + x)^(m + (p - 1)/2)*(a - x)^((p - 1)/2)*(c + (d/b)*x)^n, x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, e, f, c, d, m, n}, x] && IntegerQ[(p - 1)/2] && EqQ[a^2 - b^2, 0]
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (1/(b^p*f))*Subst[Int[(a + x)^m*(c + (d/b)*x)^n*(b^2 - x^2)^((p - 1)/2), x], x, b*Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IntegerQ[(p - 1)/2] && NeQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := a*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^n, x] + (b/d)*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, g, n, p}, x]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (g^2/a)*Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^n, x] - (g^2/(b*d))*Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && EqQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^m*(c^m/g^(2*m))*Int[(g*Cos[e + f*x])^(2*m + p)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] &&  !(IntegerQ[n] && LtQ[n^2, m^2])
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (1/(a^(p/2)*c^(p/2)))*Int[(a + b*Sin[e + f*x])^(m + p/2)*(c + d*Sin[e + f*x])^(n + p/2), x] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[p/2]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := g*(Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]))*Int[(g*Cos[e + f*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^IntPart[m]*c^IntPart[m]*(a + b*Sin[e + f*x])^FracPart[m]*((c + d*Sin[e + f*x])^FracPart[m]/(g^(2*IntPart[m])*(g*Cos[e + f*x])^(2*FracPart[m])))*Int[(g*Cos[e + f*x])^(2*m + p)/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[2*m + p - 1, 0] && EqQ[m - n - 1, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^n/(f*g*(m - n - 1))) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[2*m + p - 1, 0] && NeQ[m - n - 1, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := -2*b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^n/(f*g*(2*n + p + 1))) - b*((2*m + p - 1)/(d*(2*n + p + 1)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[Simplify[m + p/2 - 1/2], 0] && LtQ[n, -1] && NeQ[2*n + p + 1, 0] &&  !(ILtQ[Simplify[m + n + p], 0] && GtQ[Simplify[2*m + n + 3*(p/2) + 1], 0])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b)*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^n/(f*g*(m + n + p))) + a*((2*m + p - 1)/(m + n + p))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[Simplify[m + p/2 - 1/2], 0] &&  !LtQ[n, -1] &&  !(IGtQ[Simplify[n + p/2 - 1/2], 0] && GtQ[m - n, 0]) &&  !(ILtQ[Simplify[m + n + p], 0] && GtQ[Simplify[2*m + n + 3*(p/2) + 1], 0])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := a^IntPart[m]*c^IntPart[m]*(a + b*Sin[e + f*x])^FracPart[m]*((c + d*Sin[e + f*x])^FracPart[m]/(g^(2*IntPart[m])*(g*Cos[e + f*x])^(2*FracPart[m])))*Int[(g*Cos[e + f*x])^(2*m + p), x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[2*m + p + 1, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(a*f*g*(m - n))) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + p + 1, 0] && NeQ[m, n]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(a*f*g*(2*m + p + 1))) + ((m + n + p + 1)/(a*(2*m + p + 1)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && ILtQ[Simplify[m + n + p + 1], 0] && NeQ[2*m + p + 1, 0] && (SumSimplerQ[m, 1] ||  !SumSimplerQ[n, 1])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := -2*b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^n/(f*g*(2*n + p + 1))) - b*((2*m + p - 1)/(d*(2*n + p + 1)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && GtQ[m, 0] && LtQ[n, -1] && NeQ[2*n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b)*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^n/(f*g*(m + n + p))) + a*((2*m + p - 1)/(m + n + p))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && GtQ[m, 0] && NeQ[m + n + p, 0] &&  !LtQ[0, n, m] && IntegersQ[2*m, 2*n, 2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(a*f*g*(2*m + p + 1))) + ((m + n + p + 1)/(a*(2*m + p + 1)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && NeQ[2*m + p + 1, 0] &&  !LtQ[m, n, -1] && IntegersQ[2*m, 2*n, 2*p]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^IntPart[m]*c^IntPart[m]*(a + b*Sin[e + f*x])^FracPart[m]*((c + d*Sin[e + f*x])^FracPart[m]/(g^(2*IntPart[m])*(g*Cos[e + f*x])^(2*FracPart[m])))*Int[(g*Cos[e + f*x])^(2*m + p)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && (FractionQ[m] ||  !FractionQ[n])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-d)*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(f*g*(m + p + 1))) /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && EqQ[a*d*m + b*c*(m + p + 1), 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(b*c + a*d))*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(a*f*g*(p + 1))) + b*((a*d*m + b*c*(m + p + 1))/(a*g^2*(p + 1)))*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, -1] && LtQ[p, -1]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-d)*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(f*g*(m + p + 1))) + ((a*d*m + b*c*(m + p + 1))/(b*(m + p + 1)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[Simplify[(2*m + p + 1)/2], 0] && NeQ[m + p + 1, 0]
Int[cos[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := 2*(b*c - a*d)*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b^2*f*(2*m + 3))) + (1/(b^3*(2*m + 3)))*Int[(a + b*Sin[e + f*x])^(m + 2)*(b*c + 2*a*d*(m + 1) - b*d*(2*m + 3)*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -3/2]
Int[cos[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := d*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 2)/(b^2*f*(m + 3))) - (1/(b^2*(m + 3)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(b*d*(m + 2) - a*c*(m + 3) + (b*c*(m + 3) - a*d*(m + 4))*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GeQ[m, -3/2] && LtQ[m, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (b*c - a*d)*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(a*f*g*(2*m + p + 1))) + ((a*d*m + b*c*(m + p + 1))/(a*b*(2*m + p + 1)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1), x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && (LtQ[m, -1] || ILtQ[Simplify[m + p], 0]) && NeQ[2*m + p + 1, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-d)*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(f*g*(m + p + 1))) + ((a*d*m + b*c*(m + p + 1))/(b*(m + p + 1)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && NeQ[m + p + 1, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(g*Cos[e + f*x])^(p + 1))*(a + b*Sin[e + f*x])^m*((d + c*Sin[e + f*x])/(f*g*(p + 1))) + (1/(g^2*(p + 1)))*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 1)*Simp[a*c*(p + 2) + b*d*m + b*c*(m + p + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && LtQ[p, -1] && IntegerQ[2*m] &&  !(EqQ[m, 1] && NeQ[c^2 - d^2, 0] && SimplerQ[c + d*x, a + b*x])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-d)*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(f*g*(m + p + 1))) + (1/(m + p + 1))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m - 1)*Simp[a*c*(m + p + 1) + b*d*m + (a*d*m + b*c*(m + p + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] &&  !LtQ[p, -1] && IntegerQ[2*m] &&  !(EqQ[m, 1] && NeQ[c^2 - d^2, 0] && SimplerQ[c + d*x, a + b*x])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*(a + b*Sin[e + f*x])^(m + 1)*((b*c*(m + p + 1) - a*d*p + b*d*(m + 1)*Sin[e + f*x])/(b^2*f*(m + 1)*(m + p + 1))) + g^2*((p - 1)/(b^2*(m + 1)*(m + p + 1)))*Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^(m + 1)*Simp[b*d*(m + 1) + (b*c*(m + p + 1) - a*d*p)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[p, 1] && NeQ[m + p + 1, 0] && IntegerQ[2*m]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(b*c - a*d))*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^(m + 1)/(f*g*(a^2 - b^2)*(m + 1))) + (1/((a^2 - b^2)*(m + 1)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1)*Simp[(a*c - b*d)*(m + 1) - (b*c - a*d)*(m + p + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegerQ[2*m]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := g*(g*Cos[e + f*x])^(p - 1)*(a + b*Sin[e + f*x])^(m + 1)*((b*c*(m + p + 1) - a*d*p + b*d*(m + p)*Sin[e + f*x])/(b^2*f*(m + p)*(m + p + 1))) + g^2*((p - 1)/(b^2*(m + p)*(m + p + 1)))*Int[(g*Cos[e + f*x])^(p - 2)*(a + b*Sin[e + f*x])^m*Simp[b*(a*d*m + b*c*(m + p + 1)) + (a*b*c*(m + p + 1) - d*(a^2*p - b^2*(m + p)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[a^2 - b^2, 0] && GtQ[p, 1] && NeQ[m + p, 0] && NeQ[m + p + 1, 0] && IntegerQ[2*m]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (g*Cos[e + f*x])^(p + 1)*(a + b*Sin[e + f*x])^(m + 1)*((b*c - a*d - (a*c - b*d)*Sin[e + f*x])/(f*g*(a^2 - b^2)*(p + 1))) + (1/(g^2*(a^2 - b^2)*(p + 1)))*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^m*Simp[c*(a^2*(p + 2) - b^2*(m + p + 2)) + a*b*d*m + b*(a*c - b*d)*(m + p + 3)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, g, m}, x] && NeQ[a^2 - b^2, 0] && LtQ[p, -1] && IntegerQ[2*m]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (d/b)*Int[(g*Cos[e + f*x])^p, x] + ((b*c - a*d)/b)*Int[(g*Cos[e + f*x])^p/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := c*g*((g*Cos[e + f*x])^(p - 1)/(f*(1 + Sin[e + f*x])^((p - 1)/2)*(1 - Sin[e + f*x])^((p - 1)/2)))*Subst[Int[(1 + (d/c)*x)^((p + 1)/2)*(1 - (d/c)*x)^((p - 1)/2)*(a + b*x)^m, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, p}, x] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^(2*m)*Int[(d*Sin[e + f*x])^n/(a - b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[m, p] && EqQ[2*m + p, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*sin[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-(g*Cos[e + f*x])^(p + 1))*((a + b*Sin[e + f*x])^(m + 1)/(2*b*f*g*(m + 1))) + (a/(2*g^2))*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && EqQ[m - p, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*sin[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(a*f*g*m)) - (1/g^2)*Int[(g*Cos[e + f*x])^(p + 2)*(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && EqQ[m + p + 1, 0]
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (1/a^p)*Int[ExpandTrig[(d*sin[e + f*x])^n*(a - b*sin[e + f*x])^(p/2)*(a + b*sin[e + f*x])^(m + p/2), x], x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[m, n, p/2] && ((GtQ[m, 0] && GtQ[p, 0] && LtQ[-m - p, n, -1]) || (GtQ[m, 2] && LtQ[p, 0] && GtQ[m + p/2, 0]))
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^p, (d*sin[e + f*x])^n*(a + b*sin[e + f*x])^m, x], x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[cos[(e_.) + (f_.)*(x_)]^2*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (1/b^2)*Int[(d*Sin[e + f*x])^n*(a + b*Sin[e + f*x])^(m + 1)*(a - b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && (ILtQ[m, 0] ||  !IGtQ[n, 0])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (a/g)^(2*m)*Int[(g*Cos[e + f*x])^(2*m + p)*((d*Sin[e + f*x])^n/(a - b*Sin[e + f*x])^m), x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && EqQ[a^2 - b^2, 0] && ILtQ[m, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (a/g)^(2*m)*Int[(g*Cos[e + f*x])^(2*m + p)*((d*Sin[e + f*x])^n/(a - b*Sin[e + f*x])^m), x] /; FreeQ[{a, b, d, e, f, g, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && RationalQ[p] && (EqQ[2*m + p, 0] || (GtQ[2*m + p, 0] && LtQ[p, -1]))
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*sin[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := b*(g*Cos[e + f*x])^(p + 1)*((a + b*Sin[e + f*x])^m/(a*f*g*(2*m + p + 1))) - (1/(a^2*(2*m + p + 1)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^(m + 1)*(a*m - b*(2*m + p + 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, p}, x] && EqQ[a^2 - b^2, 0] && LeQ[m, -2^(-1)] && NeQ[2*m + p + 1, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*sin[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-(g*Cos[e + f*x])^(p + 1))*((a + b*Sin[e + f*x])^(m + 1)/(b*f*g*(m + p + 2))) + (1/(b*(m + p + 2)))*Int[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^m*(b*(m + 1) - a*(p + 1)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && EqQ[a^2 - b^2, 0] && NeQ[m + p + 2, 0]
Int[cos[(e_.) + (f_.)*(x_)]^2*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (1/b^2)*Int[(d*Sin[e + f*x])^n*(a + b*Sin[e + f*x])^(m + 1)*(a - b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n]
Int[cos[(e_.) + (f_.)*(x_)]^4*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-2/(a*b*d))*Int[(d*Sin[e + f*x])^(n + 1)*(a + b*Sin[e + f*x])^(m + 2), x] + (1/a^2)*Int[(d*Sin[e + f*x])^n*(a + b*Sin[e + f*x])^(m + 2)*(1 + Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[cos[(e_.) + (f_.)*(x_)]^4*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (1/d^4)*Int[(d*Sin[e + f*x])^(n + 4)*(a + b*Sin[e + f*x])^m, x] + Int[(d*Sin[e + f*x])^n*(a + b*Sin[e + f*x])^m*(1 - 2*Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] &&  !IGtQ[m, 0]
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := a^m*(Cos[e + f*x]/(f*Sqrt[1 + Sin[e + f*x]]*Sqrt[1 - Sin[e + f*x]]))*Subst[Int[(d*x)^n*(1 + (b/a)*x)^(m + (p - 1)/2)*(1 - (b/a)*x)^((p - 1)/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[p/2] && IntegerQ[m]
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (Cos[e + f*x]/(a^(p - 2)*f*Sqrt[a + b*Sin[e + f*x]]*Sqrt[a - b*Sin[e + f*x]]))*Subst[Int[(d*x)^n*(a + b*x)^(m + p/2 - 1/2)*(a - b*x)^(p/2 - 1/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[p/2] &&  !IntegerQ[m]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^p, (d*sin[e + f*x])^n*(a + b*sin[e + f*x])^m, x], x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0] && (IntegerQ[p] || IGtQ[n, 0])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := a^m*g*((g*Cos[e + f*x])^(p - 1)/(f*(1 + Sin[e + f*x])^((p - 1)/2)*(1 - Sin[e + f*x])^((p - 1)/2)))*Subst[Int[(d*x)^n*(1 + (b/a)*x)^(m + (p - 1)/2)*(1 - (b/a)*x)^((p - 1)/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, d, e, f, n, p}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := g*((g*Cos[e + f*x])^(p - 1)/(f*(a + b*Sin[e + f*x])^((p - 1)/2)*(a - b*Sin[e + f*x])^((p - 1)/2)))*Subst[Int[(d*x)^n*(a + b*x)^(m + (p - 1)/2)*(a - b*x)^((p - 1)/2), x], x, Sin[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n, p}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)/Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (-g)*(g*Cos[e + f*x])^(p - 1)*Sqrt[d*Sin[e + f*x]]*((a + b*Sin[e + f*x])^(m + 1)/(a*d*f*(m + 1))) + g^2*((2*m + 3)/(2*a*(m + 1)))*Int[(g*Cos[e + f*x])^(p - 2)*((a + b*Sin[e + f*x])^(m + 1)/Sqrt[d*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && EqQ[m + p + 1/2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)/Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := 2*(g*Cos[e + f*x])^(p + 1)*Sqrt[d*Sin[e + f*x]]*((a + b*Sin[e + f*x])^m/(d*f*g*(2*m + 1))) + 2*a*(m/(g^2*(2*m + 1)))*Int[(g*Cos[e + f*x])^(p + 2)*((a + b*Sin[e + f*x])^(m - 1)/Sqrt[d*Sin[e + f*x]]), x] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && EqQ[m + p + 3/2, 0]
Int[cos[(e_.) + (f_.)*(x_)]^2*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Int[(d*Sin[e + f*x])^n*(a + b*Sin[e + f*x])^m*(1 - Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && NeQ[a^2 - b^2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n])
Int[cos[(e_.) + (f_.)*(x_)]^4*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Cos[e + f*x]*(d*Sin[e + f*x])^(n + 1)*((a + b*Sin[e + f*x])^(m + 1)/(a*d*f*(n + 1))) - (a^2*(n + 1) - b^2*(m + n + 2))*Cos[e + f*x]*(d*Sin[e + f*x])^(n + 2)*((a + b*Sin[e + f*x])^(m + 1)/(a^2*b*d^2*f*(n + 1)*(m + 1))) + (1/(a^2*b*d*(n + 1)*(m + 1)))*Int[(d*Sin[e + f*x])^(n + 1)*(a + b*Sin[e + f*x])^(m + 1)*Simp[a^2*(n + 1)*(n + 2) - b^2*(m + n + 2)*(m + n + 3) + a*b*(m + 1)*Sin[e + f*x] - (a^2*(n + 1)*(n + 3) - b^2*(m + n + 2)*(m + n + 4))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n] && LtQ[m, -1] && LtQ[n, -1]
Int[cos[(e_.) + (f_.)*(x_)]^4*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (a^2 - b^2)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((d*Sin[e + f*x])^(n + 1)/(a*b^2*d*f*(m + 1))) + (a^2*(n - m + 1) - b^2*(m + n + 2))*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 2)*((d*Sin[e + f*x])^(n + 1)/(a^2*b^2*d*f*(m + 1)*(m + 2))) - (1/(a^2*b^2*(m + 1)*(m + 2)))*Int[(a + b*Sin[e + f*x])^(m + 2)*(d*Sin[e + f*x])^n*Simp[a^2*(n + 1)*(n + 3) - b^2*(m + n + 2)*(m + n + 3) + a*b*(m + 2)*Sin[e + f*x] - (a^2*(n + 2)*(n + 3) - b^2*(m + n + 2)*(m + n + 4))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n] && LtQ[m, -1] &&  !LtQ[n, -1] && (LtQ[m, -2] || EqQ[m + n + 4, 0])
Int[cos[(e_.) + (f_.)*(x_)]^4*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (a^2 - b^2)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((d*Sin[e + f*x])^(n + 1)/(a*b^2*d*f*(m + 1))) - Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 2)*((d*Sin[e + f*x])^(n + 1)/(b^2*d*f*(m + n + 4))) - (1/(a*b^2*(m + 1)*(m + n + 4)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(d*Sin[e + f*x])^n*Simp[a^2*(n + 1)*(n + 3) - b^2*(m + n + 2)*(m + n + 4) + a*b*(m + 1)*Sin[e + f*x] - (a^2*(n + 2)*(n + 3) - b^2*(m + n + 3)*(m + n + 4))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n] && LtQ[m, -1] &&  !LtQ[n, -1] && NeQ[m + n + 4, 0]
Int[cos[(e_.) + (f_.)*(x_)]^4*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((d*Sin[e + f*x])^(n + 1)/(a*d*f*(n + 1))) - b*(m + n + 2)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((d*Sin[e + f*x])^(n + 2)/(a^2*d^2*f*(n + 1)*(n + 2))) - (1/(a^2*d^2*(n + 1)*(n + 2)))*Int[(a + b*Sin[e + f*x])^m*(d*Sin[e + f*x])^(n + 2)*Simp[a^2*n*(n + 2) - b^2*(m + n + 2)*(m + n + 3) + a*b*m*Sin[e + f*x] - (a^2*(n + 1)*(n + 2) - b^2*(m + n + 2)*(m + n + 4))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, m}, x] && NeQ[a^2 - b^2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n]) &&  !m < -1 && LtQ[n, -1] && (LtQ[n, -2] || EqQ[m + n + 4, 0])
Int[cos[(e_.) + (f_.)*(x_)]^4*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((d*Sin[e + f*x])^(n + 1)/(a*d*f*(n + 1))) - Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((d*Sin[e + f*x])^(n + 2)/(b*d^2*f*(m + n + 4))) + (1/(a*b*d*(n + 1)*(m + n + 4)))*Int[(a + b*Sin[e + f*x])^m*(d*Sin[e + f*x])^(n + 1)*Simp[a^2*(n + 1)*(n + 2) - b^2*(m + n + 2)*(m + n + 4) + a*b*(m + 3)*Sin[e + f*x] - (a^2*(n + 1)*(n + 3) - b^2*(m + n + 3)*(m + n + 4))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, m}, x] && NeQ[a^2 - b^2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n]) &&  !m < -1 && LtQ[n, -1] && NeQ[m + n + 4, 0]
Int[cos[(e_.) + (f_.)*(x_)]^4*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := a*(n + 3)*Cos[e + f*x]*(d*Sin[e + f*x])^(n + 1)*((a + b*Sin[e + f*x])^(m + 1)/(b^2*d*f*(m + n + 3)*(m + n + 4))) - Cos[e + f*x]*(d*Sin[e + f*x])^(n + 2)*((a + b*Sin[e + f*x])^(m + 1)/(b*d^2*f*(m + n + 4))) - (1/(b^2*(m + n + 3)*(m + n + 4)))*Int[(d*Sin[e + f*x])^n*(a + b*Sin[e + f*x])^m*Simp[a^2*(n + 1)*(n + 3) - b^2*(m + n + 3)*(m + n + 4) + a*b*m*Sin[e + f*x] - (a^2*(n + 2)*(n + 3) - b^2*(m + n + 3)*(m + n + 5))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, m, n}, x] && NeQ[a^2 - b^2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n]) &&  !m < -1 &&  !LtQ[n, -1] && NeQ[m + n + 3, 0] && NeQ[m + n + 4, 0]
Int[cos[(e_.) + (f_.)*(x_)]^6*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Cos[e + f*x]*(d*Sin[e + f*x])^(n + 1)*((a + b*Sin[e + f*x])^(m + 1)/(a*d*f*(n + 1))) - b*(m + n + 2)*Cos[e + f*x]*(d*Sin[e + f*x])^(n + 2)*((a + b*Sin[e + f*x])^(m + 1)/(a^2*d^2*f*(n + 1)*(n + 2))) - a*(n + 5)*Cos[e + f*x]*(d*Sin[e + f*x])^(n + 3)*((a + b*Sin[e + f*x])^(m + 1)/(b^2*d^3*f*(m + n + 5)*(m + n + 6))) + Cos[e + f*x]*(d*Sin[e + f*x])^(n + 4)*((a + b*Sin[e + f*x])^(m + 1)/(b*d^4*f*(m + n + 6))) + (1/(a^2*b^2*d^2*(n + 1)*(n + 2)*(m + n + 5)*(m + n + 6)))*Int[(d*Sin[e + f*x])^(n + 2)*(a + b*Sin[e + f*x])^m*Simp[a^4*(n + 1)*(n + 2)*(n + 3)*(n + 5) - a^2*b^2*(n + 2)*(2*n + 1)*(m + n + 5)*(m + n + 6) + b^4*(m + n + 2)*(m + n + 3)*(m + n + 5)*(m + n + 6) + a*b*m*(a^2*(n + 1)*(n + 2) - b^2*(m + n + 5)*(m + n + 6))*Sin[e + f*x] - (a^4*(n + 1)*(n + 2)*(4 + n)*(n + 5) + b^4*(m + n + 2)*(m + n + 4)*(m + n + 5)*(m + n + 6) - a^2*b^2*(n + 1)*(n + 2)*(m + n + 5)*(2*n + 2*m + 13))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, m, n}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n] && NeQ[n, -1] && NeQ[n, -2] && NeQ[m + n + 5, 0] && NeQ[m + n + 6, 0] &&  !IGtQ[m, 0]
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Int[ExpandTrig[(d*sin[e + f*x])^n*(a + b*sin[e + f*x])^m*(1 - sin[e + f*x]^2)^(p/2), x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[m, 2*n, p/2] && (LtQ[m, -1] || (EqQ[m, -1] && GtQ[p, 0]))
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(sin[(e_.) + (f_.)*(x_)]^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^p, sin[e + f*x]^n/(a + b*sin[e + f*x]), x], x] /; FreeQ[{a, b, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[n] && (LtQ[n, 0] || IGtQ[p + 1/2, 0])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (g^2/a)*Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^n, x] - b*(g^2/(a^2*d))*Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^(n + 1), x] - g^2*((a^2 - b^2)/(a^2*d^2))*Int[(g*Cos[e + f*x])^(p - 2)*((d*Sin[e + f*x])^(n + 2)/(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && GtQ[p, 1] && (LeQ[n, -2] || (EqQ[n, -3/2] && EqQ[p, 3/2]))
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (g^2/(a*b))*Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^n*(b - a*Sin[e + f*x]), x] + g^2*((a^2 - b^2)/(a*b*d))*Int[(g*Cos[e + f*x])^(p - 2)*((d*Sin[e + f*x])^(n + 1)/(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && GtQ[p, 1] && (LtQ[n, -1] || (EqQ[p, 3/2] && EqQ[n, -2^(-1)]))
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (g^2/b^2)*Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^n*(a - b*Sin[e + f*x]), x] - g^2*((a^2 - b^2)/b^2)*Int[(g*Cos[e + f*x])^(p - 2)*((d*Sin[e + f*x])^n/(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && GtQ[p, 1]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := a*(d^2/(a^2 - b^2))*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^(n - 2), x] - b*(d/(a^2 - b^2))*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^(n - 1), x] - a^2*(d^2/(g^2*(a^2 - b^2)))*Int[(g*Cos[e + f*x])^(p + 2)*((d*Sin[e + f*x])^(n - 2)/(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && LtQ[p, -1] && GtQ[n, 1]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (-(d/(a^2 - b^2)))*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^(n - 1)*(b - a*Sin[e + f*x]), x] + a*b*(d/(g^2*(a^2 - b^2)))*Int[(g*Cos[e + f*x])^(p + 2)*((d*Sin[e + f*x])^(n - 1)/(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && LtQ[p, -1] && GtQ[n, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/(a^2 - b^2))*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^n*(a - b*Sin[e + f*x]), x] - (b^2/(g^2*(a^2 - b^2)))*Int[(g*Cos[e + f*x])^(p + 2)*((d*Sin[e + f*x])^n/(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && LtQ[p, -1]
Int[Sqrt[(g_.)*cos[(e_.) + (f_.)*(x_)]]/(Sqrt[sin[(e_.) + (f_.)*(x_)]]*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := -4*Sqrt[2]*(g/f)*Subst[Int[x^2/(((a + b)*g^2 + (a - b)*x^4)*Sqrt[1 - x^4/g^2]), x], x, Sqrt[g*Cos[e + f*x]]/Sqrt[1 + Sin[e + f*x]]] /; FreeQ[{a, b, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[(g_.)*cos[(e_.) + (f_.)*(x_)]]/(Sqrt[(d_)*sin[(e_.) + (f_.)*(x_)]]*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (Sqrt[Sin[e + f*x]]/Sqrt[d*Sin[e + f*x]])*Int[Sqrt[g*Cos[e + f*x]]/(Sqrt[Sin[e + f*x]]*(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]/(Sqrt[cos[(e_.) + (f_.)*(x_)]]*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := With[{q = Rt[-a^2 + b^2, 2]}, 2*Sqrt[2]*d*((b + q)/(f*q))*Subst[Int[1/((d*(b + q) + a*x^2)*Sqrt[1 - x^4/d^2]), x], x, Sqrt[d*Sin[e + f*x]]/Sqrt[1 + Cos[e + f*x]]] - 2*Sqrt[2]*d*((b - q)/(f*q))*Subst[Int[1/((d*(b - q) + a*x^2)*Sqrt[1 - x^4/d^2]), x], x, Sqrt[d*Sin[e + f*x]]/Sqrt[1 + Cos[e + f*x]]]] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]/(Sqrt[(g_.)*cos[(e_.) + (f_.)*(x_)]]*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (Sqrt[Cos[e + f*x]]/Sqrt[g*Cos[e + f*x]])*Int[Sqrt[d*Sin[e + f*x]]/(Sqrt[Cos[e + f*x]]*(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (d/b)*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^(n - 1), x] - a*(d/b)*Int[(g*Cos[e + f*x])^p*((d*Sin[e + f*x])^(n - 1)/(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && LtQ[-1, p, 1] && GtQ[n, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*(((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/a)*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^n, x] - (b/(a*d))*Int[(g*Cos[e + f*x])^p*((d*Sin[e + f*x])^(n + 1)/(a + b*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*n, 2*p] && LtQ[-1, p, 1] && LtQ[n, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^2, x_Symbol] := 2*a*(b/d)*Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^(n + 1), x] + Int[(g*Cos[e + f*x])^p*(d*Sin[e + f*x])^n*(a^2 + b^2*Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && NeQ[a^2 - b^2, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^p, (d*sin[e + f*x])^n*(a + b*sin[e + f*x])^m, x], x] /; FreeQ[{a, b, d, e, f, g, n, p}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[m] && (GtQ[m, 0] || IntegerQ[n])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (g^2/a)*Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^n*(a + b*Sin[e + f*x])^(m + 1), x] - b*(g^2/(a^2*d))*Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^(n + 1)*(a + b*Sin[e + f*x])^(m + 1), x] - g^2*((a^2 - b^2)/(a^2*d^2))*Int[(g*Cos[e + f*x])^(p - 2)*(d*Sin[e + f*x])^(n + 2)*(a + b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, d, e, f, g}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[m, 2*n, 2*p] && LtQ[m, 0] && GtQ[p, 1] && (LeQ[n, -2] || (EqQ[m, -1] && EqQ[n, -3/2] && EqQ[p, 3/2]))
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^(2*m)*Int[(c + d*Sin[e + f*x])^n/(a - b*Sin[e + f*x])^m, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[m, p] && EqQ[2*m + p, 0]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a/g)^(2*m)*Int[(g*Cos[e + f*x])^(2*m + p)*((c + d*Sin[e + f*x])^n/(a - b*Sin[e + f*x])^m), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && (EqQ[2*m + p, 0] || (GtQ[2*m + p, 0] && LtQ[p, -1]))
Int[cos[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (1/b^2)*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n*(a - b*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n]
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^m*(Cos[e + f*x]/(f*Sqrt[1 + Sin[e + f*x]]*Sqrt[1 - Sin[e + f*x]]))*Subst[Int[(1 + (b/a)*x)^(m + (p - 1)/2)*(1 - (b/a)*x)^((p - 1)/2)*(c + d*x)^n, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[p/2] && IntegerQ[m]
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (Cos[e + f*x]/(a^(p - 2)*f*Sqrt[a + b*Sin[e + f*x]]*Sqrt[a - b*Sin[e + f*x]]))*Subst[Int[(a + b*x)^(m + p/2 - 1/2)*(a - b*x)^(p/2 - 1/2)*(c + d*x)^n, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[p/2] &&  !IntegerQ[m]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^p, (a + b*sin[e + f*x])^m*(c + d*sin[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0] && (IntegerQ[p] || IGtQ[n, 0])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^m*g*((g*Cos[e + f*x])^(p - 1)/(f*(1 + Sin[e + f*x])^((p - 1)/2)*(1 - Sin[e + f*x])^((p - 1)/2)))*Subst[Int[(1 + (b/a)*x)^(m + (p - 1)/2)*(1 - (b/a)*x)^((p - 1)/2)*(c + d*x)^n, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := g*((g*Cos[e + f*x])^(p - 1)/(f*(a + b*Sin[e + f*x])^((p - 1)/2)*(a - b*Sin[e + f*x])^((p - 1)/2)))*Subst[Int[(a + b*x)^(m + (p - 1)/2)*(a - b*x)^((p - 1)/2)*(c + d*x)^n, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m]
Int[cos[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n*(1 - Sin[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[a^2 - b^2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n])
Int[cos[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[ExpandTrig[(a + b*sin[e + f*x])^m*(c + d*sin[e + f*x])^n*(1 - sin[e + f*x]^2)^(p/2), x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[a^2 - b^2, 0] && IGtQ[p/2, 0] && (IGtQ[m, 0] || IntegersQ[2*m, 2*n])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[ExpandTrig[(g*cos[e + f*x])^p*(a + b*sin[e + f*x])^m*(c + d*sin[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[a^2 - b^2, 0] && IntegersQ[2*m, 2*n]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Unintegrable[(g*Cos[e + f*x])^p*(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[a^2 - b^2, 0]
Int[((g_.)*sec[(e_.) + (f_.)*(x_)])^(p_)*((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := g^(2*IntPart[p])*(g*Cos[e + f*x])^FracPart[p]*(g*Sec[e + f*x])^FracPart[p]*Int[(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(g*Cos[e + f*x])^p), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] &&  !IntegerQ[p]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_)*((a_.) + (b_.)*cos[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*cos[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := g^(2*IntPart[p])*(g*Sin[e + f*x])^FracPart[p]*(g*Csc[e + f*x])^FracPart[p]*Int[(a + b*Cos[e + f*x])^m*((c + d*Cos[e + f*x])^n/(g*Sin[e + f*x])^p), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] &&  !IntegerQ[p]

(* ::Subsection::Closed:: *)
(* 4.1.2.3 (g sin)^p (a+b sin)^m (c+d sin)^n *)
Int[Sqrt[(g_.)*sin[(e_.) + (f_.)*(x_)]]*(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (g/d)*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[g*Sin[e + f*x]], x] - c*(g/d)*Int[Sqrt[a + b*Sin[e + f*x]]/(Sqrt[g*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[Sqrt[(g_.)*sin[(e_.) + (f_.)*(x_)]]*(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (b/d)*Int[Sqrt[g*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] - ((b*c - a*d)/d)*Int[Sqrt[g*Sin[e + f*x]]/(Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/(Sqrt[(g_.)*sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := -2*(b/f)*Subst[Int[1/(b*c + a*d + c*g*x^2), x], x, b*(Cos[e + f*x]/(Sqrt[g*Sin[e + f*x]]*Sqrt[a + b*Sin[e + f*x]]))] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/(Sqrt[sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (-(Sqrt[a + b]/(c*f)))*EllipticE[ArcSin[Cos[e + f*x]/(1 + Sin[e + f*x])], -((a - b)/(a + b))] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[d, c] && GtQ[b^2 - a^2, 0] && GtQ[b, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/(Sqrt[(g_.)*sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (-Sqrt[a + b*Sin[e + f*x]])*(Sqrt[d*(Sin[e + f*x]/(c + d*Sin[e + f*x]))]/(d*f*Sqrt[g*Sin[e + f*x]]*Sqrt[c^2*((a + b*Sin[e + f*x])/((a*c + b*d)*(c + d*Sin[e + f*x])))]))*EllipticE[ArcSin[c*(Cos[e + f*x]/(c + d*Sin[e + f*x]))], (b*c - a*d)/(b*c + a*d)] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/(Sqrt[(g_.)*sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (a/c)*Int[1/(Sqrt[g*Sin[e + f*x]]*Sqrt[a + b*Sin[e + f*x]]), x] + ((b*c - a*d)/(c*g))*Int[Sqrt[g*Sin[e + f*x]]/(Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/(sin[(e_.) + (f_.)*(x_)]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/c)*Int[Sqrt[a + b*Sin[e + f*x]]/Sin[e + f*x], x] - (d/c)*Int[Sqrt[a + b*Sin[e + f*x]]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/(sin[(e_.) + (f_.)*(x_)]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (a/c)*Int[1/(Sin[e + f*x]*Sqrt[a + b*Sin[e + f*x]]), x] + ((b*c - a*d)/c)*Int[1/(Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[Sqrt[(g_.)*sin[(e_.) + (f_.)*(x_)]]/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (-a)*(g/(b*c - a*d))*Int[1/(Sqrt[g*Sin[e + f*x]]*Sqrt[a + b*Sin[e + f*x]]), x] + c*(g/(b*c - a*d))*Int[Sqrt[a + b*Sin[e + f*x]]/(Sqrt[g*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[Sqrt[(g_.)*sin[(e_.) + (f_.)*(x_)]]/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := 2*Sqrt[-Cot[e + f*x]^2]*(Sqrt[g*Sin[e + f*x]]/(f*(c + d)*Cot[e + f*x]*Sqrt[a + b*Sin[e + f*x]]))*Sqrt[(b + a*Csc[e + f*x])/(a + b)]*EllipticPi[2*(c/(c + d)), ArcSin[Sqrt[1 - Csc[e + f*x]]/Sqrt[2]], 2*(a/(a + b))] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(Sqrt[(g_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (b/(b*c - a*d))*Int[1/(Sqrt[g*Sin[e + f*x]]*Sqrt[a + b*Sin[e + f*x]]), x] - (d/(b*c - a*d))*Int[Sqrt[a + b*Sin[e + f*x]]/(Sqrt[g*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[1/(Sqrt[(g_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/c)*Int[1/(Sqrt[g*Sin[e + f*x]]*Sqrt[a + b*Sin[e + f*x]]), x] - (d/(c*g))*Int[Sqrt[g*Sin[e + f*x]]/(Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(sin[(e_.) + (f_.)*(x_)]*Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (d^2/(c*(b*c - a*d)))*Int[Sqrt[a + b*Sin[e + f*x]]/(c + d*Sin[e + f*x]), x] + (1/(c*(b*c - a*d)))*Int[(b*c - a*d - b*d*Sin[e + f*x])/(Sin[e + f*x]*Sqrt[a + b*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[1/(sin[(e_.) + (f_.)*(x_)]*Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/c)*Int[1/(Sin[e + f*x]*Sqrt[a + b*Sin[e + f*x]]), x] - (d/c)*Int[1/(Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/(sin[(e_.) + (f_.)*(x_)]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (-(d/c))*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + (1/c)*Int[Sqrt[a + b*Sin[e + f*x]]*(Sqrt[c + d*Sin[e + f*x]]/Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[b*c + a*d, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/(sin[(e_.) + (f_.)*(x_)]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*(a/f)*Subst[Int[1/(1 - a*c*x^2), x], x, Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[b*c + a*d, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/(sin[(e_.) + (f_.)*(x_)]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := ((b*c - a*d)/c)*Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] + (a/c)*Int[Sqrt[c + d*Sin[e + f*x]]/(Sin[e + f*x]*Sqrt[a + b*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]/(sin[(e_.) + (f_.)*(x_)]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*((a + b*Sin[e + f*x])/(c*f*Rt[(a + b)/(c + d), 2]*Cos[e + f*x]))*Sqrt[(-(b*c - a*d))*((1 - Sin[e + f*x])/((c + d)*(a + b*Sin[e + f*x])))]*Sqrt[(b*c - a*d)*((1 + Sin[e + f*x])/((c - d)*(a + b*Sin[e + f*x])))]*EllipticPi[a*((c + d)/(c*(a + b))), ArcSin[Rt[(a + b)/(c + d), 2]*(Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]])], (a - b)*((c + d)/((a + b)*(c - d)))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(sin[(e_.) + (f_.)*(x_)]*Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (Cos[e + f*x]/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]))*Int[1/(Cos[e + f*x]*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[1/(sin[(e_.) + (f_.)*(x_)]*Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (-(b/a))*Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] + (1/a)*Int[Sqrt[a + b*Sin[e + f*x]]/(Sin[e + f*x]*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (NeQ[a^2 - b^2, 0] || NeQ[c^2 - d^2, 0])
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*(Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]/sin[(e_.) + (f_.)*(x_)]), x_Symbol] := Sqrt[a + b*Sin[e + f*x]]*(Sqrt[c + d*Sin[e + f*x]]/Cos[e + f*x])*Int[Cot[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*(Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]/sin[(e_.) + (f_.)*(x_)]), x_Symbol] := d*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + c*Int[Sqrt[a + b*Sin[e + f*x]]/(Sin[e + f*x]*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (NeQ[a^2 - b^2, 0] || NeQ[c^2 - d^2, 0])
Int[sin[(e_.) + (f_.)*(x_)]^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^n*c^n*Int[Tan[e + f*x]^p*(a + b*Sin[e + f*x])^(m - n), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[p + 2*n, 0] && IntegerQ[n]
Int[((g_.)*sin[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Sqrt[a - b*Sin[e + f*x]]*(Sqrt[a + b*Sin[e + f*x]]/(f*Cos[e + f*x]))*Subst[Int[(g*x)^p*(a + b*x)^(m - 1/2)*((c + d*x)^n/Sqrt[a - b*x]), x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && IntegerQ[m - 1/2]
Int[((g_.)*sin[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[ExpandTrig[(g*sin[e + f*x])^p*(a + b*sin[e + f*x])^m*(c + d*sin[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && NeQ[b*c - a*d, 0] && (IntegersQ[m, n] || IntegersQ[m, p] || IntegersQ[n, p]) && NeQ[p, 2]
Int[((g_.)*sin[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Unintegrable[(g*Sin[e + f*x])^p*(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[p, 2]
Int[((g_.)*sin[(e_.) + (f_.)*(x_)])^(p_.)*((a_.) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := g^(m + n)*Int[(g*Sin[e + f*x])^(p - m - n)*(b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[b*c - a*d, 0] &&  !IntegerQ[p] && IntegerQ[m] && IntegerQ[n]
Int[((g_.)*sin[(e_.) + (f_.)*(x_)])^(p_.)*((a_.) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (g*Csc[e + f*x])^p*(g*Sin[e + f*x])^p*Int[(a + b*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^n/(g*Csc[e + f*x])^p), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] &&  !IntegerQ[p] &&  !(IntegerQ[m] && IntegerQ[n])
Int[((g_.)*sin[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := g^n*Int[(g*Sin[e + f*x])^(p - n)*(a + b*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && IntegerQ[n]
Int[sin[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[(b + a*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^n/Csc[e + f*x]^(m + p)), x] /; FreeQ[{a, b, c, d, e, f, n}, x] &&  !IntegerQ[n] && IntegerQ[m] && IntegerQ[p]
Int[((g_.)*sin[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Csc[e + f*x]^p*(g*Sin[e + f*x])^p*Int[(b + a*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^n/Csc[e + f*x]^(m + p)), x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] &&  !IntegerQ[n] && IntegerQ[m] &&  !IntegerQ[p]
Int[((g_.)*sin[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (g*Sin[e + f*x])^n*((c + d*Csc[e + f*x])^n/(d + c*Sin[e + f*x])^n)*Int[(g*Sin[e + f*x])^(p - n)*(a + b*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] &&  !IntegerQ[n] &&  !IntegerQ[m]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := g^(m + n)*Int[(g*Csc[e + f*x])^(p - m - n)*(b + a*Csc[e + f*x])^m*(d + c*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[b*c - a*d, 0] &&  !IntegerQ[p] && IntegerQ[m] && IntegerQ[n]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (g*Csc[e + f*x])^p*(g*Sin[e + f*x])^p*Int[(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(g*Sin[e + f*x])^p), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] &&  !IntegerQ[p] &&  !(IntegerQ[m] && IntegerQ[n])
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := g^m*Int[(g*Csc[e + f*x])^(p - m)*(b + a*Csc[e + f*x])^m*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && IntegerQ[m]
Int[csc[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[(a + b*Sin[e + f*x])^m*((d + c*Sin[e + f*x])^n/Sin[e + f*x]^(n + p)), x] /; FreeQ[{a, b, c, d, e, f, m}, x] &&  !IntegerQ[m] && IntegerQ[n] && IntegerQ[p]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Sin[e + f*x]^p*(g*Csc[e + f*x])^p*Int[(a + b*Sin[e + f*x])^m*((d + c*Sin[e + f*x])^n/Sin[e + f*x]^(n + p)), x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] &&  !IntegerQ[m] && IntegerQ[n] &&  !IntegerQ[p]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a + b*Sin[e + f*x])^m*((g*Csc[e + f*x])^m/(b + a*Csc[e + f*x])^m)*Int[(g*Csc[e + f*x])^(p - m)*(b + a*Csc[e + f*x])^m*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] &&  !IntegerQ[m] &&  !IntegerQ[n]

(* ::Subsection::Closed:: *)
(* 4.1.3.1 (a+b sin)^m (c+d sin)^n (A+B sin) *)
Int[sin[(e_.) + (f_.)*(x_)]^(n_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := Int[ExpandTrig[sin[e + f*x]^n*(a + b*sin[e + f*x])^m*(A + B*sin[e + f*x]), x], x] /; FreeQ[{a, b, e, f, A, B}, x] && EqQ[A*b + a*B, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && IntegerQ[n]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := a^m*c^m*Int[Cos[e + f*x]^(2*m)*(c + d*Sin[e + f*x])^(n - m)*(A + B*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] &&  !(IntegerQ[n] && ((LtQ[m, 0] && GtQ[n, 0]) || LtQ[0, n, m] || LtQ[m, n, 0]))
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := Int[(a + b*Sin[e + f*x])^m*(A*c + (B*c + A*d)*Sin[e + f*x] + B*d*Sin[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0]
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := ((A*b + a*B)/(2*a*b))*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + ((B*c + A*d)/(2*c*d))*Int[Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-B)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(f*(m + n + 1))) /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[A*b*(m + n + 1) + a*B*(m - n), 0] && NeQ[m, -2^(-1)]
Int[Sqrt[(a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (B/d)*Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^(n + 1), x] - ((B*c - A*d)/d)*Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (A*b - a*B)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(a*f*(2*m + 1))) + ((a*B*(m - n) + A*b*(m + n + 1))/(a*b*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && (LtQ[m, -2^(-1)] || (ILtQ[m + n, 0] &&  !SumSimplerQ[n, 1])) && NeQ[2*m + 1, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-B)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(f*(m + n + 1))) - ((B*c*(m - n) - A*d*(m + n + 1))/(d*(m + n + 1)))*Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)] && NeQ[m + n + 1, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (B*c - A*d)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 - d^2))) /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[m + n + 2, 0] && EqQ[A*(a*d*m + b*c*(n + 1)) - B*(a*c*m + b*d*(n + 1)), 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b^2)*(B*c - A*d)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(b*c + a*d))) - (b/(d*(n + 1)*(b*c + a*d)))*Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1)*Simp[a*A*d*(m - n - 2) - B*(a*c*(m - 1) + b*d*(n + 1)) - (A*b*d*(m + n + 1) - B*(b*c*m - a*d*(n + 1)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1/2] && LtQ[n, -1] && IntegerQ[2*m] && (IntegerQ[2*n] || EqQ[c, 0])
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b)*B*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 1))) + (1/(d*(m + n + 1)))*Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n*Simp[a*A*d*(m + n + 1) + B*(a*c*(m - 1) + b*d*(n + 1)) + (A*b*d*(m + n + 1) - B*(b*c*m - a*d*(2*m + n)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1/2] &&  !LtQ[n, -1] && IntegerQ[2*m] && (IntegerQ[2*n] || EqQ[c, 0])
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (A*b - a*B)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(a*f*(2*m + 1))) - (1/(a*b*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 1)*Simp[A*(a*d*n - b*c*(m + 1)) - B*(a*c*m + b*d*n) - d*(a*B*(m - n) + A*b*(m + n + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -2^(-1)] && GtQ[n, 0] && IntegerQ[2*m] && (IntegerQ[2*n] || EqQ[c, 0])
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := b*(A*b - a*B)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(a*f*(2*m + 1)*(b*c - a*d))) + (1/(a*(2*m + 1)*(b*c - a*d)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n*Simp[B*(a*c*m + b*d*(n + 1)) + A*(b*c*(m + 1) - a*d*(2*m + n + 2)) + d*(A*b - a*B)*(m + n + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -2^(-1)] &&  !GtQ[n, 0] && IntegerQ[2*m] && (IntegerQ[2*n] || EqQ[c, 0])
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := -2*b*B*Cos[e + f*x]*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(2*n + 3)*Sqrt[a + b*Sin[e + f*x]])) /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[A*b*d*(2*n + 3) - B*(b*c - 2*a*d*(n + 1)), 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b^2)*(B*c - A*d)*Cos[e + f*x]*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(b*c + a*d)*Sqrt[a + b*Sin[e + f*x]])) + ((A*b*d*(2*n + 3) - B*(b*c - 2*a*d*(n + 1)))/(2*d*(n + 1)*(b*c + a*d)))*Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[n, -1]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := -2*b*B*Cos[e + f*x]*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(2*n + 3)*Sqrt[a + b*Sin[e + f*x]])) + ((A*b*d*(2*n + 3) - B*(b*c - 2*a*d*(n + 1)))/(b*d*(2*n + 3)))*Int[Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] &&  !LtQ[n, -1]
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := ((A*b - a*B)/b)*Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] + (B/b)*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-B)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^n/(f*(m + n + 1))) + (1/(b*(m + n + 1)))*Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^(n - 1)*Simp[A*b*c*(m + n + 1) + B*(a*c*m + b*d*n) + (A*b*d*(m + n + 1) + B*(a*d*m + b*c*n))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[n, 0] && (IntegerQ[n] || EqQ[m + 1/2, 0])
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (B*c - A*d)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 - d^2))) + (1/(b*(n + 1)*(c^2 - d^2)))*Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^(n + 1)*Simp[A*(a*d*m + b*c*(n + 1)) - B*(a*c*m + b*d*(n + 1)) + b*(B*c - A*d)*(m + n + 2)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[n, -1] && (IntegerQ[n] || EqQ[m + 1/2, 0])
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := ((A*b - a*B)/(b*c - a*d))*Int[1/Sqrt[a + b*Sin[e + f*x]], x] + ((B*c - A*d)/(b*c - a*d))*Int[Sqrt[a + b*Sin[e + f*x]]/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*(((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])/((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (B/d)*Int[(a + b*Sin[e + f*x])^m, x] - ((B*c - A*d)/d)*Int[(a + b*Sin[e + f*x])^m/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && NeQ[m + 1/2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := ((A*b - a*B)/b)*Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n, x] + (B/b)*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && NeQ[A*b + a*B, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(b*c - a*d))*(B*c - A*d)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2))) + (1/(d*(n + 1)*(c^2 - d^2)))*Int[(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^(n + 1)*Simp[b*(b*c - a*d)*(B*c - A*d)*(m - 1) + a*d*(a*A*c + b*B*c - (A*b + a*B)*d)*(n + 1) + (b*(b*d*(B*c - A*d) + a*(A*c*d + B*(c^2 - 2*d^2)))*(n + 1) - a*(b*c - a*d)*(B*c - A*d)*(n + 2))*Sin[e + f*x] + b*(d*(A*b*c + a*B*c - a*A*d)*(m + n + 1) - b*B*(c^2*m + d^2*(n + 1)))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1] && LtQ[n, -1]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b)*B*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m - 1)*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 1))) + (1/(d*(m + n + 1)))*Int[(a + b*Sin[e + f*x])^(m - 2)*(c + d*Sin[e + f*x])^n*Simp[a^2*A*d*(m + n + 1) + b*B*(b*c*(m - 1) + a*d*(n + 1)) + (a*d*(2*A*b + a*B)*(m + n + 1) - b*B*(a*c - b*d*(m + n)))*Sin[e + f*x] + b*(A*b*d*(m + n + 1) - B*(b*c*m - a*d*(2*m + n)))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 1] &&  !(IGtQ[n, 1] && ( !IntegerQ[m] || (EqQ[a, 0] && NeQ[c, 0])))
Int[Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]*(((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])/((b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)), x_Symbol] := B*(d/b^2)*Int[Sqrt[b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + Int[(A*c + (B*c + A*d)*Sin[e + f*x])/((b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{b, c, d, e, f, A, B}, x] && NeQ[c^2 - d^2, 0]
Int[Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]*(((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)), x_Symbol] := (B/b)*Int[Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] + ((A*b - a*B)/b)*Int[Sqrt[c + d*Sin[e + f*x]]/(a + b*Sin[e + f*x])^(3/2), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := 2*(A*b - a*B)*(Cos[e + f*x]/(f*(a^2 - b^2)*Sqrt[a + b*Sin[e + f*x]]*Sqrt[d*Sin[e + f*x]])) + (d/(a^2 - b^2))*Int[(A*b - a*B + (a*A - b*B)*Sin[e + f*x])/(Sqrt[a + b*Sin[e + f*x]]*(d*Sin[e + f*x])^(3/2)), x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[a^2 - b^2, 0]
Int[((A_) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(((b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*A*(c - d)*(Tan[e + f*x]/(f*b*c^2))*Rt[(c + d)/b, 2]*Sqrt[c*((1 + Csc[e + f*x])/(c - d))]*Sqrt[c*((1 - Csc[e + f*x])/(c + d))]*EllipticE[ArcSin[Sqrt[c + d*Sin[e + f*x]]/(Sqrt[b*Sin[e + f*x]]*Rt[(c + d)/b, 2])], -((c + d)/(c - d))] /; FreeQ[{b, c, d, e, f, A, B}, x] && NeQ[c^2 - d^2, 0] && EqQ[A, B] && PosQ[(c + d)/b]
Int[((A_) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(((b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (-(Sqrt[(-b)*Sin[e + f*x]]/Sqrt[b*Sin[e + f*x]]))*Int[(A + B*Sin[e + f*x])/(((-b)*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{b, c, d, e, f, A, B}, x] && NeQ[c^2 - d^2, 0] && EqQ[A, B] && NegQ[(c + d)/b]
Int[((A_) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*A*(c - d)*((a + b*Sin[e + f*x])/(f*(b*c - a*d)^2*Rt[(a + b)/(c + d), 2]*Cos[e + f*x]))*Sqrt[(b*c - a*d)*((1 + Sin[e + f*x])/((c - d)*(a + b*Sin[e + f*x])))]*Sqrt[(-(b*c - a*d))*((1 - Sin[e + f*x])/((c + d)*(a + b*Sin[e + f*x])))]*EllipticE[ArcSin[Rt[(a + b)/(c + d), 2]*(Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]])], (a - b)*((c + d)/((a + b)*(c - d)))] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[A, B] && PosQ[(a + b)/(c + d)]
Int[((A_) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (Sqrt[-c - d*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]])*Int[(A + B*Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)*Sqrt[-c - d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[A, B] && NegQ[(a + b)/(c + d)]
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := ((A - B)/(a - b))*Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] - ((A*b - a*B)/(a - b))*Int[(1 + Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && NeQ[A, B]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (B*a - A*b)*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((c + d*Sin[e + f*x])^n/(f*(m + 1)*(a^2 - b^2))) + (1/((m + 1)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^(n - 1)*Simp[c*(a*A - b*B)*(m + 1) + d*n*(A*b - a*B) + (d*(a*A - b*B)*(m + 1) - c*(A*b - a*B)*(m + 2))*Sin[e + f*x] - d*(A*b - a*B)*(m + n + 2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && GtQ[n, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(A*b^2 - a*b*B))*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((c + d*Sin[e + f*x])^(1 + n)/(f*(m + 1)*(b*c - a*d)*(a^2 - b^2))) + (1/((m + 1)*(b*c - a*d)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n*Simp[(a*A - b*B)*(b*c - a*d)*(m + 1) + b*d*(A*b - a*B)*(m + n + 2) + (A*b - a*B)*(a*d*(m + 1) - b*c*(m + 2))*Sin[e + f*x] - b*d*(A*b - a*B)*(m + n + 3)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && RationalQ[m] && m < -1 && ((EqQ[a, 0] && IntegerQ[m] &&  !IntegerQ[n]) ||  !(IntegerQ[2*n] && LtQ[n, -1] && ((IntegerQ[n] &&  !IntegerQ[m]) || EqQ[a, 0])))
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := ((A*b - a*B)/(b*c - a*d))*Int[1/(a + b*Sin[e + f*x]), x] + ((B*c - A*d)/(b*c - a*d))*Int[1/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*(((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])/((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (B/d)*Int[(a + b*Sin[e + f*x])^m, x] - ((B*c - A*d)/d)*Int[(a + b*Sin[e + f*x])^m/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[(a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := -2*B*Cos[e + f*x]*Sqrt[a + b*Sin[e + f*x]]*((c + d*Sin[e + f*x])^n/(f*(2*n + 3))) + (1/(2*n + 3))*Int[((c + d*Sin[e + f*x])^(n - 1)/Sqrt[a + b*Sin[e + f*x]])*Simp[a*A*c*(2*n + 3) + B*(b*c + 2*a*d*n) + (B*(a*c + b*d)*(2*n + 1) + A*(b*c + a*d)*(2*n + 3))*Sin[e + f*x] + (A*b*d*(2*n + 3) + B*(a*d + 2*b*c*n))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[n^2, 1/4]
Int[((A_) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(Sqrt[sin[(e_.) + (f_.)*(x_)]]*Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := 4*(A/(f*Sqrt[a + b]))*EllipticPi[-1, -ArcSin[Cos[e + f*x]/(1 + Sin[e + f*x])], -((a - b)/(a + b))] /; FreeQ[{a, b, e, f, A, B}, x] && GtQ[b, 0] && GtQ[b^2 - a^2, 0] && EqQ[A, B]
Int[((A_) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(d_)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (Sqrt[Sin[e + f*x]]/Sqrt[d*Sin[e + f*x]])*Int[(A + B*Sin[e + f*x])/(Sqrt[Sin[e + f*x]]*Sqrt[a + b*Sin[e + f*x]]), x] /; FreeQ[{a, b, e, f, d, A, B}, x] && GtQ[b, 0] && GtQ[b^2 - a^2, 0] && EqQ[A, B]
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])/(Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (B/d)*Int[Sqrt[c + d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] - ((B*c - A*d)/d)*Int[1/(Sqrt[a + b*Sin[e + f*x]]*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]), x_Symbol] := Unintegrable[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n*(A + B*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)])^(p_), x_Symbol] := Sqrt[a + b*Sin[e + f*x]]*(Sqrt[c + d*Sin[e + f*x]]/(f*Cos[e + f*x]))*Subst[Int[(a + b*x)^(m - 1/2)*(c + d*x)^(n - 1/2)*(A + B*x)^p, x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*cos[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*cos[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*cos[(e_.) + (f_.)*(x_)])^(p_), x_Symbol] := (-Sqrt[a + b*Cos[e + f*x]])*(Sqrt[c + d*Cos[e + f*x]]/(f*Sin[e + f*x]))*Subst[Int[(a + b*x)^(m - 1/2)*(c + d*x)^(n - 1/2)*(A + B*x)^p, x], x, Cos[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]

(* ::Subsection::Closed:: *)
(* 4.1.4.1 (a+b sin)^m (A+B sin+C sin^2) *)
Int[((b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (1/b)*Int[(b*Sin[e + f*x])^(m + 1)*(B + C*Sin[e + f*x]), x] /; FreeQ[{b, e, f, B, C, m}, x]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((A_) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*Cos[e + f*x]*((b*Sin[e + f*x])^(m + 1)/(b*f*(m + 1))) /; FreeQ[{b, e, f, A, C, m}, x] && EqQ[A*(m + 2) + C*(m + 1), 0]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((A_) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*Cos[e + f*x]*((b*Sin[e + f*x])^(m + 1)/(b*f*(m + 1))) + ((A*(m + 2) + C*(m + 1))/(b^2*(m + 1)))*Int[(b*Sin[e + f*x])^(m + 2), x] /; FreeQ[{b, e, f, A, C}, x] && LtQ[m, -1]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*((A_) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-f^(-1))*Subst[Int[(1 - x^2)^((m - 1)/2)*(A + C - C*x^2), x], x, Cos[e + f*x]] /; FreeQ[{e, f, A, C}, x] && IGtQ[(m + 1)/2, 0]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((A_) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cos[e + f*x]*((b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2))) + ((A*(m + 2) + C*(m + 1))/(m + 2))*Int[(b*Sin[e + f*x])^m, x] /; FreeQ[{b, e, f, A, C, m}, x] &&  !LtQ[m, -1]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (1/b^2)*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[b*B - a*C + b*C*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[A*b^2 - a*b*B + a^2*C, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (C/b^2)*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[-a + b*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A*b^2 + a^2*C, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A - C)*Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x]), x] + C*Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x])^2, x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[A - B + C, 0] &&  !IntegerQ[2*m]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A - C)*Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x]), x] + C*Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x])^2, x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A + C, 0] &&  !IntegerQ[2*m]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A*b - a*B + b*C)*Cos[e + f*x]*((a + b*Sin[e + f*x])^m/(a*f*(2*m + 1))) + (1/(a^2*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[a*A*(m + 1) + m*(b*B - a*C) + b*C*(2*m + 1)*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && LtQ[m, -1] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := b*(A + C)*Cos[e + f*x]*((a + b*Sin[e + f*x])^m/(a*f*(2*m + 1))) + (1/(a^2*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[a*A*(m + 1) - a*C*m + b*C*(2*m + 1)*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && LtQ[m, -1] && EqQ[a^2 - b^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(A*b^2 - a*b*B + a^2*C))*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 - b^2))) + (1/(b*(m + 1)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[b*(a*A - b*B + a*C)*(m + 1) - (A*b^2 - a*b*B + a^2*C + b*(A*b - a*B + b*C)*(m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && LtQ[m, -1] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(A*b^2 + a^2*C))*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 - b^2))) + (1/(b*(m + 1)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[a*b*(A + C)*(m + 1) - (A*b^2 + a^2*C + b^2*(A + C)*(m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && LtQ[m, -1] && NeQ[a^2 - b^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2))) + (1/(b*(m + 2)))*Int[(a + b*Sin[e + f*x])^m*Simp[A*b*(m + 2) + b*C*(m + 1) + (b*B*(m + 2) - a*C)*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] &&  !LtQ[m, -1]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2))) + (1/(b*(m + 2)))*Int[(a + b*Sin[e + f*x])^m*Simp[A*b*(m + 2) + b*C*(m + 1) - a*C*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] &&  !LtQ[m, -1]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)]^(p_))^(m_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := ((b*Sin[e + f*x]^p)^m/(b*Sin[e + f*x])^(m*p))*Int[(b*Sin[e + f*x])^(m*p)*(A + B*Sin[e + f*x] + C*Sin[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m, p}, x] &&  !IntegerQ[m]
Int[((b_.)*cos[(e_.) + (f_.)*(x_)]^(p_))^(m_)*((A_.) + (B_.)*cos[(e_.) + (f_.)*(x_)] + (C_.)*cos[(e_.) + (f_.)*(x_)]^2), x_Symbol] := ((b*Cos[e + f*x]^p)^m/(b*Cos[e + f*x])^(m*p))*Int[(b*Cos[e + f*x])^(m*p)*(A + B*Cos[e + f*x] + C*Cos[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m, p}, x] &&  !IntegerQ[m]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)]^(p_))^(m_)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := ((b*Sin[e + f*x]^p)^m/(b*Sin[e + f*x])^(m*p))*Int[(b*Sin[e + f*x])^(m*p)*(A + C*Sin[e + f*x]^2), x] /; FreeQ[{b, e, f, A, C, m, p}, x] &&  !IntegerQ[m]
Int[((b_.)*cos[(e_.) + (f_.)*(x_)]^(p_))^(m_)*((A_.) + (C_.)*cos[(e_.) + (f_.)*(x_)]^2), x_Symbol] := ((b*Cos[e + f*x]^p)^m/(b*Cos[e + f*x])^(m*p))*Int[(b*Cos[e + f*x])^(m*p)*(A + C*Cos[e + f*x]^2), x] /; FreeQ[{b, e, f, A, C, m, p}, x] &&  !IntegerQ[m]

(* ::Subsection::Closed:: *)
(* 4.1.4.2 (a+b sin)^m (c+d sin)^n (A+B sin+C sin^2) *)
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(b*c - a*d))*(A*b^2 - a*b*B + a^2*C)*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b^2*f*(m + 1)*(a^2 - b^2))) - (1/(b^2*(m + 1)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[b*(m + 1)*((b*B - a*C)*(b*c - a*d) - A*b*(a*c - b*d)) + (b*B*(a^2*d + b^2*d*(m + 1) - a*b*c*(m + 2)) + (b*c - a*d)*(A*b^2*(m + 2) + C*(a^2 + b^2*(m + 1))))*Sin[e + f*x] - b*C*d*(m + 1)*(a^2 - b^2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(b*c - a*d))*(A*b^2 + a^2*C)*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b^2*f*(m + 1)*(a^2 - b^2))) + (1/(b^2*(m + 1)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[b*(m + 1)*(a*C*(b*c - a*d) + A*b*(a*c - b*d)) - ((b*c - a*d)*(A*b^2*(m + 2) + C*(a^2 + b^2*(m + 1))))*Sin[e + f*x] + b*C*d*(m + 1)*(a^2 - b^2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*d*Cos[e + f*x]*Sin[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 3))) + (1/(b*(m + 3)))*Int[(a + b*Sin[e + f*x])^m*Simp[a*C*d + A*b*c*(m + 3) + b*(B*c*(m + 3) + d*(C*(m + 2) + A*(m + 3)))*Sin[e + f*x] - (2*a*C*d - b*(c*C + B*d)*(m + 3))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] &&  !LtQ[m, -1]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*sin[(e_.) + (f_.)*(x_)])*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*d*Cos[e + f*x]*Sin[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 3))) + (1/(b*(m + 3)))*Int[(a + b*Sin[e + f*x])^m*Simp[a*C*d + A*b*c*(m + 3) + b*d*(C*(m + 2) + A*(m + 3))*Sin[e + f*x] - (2*a*C*d - b*c*C*(m + 3))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] &&  !LtQ[m, -1]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (a*A - b*B + a*C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(2*b*c*f*(2*m + 1))) - (1/(2*b*c*d*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n*Simp[A*(c^2*(m + 1) + d^2*(2*m + n + 2)) - B*c*d*(m - n - 1) - C*(c^2*m - d^2*(n + 1)) + d*((A*c + B*d)*(m + n + 2) - c*C*(3*m - n))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && (LtQ[m, -2^(-1)] || (EqQ[m + n + 2, 0] && NeQ[2*m + 1, 0]))
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (a*A + a*C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(2*b*c*f*(2*m + 1))) - (1/(2*b*c*d*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n*Simp[A*(c^2*(m + 1) + d^2*(2*m + n + 2)) - C*(c^2*m - d^2*(n + 1)) + d*(A*c*(m + n + 2) - c*C*(3*m - n))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && (LtQ[m, -2^(-1)] || (EqQ[m + n + 2, 0] && NeQ[2*m + 1, 0]))
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*(((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*C*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(2*m + 3)*Sqrt[c + d*Sin[e + f*x]])) + Int[(a + b*Sin[e + f*x])^m*(Simp[A + C + B*Sin[e + f*x], x]/Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*(((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*C*Cos[e + f*x]*((a + b*Sin[e + f*x])^(m + 1)/(b*f*(2*m + 3)*Sqrt[c + d*Sin[e + f*x]])) + (A + C)*Int[(a + b*Sin[e + f*x])^m/Sqrt[c + d*Sin[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f, A, C, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2))) + (1/(b*d*(m + n + 2)))*Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n*Simp[A*b*d*(m + n + 2) + C*(a*c*m + b*d*(n + 1)) + (b*B*d*(m + n + 2) - b*c*C*(2*m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)] && NeQ[m + n + 2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2))) + (1/(b*d*(m + n + 2)))*Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n*Simp[A*b*d*(m + n + 2) + C*(a*c*m + b*d*(n + 1)) - b*c*C*(2*m + 1)*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)] && NeQ[m + n + 2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (a*A - b*B + a*C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(f*(b*c - a*d)*(2*m + 1))) + (1/(b*(b*c - a*d)*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n*Simp[A*(a*c*(m + 1) - b*d*(2*m + n + 2)) + B*(b*c*m + a*d*(n + 1)) - C*(a*c*m + b*d*(n + 1)) + (d*(a*A - b*B)*(m + n + 2) + C*(b*c*(2*m + 1) - a*d*(m - n - 1)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := a*(A + C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(f*(b*c - a*d)*(2*m + 1))) + (1/(b*(b*c - a*d)*(2*m + 1)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n*Simp[A*(a*c*(m + 1) - b*d*(2*m + n + 2)) - C*(a*c*m + b*d*(n + 1)) + (a*A*d*(m + n + 2) + C*(b*c*(2*m + 1) - a*d*(m - n - 1)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(c^2*C - B*c*d + A*d^2))*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2))) + (1/(b*d*(n + 1)*(c^2 - d^2)))*Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^(n + 1)*Simp[A*d*(a*d*m + b*c*(n + 1)) + (c*C - B*d)*(a*c*m + b*d*(n + 1)) + b*(d*(B*c - A*d)*(m + n + 2) - C*(c^2*(m + 1) + d^2*(n + 1)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] &&  !LtQ[m, -2^(-1)] && (LtQ[n, -1] || EqQ[m + n + 2, 0])
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(c^2*C + A*d^2))*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2))) + (1/(b*d*(n + 1)*(c^2 - d^2)))*Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^(n + 1)*Simp[A*d*(a*d*m + b*c*(n + 1)) + c*C*(a*c*m + b*d*(n + 1)) - b*(A*d^2*(m + n + 2) + C*(c^2*(m + 1) + d^2*(n + 1)))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] &&  !LtQ[m, -2^(-1)] && (LtQ[n, -1] || EqQ[m + n + 2, 0])
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2))) + (1/(b*d*(m + n + 2)))*Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n*Simp[A*b*d*(m + n + 2) + C*(a*c*m + b*d*(n + 1)) + (C*(a*d*m - b*c*(m + 1)) + b*B*d*(m + n + 2))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] &&  !LtQ[m, -2^(-1)] && NeQ[m + n + 2, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2))) + (1/(b*d*(m + n + 2)))*Int[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n*Simp[A*b*d*(m + n + 2) + C*(a*c*m + b*d*(n + 1)) + C*(a*d*m - b*c*(m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] &&  !LtQ[m, -2^(-1)] && NeQ[m + n + 2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(c^2*C - B*c*d + A*d^2))*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2))) + (1/(d*(n + 1)*(c^2 - d^2)))*Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1)*Simp[A*d*(b*d*m + a*c*(n + 1)) + (c*C - B*d)*(b*c*m + a*d*(n + 1)) - (d*(A*(a*d*(n + 2) - b*c*(n + 1)) + B*(b*d*(n + 1) - a*c*(n + 2))) - C*(b*c*d*(n + 1) - a*(c^2 + d^2*(n + 1))))*Sin[e + f*x] + b*(d*(B*c - A*d)*(m + n + 2) - C*(c^2*(m + 1) + d^2*(n + 1)))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 0] && LtQ[n, -1]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(c^2*C + A*d^2))*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 - d^2))) + (1/(d*(n + 1)*(c^2 - d^2)))*Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^(n + 1)*Simp[A*d*(b*d*m + a*c*(n + 1)) + c*C*(b*c*m + a*d*(n + 1)) - (A*d*(a*d*(n + 2) - b*c*(n + 1)) - C*(b*c*d*(n + 1) - a*(c^2 + d^2*(n + 1))))*Sin[e + f*x] - b*(A*d^2*(m + n + 2) + C*(c^2*(m + 1) + d^2*(n + 1)))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 0] && LtQ[n, -1]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2))) + (1/(d*(m + n + 2)))*Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n*Simp[a*A*d*(m + n + 2) + C*(b*c*m + a*d*(n + 1)) + (d*(A*b + a*B)*(m + n + 2) - C*(a*c - b*d*(m + n + 1)))*Sin[e + f*x] + (C*(a*d*m - b*c*(m + 1)) + b*B*d*(m + n + 2))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 0] &&  !(IGtQ[n, 0] && ( !IntegerQ[m] || (EqQ[a, 0] && NeQ[c, 0])))
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m*((c + d*Sin[e + f*x])^(n + 1)/(d*f*(m + n + 2))) + (1/(d*(m + n + 2)))*Int[(a + b*Sin[e + f*x])^(m - 1)*(c + d*Sin[e + f*x])^n*Simp[a*A*d*(m + n + 2) + C*(b*c*m + a*d*(n + 1)) + (A*b*d*(m + n + 2) - C*(a*c - b*d*(m + n + 1)))*Sin[e + f*x] + C*(a*d*m - b*c*(m + 1))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && GtQ[m, 0] &&  !(IGtQ[n, 0] && ( !IntegerQ[m] || (EqQ[a, 0] && NeQ[c, 0])))
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/(((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (C/(b*d))*Int[Sqrt[d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] + (1/b)*Int[(A*b + (b*B - a*C)*Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)*Sqrt[d*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0]
Int[((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/(((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (C/(b*d))*Int[Sqrt[d*Sin[e + f*x]]/Sqrt[a + b*Sin[e + f*x]], x] + (1/b)*Int[(A*b - a*C*Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)*Sqrt[d*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f, A, C}, x] && NeQ[a^2 - b^2, 0]
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/(((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (C/b^2)*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + (1/b^2)*Int[(A*b^2 - a^2*C + b*(b*B - 2*a*C)*Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/(((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (C/b^2)*Int[Sqrt[a + b*Sin[e + f*x]]/Sqrt[c + d*Sin[e + f*x]], x] + (1/b^2)*Int[(A*b^2 - a^2*C - 2*a*b*C*Sin[e + f*x])/((a + b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(A*b^2 - a*b*B + a^2*C))*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((c + d*Sin[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 - b^2))) + (1/((m + 1)*(b*c - a*d)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n*Simp[(m + 1)*(b*c - a*d)*(a*A - b*B + a*C) + d*(A*b^2 - a*b*B + a^2*C)*(m + n + 2) - (c*(A*b^2 - a*b*B + a^2*C) + (m + 1)*(b*c - a*d)*(A*b - a*B + b*C))*Sin[e + f*x] - d*(A*b^2 - a*b*B + a^2*C)*(m + n + 3)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && ((EqQ[a, 0] && IntegerQ[m] &&  !IntegerQ[n]) ||  !(IntegerQ[2*n] && LtQ[n, -1] && ((IntegerQ[n] &&  !IntegerQ[m]) || EqQ[a, 0])))
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(A*b^2 + a^2*C))*Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)*((c + d*Sin[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 - b^2))) + (1/((m + 1)*(b*c - a*d)*(a^2 - b^2)))*Int[(a + b*Sin[e + f*x])^(m + 1)*(c + d*Sin[e + f*x])^n*Simp[a*(m + 1)*(b*c - a*d)*(A + C) + d*(A*b^2 + a^2*C)*(m + n + 2) - (c*(A*b^2 + a^2*C) + b*(m + 1)*(b*c - a*d)*(A + C))*Sin[e + f*x] - d*(A*b^2 + a^2*C)*(m + n + 3)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && LtQ[m, -1] && ((EqQ[a, 0] && IntegerQ[m] &&  !IntegerQ[n]) ||  !(IntegerQ[2*n] && LtQ[n, -1] && ((IntegerQ[n] &&  !IntegerQ[m]) || EqQ[a, 0])))
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/(((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := C*(x/(b*d)) + ((A*b^2 - a*b*B + a^2*C)/(b*(b*c - a*d)))*Int[1/(a + b*Sin[e + f*x]), x] - ((c^2*C - B*c*d + A*d^2)/(d*(b*c - a*d)))*Int[1/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/(((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := C*(x/(b*d)) + ((A*b^2 + a^2*C)/(b*(b*c - a*d)))*Int[1/(a + b*Sin[e + f*x]), x] - ((c^2*C + A*d^2)/(d*(b*c - a*d)))*Int[1/(c + d*Sin[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/(Sqrt[(a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (C/(b*d))*Int[Sqrt[a + b*Sin[e + f*x]], x] - (1/(b*d))*Int[Simp[a*c*C - A*b*d + (b*c*C - b*B*d + a*C*d)*Sin[e + f*x], x]/(Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/(Sqrt[(a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (C/(b*d))*Int[Sqrt[a + b*Sin[e + f*x]], x] - (1/(b*d))*Int[Simp[a*c*C - A*b*d + (b*c*C + a*C*d)*Sin[e + f*x], x]/(Sqrt[a + b*Sin[e + f*x]]*(c + d*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/(Sqrt[(a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (-C)*Cos[e + f*x]*(Sqrt[c + d*Sin[e + f*x]]/(d*f*Sqrt[a + b*Sin[e + f*x]])) + (1/(2*d))*Int[(1/((a + b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]]))*Simp[2*a*A*d - C*(b*c - a*d) - 2*(a*c*C - d*(A*b + a*B))*Sin[e + f*x] + (2*b*B*d - C*(b*c + a*d))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/(Sqrt[(a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*sin[(e_.) + (f_.)*(x_)]]), x_Symbol] := (-C)*Cos[e + f*x]*(Sqrt[c + d*Sin[e + f*x]]/(d*f*Sqrt[a + b*Sin[e + f*x]])) + (1/(2*d))*Int[(1/((a + b*Sin[e + f*x])^(3/2)*Sqrt[c + d*Sin[e + f*x]]))*Simp[2*a*A*d - C*(b*c - a*d) - 2*(a*c*C - A*b*d)*Sin[e + f*x] - C*(b*c + a*d)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*(((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := ((b*B - a*C)/b^2)*Int[(d*Sin[e + f*x])^n, x] + (C/(b*d))*Int[(d*Sin[e + f*x])^(n + 1), x] + ((A*b^2 - a*b*B + a^2*C)/b^2)*Int[(d*Sin[e + f*x])^n/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] && NeQ[a^2 - b^2, 0]
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*(((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)])), x_Symbol] := (-a)*(C/b^2)*Int[(d*Sin[e + f*x])^n, x] + (C/(b*d))*Int[(d*Sin[e + f*x])^(n + 1), x] + ((A*b^2 + a^2*C)/b^2)*Int[(d*Sin[e + f*x])^n/(a + b*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] && NeQ[a^2 - b^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := Unintegrable[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n*(A + B*Sin[e + f*x] + C*Sin[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := Unintegrable[(a + b*Sin[e + f*x])^m*(c + d*Sin[e + f*x])^n*(A + C*Sin[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)]^(p_))^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)] + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := ((b*Sin[e + f*x]^p)^m/(b*Sin[e + f*x])^(m*p))*Int[(b*Sin[e + f*x])^(m*p)*(c + d*Sin[e + f*x])^n*(A + B*Sin[e + f*x] + C*Sin[e + f*x]^2), x] /; FreeQ[{b, c, d, e, f, A, B, C, m, n, p}, x] &&  !IntegerQ[m]
Int[((b_.)*cos[(e_.) + (f_.)*(x_)]^(p_))^(m_)*((c_.) + (d_.)*cos[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*cos[(e_.) + (f_.)*(x_)] + (C_.)*cos[(e_.) + (f_.)*(x_)]^2), x_Symbol] := ((b*Cos[e + f*x]^p)^m/(b*Cos[e + f*x])^(m*p))*Int[(b*Cos[e + f*x])^(m*p)*(c + d*Cos[e + f*x])^n*(A + B*Cos[e + f*x] + C*Cos[e + f*x]^2), x] /; FreeQ[{b, c, d, e, f, A, B, C, m, n, p}, x] &&  !IntegerQ[m]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)]^(p_))^(m_)*((c_.) + (d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (C_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := ((b*Sin[e + f*x]^p)^m/(b*Sin[e + f*x])^(m*p))*Int[(b*Sin[e + f*x])^(m*p)*(c + d*Sin[e + f*x])^n*(A + C*Sin[e + f*x]^2), x] /; FreeQ[{b, c, d, e, f, A, C, m, n, p}, x] &&  !IntegerQ[m]
Int[((b_.)*cos[(e_.) + (f_.)*(x_)]^(p_))^(m_)*((c_.) + (d_.)*cos[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (C_.)*cos[(e_.) + (f_.)*(x_)]^2), x_Symbol] := ((b*Cos[e + f*x]^p)^m/(b*Cos[e + f*x])^(m*p))*Int[(b*Cos[e + f*x])^(m*p)*(c + d*Cos[e + f*x])^n*(A + C*Cos[e + f*x]^2), x] /; FreeQ[{b, c, d, e, f, A, C, m, n, p}, x] &&  !IntegerQ[m]

(* ::Subsection::Closed:: *)
(* 4.1.5 trig^m (a cos+b sin)^n *)
Int[((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := a*((a*Cos[c + d*x] + b*Sin[c + d*x])^n/(b*d*n)) /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 + b^2, 0]
Int[((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-d^(-1))*Subst[Int[(a^2 + b^2 - x^2)^((n - 1)/2), x], x, b*Cos[c + d*x] - a*Sin[c + d*x]] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && IGtQ[(n - 1)/2, 0]
Int[((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-(b*Cos[c + d*x] - a*Sin[c + d*x]))*((a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/(d*n)) + (n - 1)*((a^2 + b^2)/n)*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] &&  !IntegerQ[(n - 1)/2] && GtQ[n, 1]
Int[1/((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)]), x_Symbol] := (-d^(-1))*Subst[Int[1/(a^2 + b^2 - x^2), x], x, b*Cos[c + d*x] - a*Sin[c + d*x]] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[1/((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^2, x_Symbol] := Sin[c + d*x]/(a*d*(a*Cos[c + d*x] + b*Sin[c + d*x])) /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (b*Cos[c + d*x] - a*Sin[c + d*x])*((a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1)/(d*(n + 1)*(a^2 + b^2))) + ((n + 2)/((n + 1)*(a^2 + b^2)))*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1] && NeQ[n, -2]
Int[((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (a^2 + b^2)^(n/2)*Int[Cos[c + d*x - ArcTan[a, b]]^n, x] /; FreeQ[{a, b, c, d, n}, x] &&  !(GeQ[n, 1] || LeQ[n, -1]) && GtQ[a^2 + b^2, 0]
Int[((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := ((a*Cos[c + d*x] + b*Sin[c + d*x])^n/((a*Cos[c + d*x] + b*Sin[c + d*x])/Sqrt[a^2 + b^2])^n)*Int[Cos[c + d*x - ArcTan[a, b]]^n, x] /; FreeQ[{a, b, c, d, n}, x] &&  !(GeQ[n, 1] || LeQ[n, -1]) &&  !(GtQ[a^2 + b^2, 0] || EqQ[a^2 + b^2, 0])
Int[sin[(c_.) + (d_.)*(x_)]^(m_)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-a)*((a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/(d*(n - 1)*Sin[c + d*x]^(n - 1))) + 2*b*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/Sin[c + d*x]^(n - 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] && GtQ[n, 1]
Int[cos[(c_.) + (d_.)*(x_)]^(m_)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := b*((a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/(d*(n - 1)*Cos[c + d*x]^(n - 1))) + 2*a*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/Cos[c + d*x]^(n - 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] && GtQ[n, 1]
Int[sin[(c_.) + (d_.)*(x_)]^(m_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := a*((a*Cos[c + d*x] + b*Sin[c + d*x])^n/(2*b*d*n*Sin[c + d*x]^n)) + (1/(2*b))*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1)/Sin[c + d*x]^(n + 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] && LtQ[n, 0]
Int[cos[(c_.) + (d_.)*(x_)]^(m_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-b)*((a*Cos[c + d*x] + b*Sin[c + d*x])^n/(2*a*d*n*Cos[c + d*x]^n)) + (1/(2*a))*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1)/Cos[c + d*x]^(n + 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] && LtQ[n, 0]
Int[sin[(c_.) + (d_.)*(x_)]^(m_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := a*((a*Cos[c + d*x] + b*Sin[c + d*x])^n/(2*b*d*n*Sin[c + d*x]^n))*Hypergeometric2F1[1, n, n + 1, (b + a*Cot[c + d*x])/(2*b)] /; FreeQ[{a, b, c, d, n}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] &&  !IntegerQ[n]
Int[cos[(c_.) + (d_.)*(x_)]^(m_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-b)*((a*Cos[c + d*x] + b*Sin[c + d*x])^n/(2*a*d*n*Cos[c + d*x]^n))*Hypergeometric2F1[1, n, n + 1, (a + b*Tan[c + d*x])/(2*a)] /; FreeQ[{a, b, c, d, n}, x] && EqQ[m + n, 0] && EqQ[a^2 + b^2, 0] &&  !IntegerQ[n]
Int[sin[(c_.) + (d_.)*(x_)]^(m_)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := Int[(b + a*Cot[c + d*x])^n, x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && IntegerQ[n] && NeQ[a^2 + b^2, 0]
Int[cos[(c_.) + (d_.)*(x_)]^(m_)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := Int[(a + b*Tan[c + d*x])^n, x] /; FreeQ[{a, b, c, d}, x] && EqQ[m + n, 0] && IntegerQ[n] && NeQ[a^2 + b^2, 0]
Int[sin[(c_.) + (d_.)*(x_)]^(m_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (1/d)*Subst[Int[x^m*((a + b*x)^n/(1 + x^2)^((m + n + 2)/2)), x], x, Tan[c + d*x]] /; FreeQ[{a, b, c, d}, x] && IntegerQ[n] && IntegerQ[(m + n)/2] && NeQ[n, -1] &&  !(GtQ[n, 0] && GtQ[m, 1])
Int[cos[(c_.) + (d_.)*(x_)]^(m_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-d^(-1))*Subst[Int[x^m*((b + a*x)^n/(1 + x^2)^((m + n + 2)/2)), x], x, Cot[c + d*x]] /; FreeQ[{a, b, c, d}, x] && IntegerQ[n] && IntegerQ[(m + n)/2] && NeQ[n, -1] &&  !(GtQ[n, 0] && GtQ[m, 1])
Int[sin[(c_.) + (d_.)*(x_)]^(m_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := Int[ExpandTrig[sin[c + d*x]^m*(a*cos[c + d*x] + b*sin[c + d*x])^n, x], x] /; FreeQ[{a, b, c, d}, x] && IntegerQ[m] && IGtQ[n, 0]
Int[cos[(c_.) + (d_.)*(x_)]^(m_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := Int[ExpandTrig[cos[c + d*x]^m*(a*cos[c + d*x] + b*sin[c + d*x])^n, x], x] /; FreeQ[{a, b, c, d}, x] && IntegerQ[m] && IGtQ[n, 0]
Int[sin[(c_.) + (d_.)*(x_)]^(m_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := a^n*b^n*Int[Sin[c + d*x]^m/(b*Cos[c + d*x] + a*Sin[c + d*x])^n, x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[a^2 + b^2, 0] && ILtQ[n, 0]
Int[cos[(c_.) + (d_.)*(x_)]^(m_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := a^n*b^n*Int[Cos[c + d*x]^m/(b*Cos[c + d*x] + a*Sin[c + d*x])^n, x] /; FreeQ[{a, b, c, d, m}, x] && EqQ[a^2 + b^2, 0] && ILtQ[n, 0]
Int[((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_)/sin[(c_.) + (d_.)*(x_)], x_Symbol] := a*((a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/(d*(n - 1))) + b*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1), x] + a^2*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2)/Sin[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_)/cos[(c_.) + (d_.)*(x_)], x_Symbol] := (-b)*((a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1)/(d*(n - 1))) + a*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1), x] + b^2*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2)/Cos[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[sin[(c_.) + (d_.)*(x_)]^(m_)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-(a^2 + b^2))*Int[Sin[c + d*x]^(m + 2)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2), x] + 2*b*Int[Sin[c + d*x]^(m + 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1), x] + a^2*Int[Sin[c + d*x]^m*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && GtQ[n, 1] && LtQ[m, -1]
Int[cos[(c_.) + (d_.)*(x_)]^(m_)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-(a^2 + b^2))*Int[Cos[c + d*x]^(m + 2)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2), x] + 2*a*Int[Cos[c + d*x]^(m + 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 1), x] + b^2*Int[Cos[c + d*x]^m*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && GtQ[n, 1] && LtQ[m, -1]
Int[sin[(c_.) + (d_.)*(x_)]/((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)]), x_Symbol] := b*(x/(a^2 + b^2)) - (a/(a^2 + b^2))*Int[(b*Cos[c + d*x] - a*Sin[c + d*x])/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[cos[(c_.) + (d_.)*(x_)]/((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)]), x_Symbol] := a*(x/(a^2 + b^2)) + (b/(a^2 + b^2))*Int[(b*Cos[c + d*x] - a*Sin[c + d*x])/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[sin[(c_.) + (d_.)*(x_)]^(m_)/((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)]), x_Symbol] := (-a)*(Sin[c + d*x]^(m - 1)/(d*(a^2 + b^2)*(m - 1))) + (b/(a^2 + b^2))*Int[Sin[c + d*x]^(m - 1), x] + (a^2/(a^2 + b^2))*Int[Sin[c + d*x]^(m - 2)/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && GtQ[m, 1]
Int[cos[(c_.) + (d_.)*(x_)]^(m_)/((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)]), x_Symbol] := b*(Cos[c + d*x]^(m - 1)/(d*(a^2 + b^2)*(m - 1))) + (a/(a^2 + b^2))*Int[Cos[c + d*x]^(m - 1), x] + (b^2/(a^2 + b^2))*Int[Cos[c + d*x]^(m - 2)/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && GtQ[m, 1]
Int[1/(sin[(c_.) + (d_.)*(x_)]*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[Cot[c + d*x], x] - (1/a)*Int[(b*Cos[c + d*x] - a*Sin[c + d*x])/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[1/(cos[(c_.) + (d_.)*(x_)]*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/b)*Int[Tan[c + d*x], x] + (1/b)*Int[(b*Cos[c + d*x] - a*Sin[c + d*x])/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[sin[(c_.) + (d_.)*(x_)]^(m_)/((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)]), x_Symbol] := Sin[c + d*x]^(m + 1)/(a*d*(m + 1)) - (b/a^2)*Int[Sin[c + d*x]^(m + 1), x] + ((a^2 + b^2)/a^2)*Int[Sin[c + d*x]^(m + 2)/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[m, -1]
Int[cos[(c_.) + (d_.)*(x_)]^(m_)/((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)]), x_Symbol] := -(Cos[c + d*x]^(m + 1)/(b*d*(m + 1))) - (a/b^2)*Int[Cos[c + d*x]^(m + 1), x] + ((a^2 + b^2)/b^2)*Int[Cos[c + d*x]^(m + 2)/(a*Cos[c + d*x] + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[m, -1]
Int[((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_)/sin[(c_.) + (d_.)*(x_)], x_Symbol] := -((a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1)/(a*d*(n + 1))) - (b/a^2)*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1), x] + (1/a^2)*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 2)/Sin[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_)/cos[(c_.) + (d_.)*(x_)], x_Symbol] := (a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1)/(b*d*(n + 1)) - (a/b^2)*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1), x] + (1/b^2)*Int[(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 2)/Cos[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[sin[(c_.) + (d_.)*(x_)]^(m_)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := ((a^2 + b^2)/a^2)*Int[Sin[c + d*x]^(m + 2)*(a*Cos[c + d*x] + b*Sin[c + d*x])^n, x] - 2*(b/a^2)*Int[Sin[c + d*x]^(m + 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1), x] + (1/a^2)*Int[Sin[c + d*x]^m*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1] && LtQ[m, -1]
Int[cos[(c_.) + (d_.)*(x_)]^(m_)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := ((a^2 + b^2)/b^2)*Int[Cos[c + d*x]^(m + 2)*(a*Cos[c + d*x] + b*Sin[c + d*x])^n, x] - 2*(a/b^2)*Int[Cos[c + d*x]^(m + 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 1), x] + (1/b^2)*Int[Cos[c + d*x]^m*(a*Cos[c + d*x] + b*Sin[c + d*x])^(n + 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1] && LtQ[m, -1]
Int[cos[(c_.) + (d_.)*(x_)]^(m_.)*sin[(c_.) + (d_.)*(x_)]^(n_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(p_.), x_Symbol] := Int[ExpandTrig[cos[c + d*x]^m*sin[c + d*x]^n*(a*cos[c + d*x] + b*sin[c + d*x])^p, x], x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p, 0]
Int[cos[(c_.) + (d_.)*(x_)]^(m_.)*sin[(c_.) + (d_.)*(x_)]^(n_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := a^p*b^p*Int[(Cos[c + d*x]^m*Sin[c + d*x]^n)/(b*Cos[c + d*x] + a*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[a^2 + b^2, 0] && ILtQ[p, 0]
Int[cos[(c_.) + (d_.)*(x_)]^(m_.)*(sin[(c_.) + (d_.)*(x_)]^(n_.)/((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (b/(a^2 + b^2))*Int[Cos[c + d*x]^m*Sin[c + d*x]^(n - 1), x] + (a/(a^2 + b^2))*Int[Cos[c + d*x]^(m - 1)*Sin[c + d*x]^n, x] - a*(b/(a^2 + b^2))*Int[Cos[c + d*x]^(m - 1)*(Sin[c + d*x]^(n - 1)/(a*Cos[c + d*x] + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && IGtQ[m, 0] && IGtQ[n, 0]
Int[cos[(c_.) + (d_.)*(x_)]^(m_.)*(sin[(c_.) + (d_.)*(x_)]^(n_.)/((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])), x_Symbol] := Int[ExpandTrig[cos[c + d*x]^m*(sin[c + d*x]^n/(a*cos[c + d*x] + b*sin[c + d*x])), x], x] /; FreeQ[{a, b, c, d, m, n}, x] && IntegersQ[m, n]
Int[cos[(c_.) + (d_.)*(x_)]^(m_.)*sin[(c_.) + (d_.)*(x_)]^(n_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (b/(a^2 + b^2))*Int[Cos[c + d*x]^m*Sin[c + d*x]^(n - 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^(p + 1), x] + (a/(a^2 + b^2))*Int[Cos[c + d*x]^(m - 1)*Sin[c + d*x]^n*(a*Cos[c + d*x] + b*Sin[c + d*x])^(p + 1), x] - a*(b/(a^2 + b^2))*Int[Cos[c + d*x]^(m - 1)*Sin[c + d*x]^(n - 1)*(a*Cos[c + d*x] + b*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && IGtQ[m, 0] && IGtQ[n, 0] && ILtQ[p, 0]

(* ::Subsection::Closed:: *)
(* 4.1.6 (a+b cos+c sin)^n *)
Int[Sqrt[(a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]], x_Symbol] := -2*((c*Cos[d + e*x] - b*Sin[d + e*x])/(e*Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]])) /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0]
Int[((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_), x_Symbol] := (-(c*Cos[d + e*x] - b*Sin[d + e*x]))*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)/(e*n)) + a*((2*n - 1)/n)*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0] && GtQ[n, 0]
Int[1/((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := -((c - a*Sin[d + e*x])/(c*e*(c*Cos[d + e*x] - b*Sin[d + e*x]))) /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0]
Int[1/Sqrt[(a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]], x_Symbol] := Int[1/Sqrt[a + Sqrt[b^2 + c^2]*Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0]
Int[((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_), x_Symbol] := (c*Cos[d + e*x] - b*Sin[d + e*x])*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^n/(a*e*(2*n + 1))) + ((n + 1)/(a*(2*n + 1)))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0] && LtQ[n, -1]
Int[Sqrt[(a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]], x_Symbol] := (b/(c*e))*Subst[Int[Sqrt[a + x]/x, x], x, b*Cos[d + e*x] + c*Sin[d + e*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[b^2 + c^2, 0]
Int[Sqrt[(a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]], x_Symbol] := Int[Sqrt[a + Sqrt[b^2 + c^2]*Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 + c^2, 0] && GtQ[a + Sqrt[b^2 + c^2], 0]
Int[Sqrt[(a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]], x_Symbol] := (Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/Sqrt[(a + b*Cos[d + e*x] + c*Sin[d + e*x])/(a + Sqrt[b^2 + c^2])])*Int[Sqrt[a/(a + Sqrt[b^2 + c^2]) + (Sqrt[b^2 + c^2]/(a + Sqrt[b^2 + c^2]))*Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[b^2 + c^2, 0] &&  !GtQ[a + Sqrt[b^2 + c^2], 0]
Int[((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_), x_Symbol] := (-(c*Cos[d + e*x] - b*Sin[d + e*x]))*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)/(e*n)) + (1/n)*Int[Simp[n*a^2 + (n - 1)*(b^2 + c^2) + a*b*(2*n - 1)*Cos[d + e*x] + a*c*(2*n - 1)*Sin[d + e*x], x]*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && GtQ[n, 1]
Int[1/((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := Module[{f = FreeFactors[Cot[(d + e*x)/2], x]}, (-(f/e))*Subst[Int[1/(a + c*f*x), x], x, Cot[(d + e*x)/2]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a + b, 0]
Int[1/((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := Module[{f = FreeFactors[Tan[(d + e*x)/2 + Pi/4], x]}, (f/e)*Subst[Int[1/(a + b*f*x), x], x, Tan[(d + e*x)/2 + Pi/4]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a + c, 0]
Int[1/((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := Module[{f = FreeFactors[Cot[(d + e*x)/2 + Pi/4], x]}, (-(f/e))*Subst[Int[1/(a + b*f*x), x], x, Cot[(d + e*x)/2 + Pi/4]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a - c, 0] && NeQ[a - b, 0]
Int[1/((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := Module[{f = FreeFactors[Tan[(d + e*x)/2], x]}, 2*(f/e)*Subst[Int[1/(a + b + 2*c*f*x + (a - b)*f^2*x^2), x], x, Tan[(d + e*x)/2]/f]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0]
Int[1/Sqrt[(a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]], x_Symbol] := (b/(c*e))*Subst[Int[1/(x*Sqrt[a + x]), x], x, b*Cos[d + e*x] + c*Sin[d + e*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[b^2 + c^2, 0]
Int[1/Sqrt[(a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]], x_Symbol] := Int[1/Sqrt[a + Sqrt[b^2 + c^2]*Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 + c^2, 0] && GtQ[a + Sqrt[b^2 + c^2], 0]
Int[1/Sqrt[(a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]], x_Symbol] := (Sqrt[(a + b*Cos[d + e*x] + c*Sin[d + e*x])/(a + Sqrt[b^2 + c^2])]/Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]])*Int[1/Sqrt[a/(a + Sqrt[b^2 + c^2]) + (Sqrt[b^2 + c^2]/(a + Sqrt[b^2 + c^2]))*Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[b^2 + c^2, 0] &&  !GtQ[a + Sqrt[b^2 + c^2], 0]
Int[1/((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(3/2), x_Symbol] := 2*((c*Cos[d + e*x] - b*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]])) + (1/(a^2 - b^2 - c^2))*Int[Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0]
Int[((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_), x_Symbol] := ((-c)*Cos[d + e*x] + b*Sin[d + e*x])*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/(e*(n + 1)*(a^2 - b^2 - c^2))) + (1/((n + 1)*(a^2 - b^2 - c^2)))*Int[(a*(n + 1) - b*(n + 2)*Cos[d + e*x] - c*(n + 2)*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && LtQ[n, -1] && NeQ[n, -3/2]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)] + (C_.)*sin[(d_.) + (e_.)*(x_)])/((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := (2*a*A - b*B - c*C)*(x/(2*a^2)) - (b*B + c*C)*((b*Cos[d + e*x] - c*Sin[d + e*x])/(2*a*b*c*e)) + (a^2*(b*B - c*C) - 2*a*A*b^2 + b^2*(b*B + c*C))*(Log[RemoveContent[a + b*Cos[d + e*x] + c*Sin[d + e*x], x]]/(2*a^2*b*c*e)) /; FreeQ[{a, b, c, d, e, A, B, C}, x] && EqQ[b^2 + c^2, 0]
Int[((A_.) + (C_.)*sin[(d_.) + (e_.)*(x_)])/((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := (2*a*A - c*C)*(x/(2*a^2)) - C*(Cos[d + e*x]/(2*a*e)) + c*C*(Sin[d + e*x]/(2*a*b*e)) + ((-a^2)*C + 2*a*c*A + b^2*C)*(Log[RemoveContent[a + b*Cos[d + e*x] + c*Sin[d + e*x], x]]/(2*a^2*b*e)) /; FreeQ[{a, b, c, d, e, A, C}, x] && EqQ[b^2 + c^2, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)])/((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := (2*a*A - b*B)*(x/(2*a^2)) - b*B*(Cos[d + e*x]/(2*a*c*e)) + B*(Sin[d + e*x]/(2*a*e)) + (a^2*B - 2*a*b*A + b^2*B)*(Log[RemoveContent[a + b*Cos[d + e*x] + c*Sin[d + e*x], x]]/(2*a^2*c*e)) /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 + c^2, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)] + (C_.)*sin[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := (b*B + c*C)*(x/(b^2 + c^2)) + (c*B - b*C)*(Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2))) /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[b^2 + c^2, 0] && EqQ[A*(b^2 + c^2) - a*(b*B + c*C), 0]
Int[((A_.) + (C_.)*sin[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := c*C*(x/(b^2 + c^2)) - b*C*(Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2))) /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[b^2 + c^2, 0] && EqQ[A*(b^2 + c^2) - a*c*C, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := b*B*(x/(b^2 + c^2)) + c*B*(Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2))) /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 + c^2, 0] && EqQ[A*(b^2 + c^2) - a*b*B, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)] + (C_.)*sin[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := (b*B + c*C)*(x/(b^2 + c^2)) + (c*B - b*C)*(Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2))) + ((A*(b^2 + c^2) - a*(b*B + c*C))/(b^2 + c^2))*Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[b^2 + c^2, 0] && NeQ[A*(b^2 + c^2) - a*(b*B + c*C), 0]
Int[((A_.) + (C_.)*sin[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := c*C*((d + e*x)/(e*(b^2 + c^2))) - b*C*(Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2))) + ((A*(b^2 + c^2) - a*c*C)/(b^2 + c^2))*Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[b^2 + c^2, 0] && NeQ[A*(b^2 + c^2) - a*c*C, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]), x_Symbol] := b*B*((d + e*x)/(e*(b^2 + c^2))) + c*B*(Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2))) + ((A*(b^2 + c^2) - a*b*B)/(b^2 + c^2))*Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 + c^2, 0] && NeQ[A*(b^2 + c^2) - a*b*B, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)] + (C_.)*sin[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := (B*c - b*C - a*C*Cos[d + e*x] + a*B*Sin[d + e*x])*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^n/(a*e*(n + 1))) /; FreeQ[{a, b, c, d, e, A, B, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && EqQ[(b*B + c*C)*n + a*A*(n + 1), 0]
Int[((A_.) + (C_.)*sin[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := (-(b*C + a*C*Cos[d + e*x]))*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^n/(a*e*(n + 1))) /; FreeQ[{a, b, c, d, e, A, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && EqQ[c*C*n + a*A*(n + 1), 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := (B*c + a*B*Sin[d + e*x])*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^n/(a*e*(n + 1))) /; FreeQ[{a, b, c, d, e, A, B, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && EqQ[b*B*n + a*A*(n + 1), 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)] + (C_.)*sin[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := (B*c - b*C - a*C*Cos[d + e*x] + a*B*Sin[d + e*x])*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^n/(a*e*(n + 1))) + (((b*B + c*C)*n + a*A*(n + 1))/(a*(n + 1)))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e, A, B, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && NeQ[(b*B + c*C)*n + a*A*(n + 1), 0]
Int[((A_.) + (C_.)*sin[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := (-(b*C + a*C*Cos[d + e*x]))*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^n/(a*e*(n + 1))) + ((c*C*n + a*A*(n + 1))/(a*(n + 1)))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e, A, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && NeQ[c*C*n + a*A*(n + 1), 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := (B*c + a*B*Sin[d + e*x])*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^n/(a*e*(n + 1))) + ((b*B*n + a*A*(n + 1))/(a*(n + 1)))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e, A, B, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && NeQ[b*B*n + a*A*(n + 1), 0]
Int[((B_.)*cos[(d_.) + (e_.)*(x_)] + (C_.)*sin[(d_.) + (e_.)*(x_)])*((b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := (c*B - b*C)*((b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/(e*(n + 1)*(b^2 + c^2))) /; FreeQ[{b, c, d, e, B, C}, x] && NeQ[n, -1] && NeQ[b^2 + c^2, 0] && EqQ[b*B + c*C, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)] + (C_.)*sin[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := (B*c - b*C - a*C*Cos[d + e*x] + a*B*Sin[d + e*x])*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^n/(a*e*(n + 1))) + (1/(a*(n + 1)))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)*Simp[a*(b*B + c*C)*n + a^2*A*(n + 1) + (n*(a^2*B - B*c^2 + b*c*C) + a*b*A*(n + 1))*Cos[d + e*x] + (n*(b*B*c + a^2*C - b^2*C) + a*c*A*(n + 1))*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && GtQ[n, 0] && NeQ[a^2 - b^2 - c^2, 0]
Int[((A_.) + (C_.)*sin[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := (-(b*C + a*C*Cos[d + e*x]))*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^n/(a*e*(n + 1))) + (1/(a*(n + 1)))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)*Simp[a*c*C*n + a^2*A*(n + 1) + (c*b*C*n + a*b*A*(n + 1))*Cos[d + e*x] + (a^2*C*n - b^2*C*n + a*c*A*(n + 1))*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, C}, x] && GtQ[n, 0] && NeQ[a^2 - b^2 - c^2, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := (B*c + a*B*Sin[d + e*x])*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^n/(a*e*(n + 1))) + (1/(a*(n + 1)))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)*Simp[a*b*B*n + a^2*A*(n + 1) + (a^2*B*n - c^2*B*n + a*b*A*(n + 1))*Cos[d + e*x] + (b*c*B*n + a*c*A*(n + 1))*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && GtQ[n, 0] && NeQ[a^2 - b^2 - c^2, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)] + (C_.)*sin[(d_.) + (e_.)*(x_)])/Sqrt[(a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]], x_Symbol] := (B/b)*Int[Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]], x] + ((A*b - a*B)/b)*Int[1/Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]], x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && EqQ[B*c - b*C, 0] && NeQ[A*b - a*B, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)] + (C_.)*sin[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^2, x_Symbol] := (c*B - b*C - (a*C - c*A)*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && EqQ[a*A - b*B - c*C, 0]
Int[((A_.) + (C_.)*sin[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^2, x_Symbol] := -((b*C + (a*C - c*A)*Cos[d + e*x] + b*A*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x]))) /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && EqQ[a*A - c*C, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^2, x_Symbol] := (c*B + c*A*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[a^2 - b^2 - c^2, 0] && EqQ[a*A - b*B, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)] + (C_.)*sin[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^2, x_Symbol] := (c*B - b*C - (a*C - c*A)*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) + ((a*A - b*B - c*C)/(a^2 - b^2 - c^2))*Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[a*A - b*B - c*C, 0]
Int[((A_.) + (C_.)*sin[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^2, x_Symbol] := -((b*C + (a*C - c*A)*Cos[d + e*x] + b*A*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x]))) + ((a*A - c*C)/(a^2 - b^2 - c^2))*Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[a*A - c*C, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^2, x_Symbol] := (c*B + c*A*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) + ((a*A - b*B)/(a^2 - b^2 - c^2))*Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[a*A - b*B, 0]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)] + (C_.)*sin[(d_.) + (e_.)*(x_)])*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_), x_Symbol] := (-(c*B - b*C - (a*C - c*A)*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x]))*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/(e*(n + 1)*(a^2 - b^2 - c^2))) + (1/((n + 1)*(a^2 - b^2 - c^2)))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)*Simp[(n + 1)*(a*A - b*B - c*C) + (n + 2)*(a*B - b*A)*Cos[d + e*x] + (n + 2)*(a*C - c*A)*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && LtQ[n, -1] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[n, -2]
Int[((A_.) + (C_.)*sin[(d_.) + (e_.)*(x_)])*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_), x_Symbol] := (b*C + (a*C - c*A)*Cos[d + e*x] + b*A*Sin[d + e*x])*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/(e*(n + 1)*(a^2 - b^2 - c^2))) + (1/((n + 1)*(a^2 - b^2 - c^2)))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)*Simp[(n + 1)*(a*A - c*C) - (n + 2)*b*A*Cos[d + e*x] + (n + 2)*(a*C - c*A)*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, C}, x] && LtQ[n, -1] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[n, -2]
Int[((A_.) + (B_.)*cos[(d_.) + (e_.)*(x_)])*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)])^(n_), x_Symbol] := (-(c*B + c*A*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x]))*((a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/(e*(n + 1)*(a^2 - b^2 - c^2))) + (1/((n + 1)*(a^2 - b^2 - c^2)))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)*Simp[(n + 1)*(a*A - b*B) + (n + 2)*(a*B - b*A)*Cos[d + e*x] - (n + 2)*c*A*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && LtQ[n, -1] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[n, -2]
Int[1/((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)] + (c_.)*tan[(d_.) + (e_.)*(x_)]), x_Symbol] := Int[Cos[d + e*x]/(b + a*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e}, x]
Int[1/((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)] + (c_.)*cot[(d_.) + (e_.)*(x_)]), x_Symbol] := Int[Sin[d + e*x]/(b + a*Sin[d + e*x] + c*Cos[d + e*x]), x] /; FreeQ[{a, b, c, d, e}, x]
Int[cos[(d_.) + (e_.)*(x_)]^(n_.)*((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)] + (c_.)*tan[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := Int[(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[n]
Int[sin[(d_.) + (e_.)*(x_)]^(n_.)*((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)] + (c_.)*cot[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := Int[(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[n]
Int[cos[(d_.) + (e_.)*(x_)]^(n_)*((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)] + (c_.)*tan[(d_.) + (e_.)*(x_)])^(n_), x_Symbol] := Cos[d + e*x]^n*((a + b*Sec[d + e*x] + c*Tan[d + e*x])^n/(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n)*Int[(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] &&  !IntegerQ[n]
Int[sin[(d_.) + (e_.)*(x_)]^(n_)*((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)] + (c_.)*cot[(d_.) + (e_.)*(x_)])^(n_), x_Symbol] := Sin[d + e*x]^n*((a + b*Csc[d + e*x] + c*Cot[d + e*x])^n/(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n)*Int[(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] &&  !IntegerQ[n]
Int[sec[(d_.) + (e_.)*(x_)]^(n_.)*((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)] + (c_.)*tan[(d_.) + (e_.)*(x_)])^(m_), x_Symbol] := Int[1/(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] && IntegerQ[n]
Int[csc[(d_.) + (e_.)*(x_)]^(n_.)*((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)] + (c_.)*cot[(d_.) + (e_.)*(x_)])^(m_), x_Symbol] := Int[1/(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] && IntegerQ[n]
Int[sec[(d_.) + (e_.)*(x_)]^(n_.)*((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)] + (c_.)*tan[(d_.) + (e_.)*(x_)])^(m_), x_Symbol] := Sec[d + e*x]^n*((b + a*Cos[d + e*x] + c*Sin[d + e*x])^n/(a + b*Sec[d + e*x] + c*Tan[d + e*x])^n)*Int[1/(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] &&  !IntegerQ[n]
Int[csc[(d_.) + (e_.)*(x_)]^(n_.)*((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)] + (c_.)*cot[(d_.) + (e_.)*(x_)])^(m_), x_Symbol] := Csc[d + e*x]^n*((b + a*Sin[d + e*x] + c*Cos[d + e*x])^n/(a + b*Csc[d + e*x] + c*Cot[d + e*x])^n)*Int[1/(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] &&  !IntegerQ[n]

(* ::Subsection::Closed:: *)
(* 4.1.7 (d trig)^m (a+b (c sin)^n)^p *)
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (4*A*(2*a + b) + B*(4*a + 3*b))*(x/8) - (4*A*b + B*(4*a + 3*b))*Cos[e + f*x]*(Sin[e + f*x]/(8*f)) - b*B*Cos[e + f*x]*(Sin[e + f*x]^3/(4*f)) /; FreeQ[{a, b, e, f, A, B}, x]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-B)*Cos[e + f*x]*Sin[e + f*x]*((a + b*Sin[e + f*x]^2)^p/(2*f*(p + 1))) + (1/(2*(p + 1)))*Int[(a + b*Sin[e + f*x]^2)^(p - 1)*Simp[a*B + 2*a*A*(p + 1) + (2*A*b*(p + 1) + B*(b + 2*a*p + 2*b*p))*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B}, x] && GtQ[p, 0]
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]^2)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := B*(x/b) + ((A*b - a*B)/b)*Int[1/(a + b*Sin[e + f*x]^2), x] /; FreeQ[{a, b, e, f, A, B}, x]
Int[((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]^2)/Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2], x_Symbol] := (B/b)*Int[Sqrt[a + b*Sin[e + f*x]^2], x] + ((A*b - a*B)/b)*Int[1/Sqrt[a + b*Sin[e + f*x]^2], x] /; FreeQ[{a, b, e, f, A, B}, x]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(A*b - a*B))*Cos[e + f*x]*Sin[e + f*x]*((a + b*Sin[e + f*x]^2)^(p + 1)/(2*a*f*(a + b)*(p + 1))) - (1/(2*a*(a + b)*(p + 1)))*Int[(a + b*Sin[e + f*x]^2)^(p + 1)*Simp[a*B - A*(2*a*(p + 1) + b*(2*p + 3)) + 2*(A*b - a*B)*(p + 2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B}, x] && LtQ[p, -1] && NeQ[a + b, 0]
Int[((a_.) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_)*((A_.) + (B_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(a + b*Sin[e + f*x]^2)^p*((Sec[e + f*x]^2)^p/(f*(a + (a + b)*Tan[e + f*x]^2)^p))*Subst[Int[(a + (a + b)*ff^2*x^2)^p*((A + (A + B)*ff^2*x^2)/(1 + ff^2*x^2)^(p + 2)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, A, B}, x] &&  !IntegerQ[p]
Int[(u_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := a^p*Int[ActivateTrig[u*cos[e + f*x]^(2*p)], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a + b, 0] && IntegerQ[p]
Int[(u_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := Int[ActivateTrig[u*(a*cos[e + f*x]^2)^p], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a + b, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2], x_Symbol] := (Sqrt[a]/f)*EllipticE[e + f*x, -(b/a)] /; FreeQ[{a, b, e, f}, x] && GtQ[a, 0]
Int[Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2], x_Symbol] := (Sqrt[a + b*Sin[e + f*x]^2]/Sqrt[1 + b*(Sin[e + f*x]^2/a)])*Int[Sqrt[1 + (b*Sin[e + f*x]^2)/a], x] /; FreeQ[{a, b, e, f}, x] &&  !GtQ[a, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^2, x_Symbol] := (8*a^2 + 8*a*b + 3*b^2)*(x/8) - b*(8*a + 3*b)*Cos[e + f*x]*(Sin[e + f*x]/(8*f)) - b^2*Cos[e + f*x]*(Sin[e + f*x]^3/(4*f)) /; FreeQ[{a, b, e, f}, x]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := (-b)*Cos[e + f*x]*Sin[e + f*x]*((a + b*Sin[e + f*x]^2)^(p - 1)/(2*f*p)) + (1/(2*p))*Int[(a + b*Sin[e + f*x]^2)^(p - 2)*Simp[a*(b + 2*a*p) + b*(2*a + b)*(2*p - 1)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a + b, 0] && GtQ[p, 1]
Int[1/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[1/(a + (a + b)*ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x]
Int[1/Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2], x_Symbol] := (1/(Sqrt[a]*f))*EllipticF[e + f*x, -(b/a)] /; FreeQ[{a, b, e, f}, x] && GtQ[a, 0]
Int[1/Sqrt[(a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2], x_Symbol] := (Sqrt[1 + b*(Sin[e + f*x]^2/a)]/Sqrt[a + b*Sin[e + f*x]^2])*Int[1/Sqrt[1 + (b*Sin[e + f*x]^2)/a], x] /; FreeQ[{a, b, e, f}, x] &&  !GtQ[a, 0]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := (-b)*Cos[e + f*x]*Sin[e + f*x]*((a + b*Sin[e + f*x]^2)^(p + 1)/(2*a*f*(p + 1)*(a + b))) + (1/(2*a*(p + 1)*(a + b)))*Int[(a + b*Sin[e + f*x]^2)^(p + 1)*Simp[2*a*(p + 1) + b*(2*p + 3) - 2*b*(p + 2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a + b, 0] && LtQ[p, -1]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*(Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x]))*Subst[Int[(a + b*ff^2*x^2)^p/Sqrt[1 - ff^2*x^2], x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] &&  !IntegerQ[p]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, (-(ff/f))*Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b - b*ff^2*x^2)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[sin[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff^(m + 1)/f)*Subst[Int[x^m*((a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^(m/2 + p + 1)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[sin[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff^(m + 1)*(Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x]))*Subst[Int[x^m*((a + b*ff^2*x^2)^p/Sqrt[1 - ff^2*x^2]), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] &&  !IntegerQ[p]
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, (-ff)*d^(2*IntPart[(m - 1)/2] + 1)*((d*Sin[e + f*x])^(2*FracPart[(m - 1)/2])/(f*(Sin[e + f*x]^2)^FracPart[(m - 1)/2]))*Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b - b*ff^2*x^2)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] &&  !IntegerQ[m]
Int[cos[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (ff/f)*Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[cos[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^(m/2 + p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[cos[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*(Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x]))*Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] &&  !IntegerQ[p]
Int[((d_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*d^(2*IntPart[(m - 1)/2] + 1)*((d*Cos[e + f*x])^(2*FracPart[(m - 1)/2])/(f*(Cos[e + f*x]^2)^FracPart[(m - 1)/2]))*Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] &&  !IntegerQ[m]
Int[tan[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x]^2, x]}, (ff^((m + 1)/2)/(2*f))*Subst[Int[x^((m - 1)/2)*((a + b*ff*x)^p/(1 - ff*x)^((m + 1)/2)), x], x, Sin[e + f*x]^2/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(d*ff*x)^m*((a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^(p + 1)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[p]
Int[tan[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff^(m + 1)*(Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x]))*Subst[Int[x^m*((a + b*ff^2*x^2)^p/(1 - ff^2*x^2)^((m + 1)/2)), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] &&  !IntegerQ[p]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*(d*Tan[e + f*x])^(m + 1)*((Cos[e + f*x]^2)^((m + 1)/2)/(d*f*Sin[e + f*x]^(m + 1)))*Subst[Int[(ff*x)^m*((a + b*ff^2*x^2)^p/(1 - ff^2*x^2)^((m + 1)/2)), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] &&  !IntegerQ[m]
Int[cos[(e_.) + (f_.)*(x_)]^(m_.)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (ff/f)*Subst[Int[(d*ff*x)^n*(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, n, p}, x] && IntegerQ[(m - 1)/2]
Int[((c_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*sin[(e_.) + (f_.)*(x_)]^(n_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, (-(ff/f))*Subst[Int[(c*ff*x)^m*(1 - ff^2*x^2)^((n - 1)/2)*(a + b - b*ff^2*x^2)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, m, p}, x] && IntegerQ[(n - 1)/2]
Int[cos[(e_.) + (f_.)*(x_)]^(m_)*sin[(e_.) + (f_.)*(x_)]^(n_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff^(n + 1)/f)*Subst[Int[x^n*((a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^((m + n)/2 + p + 1)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[(e_.) + (f_.)*(x_)]^(m_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*(Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x]))*Subst[Int[(d*ff*x)^n*(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, n, p}, x] && IntegerQ[m/2]
Int[((c_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*c^(2*IntPart[(m - 1)/2] + 1)*((c*Cos[e + f*x])^(2*FracPart[(m - 1)/2])/(f*(Cos[e + f*x]^2)^FracPart[(m - 1)/2]))*Subst[Int[(d*ff*x)^n*(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[m]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := (-Cot[e + f*x])*((b*Sin[e + f*x]^2)^p/(2*f*p)) + b*((2*p - 1)/(2*p))*Int[(b*Sin[e + f*x]^2)^(p - 1), x] /; FreeQ[{b, e, f}, x] &&  !IntegerQ[p] && GtQ[p, 1]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := Cot[e + f*x]*((b*Sin[e + f*x]^2)^(p + 1)/(b*f*(2*p + 1))) + 2*((p + 1)/(b*(2*p + 1)))*Int[(b*Sin[e + f*x]^2)^(p + 1), x] /; FreeQ[{b, e, f}, x] &&  !IntegerQ[p] && LtQ[p, -1]
Int[tan[(e_.) + (f_.)*(x_)]^(m_.)*((b_.)*sin[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x]^2, x]}, (ff^((m + 1)/2)/(2*f))*Subst[Int[x^((m - 1)/2)*((b*ff^(n/2)*x^(n/2))^p/(1 - ff*x)^((m + 1)/2)), x], x, Sin[e + f*x]^2/ff]] /; FreeQ[{b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2]
Int[tan[(e_.) + (f_.)*(x_)]^(m_.)*((b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (ff^(m + 1)/f)*Subst[Int[x^m*((b*(c*ff*x)^n)^p/(1 - ff^2*x^2)^((m + 1)/2)), x], x, Sin[e + f*x]/ff]] /; FreeQ[{b, c, e, f, n, p}, x] && ILtQ[(m - 1)/2, 0]
Int[(u_.)*((b_.)*sin[(e_.) + (f_.)*(x_)]^(n_))^(p_), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (b*ff^n)^IntPart[p]*((b*Sin[e + f*x]^n)^FracPart[p]/(Sin[e + f*x]/ff)^(n*FracPart[p]))*Int[ActivateTrig[u]*(Sin[e + f*x]/ff)^(n*p), x]] /; FreeQ[{b, e, f, n, p}, x] &&  !IntegerQ[p] && IntegerQ[n] && (EqQ[u, 1] || MatchQ[u, ((d_.)*(trig_)[e + f*x])^(m_.) /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[(u_.)*((b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := b^IntPart[p]*((b*(c*Sin[e + f*x])^n)^FracPart[p]/(c*Sin[e + f*x])^(n*FracPart[p]))*Int[ActivateTrig[u]*(c*Sin[e + f*x])^(n*p), x] /; FreeQ[{b, c, e, f, n, p}, x] &&  !IntegerQ[p] &&  !IntegerQ[n] && (EqQ[u, 1] || MatchQ[u, ((d_.)*(trig_)[e + f*x])^(m_.) /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^4)^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^p/(1 + ff^2*x^2)^(2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[p]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^4)^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(a + b*Sin[e + f*x]^4)^p*((Sec[e + f*x]^2)^(2*p)/(f*(a + 2*a*Tan[e + f*x]^2 + (a + b)*Tan[e + f*x]^4)^p))*Subst[Int[(a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^p/(1 + ff^2*x^2)^(2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[p - 1/2]
Int[1/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^(n_)), x_Symbol] := Module[{k}, Dist[2/(a*n), Sum[Int[1/(1 - Sin[e + f*x]^2/((-1)^(4*(k/n))*Rt[-(a/b), n/2])), x], {k, 1, n/2}], x]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[n/2]
Int[((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^(n_))^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(b*ff^n*x^n + a*(1 + ff^2*x^2)^(n/2))^p/(1 + ff^2*x^2)^(n*(p/2) + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[n/2] && IGtQ[p, 0]
Int[((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := Int[ExpandTrig[(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, e, f, n}, x] && (IGtQ[p, 0] || (EqQ[p, -1] && IntegerQ[n]))
Int[((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := Unintegrable[(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, e, f, n, p}, x]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^4)^(p_.), x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, (-(ff/f))*Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b - 2*b*ff^2*x^2 + b*ff^4*x^4)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, (-(ff/f))*Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*(1 - ff^2*x^2)^(n/2))^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2]
Int[sin[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^4)^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff^(m + 1)/f)*Subst[Int[x^m*((a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^p/(1 + ff^2*x^2)^(m/2 + 2*p + 1)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[sin[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff^(m + 1)/f)*Subst[Int[x^m*((a*(1 + ff^2*x^2)^(n/2) + b*ff^n*x^n)^p/(1 + ff^2*x^2)^(m/2 + n*(p/2) + 1)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[n/2] && IntegerQ[p]
Int[sin[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^4)^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)*(a + b*Sin[e + f*x]^4)^p*((Sec[e + f*x]^2)^(2*p)/(f*Apart[a*(1 + Tan[e + f*x]^2)^2 + b*Tan[e + f*x]^4]^p))*Subst[Int[x^m*(ExpandToSum[a*(1 + ff^2*x^2)^2 + b*ff^4*x^4, x]^p/(1 + ff^2*x^2)^(m/2 + 2*p + 1)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && IntegerQ[p - 1/2]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := Int[ExpandTrig[sin[e + f*x]^m*(a + b*sin[e + f*x]^n)^p, x], x] /; FreeQ[{a, b, e, f}, x] && IntegersQ[m, p] && (EqQ[n, 4] || GtQ[p, 0] || (EqQ[p, -1] && IntegerQ[n]))
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Int[ExpandTrig[(d*sin[e + f*x])^m*(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Unintegrable[(d*Sin[e + f*x])^m*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[cos[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (ff/f)*Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*(c*ff*x)^n)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && IntegerQ[(m - 1)/2] && (EqQ[n, 4] || GtQ[m, 0] || IGtQ[p, 0] || IntegersQ[m, p])
Int[cos[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^4)^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^p/(1 + ff^2*x^2)^(m/2 + 2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[cos[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(b*ff^n*x^n + a*(1 + ff^2*x^2)^(n/2))^p/(1 + ff^2*x^2)^(m/2 + n*(p/2) + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[(e_.) + (f_.)*(x_)]^(m_)/((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^(n_)), x_Symbol] := Int[Expand[(1 - Sin[e + f*x]^2)^(m/2)/(a + b*Sin[e + f*x]^n), x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m/2, 0] && IntegerQ[(n - 1)/2]
Int[((d_.)*cos[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Int[ExpandTrig[(d*cos[e + f*x])^m*(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[((d_.)*cos[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Unintegrable[(d*Cos[e + f*x])^m*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[tan[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x]^2, x]}, (ff^((m + 1)/2)/(2*f))*Subst[Int[x^((m - 1)/2)*((a + b*ff^(n/2)*x^(n/2))^p/(1 - ff*x)^((m + 1)/2)), x], x, Sin[e + f*x]^2/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2]
Int[tan[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (ff^(m + 1)/f)*Subst[Int[x^m*((a + b*(c*ff*x)^n)^p/(1 - ff^2*x^2)^((m + 1)/2)), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && ILtQ[(m - 1)/2, 0]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^4)^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(d*ff*x)^m*(ExpandToSum[a*(1 + ff^2*x^2)^2 + b*ff^4*x^4, x]^p/(1 + ff^2*x^2)^(2*p + 1)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[p]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^4)^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(a + b*Sin[e + f*x]^4)^p*((Sec[e + f*x]^2)^(2*p)/(f*Apart[a*(1 + Tan[e + f*x]^2)^2 + b*Tan[e + f*x]^4]^p))*Subst[Int[(d*ff*x)^m*(ExpandToSum[a*(1 + ff^2*x^2)^2 + b*ff^4*x^4, x]^p/(1 + ff^2*x^2)^(2*p + 1)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[p - 1/2]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff^(m + 1)/f)*Subst[Int[(d*x)^m*((b*ff^n*x^n + a*(1 + ff^2*x^2)^(n/2))^p/(1 + ff^2*x^2)^(n*(p/2) + 1)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[n/2] && IGtQ[p, 0]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Int[ExpandTrig[(d*tan[e + f*x])^m*(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Unintegrable[(d*Tan[e + f*x])^m*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[((d_.)*cot[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := (d*Cot[e + f*x])^FracPart[m]*(Tan[e + f*x]/d)^FracPart[m]*Int[(a + b*(c*Sin[e + f*x])^n)^p/(Tan[e + f*x]/d)^m, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[m]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := (d*Sec[e + f*x])^FracPart[m]*(Cos[e + f*x]/d)^FracPart[m]*Int[(a + b*(c*Sin[e + f*x])^n)^p/(Cos[e + f*x]/d)^m, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[m]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*sin[(e_.) + (f_.)*(x_)]^(n_.))^(p_.), x_Symbol] := d^(n*p)*Int[(d*Csc[e + f*x])^(m - n*p)*(b + a*Csc[e + f*x]^n)^p, x] /; FreeQ[{a, b, d, e, f, m, n, p}, x] &&  !IntegerQ[m] && IntegersQ[n, p]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*((c_.)*sin[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := (d*Csc[e + f*x])^FracPart[m]*(Sin[e + f*x]/d)^FracPart[m]*Int[(a + b*(c*Sin[e + f*x])^n)^p/(Sin[e + f*x]/d)^m, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[m]

(* ::Subsection::Closed:: *)
(* 4.1.8 trig^m (a+b cos^p+c sin^q)^n *)
Int[sin[(d_.) + (e_.)*(x_)]^(m_)*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(p_) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(q_))^(n_), x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, (-(f/e))*Subst[Int[ExpandToSum[c + b*(1 + f^2*x^2)^(q/2 - p/2) + a*(1 + f^2*x^2)^(q/2), x]^n/(1 + f^2*x^2)^(m/2 + n*(q/2) + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && GtQ[p, 0] && LeQ[p, q]
Int[cos[(d_.) + (e_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(p_) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(q_))^(n_), x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, (f/e)*Subst[Int[ExpandToSum[c + b*(1 + f^2*x^2)^(q/2 - p/2) + a*(1 + f^2*x^2)^(q/2), x]^n/(1 + f^2*x^2)^(m/2 + n*(q/2) + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && GtQ[p, 0] && LeQ[p, q]
Int[sin[(d_.) + (e_.)*(x_)]^(m_)*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(p_) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(q_))^(n_), x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, (-(f/e))*Subst[Int[ExpandToSum[a*(1 + f^2*x^2)^(p/2) + b*f^p*x^p + c*(1 + f^2*x^2)^(p/2 - q/2), x]^n/(1 + f^2*x^2)^(m/2 + n*(p/2) + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && LtQ[0, q, p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(p_) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(q_))^(n_), x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, (f/e)*Subst[Int[ExpandToSum[a*(1 + f^2*x^2)^(p/2) + b*f^p*x^p + c*(1 + f^2*x^2)^(p/2 - q/2), x]^n/(1 + f^2*x^2)^(m/2 + n*(p/2) + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && LtQ[0, q, p]
Int[sin[(d_.) + (e_.)*(x_)]^(m_)*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(p_) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(q_))^(n_), x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, (-(f/e))*Subst[Int[ExpandToSum[c + b*(1 + f^2*x^2)^(q/2 - p/2) + a*(1 + f^2*x^2)^(q/2), x]^n/(1 + f^2*x^2)^(m/2 + n*(q/2) + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && GtQ[p, 0] && LeQ[p, q]
Int[cos[(d_.) + (e_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(p_) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(q_))^(n_), x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, (f/e)*Subst[Int[ExpandToSum[c + b*(1 + f^2*x^2)^(q/2 - p/2) + a*(1 + f^2*x^2)^(q/2), x]^n/(1 + f^2*x^2)^(m/2 + n*(q/2) + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && GtQ[p, 0] && LeQ[p, q]
Int[sin[(d_.) + (e_.)*(x_)]^(m_)*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(p_) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(q_))^(n_), x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, (-(f/e))*Subst[Int[ExpandToSum[a*(1 + f^2*x^2)^(p/2) + b*f^p*x^p + c*(1 + f^2*x^2)^(p/2 - q/2), x]^n/(1 + f^2*x^2)^(m/2 + n*(p/2) + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && LtQ[0, q, p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_)*((a_) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(p_) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(q_))^(n_), x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, (f/e)*Subst[Int[ExpandToSum[a*(1 + f^2*x^2)^(p/2) + b*f^p*x^p + c*(1 + f^2*x^2)^(p/2 - q/2), x]^n/(1 + f^2*x^2)^(m/2 + n*(p/2) + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[m/2] && IntegerQ[p/2] && IntegerQ[q/2] && IntegerQ[n] && LtQ[0, q, p]

(* ::Subsection::Closed:: *)
(* 4.1.9 trig^m (a+b sin^n+c sin^(2 n))^p *)
Int[((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Sin[d + e*x]^n + c*Sin[d + e*x]^(2*n))^p/(b + 2*c*Sin[d + e*x]^n)^(2*p))*Int[u*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Cos[d + e*x]^n + c*Cos[d + e*x]^(2*n))^p/(b + 2*c*Cos[d + e*x]^n)^(2*p))*Int[u*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[1/((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.)), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*(c/q)*Int[1/(b - q + 2*c*Sin[d + e*x]^n), x] - 2*(c/q)*Int[1/(b + q + 2*c*Sin[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[1/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.)), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*(c/q)*Int[1/(b - q + 2*c*Cos[d + e*x]^n), x] - 2*(c/q)*Int[1/(b + q + 2*c*Cos[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[sin[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := (1/(4^p*c^p))*Int[Sin[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := (1/(4^p*c^p))*Int[Cos[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[sin[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Sin[d + e*x]^n + c*Sin[d + e*x]^(2*n))^p/(b + 2*c*Sin[d + e*x]^n)^(2*p))*Int[Sin[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Cos[d + e*x]^n + c*Cos[d + e*x]^(2*n))^p/(b + 2*c*Cos[d + e*x]^n)^(2*p))*Int[Cos[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[sin[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_))^(p_), x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, (-(f/e))*Subst[Int[ExpandToSum[c + b*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^p/(1 + f^2*x^2)^(m/2 + n*p + 1), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_))^(p_), x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, (f/e)*Subst[Int[ExpandToSum[c + b*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^p/(1 + f^2*x^2)^(m/2 + n*p + 1), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[sin[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := Int[ExpandTrig[sin[d + e*x]^m*(a + b*sin[d + e*x]^n + c*sin[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[m, n, p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := Int[ExpandTrig[cos[d + e*x]^m*(a + b*cos[d + e*x]^n + c*cos[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[m, n, p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*((f_.)*sin[(d_.) + (e_.)*(x_)])^(n_.) + (c_.)*((f_.)*sin[(d_.) + (e_.)*(x_)])^(n2_.))^(p_.), x_Symbol] := Module[{g = FreeFactors[Sin[d + e*x], x]}, (g/e)*Subst[Int[(1 - g^2*x^2)^((m - 1)/2)*(a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^p, x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2]
Int[sin[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*((f_.)*cos[(d_.) + (e_.)*(x_)])^(n_.) + (c_.)*((f_.)*cos[(d_.) + (e_.)*(x_)])^(n2_.))^(p_.), x_Symbol] := Module[{g = FreeFactors[Cos[d + e*x], x]}, (-(g/e))*Subst[Int[(1 - g^2*x^2)^((m - 1)/2)*(a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^p, x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2]
Int[cos[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[Cos[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[sin[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[Sin[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Sin[d + e*x]^n + c*Sin[d + e*x]^(2*n))^p/(b + 2*c*Sin[d + e*x]^n)^(2*p))*Int[Cos[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[sin[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Cos[d + e*x]^n + c*Cos[d + e*x]^(2*n))^p/(b + 2*c*Cos[d + e*x]^n)^(2*p))*Int[Sin[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, (-(f^(m + 1)/e))*Subst[Int[x^m*(ExpandToSum[c + b*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^p/(1 + f^2*x^2)^(m/2 + n*p + 1)), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[sin[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, (f^(m + 1)/e)*Subst[Int[x^m*(ExpandToSum[c + b*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^p/(1 + f^2*x^2)^(m/2 + n*p + 1)), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Int[ExpandTrig[(1 - sin[d + e*x]^2)^(m/2)*(a + b*sin[d + e*x]^n + c*sin[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[sin[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Int[ExpandTrig[(1 - cos[d + e*x]^2)^(m/2)*(a + b*cos[d + e*x]^n + c*cos[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_) + (b_.)*((f_.)*sin[(d_.) + (e_.)*(x_)])^(n_) + (c_.)*((f_.)*sin[(d_.) + (e_.)*(x_)])^(n2_.))^(p_.), x_Symbol] := Module[{g = FreeFactors[Sin[d + e*x], x]}, (g^(m + 1)/e)*Subst[Int[x^m*((a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^p/(1 - g^2*x^2)^((m + 1)/2)), x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n}, x] && IntegerQ[(m - 1)/2] && IntegerQ[2*p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_) + (b_.)*((f_.)*cos[(d_.) + (e_.)*(x_)])^(n_) + (c_.)*((f_.)*cos[(d_.) + (e_.)*(x_)])^(n2_.))^(p_.), x_Symbol] := Module[{g = FreeFactors[Cos[d + e*x], x]}, (-(g^(m + 1)/e))*Subst[Int[x^m*((a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^p/(1 - g^2*x^2)^((m + 1)/2)), x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n}, x] && IntegerQ[(m - 1)/2] && IntegerQ[2*p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[Tan[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[Cot[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Sin[d + e*x]^n + c*Sin[d + e*x]^(2*n))^p/(b + 2*c*Sin[d + e*x]^n)^(2*p))*Int[Tan[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Cos[d + e*x]^n + c*Cos[d + e*x]^(2*n))^p/(b + 2*c*Cos[d + e*x]^n)^(2*p))*Int[Cot[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, (f^(m + 1)/e)*Subst[Int[x^m*(ExpandToSum[c*x^(2*n) + b*x^n*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^p/(1 + f^2*x^2)^(n*p + 1)), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, (-(f^(m + 1)/e))*Subst[Int[x^m*(ExpandToSum[c*x^(2*n) + b*x^n*(1 + x^2)^(n/2) + a*(1 + x^2)^n, x]^p/(1 + f^2*x^2)^(n*p + 1)), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2] && IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Int[ExpandTrig[sin[d + e*x]^m*((a + b*sin[d + e*x]^n + c*sin[d + e*x]^(2*n))^p/(1 - sin[d + e*x]^2)^(m/2)), x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Int[ExpandTrig[cos[d + e*x]^m*((a + b*cos[d + e*x]^n + c*cos[d + e*x]^(2*n))^p/(1 - cos[d + e*x]^2)^(m/2)), x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_) + (b_.)*((f_.)*sin[(d_.) + (e_.)*(x_)])^(n_) + (c_.)*((f_.)*sin[(d_.) + (e_.)*(x_)])^(n2_.))^(p_.), x_Symbol] := Module[{g = FreeFactors[Sin[d + e*x], x]}, (g^(m + 1)/e)*Subst[Int[(1 - g^2*x^2)^((m - 1)/2)*((a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^p/x^m), x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n}, x] && IntegerQ[(m - 1)/2] && IntegerQ[2*p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_) + (b_.)*((f_.)*cos[(d_.) + (e_.)*(x_)])^(n_) + (c_.)*((f_.)*cos[(d_.) + (e_.)*(x_)])^(n2_.))^(p_.), x_Symbol] := Module[{g = FreeFactors[Cos[d + e*x], x]}, (-(g^(m + 1)/e))*Subst[Int[(1 - g^2*x^2)^((m - 1)/2)*((a + b*(f*g*x)^n + c*(f*g*x)^(2*n))^p/x^m), x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, f, n}, x] && IntegerQ[(m - 1)/2] && IntegerQ[2*p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[Cot[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[Tan[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Sin[d + e*x]^n + c*Sin[d + e*x]^(2*n))^p/(b + 2*c*Sin[d + e*x]^n)^(2*p))*Int[Cot[d + e*x]^m*(b + 2*c*Sin[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Cos[d + e*x]^n + c*Cos[d + e*x]^(2*n))^p/(b + 2*c*Cos[d + e*x]^n)^(2*p))*Int[Tan[d + e*x]^m*(b + 2*c*Cos[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] &&  !IntegerQ[(m - 1)/2] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, (-(f^(m + 1)/e))*Subst[Int[x^m*(ExpandToSum[c + b*(1 + f^2*x^2)^(n/2) + a*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)^(n*p + 1)), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[n2, 2*n] && IntegerQ[n/2] && IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, (f^(m + 1)/e)*Subst[Int[x^m*(ExpandToSum[c + b*(1 + f^2*x^2)^(n/2) + a*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)^(n*p + 1)), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[n2, 2*n] && IntegerQ[n/2] && IntegerQ[p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sin[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Int[ExpandTrig[(1 - sin[d + e*x]^2)^(m/2)*((a + b*sin[d + e*x]^n + c*sin[d + e*x]^(2*n))^p/sin[d + e*x]^m), x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cos[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Int[ExpandTrig[(1 - cos[d + e*x]^2)^(m/2)*((a + b*cos[d + e*x]^n + c*cos[d + e*x]^(2*n))^p/cos[d + e*x]^m), x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && NeQ[b^2 - 4*a*c, 0] && IntegersQ[n, p]
Int[((A_) + (B_.)*sin[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*sin[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := (1/(4^n*c^n))*Int[(A + B*Sin[d + e*x])*(b + 2*c*Sin[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[((A_) + (B_.)*cos[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*cos[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := (1/(4^n*c^n))*Int[(A + B*Cos[d + e*x])*(b + 2*c*Cos[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[((A_) + (B_.)*sin[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*sin[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := ((a + b*Sin[d + e*x] + c*Sin[d + e*x]^2)^n/(b + 2*c*Sin[d + e*x])^(2*n))*Int[(A + B*Sin[d + e*x])*(b + 2*c*Sin[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[n]
Int[((A_) + (B_.)*cos[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*cos[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := ((a + b*Cos[d + e*x] + c*Cos[d + e*x]^2)^n/(b + 2*c*Cos[d + e*x])^(2*n))*Int[(A + B*Cos[d + e*x])*(b + 2*c*Cos[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[n]
Int[((A_) + (B_.)*sin[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/(b + q + 2*c*Sin[d + e*x]), x] + (B - (b*B - 2*A*c)/q)*Int[1/(b - q + 2*c*Sin[d + e*x]), x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[((A_) + (B_.)*cos[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*cos[(d_.) + (e_.)*(x_)]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/(b + q + 2*c*Cos[d + e*x]), x] + (B - (b*B - 2*A*c)/q)*Int[1/(b - q + 2*c*Cos[d + e*x]), x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[((A_) + (B_.)*sin[(d_.) + (e_.)*(x_)])*((a_.) + (b_.)*sin[(d_.) + (e_.)*(x_)] + (c_.)*sin[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := Int[ExpandTrig[(A + B*sin[d + e*x])*(a + b*sin[d + e*x] + c*sin[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[((A_) + (B_.)*cos[(d_.) + (e_.)*(x_)])*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)] + (c_.)*cos[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := Int[ExpandTrig[(A + B*cos[d + e*x])*(a + b*cos[d + e*x] + c*cos[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]

(* ::Subsection::Closed:: *)
(* 4.2.10 (c+d x)^m (a+b tan)^n *)
Int[((c_.) + (d_.)*(x_))^(m_.)*tan[(e_.) + (k_.)*Pi + (f_.)*(Complex[0, fz_])*(x_)], x_Symbol] := (-I)*((c + d*x)^(m + 1)/(d*(m + 1))) + 2*I*Int[((c + d*x)^m*(E^(2*((-I)*e + f*fz*x))/(1 + E^(2*((-I)*e + f*fz*x))/E^(2*I*k*Pi))))/E^(2*I*k*Pi), x] /; FreeQ[{c, d, e, f, fz}, x] && IntegerQ[4*k] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*tan[(e_.) + (k_.)*Pi + (f_.)*(x_)], x_Symbol] := I*((c + d*x)^(m + 1)/(d*(m + 1))) - 2*I*Int[(c + d*x)^m*E^(2*I*k*Pi)*(E^(2*I*(e + f*x))/(1 + E^(2*I*k*Pi)*E^(2*I*(e + f*x)))), x] /; FreeQ[{c, d, e, f}, x] && IntegerQ[4*k] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*tan[(e_.) + (f_.)*(Complex[0, fz_])*(x_)], x_Symbol] := (-I)*((c + d*x)^(m + 1)/(d*(m + 1))) + 2*I*Int[(c + d*x)^m*(E^(2*((-I)*e + f*fz*x))/(1 + E^(2*((-I)*e + f*fz*x)))), x] /; FreeQ[{c, d, e, f, fz}, x] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*tan[(e_.) + (f_.)*(x_)], x_Symbol] := I*((c + d*x)^(m + 1)/(d*(m + 1))) - 2*I*Int[(c + d*x)^m*(E^(2*I*(e + f*x))/(1 + E^(2*I*(e + f*x)))), x] /; FreeQ[{c, d, e, f}, x] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(c + d*x)^m*((b*Tan[e + f*x])^(n - 1)/(f*(n - 1))) - b*d*(m/(f*(n - 1)))*Int[(c + d*x)^(m - 1)*(b*Tan[e + f*x])^(n - 1), x] - b^2*Int[(c + d*x)^m*(b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1] && GtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*((b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (c + d*x)^m*((b*Tan[e + f*x])^(n + 1)/(b*f*(n + 1))) - d*(m/(b*f*(n + 1)))*Int[(c + d*x)^(m - 1)*(b*Tan[e + f*x])^(n + 1), x] - (1/b^2)*Int[(c + d*x)^m*(b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{b, c, d, e, f}, x] && LtQ[n, -1] && GtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, (a + b*Tan[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (c + d*x)^(m + 1)/(2*a*d*(m + 1)) - a*((c + d*x)^m/(2*b*f*(a + b*Tan[e + f*x]))) + a*d*(m/(2*b*f))*Int[(c + d*x)^(m - 1)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0] && GtQ[m, 0]
Int[1/(((c_.) + (d_.)*(x_))^2*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := -(d*(c + d*x)*(a + b*Tan[e + f*x]))^(-1) + (f/(b*d))*Int[Cos[2*e + 2*f*x]/(c + d*x), x] - (f/(a*d))*Int[Sin[2*e + 2*f*x]/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[((c_.) + (d_.)*(x_))^(m_)/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := f*((c + d*x)^(m + 2)/(b*d^2*(m + 1)*(m + 2))) + (c + d*x)^(m + 1)/(d*(m + 1)*(a + b*Tan[e + f*x])) + 2*b*(f/(a*d*(m + 1)))*Int[(c + d*x)^(m + 1)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0] && LtQ[m, -1] && NeQ[m, -2]
Int[1/(((c_.) + (d_.)*(x_))*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := Log[c + d*x]/(2*a*d) + (1/(2*a))*Int[Cos[2*e + 2*f*x]/(c + d*x), x] + (1/(2*b))*Int[Sin[2*e + 2*f*x]/(c + d*x), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[((c_.) + (d_.)*(x_))^(m_)/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (c + d*x)^(m + 1)/(2*a*d*(m + 1)) + (1/(2*a))*Int[(c + d*x)^m*E^(2*(a/b)*(e + f*x)), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[a^2 + b^2, 0] &&  !IntegerQ[m]
Int[((c_.) + (d_.)*(x_))^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, (1/(2*a) + Cos[2*e + 2*f*x]/(2*a) + Sin[2*e + 2*f*x]/(2*b))^(-n), x], x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0] && ILtQ[m, 0] && ILtQ[n, 0]
Int[((c_.) + (d_.)*(x_))^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, (1/(2*a) + E^(2*(a/b)*(e + f*x))/(2*a))^(-n), x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[a^2 + b^2, 0] && ILtQ[n, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := With[{u = IntHide[(a + b*Tan[e + f*x])^n, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[Dist[(c + d*x)^(m - 1), u, x], x]] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[a^2 + b^2, 0] && ILtQ[n, -1] && GtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)/((a_) + (b_.)*tan[(e_.) + (k_.)*Pi + (f_.)*(x_)]), x_Symbol] := (c + d*x)^(m + 1)/(d*(m + 1)*(a + I*b)) + 2*I*b*Int[(c + d*x)^m*E^(2*I*k*Pi)*(E^Simp[2*I*(e + f*x), x]/((a + I*b)^2 + (a^2 + b^2)*E^(2*I*k*Pi)*E^Simp[2*I*(e + f*x), x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IntegerQ[4*k] && NeQ[a^2 + b^2, 0] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (c + d*x)^(m + 1)/(d*(m + 1)*(a + I*b)) + 2*I*b*Int[(c + d*x)^m*(E^Simp[2*I*(e + f*x), x]/((a + I*b)^2 + (a^2 + b^2)*E^Simp[2*I*(e + f*x), x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 + b^2, 0] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^2, x_Symbol] := -((c + d*x)^2/(2*d*(a^2 + b^2))) - b*((c + d*x)/(f*(a^2 + b^2)*(a + b*Tan[e + f*x]))) + (1/(f*(a^2 + b^2)))*Int[(b*d + 2*a*c*f + 2*a*d*f*x)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 + b^2, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, (1/(a - I*b) - 2*I*(b/(a^2 + b^2 + (a - I*b)^2*E^(2*I*(e + f*x)))))^(-n), x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[a^2 + b^2, 0] && ILtQ[n, 0] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*tan[(e_.) + (f_.)*(x_)]^(n_.), x_Symbol] := If[MatchQ[f, (f1_.)*(Complex[0, j_])], If[MatchQ[e, (e1_.) + Pi/2], I^n*Unintegrable[(c + d*x)^m*Coth[(-I)*(e - Pi/2) - I*f*x]^n, x], I^n*Unintegrable[(c + d*x)^m*Tanh[(-I)*e - I*f*x]^n, x]], If[MatchQ[e, (e1_.) + Pi/2], (-1)^n*Unintegrable[(c + d*x)^m*Cot[e - Pi/2 + f*x]^n, x], Unintegrable[(c + d*x)^m*Tan[e + f*x]^n, x]]] /; FreeQ[{c, d, e, f, m, n}, x] && IntegerQ[n]
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Unintegrable[(c + d*x)^m*(a + b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[(u_)^(m_.)*((a_.) + (b_.)*Tan[v_])^(n_.), x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Tan[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] &&  !LinearMatchQ[{u, v}, x]
Int[(u_)^(m_.)*((a_.) + (b_.)*Cot[v_])^(n_.), x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Cot[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] &&  !LinearMatchQ[{u, v}, x]

(* ::Subsection::Closed:: *)
(* 4.2.1.1 (a+b tan)^n *)
Int[((b_.)*tan[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := b*((b*Tan[c + d*x])^(n - 1)/(d*(n - 1))) - b^2*Int[(b*Tan[c + d*x])^(n - 2), x] /; FreeQ[{b, c, d}, x] && GtQ[n, 1]
Int[((b_.)*tan[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (b*Tan[c + d*x])^(n + 1)/(b*d*(n + 1)) - (1/b^2)*Int[(b*Tan[c + d*x])^(n + 2), x] /; FreeQ[{b, c, d}, x] && LtQ[n, -1]
Int[tan[(c_.) + (d_.)*(x_)], x_Symbol] := -(Log[RemoveContent[Cos[c + d*x], x]]/d) /; FreeQ[{c, d}, x]
Int[((b_.)*tan[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (b/d)*Subst[Int[x^n/(b^2 + x^2), x], x, b*Tan[c + d*x]] /; FreeQ[{b, c, d, n}, x] &&  !IntegerQ[n]
Int[((a_) + (b_.)*tan[(c_.) + (d_.)*(x_)])^2, x_Symbol] := (a^2 - b^2)*x + b^2*(Tan[c + d*x]/d) + 2*a*b*Int[Tan[c + d*x], x] /; FreeQ[{a, b, c, d}, x]
Int[((a_) + (b_.)*tan[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := b*((a + b*Tan[c + d*x])^(n - 1)/(d*(n - 1))) + 2*a*Int[(a + b*Tan[c + d*x])^(n - 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 + b^2, 0] && GtQ[n, 1]
Int[((a_) + (b_.)*tan[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := a*((a + b*Tan[c + d*x])^n/(2*b*d*n)) + (1/(2*a))*Int[(a + b*Tan[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 + b^2, 0] && LtQ[n, 0]
Int[Sqrt[(a_) + (b_.)*tan[(c_.) + (d_.)*(x_)]], x_Symbol] := -2*(b/d)*Subst[Int[1/(2*a - x^2), x], x, Sqrt[a + b*Tan[c + d*x]]] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 + b^2, 0]
Int[((a_) + (b_.)*tan[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-(b/d))*Subst[Int[(a + x)^(n - 1)/(a - x), x], x, b*Tan[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 + b^2, 0]
Int[((a_) + (b_.)*tan[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := b*((a + b*Tan[c + d*x])^(n - 1)/(d*(n - 1))) + Int[(a^2 - b^2 + 2*a*b*Tan[c + d*x])*(a + b*Tan[c + d*x])^(n - 2), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && GtQ[n, 1]
Int[((a_) + (b_.)*tan[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := b*((a + b*Tan[c + d*x])^(n + 1)/(d*(n + 1)*(a^2 + b^2))) + (1/(a^2 + b^2))*Int[(a - b*Tan[c + d*x])*(a + b*Tan[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[1/((a_) + (b_.)*tan[(c_.) + (d_.)*(x_)]), x_Symbol] := a*(x/(a^2 + b^2)) + (b/(a^2 + b^2))*Int[(b - a*Tan[c + d*x])/(a + b*Tan[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 + b^2, 0]
Int[((a_) + (b_.)*tan[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (b/d)*Subst[Int[(a + x)^n/(b^2 + x^2), x], x, b*Tan[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 + b^2, 0]

(* ::Subsection::Closed:: *)
(* 4.2.11 (e x)^m (a+b tan(c+d x^n))^p *)
Int[((a_.) + (b_.)*Tan[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/n)*Subst[Int[x^(1/n - 1)*(a + b*Tan[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[((a_.) + (b_.)*Cot[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/n)*Subst[Int[x^(1/n - 1)*(a + b*Cot[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[((a_.) + (b_.)*Tan[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Unintegrable[(a + b*Tan[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[((a_.) + (b_.)*Cot[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Unintegrable[(a + b*Cot[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[((a_.) + (b_.)*Tan[(c_.) + (d_.)*(u_)^(n_)])^(p_.), x_Symbol] := (1/Coefficient[u, x, 1])*Subst[Int[(a + b*Tan[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[((a_.) + (b_.)*Cot[(c_.) + (d_.)*(u_)^(n_)])^(p_.), x_Symbol] := (1/Coefficient[u, x, 1])*Subst[Int[(a + b*Cot[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[((a_.) + (b_.)*Tan[u_])^(p_.), x_Symbol] := Int[(a + b*Tan[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[((a_.) + (b_.)*Cot[u_])^(p_.), x_Symbol] := Int[(a + b*Cot[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[(x_)^(m_.)*((a_.) + (b_.)*Tan[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/n)*Subst[Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Tan[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[(x_)^(m_.)*((a_.) + (b_.)*Cot[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/n)*Subst[Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Cot[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[(x_)^(m_.)*Tan[(c_.) + (d_.)*(x_)^(n_)]^2, x_Symbol] := x^(m - n + 1)*(Tan[c + d*x^n]/(d*n)) - Int[x^m, x] - ((m - n + 1)/(d*n))*Int[x^(m - n)*Tan[c + d*x^n], x] /; FreeQ[{c, d, m, n}, x]
Int[(x_)^(m_.)*Cot[(c_.) + (d_.)*(x_)^(n_)]^2, x_Symbol] := (-x^(m - n + 1))*(Cot[c + d*x^n]/(d*n)) - Int[x^m, x] + ((m - n + 1)/(d*n))*Int[x^(m - n)*Cot[c + d*x^n], x] /; FreeQ[{c, d, m, n}, x]
Int[(x_)^(m_.)*((a_.) + (b_.)*Tan[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Unintegrable[x^m*(a + b*Tan[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[(x_)^(m_.)*((a_.) + (b_.)*Cot[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Unintegrable[x^m*(a + b*Cot[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[((e_)*(x_))^(m_.)*((a_.) + (b_.)*Tan[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := e^IntPart[m]*((e*x)^FracPart[m]/x^FracPart[m])*Int[x^m*(a + b*Tan[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[((e_)*(x_))^(m_.)*((a_.) + (b_.)*Cot[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := e^IntPart[m]*((e*x)^FracPart[m]/x^FracPart[m])*Int[x^m*(a + b*Cot[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[((e_)*(x_))^(m_.)*((a_.) + (b_.)*Tan[u_])^(p_.), x_Symbol] := Int[(e*x)^m*(a + b*Tan[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[((e_)*(x_))^(m_.)*((a_.) + (b_.)*Cot[u_])^(p_.), x_Symbol] := Int[(e*x)^m*(a + b*Cot[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[(x_)^(m_.)*Sec[(a_.) + (b_.)*(x_)^(n_.)]^(p_.)*Tan[(a_.) + (b_.)*(x_)^(n_.)]^(q_.), x_Symbol] := x^(m - n + 1)*(Sec[a + b*x^n]^p/(b*n*p)) - ((m - n + 1)/(b*n*p))*Int[x^(m - n)*Sec[a + b*x^n]^p, x] /; FreeQ[{a, b, p}, x] && IntegerQ[n] && GeQ[m, n] && EqQ[q, 1]
Int[(x_)^(m_.)*Csc[(a_.) + (b_.)*(x_)^(n_.)]^(p_.)*Cot[(a_.) + (b_.)*(x_)^(n_.)]^(q_.), x_Symbol] := (-x^(m - n + 1))*(Csc[a + b*x^n]^p/(b*n*p)) + ((m - n + 1)/(b*n*p))*Int[x^(m - n)*Csc[a + b*x^n]^p, x] /; FreeQ[{a, b, p}, x] && IntegerQ[n] && GeQ[m, n] && EqQ[q, 1]

(* ::Subsection::Closed:: *)
(* 4.2.12 (d+e x)^m tan(a+b x+c x^2)^n *)
Int[Tan[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_.), x_Symbol] := Unintegrable[Tan[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, n}, x]
Int[Cot[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_.), x_Symbol] := Unintegrable[Cot[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, n}, x]
Int[((d_) + (e_.)*(x_))*Tan[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := (-e)*(Log[Cos[a + b*x + c*x^2]]/(2*c)) /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0]
Int[((d_) + (e_.)*(x_))*Cot[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := e*(Log[Sin[a + b*x + c*x^2]]/(2*c)) /; FreeQ[{a, b, c, d, e}, x] && EqQ[2*c*d - b*e, 0]
Int[((d_.) + (e_.)*(x_))*Tan[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := (-e)*(Log[Cos[a + b*x + c*x^2]]/(2*c)) + ((2*c*d - b*e)/(2*c))*Int[Tan[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0]
Int[((d_.) + (e_.)*(x_))*Cot[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2], x_Symbol] := e*(Log[Sin[a + b*x + c*x^2]]/(2*c)) + ((2*c*d - b*e)/(2*c))*Int[Cot[a + b*x + c*x^2], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[2*c*d - b*e, 0]
Int[((d_.) + (e_.)*(x_))^(m_.)*Tan[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_.), x_Symbol] := Unintegrable[(d + e*x)^m*Tan[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[((d_.) + (e_.)*(x_))^(m_.)*Cot[(a_.) + (b_.)*(x_) + (c_.)*(x_)^2]^(n_.), x_Symbol] := Unintegrable[(d + e*x)^m*Cot[a + b*x + c*x^2]^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]

(* ::Subsection::Closed:: *)
(* 4.2.1.2 (d sec)^m (a+b tan)^n *)
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := b*((d*Sec[e + f*x])^m/(f*m)) + a*Int[(d*Sec[e + f*x])^m, x] /; FreeQ[{a, b, d, e, f, m}, x] && (IntegerQ[2*m] || NeQ[a^2 + b^2, 0])
Int[sec[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (1/(a^(m - 2)*b*f))*Subst[Int[(a - x)^(m/2 - 1)*(a + x)^(n + m/2 - 1), x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, e, f, n}, x] && EqQ[a^2 + b^2, 0] && IntegerQ[m/2]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(d*Sec[e + f*x])^m*((a + b*Tan[e + f*x])^n/(a*f*m)) /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && EqQ[Simplify[m + n], 0]
Int[sec[(e_.) + (f_.)*(x_)]/Sqrt[(a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*(a/(b*f))*Subst[Int[1/(2 - a*x^2), x], x, Sec[e + f*x]/Sqrt[a + b*Tan[e + f*x]]] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(d*Sec[e + f*x])^m*((a + b*Tan[e + f*x])^n/(a*f*m)) + (a/(2*d^2))*Int[(d*Sec[e + f*x])^(m + 2)*(a + b*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0] && EqQ[m/2 + n, 0] && GtQ[n, 0]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := 2*d^2*(d*Sec[e + f*x])^(m - 2)*((a + b*Tan[e + f*x])^(n + 1)/(b*f*(m - 2))) + 2*(d^2/a)*Int[(d*Sec[e + f*x])^(m - 2)*(a + b*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0] && EqQ[m/2 + n, 0] && LtQ[n, -1]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (a/d)^(2*IntPart[n])*(a + b*Tan[e + f*x])^FracPart[n]*((a - b*Tan[e + f*x])^FracPart[n]/(d*Sec[e + f*x])^(2*FracPart[n]))*Int[1/(a - b*Tan[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && EqQ[Simplify[m/2 + n], 0]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := 2*b*(d*Sec[e + f*x])^m*((a + b*Tan[e + f*x])^(n - 1)/(f*m)) /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && EqQ[Simplify[m/2 + n - 1], 0]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(d*Sec[e + f*x])^m*((a + b*Tan[e + f*x])^(n - 1)/(f*(m + n - 1))) + a*((m + 2*n - 2)/(m + n - 1))*Int[(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && IGtQ[Simplify[m/2 + n - 1], 0] &&  !IntegerQ[n]
Int[Sqrt[(d_.)*sec[(e_.) + (f_.)*(x_)]]*Sqrt[(a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := -4*b*(d^2/f)*Subst[Int[x^2/(a^2 + d^2*x^4), x], x, Sqrt[a + b*Tan[e + f*x]]/Sqrt[d*Sec[e + f*x]]] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := 2*b*(d*Sec[e + f*x])^m*((a + b*Tan[e + f*x])^(n - 1)/(f*m)) - b^2*((m + 2*n - 2)/(d^2*m))*Int[(d*Sec[e + f*x])^(m + 2)*(a + b*Tan[e + f*x])^(n - 2), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0] && GtQ[n, 1] && ((IGtQ[n/2, 0] && ILtQ[m - 1/2, 0]) || (EqQ[n, 2] && LtQ[m, 0]) || (LeQ[m, -1] && GtQ[m + n, 0]) || (ILtQ[m, 0] && LtQ[m/2 + n - 1, 0] && IntegerQ[n]) || (EqQ[n, 3/2] && EqQ[m, -2^(-1)])) && IntegerQ[2*m]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(d*Sec[e + f*x])^m*((a + b*Tan[e + f*x])^n/(a*f*m)) + a*((m + n)/(m*d^2))*Int[(d*Sec[e + f*x])^(m + 2)*(a + b*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0] && GtQ[n, 0] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(d*Sec[e + f*x])^m*((a + b*Tan[e + f*x])^(n - 1)/(f*(m + n - 1))) + a*((m + 2*n - 2)/(m + n - 1))*Int[(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f, m}, x] && EqQ[a^2 + b^2, 0] && GtQ[n, 0] && NeQ[m + n - 1, 0] && IntegersQ[2*m, 2*n]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(3/2)/Sqrt[(a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := d*(Sec[e + f*x]/(Sqrt[a - b*Tan[e + f*x]]*Sqrt[a + b*Tan[e + f*x]]))*Int[Sqrt[d*Sec[e + f*x]]*Sqrt[a - b*Tan[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := 2*d^2*(d*Sec[e + f*x])^(m - 2)*((a + b*Tan[e + f*x])^(n + 1)/(b*f*(m + 2*n))) - d^2*((m - 2)/(b^2*(m + 2*n)))*Int[(d*Sec[e + f*x])^(m - 2)*(a + b*Tan[e + f*x])^(n + 2), x] /; FreeQ[{a, b, d, e, f, m}, x] && EqQ[a^2 + b^2, 0] && LtQ[n, -1] && ((ILtQ[n/2, 0] && IGtQ[m - 1/2, 0]) || EqQ[n, -2] || IGtQ[m + n, 0] || (IntegersQ[n, m + 1/2] && GtQ[2*m + n + 1, 0])) && IntegerQ[2*m]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d^2*(d*Sec[e + f*x])^(m - 2)*((a + b*Tan[e + f*x])^(n + 1)/(b*f*(m + n - 1))) + d^2*((m - 2)/(a*(m + n - 1)))*Int[(d*Sec[e + f*x])^(m - 2)*(a + b*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0] && LtQ[n, 0] && GtQ[m, 1] &&  !ILtQ[m + n, 0] && NeQ[m + n - 1, 0] && IntegersQ[2*m, 2*n]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*(d*Sec[e + f*x])^m*((a + b*Tan[e + f*x])^n/(b*f*(m + 2*n))) + (Simplify[m + n]/(a*(m + 2*n)))*Int[(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, m}, x] && EqQ[a^2 + b^2, 0] && LtQ[n, 0] && NeQ[m + 2*n, 0] && IntegersQ[2*m, 2*n]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(d*Sec[e + f*x])^m*((a + b*Tan[e + f*x])^(n - 1)/(f*Simplify[m + n - 1])) + a*((m + 2*n - 2)/Simplify[m + n - 1])*Int[(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && IGtQ[Simplify[m + n - 1], 0] && RationalQ[n]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*(d*Sec[e + f*x])^m*((a + b*Tan[e + f*x])^n/(b*f*(m + 2*n))) + (Simplify[m + n]/(a*(m + 2*n)))*Int[(d*Sec[e + f*x])^m*(a + b*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0] && ILtQ[Simplify[m + n], 0] && NeQ[m + 2*n, 0]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := ((d*Sec[e + f*x])^m/((a + b*Tan[e + f*x])^(m/2)*(a - b*Tan[e + f*x])^(m/2)))*Int[(a + b*Tan[e + f*x])^(m/2 + n)*(a - b*Tan[e + f*x])^(m/2), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 + b^2, 0]
Int[sec[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (1/(b*f))*Subst[Int[(a + x)^n*(1 + x^2/b^2)^(m/2 - 1), x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, e, f, n}, x] && NeQ[a^2 + b^2, 0] && IntegerQ[m/2]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^2/sec[(e_.) + (f_.)*(x_)], x_Symbol] := b^2*(ArcTanh[Sin[e + f*x]]/f) - 2*a*b*(Cos[e + f*x]/f) + (a^2 - b^2)*(Sin[e + f*x]/f) /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 + b^2, 0]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^2, x_Symbol] := b*(d*Sec[e + f*x])^m*((a + b*Tan[e + f*x])/(f*(m + 1))) + (1/(m + 1))*Int[(d*Sec[e + f*x])^m*(a^2*(m + 1) - b^2 + a*b*(m + 2)*Tan[e + f*x]), x] /; FreeQ[{a, b, d, e, f, m}, x] && NeQ[a^2 + b^2, 0] && NeQ[m, -1]
Int[sec[(e_.) + (f_.)*(x_)]/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (-f^(-1))*Subst[Int[1/(a^2 + b^2 - x^2), x], x, (b - a*Tan[e + f*x])/Sec[e + f*x]] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 + b^2, 0]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_)/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(d^2/b^2))*Int[(d*Sec[e + f*x])^(m - 2)*(a - b*Tan[e + f*x]), x] + d^2*((a^2 + b^2)/b^2)*Int[(d*Sec[e + f*x])^(m - 2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 + b^2, 0] && IGtQ[m, 1]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_)/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (1/(a^2 + b^2))*Int[(d*Sec[e + f*x])^m*(a - b*Tan[e + f*x]), x] + (b^2/(d^2*(a^2 + b^2)))*Int[(d*Sec[e + f*x])^(m + 2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 + b^2, 0] && ILtQ[m, 0]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d^(2*IntPart[m/2])*((d*Sec[e + f*x])^(2*FracPart[m/2])/(b*f*(Sec[e + f*x]^2)^FracPart[m/2]))*Subst[Int[(a + x)^n*(1 + x^2/b^2)^(m/2 - 1), x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && NeQ[a^2 + b^2, 0] &&  !IntegerQ[m/2]
Int[Sqrt[(a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]]/Sqrt[(d_.)*cos[(e_.) + (f_.)*(x_)]], x_Symbol] := -4*(b/f)*Subst[Int[x^2/(a^2*d^2 + x^4), x], x, Sqrt[d*Cos[e + f*x]]*Sqrt[a + b*Tan[e + f*x]]] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[1/(((d_.)*cos[(e_.) + (f_.)*(x_)])^(3/2)*Sqrt[(a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]]), x_Symbol] := (1/(d*Cos[e + f*x]*Sqrt[a - b*Tan[e + f*x]]*Sqrt[a + b*Tan[e + f*x]]))*Int[Sqrt[a - b*Tan[e + f*x]]/Sqrt[d*Cos[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 + b^2, 0]
Int[((d_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (d*Cos[e + f*x])^m*(d*Sec[e + f*x])^m*Int[(a + b*Tan[e + f*x])^n/(d*Sec[e + f*x])^m, x] /; FreeQ[{a, b, d, e, f, m, n}, x] &&  !IntegerQ[m]

(* ::Subsection::Closed:: *)
(* 4.2.1.3 (d sin)^m (a+b tan)^n *)
Int[sin[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (b/f)*Subst[Int[x^m*((a + x)^n/(b^2 + x^2)^(m/2 + 1)), x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, e, f, n}, x] && IntegerQ[m/2]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[Expand[Sin[e + f*x]^m*(a + b*Tan[e + f*x])^n, x], x] /; FreeQ[{a, b, e, f}, x] && IntegerQ[(m - 1)/2] && IGtQ[n, 0]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[Sin[e + f*x]^m*((a*Cos[e + f*x] + b*Sin[e + f*x])^n/Cos[e + f*x]^n), x] /; FreeQ[{a, b, e, f}, x] && IntegerQ[(m - 1)/2] && ILtQ[n, 0] && ((LtQ[m, 5] && GtQ[n, -4]) || (EqQ[m, 5] && EqQ[n, -1]))
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := (d*Csc[e + f*x])^FracPart[m]*(Sin[e + f*x]/d)^FracPart[m]*Int[(a + b*Tan[e + f*x])^n/(Sin[e + f*x]/d)^m, x] /; FreeQ[{a, b, d, e, f, m, n}, x] &&  !IntegerQ[m]
Int[cos[(e_.) + (f_.)*(x_)]^(m_.)*sin[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[Cos[e + f*x]^(m - n)*Sin[e + f*x]^p*(a*Cos[e + f*x] + b*Sin[e + f*x])^n, x] /; FreeQ[{a, b, e, f, m, p}, x] && IntegerQ[n]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*cos[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*cot[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[Sin[e + f*x]^(m - n)*Cos[e + f*x]^p*(a*Sin[e + f*x] + b*Cos[e + f*x])^n, x] /; FreeQ[{a, b, e, f, m, p}, x] && IntegerQ[n]

(* ::Subsection::Closed:: *)
(* 4.2.2.1 (a+b tan)^m (c+d tan)^n *)
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^m*c^m*Int[Sec[e + f*x]^(2*m)*(c + d*Tan[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 + b^2, 0] && IntegerQ[m] &&  !(IGtQ[n, 0] && (LtQ[m, 0] || GtQ[m, n]))
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*(c/f)*Subst[Int[(a + b*x)^(m - 1)*(c + d*x)^(n - 1), x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 + b^2, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])*((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (a*c - b*d)*x + b*d*(Tan[e + f*x]/f) /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[b*c + a*d, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (a*c - b*d)*x + b*d*(Tan[e + f*x]/f) + (b*c + a*d)*Int[Tan[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[b*c + a*d, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(b*c - a*d))*((a + b*Tan[e + f*x])^m/(2*a*f*m)) + ((b*c + a*d)/(2*a*b))*Int[(a + b*Tan[e + f*x])^(m + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && LtQ[m, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := d*((a + b*Tan[e + f*x])^m/(f*m)) + ((b*c + a*d)/b)*Int[(a + b*Tan[e + f*x])^m, x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] &&  !LtQ[m, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := d*((a + b*Tan[e + f*x])^m/(f*m)) + Int[(a + b*Tan[e + f*x])^(m - 1)*Simp[a*c - b*d + (b*c + a*d)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && GtQ[m, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (b*c - a*d)*((a + b*Tan[e + f*x])^(m + 1)/(f*(m + 1)*(a^2 + b^2))) + (1/(a^2 + b^2))*Int[(a + b*Tan[e + f*x])^(m + 1)*Simp[a*c + b*d - (b*c - a*d)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && LtQ[m, -1]
Int[((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)])/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (c/(b*f))*Log[RemoveContent[a*Cos[e + f*x] + b*Sin[e + f*x], x]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && EqQ[a*c + b*d, 0]
Int[((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])/((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (a*c + b*d)*(x/(a^2 + b^2)) + ((b*c - a*d)/(a^2 + b^2))*Int[(b - a*Tan[e + f*x])/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[a*c + b*d, 0]
Int[((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)])/Sqrt[(b_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*(d^2/f)*Subst[Int[1/(2*c*d + b*x^2), x], x, (c - d*Tan[e + f*x])/Sqrt[b*Tan[e + f*x]]] /; FreeQ[{b, c, d, e, f}, x] && EqQ[c^2 - d^2, 0]
Int[((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)])/Sqrt[(b_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := 2*(c^2/f)*Subst[Int[1/(b*c - d*x^2), x], x, Sqrt[b*Tan[e + f*x]]] /; FreeQ[{b, c, d, e, f}, x] && EqQ[c^2 + d^2, 0]
Int[((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)])/Sqrt[(b_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := (2/f)*Subst[Int[(b*c + d*x^2)/(b^2 + x^4), x], x, Sqrt[b*Tan[e + f*x]]] /; FreeQ[{b, c, d, e, f}, x] && NeQ[c^2 - d^2, 0] && NeQ[c^2 + d^2, 0]
Int[((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])/Sqrt[(a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*(d^2/f)*Subst[Int[1/(2*b*c*d - 4*a*d^2 + x^2), x], x, (b*c - 2*a*d - b*d*Tan[e + f*x])/Sqrt[a + b*Tan[e + f*x]]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && EqQ[2*a*c*d - b*(c^2 - d^2), 0]
Int[((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])/Sqrt[(a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := With[{q = Rt[a^2 + b^2, 2]}, (1/(2*q))*Int[(a*c + b*d + c*q + (b*c - a*d + d*q)*Tan[e + f*x])/Sqrt[a + b*Tan[e + f*x]], x] - (1/(2*q))*Int[(a*c + b*d - c*q + (b*c - a*d - d*q)*Tan[e + f*x])/Sqrt[a + b*Tan[e + f*x]], x]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && NeQ[2*a*c*d - b*(c^2 - d^2), 0] && (PerfectSquareQ[a^2 + b^2] || RationalQ[a, b, c, d])
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := c*(d/f)*Subst[Int[(a + (b/d)*x)^m/(d^2 + c*x), x], x, d*Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && EqQ[c^2 + d^2, 0]
Int[((b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := c*Int[(b*Tan[e + f*x])^m, x] + (d/b)*Int[(b*Tan[e + f*x])^(m + 1), x] /; FreeQ[{b, c, d, e, f, m}, x] && NeQ[c^2 + d^2, 0] &&  !IntegerQ[2*m]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := ((c + I*d)/2)*Int[(a + b*Tan[e + f*x])^m*(1 - I*Tan[e + f*x]), x] + ((c - I*d)/2)*Int[(a + b*Tan[e + f*x])^m*(1 + I*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] &&  !IntegerQ[m]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^2, x_Symbol] := (-b)*(a*c + b*d)^2*((a + b*Tan[e + f*x])^m/(2*a^3*f*m)) + (1/(2*a^2))*Int[(a + b*Tan[e + f*x])^(m + 1)*Simp[a*c^2 - 2*b*c*d + a*d^2 - 2*b*d^2*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && LeQ[m, -1] && EqQ[a^2 + b^2, 0]
Int[((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^2/((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := d*(2*b*c - a*d)*(x/b^2) + (d^2/b)*Int[Tan[e + f*x], x] + ((b*c - a*d)^2/b^2)*Int[1/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^2, x_Symbol] := (b*c - a*d)^2*((a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 + b^2))) + (1/(a^2 + b^2))*Int[(a + b*Tan[e + f*x])^(m + 1)*Simp[a*c^2 + 2*b*c*d - a*d^2 - (b*c^2 - 2*a*c*d - b*d^2)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && LtQ[m, -1] && NeQ[a^2 + b^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^2, x_Symbol] := d^2*((a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1))) + Int[(a + b*Tan[e + f*x])^m*Simp[c^2 - d^2 + 2*c*d*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] &&  !LeQ[m, -1] &&  !(EqQ[m, 2] && EqQ[a, 0])
Int[Sqrt[(a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]]/Sqrt[(c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*a*(b/f)*Subst[Int[1/(a*c - b*d - 2*a^2*x^2), x], x, Sqrt[c + d*Tan[e + f*x]]/Sqrt[a + b*Tan[e + f*x]]] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*b*(a + b*Tan[e + f*x])^(m - 1)*((c + d*Tan[e + f*x])^(n + 1)/(f*(m - 1)*(a*c - b*d))) + 2*(a^2/(a*c - b*d))*Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && EqQ[m + n, 0] && GtQ[m, 1/2]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^n/(2*b*f*m)) - ((a*c - b*d)/(2*b^2))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && EqQ[m + n, 0] && LeQ[m, -2^(-1)]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(2*f*m*(b*c - a*d))) + (1/(2*a))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && EqQ[m + n + 1, 0] && LtQ[m, -1]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-d)*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(f*m*(c^2 + d^2))) + (a/(a*c - b*d))*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && EqQ[m + n + 1, 0] &&  !LtQ[m, -1]
Int[((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(a*c + b*d))*((c + d*Tan[e + f*x])^n/(2*(b*c - a*d)*f*(a + b*Tan[e + f*x]))) + (1/(2*a*(b*c - a*d)))*Int[(c + d*Tan[e + f*x])^(n - 1)*Simp[a*c*d*(n - 1) + b*c^2 + b*d^2*n - d*(b*c - a*d)*(n - 1)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[0, n, 1]
Int[((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (b*c - a*d)*((c + d*Tan[e + f*x])^(n - 1)/(2*a*f*(a + b*Tan[e + f*x]))) + (1/(2*a^2))*Int[(c + d*Tan[e + f*x])^(n - 2)*Simp[a*c^2 + a*d^2*(n - 1) - b*c*d*n - d*(a*c*(n - 2) + b*d*n)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[n, 1]
Int[1/(((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := (b/(b*c - a*d))*Int[1/(a + b*Tan[e + f*x]), x] - (d/(b*c - a*d))*Int[1/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (-a)*((c + d*Tan[e + f*x])^(n + 1)/(2*f*(b*c - a*d)*(a + b*Tan[e + f*x]))) + (1/(2*a*(b*c - a*d)))*Int[(c + d*Tan[e + f*x])^n*Simp[b*c + a*d*(n - 1) - b*d*n*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] &&  !GtQ[n, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-a^2)*(b*c - a*d)*(a + b*Tan[e + f*x])^(m - 2)*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(b*c + a*d)*(n + 1))) + (a/(d*(b*c + a*d)*(n + 1)))*Int[(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^(n + 1)*Simp[b*(b*c*(m - 2) - a*d*(m - 2*n - 4)) + (a*b*c*(m - 2) + b^2*d*(n + 1) - a^2*d*(m + n - 1))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 1] && LtQ[n, -1] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(3/2)/((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := 2*(a^2/(a*c - b*d))*Int[Sqrt[a + b*Tan[e + f*x]], x] - ((2*b*c*d + a*(c^2 - d^2))/(a*(c^2 + d^2)))*Int[(a - b*Tan[e + f*x])*(Sqrt[a + b*Tan[e + f*x]]/(c + d*Tan[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(3/2)/Sqrt[(c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := 2*a*Int[Sqrt[a + b*Tan[e + f*x]]/Sqrt[c + d*Tan[e + f*x]], x] + (b/a)*Int[(b + a*Tan[e + f*x])*(Sqrt[a + b*Tan[e + f*x]]/Sqrt[c + d*Tan[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b^2*(a + b*Tan[e + f*x])^(m - 2)*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n - 1))) + (a/(d*(m + n - 1)))*Int[(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^n*Simp[b*c*(m - 2) + a*d*(m + 2*n) + (a*c*(m - 2) + b*d*(3*m + 2*n - 4))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && IntegerQ[2*m] && GtQ[m, 1] && NeQ[m + n - 1, 0] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*Sqrt[(c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := (-b)*(a + b*Tan[e + f*x])^m*(Sqrt[c + d*Tan[e + f*x]]/(2*a*f*m)) + (1/(4*a^2*m))*Int[(a + b*Tan[e + f*x])^(m + 1)*(Simp[2*a*c*m + b*d + a*d*(2*m + 1)*Tan[e + f*x], x]/Sqrt[c + d*Tan[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, 0] && IntegersQ[2*m]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-(b*c - a*d))*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n - 1)/(2*a*f*m)) + (1/(2*a^2*m))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 2)*Simp[c*(a*c*m + b*d*(n - 1)) - d*(b*c*m + a*d*(n - 1)) - d*(b*d*(m - n + 1) - a*c*(m + n - 1))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, 0] && GtQ[n, 1] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(2*f*m*(b*c - a*d))) + (1/(2*a*m*(b*c - a*d)))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n*Simp[b*c*m - a*d*(2*m + n + 1) + b*d*(m + n + 1)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, 0] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n - 1)/(f*(m + n - 1))) - (1/(a*(m + n - 1)))*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n - 2)*Simp[d*(b*c*m + a*d*(-1 + n)) - a*c^2*(m + n - 1) + d*(b*d*m - a*c*(m + 2*n - 2))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[n, 1] && NeQ[m + n - 1, 0] && (IntegerQ[n] || IntegersQ[2*m, 2*n])
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 + d^2))) - (1/(a*(c^2 + d^2)*(n + 1)))*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n + 1)*Simp[b*d*m - a*c*(n + 1) + a*d*(m + n + 1)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[n, -1] && (IntegerQ[n] || IntegersQ[2*m, 2*n])
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)/((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (a/(a*c - b*d))*Int[(a + b*Tan[e + f*x])^m, x] - (d/(a*c - b*d))*Int[(a + b*Tan[e + f*x])^m*((b + a*Tan[e + f*x])/(c + d*Tan[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[Sqrt[(a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]]*Sqrt[(c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]], x_Symbol] := ((a*c - b*d)/a)*Int[Sqrt[a + b*Tan[e + f*x]]/Sqrt[c + d*Tan[e + f*x]], x] + (d/a)*Int[Sqrt[a + b*Tan[e + f*x]]*((b + a*Tan[e + f*x])/Sqrt[c + d*Tan[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*(b/f)*Subst[Int[(a + x)^(m - 1)*((c + (d/b)*x)^n/(b^2 + a*x)), x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (b*c - a*d)^2*(a + b*Tan[e + f*x])^(m - 2)*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2))) - (1/(d*(n + 1)*(c^2 + d^2)))*Int[(a + b*Tan[e + f*x])^(m - 3)*(c + d*Tan[e + f*x])^(n + 1)*Simp[a^2*d*(b*d*(m - 2) - a*c*(n + 1)) + b*(b*c - 2*a*d)*(b*c*(m - 2) + a*d*(n + 1)) - d*(n + 1)*(3*a^2*b*c - b^3*c - a^3*d + 3*a*b^2*d)*Tan[e + f*x] - b*(a*d*(2*b*c - a*d)*(m + n - 1) - b^2*(c^2*(m - 2) - d^2*(n + 1)))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 2] && LtQ[n, -1] && IntegerQ[2*m]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b^2*(a + b*Tan[e + f*x])^(m - 2)*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n - 1))) + (1/(d*(m + n - 1)))*Int[(a + b*Tan[e + f*x])^(m - 3)*(c + d*Tan[e + f*x])^n*Simp[a^3*d*(m + n - 1) - b^2*(b*c*(m - 2) + a*d*(1 + n)) + b*d*(m + n - 1)*(3*a^2 - b^2)*Tan[e + f*x] - b^2*(b*c*(m - 2) - a*d*(3*m + 2*n - 4))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && IntegerQ[2*m] && GtQ[m, 2] && (GeQ[n, -1] || IntegerQ[m]) &&  !(IGtQ[n, 2] && ( !IntegerQ[m] || (EqQ[c, 0] && NeQ[a, 0])))
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (b*c - a*d)*(a + b*Tan[e + f*x])^(m + 1)*((c + d*Tan[e + f*x])^(n - 1)/(f*(m + 1)*(a^2 + b^2))) + (1/((m + 1)*(a^2 + b^2)))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 2)*Simp[a*c^2*(m + 1) + a*d^2*(n - 1) + b*c*d*(m - n + 2) - (b*c^2 - 2*a*c*d - b*d^2)*(m + 1)*Tan[e + f*x] - d*(b*c - a*d)*(m + n)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] && LtQ[1, n, 2] && IntegerQ[2*m]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(a + b*Tan[e + f*x])^(m + 1)*((c + d*Tan[e + f*x])^n/(f*(m + 1)*(a^2 + b^2))) + (1/((m + 1)*(a^2 + b^2)))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 1)*Simp[a*c*(m + 1) - b*d*n - (b*c - a*d)*(m + 1)*Tan[e + f*x] - b*d*(m + n + 1)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] && GtQ[n, 0] && IntegerQ[2*m]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b^2*(a + b*Tan[e + f*x])^(m + 1)*((c + d*Tan[e + f*x])^(n + 1)/(f*(m + 1)*(a^2 + b^2)*(b*c - a*d))) + (1/((m + 1)*(a^2 + b^2)*(b*c - a*d)))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n*Simp[a*(b*c - a*d)*(m + 1) - b^2*d*(m + n + 2) - b*(b*c - a*d)*(m + 1)*Tan[e + f*x] - b^2*d*(m + n + 2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && IntegerQ[2*m] && LtQ[m, -1] && (LtQ[n, 0] || IntegerQ[m]) &&  !(ILtQ[n, -1] && ( !IntegerQ[m] || (EqQ[c, 0] && NeQ[a, 0])))
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*(a + b*Tan[e + f*x])^(m - 1)*((c + d*Tan[e + f*x])^n/(f*(m + n - 1))) + (1/(m + n - 1))*Int[(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^(n - 1)*Simp[a^2*c*(m + n - 1) - b*(b*c*(m - 1) + a*d*n) + (2*a*b*c + a^2*d - b^2*d)*(m + n - 1)*Tan[e + f*x] + b*(b*c*n + a*d*(2*m + n - 2))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 1] && GtQ[n, 0] && IntegerQ[2*n]
Int[1/(((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := (a*c - b*d)*(x/((a^2 + b^2)*(c^2 + d^2))) + (b^2/((b*c - a*d)*(a^2 + b^2)))*Int[(b - a*Tan[e + f*x])/(a + b*Tan[e + f*x]), x] - (d^2/((b*c - a*d)*(c^2 + d^2)))*Int[(d - c*Tan[e + f*x])/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[Sqrt[(a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)]]/((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (1/(c^2 + d^2))*Int[Simp[a*c + b*d + (b*c - a*d)*Tan[e + f*x], x]/Sqrt[a + b*Tan[e + f*x]], x] - d*((b*c - a*d)/(c^2 + d^2))*Int[(1 + Tan[e + f*x]^2)/(Sqrt[a + b*Tan[e + f*x]]*(c + d*Tan[e + f*x])), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(3/2)/((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (1/(c^2 + d^2))*Int[Simp[a^2*c - b^2*c + 2*a*b*d + (2*a*b*c - a^2*d + b^2*d)*Tan[e + f*x], x]/Sqrt[a + b*Tan[e + f*x]], x] + ((b*c - a*d)^2/(c^2 + d^2))*Int[(1 + Tan[e + f*x]^2)/(Sqrt[a + b*Tan[e + f*x]]*(c + d*Tan[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)/((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (1/(c^2 + d^2))*Int[(a + b*Tan[e + f*x])^m*(c - d*Tan[e + f*x]), x] + (d^2/(c^2 + d^2))*Int[(a + b*Tan[e + f*x])^m*((1 + Tan[e + f*x]^2)/(c + d*Tan[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] &&  !IntegerQ[m]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(a + b*ff*x)^m*((c + d*ff*x)^n/(1 + ff^2*x^2)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)/tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d^m*Int[(b + a*Cot[e + f*x])^m*(d*Cot[e + f*x])^(n - m), x] /; FreeQ[{a, b, d, e, f, n}, x] &&  !IntegerQ[n] && IntegerQ[m]
Int[((a_.) + (b_.)*cot[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)/cot[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d^m*Int[(b + a*Tan[e + f*x])^m*(d*Tan[e + f*x])^(n - m), x] /; FreeQ[{a, b, d, e, f, n}, x] &&  !IntegerQ[n] && IntegerQ[m]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_.)*((d_.)*tan[(e_.) + (f_.)*(x_)])^(p_))^(n_), x_Symbol] := c^IntPart[n]*((c*(d*Tan[e + f*x])^p)^FracPart[n]/(d*Tan[e + f*x])^(p*FracPart[n]))*Int[(a + b*Tan[e + f*x])^m*(d*Tan[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[n] &&  !IntegerQ[m]
Int[((a_.) + (b_.)*cot[(e_.) + (f_.)*(x_)])^(m_.)*((c_.)*((d_.)*cot[(e_.) + (f_.)*(x_)])^(p_))^(n_), x_Symbol] := c^IntPart[n]*((c*(d*Cot[e + f*x])^p)^FracPart[n]/(d*Cot[e + f*x])^(p*FracPart[n]))*Int[(a + b*Cot[e + f*x])^m*(d*Cot[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[n] &&  !IntegerQ[m]

(* ::Subsection::Closed:: *)
(* 4.2.2.3 (g tan)^p (a+b tan)^m (c+d tan)^n *)
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Unintegrable[(g*Tan[e + f*x])^p*(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x]
Int[((g_.)*cot[(e_.) + (f_.)*(x_)])^(p_)*((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := g^(m + n)*Int[(g*Cot[e + f*x])^(p - m - n)*(b + a*Cot[e + f*x])^m*(d + c*Cot[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] &&  !IntegerQ[p] && IntegerQ[m] && IntegerQ[n]
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_)*((a_.) + (b_.)*cot[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*cot[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := g^(m + n)*Int[(g*Tan[e + f*x])^(p - m - n)*(b + a*Tan[e + f*x])^m*(d + c*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] &&  !IntegerQ[p] && IntegerQ[m] && IntegerQ[n]
Int[((g_.)*tan[(e_.) + (f_.)*(x_)]^(q_))^(p_)*((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := ((g*Tan[e + f*x]^q)^p/(g*Tan[e + f*x])^(p*q))*Int[(g*Tan[e + f*x])^(p*q)*(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p, q}, x] &&  !IntegerQ[p] &&  !(IntegerQ[m] && IntegerQ[n])
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*cot[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := g^n*Int[(g*Tan[e + f*x])^(p - n)*(a + b*Tan[e + f*x])^m*(d + c*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, p}, x] && IntegerQ[n]
Int[tan[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*cot[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[(b + a*Cot[e + f*x])^m*((c + d*Cot[e + f*x])^n/Cot[e + f*x]^(m + p)), x] /; FreeQ[{a, b, c, d, e, f, n}, x] &&  !IntegerQ[n] && IntegerQ[m] && IntegerQ[p]
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*cot[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Cot[e + f*x]^p*(g*Tan[e + f*x])^p*Int[(b + a*Cot[e + f*x])^m*((c + d*Cot[e + f*x])^n/Cot[e + f*x]^(m + p)), x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] &&  !IntegerQ[n] && IntegerQ[m] &&  !IntegerQ[p]
Int[((g_.)*tan[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*cot[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (g*Tan[e + f*x])^n*((c + d*Cot[e + f*x])^n/(d + c*Tan[e + f*x])^n)*Int[(g*Tan[e + f*x])^(p - n)*(a + b*Tan[e + f*x])^m*(d + c*Tan[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] &&  !IntegerQ[n] &&  !IntegerQ[m]

(* ::Subsection::Closed:: *)
(* 4.2.3.1 (a+b tan)^m (c+d tan)^n (A+B tan) *)
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := a*(c/f)*Subst[Int[(a + b*x)^(m - 1)*(c + d*x)^(n - 1)*(A + B*x), x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 + b^2, 0]
Int[((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])*(((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)])/((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := B*(d/b)*Int[Tan[e + f*x], x] + (1/b)*Int[Simp[A*b*c + (A*b*d + B*(b*c - a*d))*Tan[e + f*x], x]/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(A*b - a*B))*(a*c + b*d)*((a + b*Tan[e + f*x])^m/(2*a^2*f*m)) + (1/(2*a*b))*Int[(a + b*Tan[e + f*x])^(m + 1)*Simp[A*b*c + a*B*c + a*A*d + b*B*d + 2*a*B*d*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && LtQ[m, -1] && EqQ[a^2 + b^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (b*c - a*d)*(A*b - a*B)*((a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 + b^2))) + (1/(a^2 + b^2))*Int[(a + b*Tan[e + f*x])^(m + 1)*Simp[a*A*c + b*B*c + A*b*d - a*B*d - (A*b*c - a*B*c - a*A*d - b*B*d)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && LtQ[m, -1] && NeQ[a^2 + b^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := B*d*((a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1))) + Int[(a + b*Tan[e + f*x])^m*Simp[A*c - B*d + (B*c + A*d)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] &&  !LeQ[m, -1]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (-a^2)*(B*c - A*d)*(a + b*Tan[e + f*x])^(m - 1)*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(b*c + a*d)*(n + 1))) - (a/(d*(b*c + a*d)*(n + 1)))*Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1)*Simp[A*b*d*(m - n - 2) - B*(b*c*(m - 1) + a*d*(n + 1)) + (a*A*d*(m + n) - B*(a*c*(m - 1) + b*d*(n + 1)))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && GtQ[m, 1] && LtQ[n, -1]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := b*B*(a + b*Tan[e + f*x])^(m - 1)*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n))) + (1/(d*(m + n)))*Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^n*Simp[a*A*d*(m + n) + B*(a*c*(m - 1) - b*d*(n + 1)) - (B*(b*c - a*d)*(m - 1) - d*(A*b + a*B)*(m + n))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && GtQ[m, 1] &&  !LtQ[n, -1]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(A*b - a*B))*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^n/(2*a*f*m)) + (1/(2*a^2*m))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 1)*Simp[A*(a*c*m + b*d*n) - B*(b*c*m + a*d*n) - d*(b*B*(m - n) - a*A*(m + n))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && LtQ[m, 0] && GtQ[n, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (a*A + b*B)*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(2*f*m*(b*c - a*d))) + (1/(2*a*m*(b*c - a*d)))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n*Simp[A*(b*c*m - a*d*(2*m + n + 1)) + B*(a*c*m - b*d*(n + 1)) + d*(A*b - a*B)*(m + n + 1)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && LtQ[m, 0] &&  !GtQ[n, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := B*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^n/(f*(m + n))) + (1/(a*(m + n)))*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n - 1)*Simp[a*A*c*(m + n) - B*(b*c*m + a*d*n) + (a*A*d*(m + n) - B*(b*d*m - a*c*n))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && GtQ[n, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (A*d - B*c)*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(f*(n + 1)*(c^2 + d^2))) - (1/(a*(n + 1)*(c^2 + d^2)))*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n + 1)*Simp[A*(b*d*m - a*c*(n + 1)) - B*(b*c*m + a*d*(n + 1)) - a*(B*c - A*d)*(m + n + 1)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && LtQ[n, -1]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := b*(B/f)*Subst[Int[(a + b*x)^(m - 1)*(c + d*x)^n, x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && EqQ[A*b + a*B, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*(((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)])/((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := ((A*b + a*B)/(b*c + a*d))*Int[(a + b*Tan[e + f*x])^m, x] - ((B*c - A*d)/(b*c + a*d))*Int[(a + b*Tan[e + f*x])^m*((a - b*Tan[e + f*x])/(c + d*Tan[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, A, B, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[A*b + a*B, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := ((A*b + a*B)/b)*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n, x] - (B/b)*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n*(a - b*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && NeQ[A*b + a*B, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (A^2/f)*Subst[Int[(a + b*x)^m*((c + d*x)^n/(A - B*x)), x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] &&  !IntegerQ[m] &&  !IntegerQ[n] &&  !IntegersQ[2*m, 2*n] && EqQ[A^2 + B^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := ((A + I*B)/2)*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n*(1 - I*Tan[e + f*x]), x] + ((A - I*B)/2)*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n*(1 + I*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] &&  !IntegerQ[m] &&  !IntegerQ[n] &&  !IntegersQ[2*m, 2*n] && NeQ[A^2 + B^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (b*c - a*d)*(B*c - A*d)*(a + b*Tan[e + f*x])^(m - 1)*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2))) - (1/(d*(n + 1)*(c^2 + d^2)))*Int[(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^(n + 1)*Simp[a*A*d*(b*d*(m - 1) - a*c*(n + 1)) + (b*B*c - (A*b + a*B)*d)*(b*c*(m - 1) + a*d*(n + 1)) - d*((a*A - b*B)*(b*c - a*d) + (A*b + a*B)*(a*c + b*d))*(n + 1)*Tan[e + f*x] - b*(d*(A*b*c + a*B*c - a*A*d)*(m + n) - b*B*(c^2*(m - 1) - d^2*(n + 1)))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 1] && LtQ[n, -1] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := b*B*(a + b*Tan[e + f*x])^(m - 1)*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n))) + (1/(d*(m + n)))*Int[(a + b*Tan[e + f*x])^(m - 2)*(c + d*Tan[e + f*x])^n*Simp[a^2*A*d*(m + n) - b*B*(b*c*(m - 1) + a*d*(n + 1)) + d*(m + n)*(2*a*A*b + B*(a^2 - b^2))*Tan[e + f*x] - (b*B*(b*c - a*d)*(m - 1) - b*(A*b + a*B)*d*(m + n))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 1] && (IntegerQ[m] || IntegersQ[2*m, 2*n]) &&  !(IGtQ[n, 1] && ( !IntegerQ[m] || (EqQ[c, 0] && NeQ[a, 0])))
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (A*b - a*B)*(a + b*Tan[e + f*x])^(m + 1)*((c + d*Tan[e + f*x])^n/(f*(m + 1)*(a^2 + b^2))) + (1/(b*(m + 1)*(a^2 + b^2)))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^(n - 1)*Simp[b*B*(b*c*(m + 1) + a*d*n) + A*b*(a*c*(m + 1) - b*d*n) - b*(A*(b*c - a*d) - B*(a*c + b*d))*(m + 1)*Tan[e + f*x] - b*d*(A*b - a*B)*(m + n + 1)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] && LtQ[0, n, 1] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := b*(A*b - a*B)*(a + b*Tan[e + f*x])^(m + 1)*((c + d*Tan[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 + b^2))) + (1/((m + 1)*(b*c - a*d)*(a^2 + b^2)))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n*Simp[b*B*(b*c*(m + 1) + a*d*(n + 1)) + A*(a*(b*c - a*d)*(m + 1) - b^2*d*(m + n + 2)) - (A*b - a*B)*(b*c - a*d)*(m + 1)*Tan[e + f*x] - b*d*(A*b - a*B)*(m + n + 2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] && (IntegerQ[m] || IntegersQ[2*m, 2*n]) &&  !(ILtQ[n, -1] && ( !IntegerQ[m] || (EqQ[c, 0] && NeQ[a, 0])))
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := B*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^n/(f*(m + n))) + (1/(m + n))*Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n - 1)*Simp[a*A*c*(m + n) - B*(b*c*m + a*d*n) + (A*b*c + a*B*c + a*A*d - b*B*d)*(m + n)*Tan[e + f*x] + (A*b*d*(m + n) + B*(a*d*m + b*c*n))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[0, m, 1] && LtQ[0, n, 1]
Int[((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)])/(((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := (B*(b*c + a*d) + A*(a*c - b*d))*(x/((a^2 + b^2)*(c^2 + d^2))) + b*((A*b - a*B)/((b*c - a*d)*(a^2 + b^2)))*Int[(b - a*Tan[e + f*x])/(a + b*Tan[e + f*x]), x] + d*((B*c - A*d)/((b*c - a*d)*(c^2 + d^2)))*Int[(d - c*Tan[e + f*x])/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[Sqrt[(c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]]*(((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)])/((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/(a^2 + b^2))*Int[Simp[A*(a*c + b*d) + B*(b*c - a*d) - (A*(b*c - a*d) - B*(a*c + b*d))*Tan[e + f*x], x]/Sqrt[c + d*Tan[e + f*x]], x] - (b*c - a*d)*((B*a - A*b)/(a^2 + b^2))*Int[(1 + Tan[e + f*x]^2)/((a + b*Tan[e + f*x])*Sqrt[c + d*Tan[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*(((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)])/((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/(a^2 + b^2))*Int[(c + d*Tan[e + f*x])^n*Simp[a*A + b*B - (A*b - a*B)*Tan[e + f*x], x], x] + b*((A*b - a*B)/(a^2 + b^2))*Int[(c + d*Tan[e + f*x])^n*((1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, A, B, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[Sqrt[(a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)]]*(((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)])/Sqrt[(c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)]]), x_Symbol] := Int[Simp[a*A - b*B + (A*b + a*B)*Tan[e + f*x], x]/(Sqrt[a + b*Tan[e + f*x]]*Sqrt[c + d*Tan[e + f*x]]), x] + b*B*Int[(1 + Tan[e + f*x]^2)/(Sqrt[a + b*Tan[e + f*x]]*Sqrt[c + d*Tan[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (A^2/f)*Subst[Int[(a + b*x)^m*((c + d*x)^n/(A - B*x)), x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && EqQ[A^2 + B^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := ((A + I*B)/2)*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n*(1 - I*Tan[e + f*x]), x] + ((A - I*B)/2)*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n*(1 + I*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[A^2 + B^2, 0]

(* ::Subsection::Closed:: *)
(* 4.2.4.1 (a+b tan)^m (A+B tan+C tan^2) *)
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((A_) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A/(b*f))*Subst[Int[(a + x)^m, x], x, b*Tan[e + f*x]] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A, C]
Int[((a_.) + (b_.)*cot[(e_.) + (f_.)*(x_)])^(m_.)*((A_) + (C_.)*cot[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(A/(b*f)))*Subst[Int[(a + x)^m, x], x, b*Cot[e + f*x]] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A, C]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (1/b^2)*Int[(a + b*Tan[e + f*x])^(m + 1)*Simp[b*B - a*C + b*C*Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[A*b^2 - a*b*B + a^2*C, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(C/b^2))*Int[(a + b*Tan[e + f*x])^(m + 1)*(a - b*Tan[e + f*x]), x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A*b^2 + a^2*C, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(a*A + b*B - a*C))*Tan[e + f*x]*((a + b*Tan[e + f*x])^m/(2*a*f*m)) + (1/(2*a^2*m))*Int[(a + b*Tan[e + f*x])^(m + 1)*Simp[(b*B - a*C) + a*A*(2*m + 1) - (b*C*(m - 1) + (A*b - a*B)*(m + 1))*Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[A*b^2 - a*b*B + a^2*C, 0] && LeQ[m, -1] && EqQ[a^2 + b^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(a*A - a*C))*Tan[e + f*x]*((a + b*Tan[e + f*x])^m/(2*a*f*m)) + (1/(2*a^2*m))*Int[(a + b*Tan[e + f*x])^(m + 1)*Simp[(-a)*C + a*A*(2*m + 1) - (b*C*(m - 1) + A*b*(m + 1))*Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[A*b^2 + a^2*C, 0] && LeQ[m, -1] && EqQ[a^2 + b^2, 0]
Int[((A_) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2)/((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (a*A + b*B - a*C)*(x/(a^2 + b^2)) + ((A*b^2 - a*b*B + a^2*C)/(a^2 + b^2))*Int[(1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[a^2 + b^2, 0] && EqQ[A*b - a*B - b*C, 0]
Int[((A_) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2)/tan[(e_.) + (f_.)*(x_)], x_Symbol] := B*x + A*Int[1/Tan[e + f*x], x] + C*Int[Tan[e + f*x], x] /; FreeQ[{e, f, A, B, C}, x] && NeQ[A, C]
Int[((A_) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2)/tan[(e_.) + (f_.)*(x_)], x_Symbol] := A*Int[1/Tan[e + f*x], x] + C*Int[Tan[e + f*x], x] /; FreeQ[{e, f, A, C}, x] && NeQ[A, C]
Int[((A_) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2)/((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := (a*A + b*B - a*C)*(x/(a^2 + b^2)) - ((A*b - a*B - b*C)/(a^2 + b^2))*Int[Tan[e + f*x], x] + ((A*b^2 - a*b*B + a^2*C)/(a^2 + b^2))*Int[(1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[A*b^2 - a*b*B + a^2*C, 0] && NeQ[a^2 + b^2, 0] && NeQ[A*b - a*B - b*C, 0]
Int[((A_) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2)/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]), x_Symbol] := a*(A - C)*(x/(a^2 + b^2)) - b*((A - C)/(a^2 + b^2))*Int[Tan[e + f*x], x] + ((a^2*C + A*b^2)/(a^2 + b^2))*Int[(1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x]), x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[a^2*C + A*b^2, 0] && NeQ[a^2 + b^2, 0] && NeQ[A, C]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A*b^2 - a*b*B + a^2*C)*((a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 + b^2))) + (1/(a^2 + b^2))*Int[(a + b*Tan[e + f*x])^(m + 1)*Simp[b*B + a*(A - C) - (A*b - a*B - b*C)*Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[A*b^2 - a*b*B + a^2*C, 0] && LtQ[m, -1] && NeQ[a^2 + b^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A*b^2 + a^2*C)*((a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 + b^2))) + (1/(a^2 + b^2))*Int[(a + b*Tan[e + f*x])^(m + 1)*Simp[a*(A - C) - (A*b - b*C)*Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[A*b^2 + a^2*C, 0] && LtQ[m, -1] && NeQ[a^2 + b^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := C*((a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1))) + Int[(a + b*Tan[e + f*x])^m*Simp[A - C + B*Tan[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && NeQ[A*b^2 - a*b*B + a^2*C, 0] &&  !LeQ[m, -1]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := C*((a + b*Tan[e + f*x])^(m + 1)/(b*f*(m + 1))) + (A - C)*Int[(a + b*Tan[e + f*x])^m, x] /; FreeQ[{a, b, e, f, A, C, m}, x] && NeQ[A*b^2 + a^2*C, 0] &&  !LeQ[m, -1]

(* ::Subsection::Closed:: *)
(* 4.2.4.2 (a+b tan)^m (c+d tan)^n (A+B tan+C tan^2) *)
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_.)*((A_) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A/f)*Subst[Int[(a + b*x)^m*(c + d*x)^n, x], x, Tan[e + f*x]] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && EqQ[A, C]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(b*c - a*d))*(c^2*C - B*c*d + A*d^2)*((c + d*Tan[e + f*x])^(n + 1)/(d^2*f*(n + 1)*(c^2 + d^2))) + (1/(d*(c^2 + d^2)))*Int[(c + d*Tan[e + f*x])^(n + 1)*Simp[a*d*(A*c - c*C + B*d) + b*(c^2*C - B*c*d + A*d^2) + d*(A*b*c + a*B*c - b*c*C - a*A*d + b*B*d + a*C*d)*Tan[e + f*x] + b*C*(c^2 + d^2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[c^2 + d^2, 0] && LtQ[n, -1]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(b*c - a*d))*(c^2*C + A*d^2)*((c + d*Tan[e + f*x])^(n + 1)/(d^2*f*(n + 1)*(c^2 + d^2))) + (1/(d*(c^2 + d^2)))*Int[(c + d*Tan[e + f*x])^(n + 1)*Simp[a*d*(A*c - c*C) + b*(c^2*C + A*d^2) + d*(A*b*c - b*c*C - a*A*d + a*C*d)*Tan[e + f*x] + b*C*(c^2 + d^2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[c^2 + d^2, 0] && LtQ[n, -1]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := b*C*Tan[e + f*x]*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 2))) - (1/(d*(n + 2)))*Int[(c + d*Tan[e + f*x])^n*Simp[b*c*C - a*A*d*(n + 2) - (A*b + a*B - b*C)*d*(n + 2)*Tan[e + f*x] - (a*C*d*(n + 2) - b*(c*C - B*d*(n + 2)))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[c^2 + d^2, 0] &&  !LtQ[n, -1]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := b*C*Tan[e + f*x]*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 2))) - (1/(d*(n + 2)))*Int[(c + d*Tan[e + f*x])^n*Simp[b*c*C - a*A*d*(n + 2) - (A*b - b*C)*d*(n + 2)*Tan[e + f*x] - (a*C*d*(n + 2) - b*c*C)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[c^2 + d^2, 0] &&  !LtQ[n, -1]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (a*A + b*B - a*C)*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(2*f*m*(b*c - a*d))) + (1/(2*a*m*(b*c - a*d)))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n*Simp[b*(c*(A + C)*m - B*d*(n + 1)) + a*(B*c*m + C*d*(n + 1) - A*d*(2*m + n + 1)) + (b*C*d*(m - n - 1) + A*b*d*(m + n + 1) + a*(2*c*C*m - B*d*(m + n + 1)))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && (LtQ[m, 0] || EqQ[m + n + 1, 0])
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := a*(A - C)*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(2*f*m*(b*c - a*d))) + (1/(2*a*m*(b*c - a*d)))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n*Simp[b*c*(A + C)*m + a*(C*d*(n + 1) - A*d*(2*m + n + 1)) + (b*C*d*(m - n - 1) + A*b*d*(m + n + 1) + 2*a*c*C*m)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] && (LtQ[m, 0] || EqQ[m + n + 1, 0])
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (c^2*C - B*c*d + A*d^2)*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2))) - (1/(a*d*(n + 1)*(c^2 + d^2)))*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n + 1)*Simp[b*(c^2*C - B*c*d + A*d^2)*m - a*d*(n + 1)*(A*c - c*C + B*d) - a*(d*(B*c - A*d)*(m + n + 1) - C*(c^2*m - d^2*(n + 1)))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] &&  !LtQ[m, 0] && LtQ[n, -1] && NeQ[c^2 + d^2, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (c^2*C + A*d^2)*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2))) - (1/(a*d*(n + 1)*(c^2 + d^2)))*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^(n + 1)*Simp[b*(c^2*C + A*d^2)*m - a*d*(n + 1)*(A*c - c*C) - a*((-A)*d^2*(m + n + 1) - C*(c^2*m - d^2*(n + 1)))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] &&  !LtQ[m, 0] && LtQ[n, -1] && NeQ[c^2 + d^2, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := C*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n + 1))) + (1/(b*d*(m + n + 1)))*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n*Simp[A*b*d*(m + n + 1) + C*(a*c*m - b*d*(n + 1)) - (C*m*(b*c - a*d) - b*B*d*(m + n + 1))*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] &&  !LtQ[m, 0] && NeQ[m + n + 1, 0]
Int[((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := C*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n + 1))) + (1/(b*d*(m + n + 1)))*Int[(a + b*Tan[e + f*x])^m*(c + d*Tan[e + f*x])^n*Simp[A*b*d*(m + n + 1) + C*(a*c*m - b*d*(n + 1)) - C*m*(b*c - a*d)*Tan[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 + b^2, 0] &&  !LtQ[m, 0] && NeQ[m + n + 1, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A*d^2 + c*(c*C - B*d))*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2))) - (1/(d*(n + 1)*(c^2 + d^2)))*Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1)*Simp[A*d*(b*d*m - a*c*(n + 1)) + (c*C - B*d)*(b*c*m + a*d*(n + 1)) - d*(n + 1)*((A - C)*(b*c - a*d) + B*(a*c + b*d))*Tan[e + f*x] - b*(d*(B*c - A*d)*(m + n + 1) - C*(c^2*m - d^2*(n + 1)))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 0] && LtQ[n, -1]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A*d^2 + c^2*C)*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(n + 1)*(c^2 + d^2))) - (1/(d*(n + 1)*(c^2 + d^2)))*Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^(n + 1)*Simp[A*d*(b*d*m - a*c*(n + 1)) + c*C*(b*c*m + a*d*(n + 1)) - d*(n + 1)*((A - C)*(b*c - a*d))*Tan[e + f*x] + b*(A*d^2*(m + n + 1) + C*(c^2*m - d^2*(n + 1)))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 0] && LtQ[n, -1]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := C*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n + 1))) + (1/(d*(m + n + 1)))*Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^n*Simp[a*A*d*(m + n + 1) - C*(b*c*m + a*d*(n + 1)) + d*(A*b + a*B - b*C)*(m + n + 1)*Tan[e + f*x] - (C*m*(b*c - a*d) - b*B*d*(m + n + 1))*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 0] &&  !(IGtQ[n, 0] && ( !IntegerQ[m] || (EqQ[c, 0] && NeQ[a, 0])))
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := C*(a + b*Tan[e + f*x])^m*((c + d*Tan[e + f*x])^(n + 1)/(d*f*(m + n + 1))) + (1/(d*(m + n + 1)))*Int[(a + b*Tan[e + f*x])^(m - 1)*(c + d*Tan[e + f*x])^n*Simp[a*A*d*(m + n + 1) - C*(b*c*m + a*d*(n + 1)) + d*(A*b - b*C)*(m + n + 1)*Tan[e + f*x] - C*m*(b*c - a*d)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && GtQ[m, 0] &&  !(IGtQ[n, 0] && ( !IntegerQ[m] || (EqQ[c, 0] && NeQ[a, 0])))
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A*b^2 - a*(b*B - a*C))*(a + b*Tan[e + f*x])^(m + 1)*((c + d*Tan[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 + b^2))) + (1/((m + 1)*(b*c - a*d)*(a^2 + b^2)))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n*Simp[A*(a*(b*c - a*d)*(m + 1) - b^2*d*(m + n + 2)) + (b*B - a*C)*(b*c*(m + 1) + a*d*(n + 1)) - (m + 1)*(b*c - a*d)*(A*b - a*B - b*C)*Tan[e + f*x] - d*(A*b^2 - a*(b*B - a*C))*(m + n + 2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] &&  !(ILtQ[n, -1] && ( !IntegerQ[m] || (EqQ[c, 0] && NeQ[a, 0])))
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A*b^2 + a^2*C)*(a + b*Tan[e + f*x])^(m + 1)*((c + d*Tan[e + f*x])^(n + 1)/(f*(m + 1)*(b*c - a*d)*(a^2 + b^2))) + (1/((m + 1)*(b*c - a*d)*(a^2 + b^2)))*Int[(a + b*Tan[e + f*x])^(m + 1)*(c + d*Tan[e + f*x])^n*Simp[A*(a*(b*c - a*d)*(m + 1) - b^2*d*(m + n + 2)) - a*C*(b*c*(m + 1) + a*d*(n + 1)) - (m + 1)*(b*c - a*d)*(A*b - b*C)*Tan[e + f*x] - d*(A*b^2 + a^2*C)*(m + n + 2)*Tan[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] && LtQ[m, -1] &&  !(ILtQ[n, -1] && ( !IntegerQ[m] || (EqQ[c, 0] && NeQ[a, 0])))
Int[((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2)/(((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := (a*(A*c - c*C + B*d) + b*(B*c - A*d + C*d))*(x/((a^2 + b^2)*(c^2 + d^2))) + ((A*b^2 - a*b*B + a^2*C)/((b*c - a*d)*(a^2 + b^2)))*Int[(b - a*Tan[e + f*x])/(a + b*Tan[e + f*x]), x] - ((c^2*C - B*c*d + A*d^2)/((b*c - a*d)*(c^2 + d^2)))*Int[(d - c*Tan[e + f*x])/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2)/(((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)])*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := (a*(A*c - c*C) - b*(A*d - C*d))*(x/((a^2 + b^2)*(c^2 + d^2))) + ((A*b^2 + a^2*C)/((b*c - a*d)*(a^2 + b^2)))*Int[(b - a*Tan[e + f*x])/(a + b*Tan[e + f*x]), x] - ((c^2*C + A*d^2)/((b*c - a*d)*(c^2 + d^2)))*Int[(d - c*Tan[e + f*x])/(c + d*Tan[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f, A, C}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*(((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2)/((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/(a^2 + b^2))*Int[(c + d*Tan[e + f*x])^n*Simp[b*B + a*(A - C) + (a*B - b*(A - C))*Tan[e + f*x], x], x] + ((A*b^2 - a*b*B + a^2*C)/(a^2 + b^2))*Int[(c + d*Tan[e + f*x])^n*((1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] &&  !GtQ[n, 0] &&  !LeQ[n, -1]
Int[((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*(((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2)/((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/(a^2 + b^2))*Int[(c + d*Tan[e + f*x])^n*Simp[a*(A - C) - (A*b - b*C)*Tan[e + f*x], x], x] + ((A*b^2 + a^2*C)/(a^2 + b^2))*Int[(c + d*Tan[e + f*x])^n*((1 + Tan[e + f*x]^2)/(a + b*Tan[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, A, C, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0] &&  !GtQ[n, 0] &&  !LeQ[n, -1]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*tan[(e_.) + (f_.)*(x_)] + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(a + b*ff*x)^m*(c + d*ff*x)^n*((A + B*ff*x + C*ff^2*x^2)/(1 + ff^2*x^2)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]
Int[((a_.) + (b_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*tan[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(a + b*ff*x)^m*(c + d*ff*x)^n*((A + C*ff^2*x^2)/(1 + ff^2*x^2)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, c, d, e, f, A, C, m, n}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 + b^2, 0] && NeQ[c^2 + d^2, 0]

(* ::Subsection::Closed:: *)
(* 4.2.7 (d trig)^m (a+b (c tan)^n)^p *)
Int[(u_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := Int[ActivateTrig[u*(a*sec[e + f*x]^2)^p], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a, b]
Int[(u_.)*((b_.)*tan[(e_.) + (f_.)*(x_)]^(n_))^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (b*ff^n)^IntPart[p]*((b*Tan[e + f*x]^n)^FracPart[p]/(Tan[e + f*x]/ff)^(n*FracPart[p]))*Int[ActivateTrig[u]*(Tan[e + f*x]/ff)^(n*p), x]] /; FreeQ[{b, e, f, n, p}, x] &&  !IntegerQ[p] && IntegerQ[n] && (EqQ[u, 1] || MatchQ[u, ((d_.)*(trig_)[e + f*x])^(m_.) /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[(u_.)*((b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := b^IntPart[p]*((b*(c*Tan[e + f*x])^n)^FracPart[p]/(c*Tan[e + f*x])^(n*FracPart[p]))*Int[ActivateTrig[u]*(c*Tan[e + f*x])^(n*p), x] /; FreeQ[{b, c, e, f, n, p}, x] &&  !IntegerQ[p] &&  !IntegerQ[n] && (EqQ[u, 1] || MatchQ[u, ((d_.)*(trig_)[e + f*x])^(m_.) /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[1/((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]^2), x_Symbol] := x/(a - b) - (b/(a - b))*Int[Sec[e + f*x]^2/(a + b*Tan[e + f*x]^2), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a, b]
Int[((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, c*(ff/f)*Subst[Int[(a + b*(ff*x)^n)^p/(c^2 + ff^2*x^2), x], x, c*(Tan[e + f*x]/ff)]] /; FreeQ[{a, b, c, e, f, n, p}, x] && (IntegersQ[n, p] || IGtQ[p, 0] || EqQ[n^2, 4] || EqQ[n^2, 16])
Int[((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Unintegrable[(a + b*(c*Tan[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, e, f, n, p}, x]
Int[sin[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, c*(ff^(m + 1)/f)*Subst[Int[x^m*((a + b*(ff*x)^n)^p/(c^2 + ff^2*x^2)^(m/2 + 1)), x], x, c*(Tan[e + f*x]/ff)]] /; FreeQ[{a, b, c, e, f, n, p}, x] && IntegerQ[m/2]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Sec[e + f*x], x]}, (1/(f*ff^m))*Subst[Int[(-1 + ff^2*x^2)^((m - 1)/2)*((a - b + b*ff^2*x^2)^p/x^(m + 1)), x], x, Sec[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Sec[e + f*x], x]}, (1/(f*ff^m))*Subst[Int[(-1 + ff^2*x^2)^((m - 1)/2)*((a + b*(-1 + ff^2*x^2)^(n/2))^p/x^(m + 1)), x], x, Sec[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2]
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Int[ExpandTrig[(d*sin[e + f*x])^m*(a + b*(c*tan[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(d*Sin[e + f*x])^m*((Sec[e + f*x]^2)^(m/2)/(f*Tan[e + f*x]^m))*Subst[Int[(ff*x)^m*((a + b*ff^2*x^2)^p/(1 + ff^2*x^2)^(m/2 + 1)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] &&  !IntegerQ[m]
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Unintegrable[(d*Sin[e + f*x])^m*(a + b*(c*Tan[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[((d_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := (d*Cos[e + f*x])^FracPart[m]*(Sec[e + f*x]/d)^FracPart[m]*Int[(a + b*(c*Tan[e + f*x])^n)^p/(Sec[e + f*x]/d)^m, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[m]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, c*(ff/f)*Subst[Int[(d*ff*(x/c))^m*((a + b*(ff*x)^n)^p/(c^2 + ff^2*x^2)), x], x, c*(Tan[e + f*x]/ff)]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && (IGtQ[p, 0] || EqQ[n, 2] || EqQ[n, 4] || (IntegerQ[p] && RationalQ[n]))
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Int[ExpandTrig[(d*tan[e + f*x])^m*(a + b*(c*tan[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Unintegrable[(d*Tan[e + f*x])^m*(a + b*(c*Tan[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[((d_.)*cot[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]^(n_.))^(p_.), x_Symbol] := d^(n*p)*Int[(d*Cot[e + f*x])^(m - n*p)*(b + a*Cot[e + f*x]^n)^p, x] /; FreeQ[{a, b, d, e, f, m, n, p}, x] &&  !IntegerQ[m] && IntegersQ[n, p]
Int[((d_.)*cot[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := (d*Cot[e + f*x])^FracPart[m]*(Tan[e + f*x]/d)^FracPart[m]*Int[(a + b*(c*Tan[e + f*x])^n)^p/(Tan[e + f*x]/d)^m, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[m]
Int[sec[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/(c^(m - 1)*f))*Subst[Int[(c^2 + ff^2*x^2)^(m/2 - 1)*(a + b*(ff*x)^n)^p, x], x, c*(Tan[e + f*x]/ff)]] /; FreeQ[{a, b, c, e, f, n, p}, x] && IntegerQ[m/2] && (IntegersQ[n, p] || IGtQ[m, 0] || IGtQ[p, 0] || EqQ[n^2, 4] || EqQ[n^2, 16])
Int[sec[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (ff/f)*Subst[Int[ExpandToSum[b*(ff*x)^n + a*(1 - ff^2*x^2)^(n/2), x]^p/(1 - ff^2*x^2)^((m + n*p + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[sec[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (ff/f)*Subst[Int[(1/(1 - ff^2*x^2)^((m + 1)/2))*((b*(ff*x)^n + a*(1 - ff^2*x^2)^(n/2))/(1 - ff^2*x^2)^(n/2))^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] &&  !IntegerQ[p]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Int[ExpandTrig[(d*sec[e + f*x])^m*(a + b*(c*tan[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*tan[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*((d*Sec[e + f*x])^m/(f*(Sec[e + f*x]^2)^(m/2)))*Subst[Int[(1 + ff^2*x^2)^(m/2 - 1)*(a + b*ff^2*x^2)^p, x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] &&  !IntegerQ[m]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Unintegrable[(d*Sec[e + f*x])^m*(a + b*(c*Tan[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*((c_.)*tan[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := (d*Csc[e + f*x])^FracPart[m]*(Sin[e + f*x]/d)^FracPart[m]*Int[(a + b*(c*Tan[e + f*x])^n)^p/(Sin[e + f*x]/d)^m, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[m]

(* ::Subsection::Closed:: *)
(* 4.2.9 trig^m (a+b tan^n+c tan^(2 n))^p *)
Int[((a_) + (b_.)*tan[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*tan[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[((a_) + (b_.)*cot[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cot[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[((a_) + (b_.)*tan[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*tan[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Tan[d + e*x]^n + c*Tan[d + e*x]^(2*n))^p/(b + 2*c*Tan[d + e*x]^n)^(2*p))*Int[(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[((a_) + (b_.)*cot[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cot[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Cot[d + e*x]^n + c*Cot[d + e*x]^(2*n))^p/(b + 2*c*Cot[d + e*x]^n)^(2*p))*Int[(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[1/((a_.) + (b_.)*tan[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*tan[(d_.) + (e_.)*(x_)]^(n2_.)), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*(c/q)*Int[1/(b - q + 2*c*Tan[d + e*x]^n), x] - 2*(c/q)*Int[1/(b + q + 2*c*Tan[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[1/((a_.) + (b_.)*cot[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cot[(d_.) + (e_.)*(x_)]^(n2_.)), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*(c/q)*Int[1/(b - q + 2*c*Cot[d + e*x]^n), x] - 2*(c/q)*Int[1/(b + q + 2*c*Cot[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[sin[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*((f_.)*tan[(d_.) + (e_.)*(x_)])^(n_.) + (c_.)*((f_.)*tan[(d_.) + (e_.)*(x_)])^(n2_.))^(p_), x_Symbol] := (f/e)*Subst[Int[x^m*((a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1)), x], x, f*Tan[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[cos[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*((f_.)*cot[(d_.) + (e_.)*(x_)])^(n_.) + (c_.)*((f_.)*cot[(d_.) + (e_.)*(x_)])^(n2_.))^(p_), x_Symbol] := (-(f/e))*Subst[Int[x^m*((a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1)), x], x, f*Cot[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[sin[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*tan[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*tan[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Module[{g = FreeFactors[Cos[d + e*x], x]}, (-(g/e))*Subst[Int[(1 - g^2*x^2)^((m - 1)/2)*(ExpandToSum[a*(g*x)^(2*n) + b*(g*x)^n*(1 - g^2*x^2)^(n/2) + c*(1 - g^2*x^2)^n, x]^p/(g*x)^(2*n*p)), x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cot[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*tan[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Module[{g = FreeFactors[Sin[d + e*x], x]}, (g/e)*Subst[Int[(1 - g^2*x^2)^((m - 1)/2)*(ExpandToSum[a*(g*x)^(2*n) + b*(g*x)^n*(1 - g^2*x^2)^(n/2) + c*(1 - g^2*x^2)^n, x]^p/(g*x)^(2*n*p)), x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*((f_.)*tan[(d_.) + (e_.)*(x_)])^(n_.) + (c_.)*((f_.)*tan[(d_.) + (e_.)*(x_)])^(n2_.))^(p_.), x_Symbol] := (f^(m + 1)/e)*Subst[Int[(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1), x], x, f*Tan[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[sin[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*((f_.)*cot[(d_.) + (e_.)*(x_)])^(n_.) + (c_.)*((f_.)*cot[(d_.) + (e_.)*(x_)])^(n2_.))^(p_.), x_Symbol] := (-(f^(m + 1)/e))*Subst[Int[(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1), x], x, f*Cot[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[cos[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*tan[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*tan[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Module[{g = FreeFactors[Sin[d + e*x], x]}, (g/e)*Subst[Int[(1 - g^2*x^2)^((m - 2*n*p - 1)/2)*ExpandToSum[c*x^(2*n) + b*x^n*(1 - x^2)^(n/2) + a*(1 - x^2)^n, x]^p, x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[sin[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*cot[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cot[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Module[{g = FreeFactors[Cos[d + e*x], x]}, (-(g/e))*Subst[Int[(1 - g^2*x^2)^((m - 2*n*p - 1)/2)*ExpandToSum[c*x^(2*n) + b*x^n*(1 - x^2)^(n/2) + a*(1 - x^2)^n, x]^p, x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*tan[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*tan[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := (1/(4^p*c^p))*Int[Tan[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cot[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cot[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := (1/(4^p*c^p))*Int[Cot[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*tan[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*tan[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Tan[d + e*x]^n + c*Tan[d + e*x]^(2*n))^p/(b + 2*c*Tan[d + e*x]^n)^(2*p))*Int[Tan[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cot[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cot[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Cot[d + e*x]^n + c*Cot[d + e*x]^(2*n))^p/(b + 2*c*Cot[d + e*x]^n)^(2*p))*Int[Cot[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*((f_.)*tan[(d_.) + (e_.)*(x_)])^(n_.) + (c_.)*((f_.)*tan[(d_.) + (e_.)*(x_)])^(n2_.))^(p_), x_Symbol] := (f/e)*Subst[Int[(x/f)^m*((a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)), x], x, f*Tan[d + e*x]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*((f_.)*cot[(d_.) + (e_.)*(x_)])^(n_.) + (c_.)*((f_.)*cot[(d_.) + (e_.)*(x_)])^(n2_.))^(p_), x_Symbol] := (-(f/e))*Subst[Int[(x/f)^m*((a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)), x], x, f*Cot[d + e*x]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*tan[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*tan[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[Cot[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cot[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cot[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[Tan[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*tan[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*tan[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Tan[d + e*x]^n + c*Tan[d + e*x]^(2*n))^p/(b + 2*c*Tan[d + e*x]^n)^(2*p))*Int[Cot[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cot[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*cot[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Cot[d + e*x]^n + c*Cot[d + e*x]^(2*n))^p/(b + 2*c*Cot[d + e*x]^n)^(2*p))*Int[Tan[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*tan[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*tan[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{g = FreeFactors[Cot[d + e*x], x]}, (g/e)*Subst[Int[(g*x)^(m - 2*n*p)*((c + b*(g*x)^n + a*(g*x)^(2*n))^p/(1 + g^2*x^2)), x], x, Cot[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, m, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*cot[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*cot[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{g = FreeFactors[Tan[d + e*x], x]}, (-(g/e))*Subst[Int[(g*x)^(m - 2*n*p)*((c + b*(g*x)^n + a*(g*x)^(2*n))^p/(1 + g^2*x^2)), x], x, Tan[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, m, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2]
Int[((A_) + (B_.)*tan[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*tan[(d_.) + (e_.)*(x_)] + (c_.)*tan[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := (1/(4^n*c^n))*Int[(A + B*Tan[d + e*x])*(b + 2*c*Tan[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[((A_) + (B_.)*cot[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cot[(d_.) + (e_.)*(x_)] + (c_.)*cot[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := (1/(4^n*c^n))*Int[(A + B*Cot[d + e*x])*(b + 2*c*Cot[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[((A_) + (B_.)*tan[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*tan[(d_.) + (e_.)*(x_)] + (c_.)*tan[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := ((a + b*Tan[d + e*x] + c*Tan[d + e*x]^2)^n/(b + 2*c*Tan[d + e*x])^(2*n))*Int[(A + B*Tan[d + e*x])*(b + 2*c*Tan[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[n]
Int[((A_) + (B_.)*cot[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*cot[(d_.) + (e_.)*(x_)] + (c_.)*cot[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := ((a + b*Cot[d + e*x] + c*Cot[d + e*x]^2)^n/(b + 2*c*Cot[d + e*x])^(2*n))*Int[(A + B*Cot[d + e*x])*(b + 2*c*Cot[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[n]
Int[((A_) + (B_.)*tan[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*tan[(d_.) + (e_.)*(x_)] + (c_.)*tan[(d_.) + (e_.)*(x_)]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/Simp[b + q + 2*c*Tan[d + e*x], x], x] + (B - (b*B - 2*A*c)/q)*Int[1/Simp[b - q + 2*c*Tan[d + e*x], x], x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[((A_) + (B_.)*cot[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*cot[(d_.) + (e_.)*(x_)] + (c_.)*cot[(d_.) + (e_.)*(x_)]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/Simp[b + q + 2*c*Cot[d + e*x], x], x] + (B - (b*B - 2*A*c)/q)*Int[1/Simp[b - q + 2*c*Cot[d + e*x], x], x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[((A_) + (B_.)*tan[(d_.) + (e_.)*(x_)])*((a_.) + (b_.)*tan[(d_.) + (e_.)*(x_)] + (c_.)*tan[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := Int[ExpandTrig[(A + B*tan[d + e*x])*(a + b*tan[d + e*x] + c*tan[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[((A_) + (B_.)*cot[(d_.) + (e_.)*(x_)])*((a_.) + (b_.)*cot[(d_.) + (e_.)*(x_)] + (c_.)*cot[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := Int[ExpandTrig[(A + B*cot[d + e*x])*(a + b*cot[d + e*x] + c*cot[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]

(* ::Subsection::Closed:: *)
(* 4.3.10 (c+d x)^m (a+b sec)^n *)
Int[((c_.) + (d_.)*(x_))^(m_.)*csc[(e_.) + (k_.)*Pi + (f_.)*(Complex[0, fz_])*(x_)], x_Symbol] := -2*(c + d*x)^m*(ArcTanh[E^((-I)*e + f*fz*x)/E^(I*k*Pi)]/(f*fz*I)) - d*(m/(f*fz*I))*Int[(c + d*x)^(m - 1)*Log[1 - E^((-I)*e + f*fz*x)/E^(I*k*Pi)], x] + d*(m/(f*fz*I))*Int[(c + d*x)^(m - 1)*Log[1 + E^((-I)*e + f*fz*x)/E^(I*k*Pi)], x] /; FreeQ[{c, d, e, f, fz}, x] && IntegerQ[2*k] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*csc[(e_.) + (k_.)*Pi + (f_.)*(x_)], x_Symbol] := -2*(c + d*x)^m*(ArcTanh[E^(I*k*Pi)*E^(I*(e + f*x))]/f) - d*(m/f)*Int[(c + d*x)^(m - 1)*Log[1 - E^(I*k*Pi)*E^(I*(e + f*x))], x] + d*(m/f)*Int[(c + d*x)^(m - 1)*Log[1 + E^(I*k*Pi)*E^(I*(e + f*x))], x] /; FreeQ[{c, d, e, f}, x] && IntegerQ[2*k] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*csc[(e_.) + (f_.)*(Complex[0, fz_])*(x_)], x_Symbol] := -2*(c + d*x)^m*(ArcTanh[E^((-I)*e + f*fz*x)]/(f*fz*I)) - d*(m/(f*fz*I))*Int[(c + d*x)^(m - 1)*Log[1 - E^((-I)*e + f*fz*x)], x] + d*(m/(f*fz*I))*Int[(c + d*x)^(m - 1)*Log[1 + E^((-I)*e + f*fz*x)], x] /; FreeQ[{c, d, e, f, fz}, x] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*csc[(e_.) + (f_.)*(x_)], x_Symbol] := -2*(c + d*x)^m*(ArcTanh[E^(I*(e + f*x))]/f) - d*(m/f)*Int[(c + d*x)^(m - 1)*Log[1 - E^(I*(e + f*x))], x] + d*(m/f)*Int[(c + d*x)^(m - 1)*Log[1 + E^(I*(e + f*x))], x] /; FreeQ[{c, d, e, f}, x] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*csc[(e_.) + (f_.)*(x_)]^2, x_Symbol] := (-(c + d*x)^m)*(Cot[e + f*x]/f) + d*(m/f)*Int[(c + d*x)^(m - 1)*Cot[e + f*x], x] /; FreeQ[{c, d, e, f}, x] && GtQ[m, 0]
Int[((c_.) + (d_.)*(x_))*((b_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b^2)*(c + d*x)*Cot[e + f*x]*((b*Csc[e + f*x])^(n - 2)/(f*(n - 1))) - b^2*d*((b*Csc[e + f*x])^(n - 2)/(f^2*(n - 1)*(n - 2))) + b^2*((n - 2)/(n - 1))*Int[(c + d*x)*(b*Csc[e + f*x])^(n - 2), x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1] && NeQ[n, 2]
Int[((c_.) + (d_.)*(x_))^(m_)*((b_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b^2)*(c + d*x)^m*Cot[e + f*x]*((b*Csc[e + f*x])^(n - 2)/(f*(n - 1))) - b^2*d*m*(c + d*x)^(m - 1)*((b*Csc[e + f*x])^(n - 2)/(f^2*(n - 1)*(n - 2))) + b^2*((n - 2)/(n - 1))*Int[(c + d*x)^m*(b*Csc[e + f*x])^(n - 2), x] + b^2*d^2*m*((m - 1)/(f^2*(n - 1)*(n - 2)))*Int[(c + d*x)^(m - 2)*(b*Csc[e + f*x])^(n - 2), x] /; FreeQ[{b, c, d, e, f}, x] && GtQ[n, 1] && NeQ[n, 2] && GtQ[m, 1]
Int[((c_.) + (d_.)*(x_))*((b_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d*((b*Csc[e + f*x])^n/(f^2*n^2)) + (c + d*x)*Cos[e + f*x]*((b*Csc[e + f*x])^(n + 1)/(b*f*n)) + ((n + 1)/(b^2*n))*Int[(c + d*x)*(b*Csc[e + f*x])^(n + 2), x] /; FreeQ[{b, c, d, e, f}, x] && LtQ[n, -1]
Int[((c_.) + (d_.)*(x_))^(m_)*((b_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d*m*(c + d*x)^(m - 1)*((b*Csc[e + f*x])^n/(f^2*n^2)) + (c + d*x)^m*Cos[e + f*x]*((b*Csc[e + f*x])^(n + 1)/(b*f*n)) + ((n + 1)/(b^2*n))*Int[(c + d*x)^m*(b*Csc[e + f*x])^(n + 2), x] - d^2*m*((m - 1)/(f^2*n^2))*Int[(c + d*x)^(m - 2)*(b*Csc[e + f*x])^n, x] /; FreeQ[{b, c, d, e, f}, x] && LtQ[n, -1] && GtQ[m, 1]
Int[((c_.) + (d_.)*(x_))^(m_.)*((b_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (b*Sin[e + f*x])^n*(b*Csc[e + f*x])^n*Int[(c + d*x)^m/(b*Sin[e + f*x])^n, x] /; FreeQ[{b, c, d, e, f, m, n}, x] &&  !IntegerQ[n]
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, (a + b*Csc[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[ExpandIntegrand[(c + d*x)^m, 1/(Sin[e + f*x]^n/(b + a*Sin[e + f*x])^n), x], x] /; FreeQ[{a, b, c, d, e, f}, x] && ILtQ[n, 0] && IGtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*csc[(e_.) + (f_.)*(x_)]^(n_.), x_Symbol] := If[MatchQ[f, (f1_.)*(Complex[0, j_])], If[MatchQ[e, (e1_.) + Pi/2], Unintegrable[(c + d*x)^m*Sech[I*(e - Pi/2) + I*f*x]^n, x], (-I)^n*Unintegrable[(c + d*x)^m*Csch[(-I)*e - I*f*x]^n, x]], If[MatchQ[e, (e1_.) + Pi/2], Unintegrable[(c + d*x)^m*Sec[e - Pi/2 + f*x]^n, x], Unintegrable[(c + d*x)^m*Csc[e + f*x]^n, x]]] /; FreeQ[{c, d, e, f, m, n}, x] && IntegerQ[n]
Int[((c_.) + (d_.)*(x_))^(m_.)*((a_.) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Unintegrable[(c + d*x)^m*(a + b*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[(u_)^(m_.)*((a_.) + (b_.)*Sec[v_])^(n_.), x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Sec[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] &&  !LinearMatchQ[{u, v}, x]
Int[(u_)^(m_.)*((a_.) + (b_.)*Csc[v_])^(n_.), x_Symbol] := Int[ExpandToSum[u, x]^m*(a + b*Csc[ExpandToSum[v, x]])^n, x] /; FreeQ[{a, b, m, n}, x] && LinearQ[{u, v}, x] &&  !LinearMatchQ[{u, v}, x]

(* ::Subsection::Closed:: *)
(* 4.3.1.1 (a+b sec)^n *)
Int[csc[(c_.) + (d_.)*(x_)]^(n_), x_Symbol] := (-d^(-1))*Subst[Int[ExpandIntegrand[(1 + x^2)^(n/2 - 1), x], x], x, Cot[c + d*x]] /; FreeQ[{c, d}, x] && IGtQ[n/2, 0]
Int[((b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-b)*Cos[c + d*x]*((b*Csc[c + d*x])^(n - 1)/(d*(n - 1))) + b^2*((n - 2)/(n - 1))*Int[(b*Csc[c + d*x])^(n - 2), x] /; FreeQ[{b, c, d}, x] && GtQ[n, 1] && IntegerQ[2*n]
Int[((b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Cos[c + d*x]*((b*Csc[c + d*x])^(n + 1)/(b*d*n)) + ((n + 1)/(b^2*n))*Int[(b*Csc[c + d*x])^(n + 2), x] /; FreeQ[{b, c, d}, x] && LtQ[n, -1] && IntegerQ[2*n]
Int[csc[(c_.) + (d_.)*(x_)], x_Symbol] := -(ArcTanh[Cos[c + d*x]]/d) /; FreeQ[{c, d}, x]
Int[((b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (b*Csc[c + d*x])^n*Sin[c + d*x]^n*Int[1/Sin[c + d*x]^n, x] /; FreeQ[{b, c, d}, x] && EqQ[n^2, 1/4]
Int[((b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (b*Csc[c + d*x])^(n - 1)*((Sin[c + d*x]/b)^(n - 1)*Int[1/(Sin[c + d*x]/b)^n, x]) /; FreeQ[{b, c, d, n}, x] &&  !IntegerQ[n]
Int[((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^2, x_Symbol] := a^2*x + 2*a*b*Int[Csc[c + d*x], x] + b^2*Int[Csc[c + d*x]^2, x] /; FreeQ[{a, b, c, d}, x]
Int[Sqrt[(a_) + (b_.)*csc[(c_.) + (d_.)*(x_)]], x_Symbol] := -2*(b/d)*Subst[Int[1/(a + x^2), x], x, b*(Cot[c + d*x]/Sqrt[a + b*Csc[c + d*x]])] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-b^2)*Cot[c + d*x]*((a + b*Csc[c + d*x])^(n - 2)/(d*(n - 1))) + (a/(n - 1))*Int[(a + b*Csc[c + d*x])^(n - 2)*(a*(n - 1) + b*(3*n - 4)*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0] && GtQ[n, 1] && IntegerQ[2*n]
Int[1/Sqrt[(a_) + (b_.)*csc[(c_.) + (d_.)*(x_)]], x_Symbol] := (1/a)*Int[Sqrt[a + b*Csc[c + d*x]], x] - (b/a)*Int[Csc[c + d*x]/Sqrt[a + b*Csc[c + d*x]], x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-Cot[c + d*x])*((a + b*Csc[c + d*x])^n/(d*(2*n + 1))) + (1/(a^2*(2*n + 1)))*Int[(a + b*Csc[c + d*x])^(n + 1)*(a*(2*n + 1) - b*(n + 1)*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0] && LeQ[n, -1] && IntegerQ[2*n]
Int[((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := a^n*(Cot[c + d*x]/(d*Sqrt[1 + Csc[c + d*x]]*Sqrt[1 - Csc[c + d*x]]))*Subst[Int[(1 + b*(x/a))^(n - 1/2)/(x*Sqrt[1 - b*(x/a)]), x], x, Csc[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[2*n] && GtQ[a, 0]
Int[((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := a^IntPart[n]*((a + b*Csc[c + d*x])^FracPart[n]/(1 + (b/a)*Csc[c + d*x])^FracPart[n])*Int[(1 + (b/a)*Csc[c + d*x])^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[2*n] &&  !GtQ[a, 0]
Int[Sqrt[(a_) + (b_.)*csc[(c_.) + (d_.)*(x_)]], x_Symbol] := 2*((a + b*Csc[c + d*x])/(d*Rt[a + b, 2]*Cot[c + d*x]))*Sqrt[b*((1 + Csc[c + d*x])/(a + b*Csc[c + d*x]))]*Sqrt[(-b)*((1 - Csc[c + d*x])/(a + b*Csc[c + d*x]))]*EllipticPi[a/(a + b), ArcSin[Rt[a + b, 2]/Sqrt[a + b*Csc[c + d*x]]], (a - b)/(a + b)] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(3/2), x_Symbol] := Int[(a^2 + b*(2*a - b)*Csc[c + d*x])/Sqrt[a + b*Csc[c + d*x]], x] + b^2*Int[Csc[c + d*x]*((1 + Csc[c + d*x])/Sqrt[a + b*Csc[c + d*x]]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-b^2)*Cot[c + d*x]*((a + b*Csc[c + d*x])^(n - 2)/(d*(n - 1))) + (1/(n - 1))*Int[(a + b*Csc[c + d*x])^(n - 3)*Simp[a^3*(n - 1) + (b*(b^2*(n - 2) + 3*a^2*(n - 1)))*Csc[c + d*x] + (a*b^2*(3*n - 4))*Csc[c + d*x]^2, x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 2] && IntegerQ[2*n]
Int[1/((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)]), x_Symbol] := x/a - (1/a)*Int[1/(1 + (a/b)*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[1/Sqrt[(a_) + (b_.)*csc[(c_.) + (d_.)*(x_)]], x_Symbol] := 2*(Rt[a + b, 2]/(a*d*Cot[c + d*x]))*Sqrt[b*((1 - Csc[c + d*x])/(a + b))]*Sqrt[(-b)*((1 + Csc[c + d*x])/(a - b))]*EllipticPi[(a + b)/a, ArcSin[Sqrt[a + b*Csc[c + d*x]]/Rt[a + b, 2]], (a + b)/(a - b)] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := b^2*Cot[c + d*x]*((a + b*Csc[c + d*x])^(n + 1)/(a*d*(n + 1)*(a^2 - b^2))) + (1/(a*(n + 1)*(a^2 - b^2)))*Int[(a + b*Csc[c + d*x])^(n + 1)*Simp[(a^2 - b^2)*(n + 1) - a*b*(n + 1)*Csc[c + d*x] + b^2*(n + 2)*Csc[c + d*x]^2, x], x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && LtQ[n, -1] && IntegerQ[2*n]
Int[((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Unintegrable[(a + b*Csc[c + d*x])^n, x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 - b^2, 0] &&  !IntegerQ[2*n]

(* ::Subsection::Closed:: *)
(* 4.3.11 (e x)^m (a+b sec(c+d x^n))^p *)
Int[((a_.) + (b_.)*Sec[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/n)*Subst[Int[x^(1/n - 1)*(a + b*Sec[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[((a_.) + (b_.)*Csc[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/n)*Subst[Int[x^(1/n - 1)*(a + b*Csc[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, p}, x] && IGtQ[1/n, 0] && IntegerQ[p]
Int[((a_.) + (b_.)*Sec[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Unintegrable[(a + b*Sec[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[((a_.) + (b_.)*Csc[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Unintegrable[(a + b*Csc[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, n, p}, x]
Int[((a_.) + (b_.)*Sec[(c_.) + (d_.)*(u_)^(n_)])^(p_.), x_Symbol] := (1/Coefficient[u, x, 1])*Subst[Int[(a + b*Sec[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[((a_.) + (b_.)*Csc[(c_.) + (d_.)*(u_)^(n_)])^(p_.), x_Symbol] := (1/Coefficient[u, x, 1])*Subst[Int[(a + b*Csc[c + d*x^n])^p, x], x, u] /; FreeQ[{a, b, c, d, n, p}, x] && LinearQ[u, x] && NeQ[u, x]
Int[((a_.) + (b_.)*Sec[u_])^(p_.), x_Symbol] := Int[(a + b*Sec[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[((a_.) + (b_.)*Csc[u_])^(p_.), x_Symbol] := Int[(a + b*Csc[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[(x_)^(m_.)*((a_.) + (b_.)*Sec[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/n)*Subst[Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Sec[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[(x_)^(m_.)*((a_.) + (b_.)*Csc[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := (1/n)*Subst[Int[x^(Simplify[(m + 1)/n] - 1)*(a + b*Csc[c + d*x])^p, x], x, x^n] /; FreeQ[{a, b, c, d, m, n, p}, x] && IGtQ[Simplify[(m + 1)/n], 0] && IntegerQ[p]
Int[(x_)^(m_.)*((a_.) + (b_.)*Sec[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Unintegrable[x^m*(a + b*Sec[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[(x_)^(m_.)*((a_.) + (b_.)*Csc[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := Unintegrable[x^m*(a + b*Csc[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, m, n, p}, x]
Int[((e_)*(x_))^(m_.)*((a_.) + (b_.)*Sec[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := e^IntPart[m]*((e*x)^FracPart[m]/x^FracPart[m])*Int[x^m*(a + b*Sec[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[((e_)*(x_))^(m_.)*((a_.) + (b_.)*Csc[(c_.) + (d_.)*(x_)^(n_)])^(p_.), x_Symbol] := e^IntPart[m]*((e*x)^FracPart[m]/x^FracPart[m])*Int[x^m*(a + b*Csc[c + d*x^n])^p, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x]
Int[((e_)*(x_))^(m_.)*((a_.) + (b_.)*Sec[u_])^(p_.), x_Symbol] := Int[(e*x)^m*(a + b*Sec[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[((e_)*(x_))^(m_.)*((a_.) + (b_.)*Csc[u_])^(p_.), x_Symbol] := Int[(e*x)^m*(a + b*Csc[ExpandToSum[u, x]])^p, x] /; FreeQ[{a, b, e, m, p}, x] && BinomialQ[u, x] &&  !BinomialMatchQ[u, x]
Int[(x_)^(m_.)*Sec[(a_.) + (b_.)*(x_)^(n_.)]^(p_)*Sin[(a_.) + (b_.)*(x_)^(n_.)], x_Symbol] := x^(m - n + 1)*(Sec[a + b*x^n]^(p - 1)/(b*n*(p - 1))) - ((m - n + 1)/(b*n*(p - 1)))*Int[x^(m - n)*Sec[a + b*x^n]^(p - 1), x] /; FreeQ[{a, b, p}, x] && IntegerQ[n] && GeQ[m - n, 0] && NeQ[p, 1]
Int[(x_)^(m_.)*Csc[(a_.) + (b_.)*(x_)^(n_.)]^(p_)*Cos[(a_.) + (b_.)*(x_)^(n_.)], x_Symbol] := (-x^(m - n + 1))*(Csc[a + b*x^n]^(p - 1)/(b*n*(p - 1))) + ((m - n + 1)/(b*n*(p - 1)))*Int[x^(m - n)*Csc[a + b*x^n]^(p - 1), x] /; FreeQ[{a, b, p}, x] && IntegerQ[n] && GeQ[m - n, 0] && NeQ[p, 1]

(* ::Subsection::Closed:: *)
(* 4.3.1.2 (d sec)^n (a+b sec)^m *)
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a*Int[(d*Csc[e + f*x])^n, x] + (b/d)*Int[(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, n}, x]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^2*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := 2*a*(b/d)*Int[(d*Csc[e + f*x])^(n + 1), x] + Int[(d*Csc[e + f*x])^n*(a^2 + b^2*Csc[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, n}, x]
Int[csc[(e_.) + (f_.)*(x_)]^2/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (1/b)*Int[Csc[e + f*x], x] - (a/b)*Int[Csc[e + f*x]/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x]
Int[csc[(e_.) + (f_.)*(x_)]^3/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := -(Cot[e + f*x]/(b*f)) - (a/b)*Int[Csc[e + f*x]^2/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Int[ExpandTrig[(a + b*csc[e + f*x])^m*(d*csc[e + f*x])^n, x], x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0] && RationalQ[n]
Int[csc[(e_.) + (f_.)*(x_)]*Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*b*(Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]])) /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-b)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m - 1)/(f*m)) + a*((2*m - 1)/m)*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 1/2] && IntegerQ[2*m]
Int[csc[(e_.) + (f_.)*(x_)]/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := -(Cot[e + f*x]/(f*(b + a*Csc[e + f*x]))) /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := (-2/f)*Subst[Int[1/(2*a + x^2), x], x, b*(Cot[e + f*x]/Sqrt[a + b*Csc[e + f*x]])] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := b*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(a*f*(2*m + 1))) + ((m + 1)/(a*(2*m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)] && IntegerQ[2*m]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-Cot[e + f*x])*((a + b*Csc[e + f*x])^m/(f*(2*m + 1))) + (m/(b*(2*m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-Cot[e + f*x])*((a + b*Csc[e + f*x])^m/(f*(m + 1))) + a*(m/(b*(m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m, x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)]
Int[csc[(e_.) + (f_.)*(x_)]^3*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := b*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(a*f*(2*m + 1))) - (1/(a^2*(2*m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(a*m - b*(2*m + 1)*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)]
Int[csc[(e_.) + (f_.)*(x_)]^3*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-Cot[e + f*x])*((a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 2))) + (1/(b*(m + 2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m*(b*(m + 1) - a*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f, m}, x] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*(a/(b*f))*Sqrt[a*(d/b)]*Subst[Int[1/Sqrt[1 + x^2/a], x], x, b*(Cot[e + f*x]/Sqrt[a + b*Csc[e + f*x]])] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[a*(d/b), 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*b*(d/f)*Subst[Int[1/(b - d*x^2), x], x, b*(Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]]))] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] &&  !GtQ[a*(d/b), 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := -2*b*d*Cot[e + f*x]*((d*Csc[e + f*x])^(n - 1)/(f*(2*n - 1)*Sqrt[a + b*Csc[e + f*x]])) + 2*a*d*((n - 1)/(b*(2*n - 1)))*Int[Sqrt[a + b*Csc[e + f*x]]*(d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[n, 1] && IntegerQ[2*n]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*a*(Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]])) /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*Cot[e + f*x]*((d*Csc[e + f*x])^n/(f*n*Sqrt[a + b*Csc[e + f*x]])) + a*((2*n + 1)/(2*b*d*n))*Int[Sqrt[a + b*Csc[e + f*x]]*(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[n, -2^(-1)] && IntegerQ[2*n]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^2*d*(Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[a - b*Csc[e + f*x]]))*Subst[Int[(d*x)^(n - 1)/Sqrt[a - b*x], x], x, Csc[e + f*x]] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0]
Int[Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := (-Sqrt[2])*(Sqrt[a]/(b*f))*Subst[Int[1/Sqrt[1 + x^2], x], x, b*(Cot[e + f*x]/(a + b*Csc[e + f*x]))] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && EqQ[d - a/b, 0] && GtQ[a, 0]
Int[Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*b*(d/(a*f))*Subst[Int[1/(2*b - d*x^2), x], x, b*(Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]]))] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-a)*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*((d*Csc[e + f*x])^n/(f*m)) + b*((2*m - 1)/(d*m))*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && EqQ[m + n, 0] && GtQ[m, 1/2] && IntegerQ[2*m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^(n - 1)/(a*f*(2*m + 1))) + d*((m + 1)/(b*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && EqQ[m + n, 0] && LtQ[m, -2^(-1)] && IntegerQ[2*m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-Cot[e + f*x])*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*(2*m + 1))) + (m/(a*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-Cot[e + f*x])*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*(m + 1))) + a*(m/(b*d*(m + 1)))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] &&  !LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b^2*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 2)*((d*Csc[e + f*x])^n/(f*n)) - (a/(d*n))*Int[(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^(n + 1)*(b*(m - 2*n - 2) - a*(m + 2*n - 1)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 1] && (LtQ[n, -1] || (EqQ[m, 3/2] && EqQ[n, -2^(-1)])) && IntegerQ[2*m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b^2)*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 2)*((d*Csc[e + f*x])^n/(f*(m + n - 1))) + (b/(m + n - 1))*Int[(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^n*(b*(m + 2*n - 1) + a*(3*m + 2*n - 4)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && GtQ[m, 1] && NeQ[m + n - 1, 0] && IntegerQ[2*m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^(n - 1)/(a*f*(2*m + 1))) - (d/(a*b*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)*(a*(n - 1) - b*(m + n)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && LtQ[1, n, 2] && (IntegersQ[2*m, 2*n] || IntegerQ[m])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-d^2)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^(n - 2)/(f*(2*m + 1))) + (d^2/(a*b*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 2)*(b*(n - 2) + a*(m - n + 2)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[n, 2] && (IntegersQ[2*m, 2*n] || IntegerQ[m])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-Cot[e + f*x])*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*(2*m + 1))) + (1/(a^2*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n*(a*(2*m + n + 1) - b*(m + n + 1)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -1] && (IntegersQ[2*m, 2*n] || IntegerQ[m])
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := d^2*Cot[e + f*x]*((d*Csc[e + f*x])^(n - 2)/(f*(a + b*Csc[e + f*x]))) - (d^2/(a*b))*Int[(d*Csc[e + f*x])^(n - 2)*(b*(n - 2) - a*(n - 1)*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[n, 1]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := Cot[e + f*x]*((d*Csc[e + f*x])^n/(f*(a + b*Csc[e + f*x]))) - (1/a^2)*Int[(d*Csc[e + f*x])^n*(a*(n - 1) - b*n*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[n, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b)*d*Cot[e + f*x]*((d*Csc[e + f*x])^(n - 1)/(a*f*(a + b*Csc[e + f*x]))) + d*((n - 1)/(a*b))*Int[(d*Csc[e + f*x])^(n - 1)*(a - b*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, n}, x] && EqQ[a^2 - b^2, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := (d/b)*Int[Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]], x] - a*(d/b)*Int[Sqrt[d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*d^2*Cot[e + f*x]*((d*Csc[e + f*x])^(n - 2)/(f*(2*n - 3)*Sqrt[a + b*Csc[e + f*x]])) + (d^2/(b*(2*n - 3)))*Int[(d*Csc[e + f*x])^(n - 2)*((2*b*(n - 2) - a*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && GtQ[n, 2] && IntegerQ[2*n]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := Cot[e + f*x]*((d*Csc[e + f*x])^n/(f*n*Sqrt[a + b*Csc[e + f*x]])) + (1/(2*b*d*n))*Int[(d*Csc[e + f*x])^(n + 1)*((a + b*(2*n + 1)*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, d, e, f}, x] && EqQ[a^2 - b^2, 0] && LtQ[n, 0] && IntegerQ[2*n]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-d^2)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^(n - 2)/(f*(m + n - 1))) + (d^2/(b*(m + n - 1)))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n - 2)*(b*(n - 2) + a*m*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, m}, x] && EqQ[a^2 - b^2, 0] && GtQ[n, 2] && NeQ[m + n - 1, 0] && IntegerQ[n]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-(a*(d/b))^n)*(Cot[e + f*x]/(a^(n - 2)*f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[a - b*Csc[e + f*x]]))*Subst[Int[(a - x)^(n - 1)*((2*a - x)^(m - 1/2)/Sqrt[x]), x], x, a - b*Csc[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m] && GtQ[a, 0] &&  !IntegerQ[n] && GtQ[a*(d/b), 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-((-a)*(d/b))^n)*(Cot[e + f*x]/(a^(n - 1)*f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[a - b*Csc[e + f*x]]))*Subst[Int[x^(m - 1/2)*((a - x)^(n - 1)/Sqrt[2*a - x]), x], x, a + b*Csc[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m] && GtQ[a, 0] &&  !IntegerQ[n] && LtQ[a*(d/b), 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^2*d*(Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[a - b*Csc[e + f*x]]))*Subst[Int[(d*x)^(n - 1)*((a + b*x)^(m - 1/2)/Sqrt[a - b*x]), x], x, Csc[e + f*x]] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m] && GtQ[a, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^IntPart[m]*((a + b*Csc[e + f*x])^FracPart[m]/(1 + (b/a)*Csc[e + f*x])^FracPart[m])*Int[(1 + (b/a)*Csc[e + f*x])^m*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, m, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[m] &&  !GtQ[a, 0]
Int[csc[(e_.) + (f_.)*(x_)]*Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := (a - b)*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] + b*Int[Csc[e + f*x]*((1 + Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-b)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m - 1)/(f*m)) + (1/m)*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m - 2)*(b^2*(m - 1) + a^2*m + a*b*(2*m - 1)*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 1] && IntegerQ[2*m]
Int[csc[(e_.) + (f_.)*(x_)]/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (1/b)*Int[1/(1 + (a/b)*Sin[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*(Rt[a + b, 2]/(b*f*Cot[e + f*x]))*Sqrt[(b*(1 - Csc[e + f*x]))/(a + b)]*Sqrt[(-b)*((1 + Csc[e + f*x])/(a - b))]*EllipticF[ArcSin[Sqrt[a + b*Csc[e + f*x]]/Rt[a + b, 2]], (a + b)/(a - b)] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-b)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(f*(m + 1)*(a^2 - b^2))) + (1/((m + 1)*(a^2 - b^2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(a*(m + 1) - b*(m + 2)*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegerQ[2*m]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (Cot[e + f*x]/(f*Sqrt[1 + Csc[e + f*x]]*Sqrt[1 - Csc[e + f*x]]))*Subst[Int[(a + b*x)^m/(Sqrt[1 + x]*Sqrt[1 - x]), x], x, Csc[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0] &&  !IntegerQ[2*m]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-Cot[e + f*x])*((a + b*Csc[e + f*x])^m/(f*(m + 1))) + (m/(m + 1))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*(b + a*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := a*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(f*(m + 1)*(a^2 - b^2))) - (1/((m + 1)*(a^2 - b^2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(b*(m + 1) - a*(m + 2)*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[(e_.) + (f_.)*(x_)]^2/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := -Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] + Int[Csc[e + f*x]*((1 + Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-(a/b))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m, x] + (1/b)*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]^3*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-a^2)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 - b^2))) + (1/(b*(m + 1)*(a^2 - b^2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*Simp[a*b*(m + 1) - (a^2 + b^2*(m + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[(e_.) + (f_.)*(x_)]^3*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-Cot[e + f*x])*((a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 2))) + (1/(b*(m + 2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m*(b*(m + 1) - a*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f, m}, x] && NeQ[a^2 - b^2, 0] &&  !LtQ[m, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^2*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 2)*((d*Csc[e + f*x])^n/(f*n)) - (1/(d*n))*Int[(a + b*Csc[e + f*x])^(m - 3)*(d*Csc[e + f*x])^(n + 1)*Simp[a^2*b*(m - 2*n - 2) - a*(3*b^2*n + a^2*(n + 1))*Csc[e + f*x] - b*(b^2*n + a^2*(m + n - 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 2] && ((IntegerQ[m] && LtQ[n, -1]) || (IntegersQ[m + 1/2, 2*n] && LeQ[n, -1]))
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b^2)*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 2)*((d*Csc[e + f*x])^n/(f*(m + n - 1))) + (1/(d*(m + n - 1)))*Int[(a + b*Csc[e + f*x])^(m - 3)*(d*Csc[e + f*x])^n*Simp[a^3*d*(m + n - 1) + a*b^2*d*n + b*(b^2*d*(m + n - 2) + 3*a^2*d*(m + n - 1))*Csc[e + f*x] + a*b^2*d*(3*m + 2*n - 4)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 2] && (IntegerQ[m] || IntegersQ[2*m, 2*n]) &&  !(IGtQ[n, 2] &&  !IntegerQ[m])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b)*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^(n - 1)/(f*(m + 1)*(a^2 - b^2))) + (1/((m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)*Simp[b*d*(n - 1) + a*d*(m + 1)*Csc[e + f*x] - b*d*(m + n + 1)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && LtQ[0, n, 1] && IntegersQ[2*m, 2*n]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*d^2*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^(n - 2)/(f*(m + 1)*(a^2 - b^2))) - (d^2/((m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 2)*(a*(n - 2) + b*(m + 1)*Csc[e + f*x] - a*(m + n)*Csc[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && LtQ[1, n, 2] && IntegersQ[2*m, 2*n]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-a^2)*d^3*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^(n - 3)/(b*f*(m + 1)*(a^2 - b^2))) + (d^3/(b*(m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 3)*Simp[a^2*(n - 3) + a*b*(m + 1)*Csc[e + f*x] - (a^2*(n - 2) + b^2*(m + 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && (IGtQ[n, 3] || (IntegersQ[n + 1/2, 2*m] && GtQ[n, 2]))
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^n/(a*f*n)) - (1/(a*d*n))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)*Simp[b*(m + n + 1) - a*(n + 1)*Csc[e + f*x] - b*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m + 1/2, 0] && ILtQ[n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b^2*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^n/(a*f*(m + 1)*(a^2 - b^2))) + (1/(a*(m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n*(a^2*(m + 1) - b^2*(m + n + 1) - a*b*(m + 1)*Csc[e + f*x] + b^2*(m + n + 2)*Csc[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && IntegersQ[2*m, 2*n]
Int[Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := Sqrt[d*Sin[e + f*x]]*(Sqrt[d*Csc[e + f*x]]/d)*Int[Sqrt[d*Sin[e + f*x]]/(b + a*Sin[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := d*Sqrt[d*Sin[e + f*x]]*Sqrt[d*Csc[e + f*x]]*Int[1/(Sqrt[d*Sin[e + f*x]]*(b + a*Sin[e + f*x])), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(5/2)/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (d/b)*Int[(d*Csc[e + f*x])^(3/2), x] - a*(d/b)*Int[(d*Csc[e + f*x])^(3/2)/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-d^3)*Cot[e + f*x]*((d*Csc[e + f*x])^(n - 3)/(b*f*(n - 2))) + (d^3/(b*(n - 2)))*Int[(d*Csc[e + f*x])^(n - 3)*(Simp[a*(n - 3) + b*(n - 3)*Csc[e + f*x] - a*(n - 2)*Csc[e + f*x]^2, x]/(a + b*Csc[e + f*x])), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 3]
Int[1/(Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (b^2/(a^2*d^2))*Int[(d*Csc[e + f*x])^(3/2)/(a + b*Csc[e + f*x]), x] + (1/a^2)*Int[(a - b*Csc[e + f*x])/Sqrt[d*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := Cot[e + f*x]*((d*Csc[e + f*x])^n/(a*f*n)) - (1/(a*d*n))*Int[((d*Csc[e + f*x])^(n + 1)/(a + b*Csc[e + f*x]))*Simp[b*n - a*(n + 1)*Csc[e + f*x] - b*(n + 1)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LeQ[n, -1] && IntegerQ[2*n]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := a*Int[Sqrt[d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] + (b/d)*Int[(d*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := -2*d*Cos[e + f*x]*Sqrt[a + b*Csc[e + f*x]]*((d*Csc[e + f*x])^(n - 1)/(f*(2*n - 1))) + (d^2/(2*n - 1))*Int[(d*Csc[e + f*x])^(n - 2)*(Simp[2*a*(n - 2) + b*(2*n - 3)*Csc[e + f*x] + a*Csc[e + f*x]^2, x]/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 1] && IntegerQ[2*n]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := (Sqrt[a + b*Csc[e + f*x]]/(Sqrt[d*Csc[e + f*x]]*Sqrt[b + a*Sin[e + f*x]]))*Int[Sqrt[b + a*Sin[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Cot[e + f*x]*Sqrt[a + b*Csc[e + f*x]]*((d*Csc[e + f*x])^n/(f*n)) - (1/(2*d*n))*Int[(d*Csc[e + f*x])^(n + 1)*(Simp[b - 2*a*(n + 1)*Csc[e + f*x] - b*(2*n + 3)*Csc[e + f*x]^2, x]/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LeQ[n, -1] && IntegerQ[2*n]
Int[Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := Sqrt[d*Csc[e + f*x]]*(Sqrt[b + a*Sin[e + f*x]]/Sqrt[a + b*Csc[e + f*x]])*Int[1/Sqrt[b + a*Sin[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := d*Sqrt[d*Csc[e + f*x]]*(Sqrt[b + a*Sin[e + f*x]]/Sqrt[a + b*Csc[e + f*x]])*Int[1/(Sin[e + f*x]*Sqrt[b + a*Sin[e + f*x]]), x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*d^2*Cos[e + f*x]*(d*Csc[e + f*x])^(n - 2)*(Sqrt[a + b*Csc[e + f*x]]/(b*f*(2*n - 3))) + (d^3/(b*(2*n - 3)))*Int[((d*Csc[e + f*x])^(n - 3)/Sqrt[a + b*Csc[e + f*x]])*Simp[2*a*(n - 3) + b*(2*n - 5)*Csc[e + f*x] - 2*a*(n - 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 2] && IntegerQ[2*n]
Int[1/(csc[(e_.) + (f_.)*(x_)]*Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := (-Cos[e + f*x])*(Sqrt[a + b*Csc[e + f*x]]/(a*f)) - (b/(2*a))*Int[(1 + Csc[e + f*x]^2)/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[1/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := (1/a)*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[d*Csc[e + f*x]], x] - (b/(a*d))*Int[Sqrt[d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := Cos[e + f*x]*(d*Csc[e + f*x])^(n + 1)*(Sqrt[a + b*Csc[e + f*x]]/(a*d*f*n)) + (1/(2*a*d*n))*Int[((d*Csc[e + f*x])^(n + 1)/Sqrt[a + b*Csc[e + f*x]])*Simp[(-b)*(2*n + 1) + 2*a*(n + 1)*Csc[e + f*x] + b*(2*n + 3)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[n, -1] && IntegerQ[2*n]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*Cot[e + f*x]*Sqrt[a + b*Csc[e + f*x]]*((d*Csc[e + f*x])^n/(f*n)) + (1/(2*d*n))*Int[((d*Csc[e + f*x])^(n + 1)/Sqrt[a + b*Csc[e + f*x]])*Simp[a*b*(2*n - 1) + 2*(b^2*n + a^2*(n + 1))*Csc[e + f*x] + a*b*(2*n + 3)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LeQ[n, -1] && IntegersQ[2*n]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-d^3)*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^(n - 3)/(b*f*(m + n - 1))) + (d^3/(b*(m + n - 1)))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n - 3)*Simp[a*(n - 3) + b*(m + n - 2)*Csc[e + f*x] - a*(n - 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, m}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 3] && (IntegerQ[n] || IntegersQ[2*m, 2*n]) &&  !IGtQ[m, 2]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-b)*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*((d*Csc[e + f*x])^(n - 1)/(f*(m + n - 1))) + (d/(m + n - 1))*Int[(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^(n - 1)*Simp[a*b*(n - 1) + (b^2*(m + n - 2) + a^2*(m + n - 1))*Csc[e + f*x] + a*b*(2*m + n - 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[0, m, 2] && LtQ[0, n, 3] && NeQ[m + n - 1, 0] && (IntegerQ[m] || IntegersQ[2*m, 2*n])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-d^2)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^(n - 2)/(f*(m + n - 1))) + (d^2/(b*(m + n - 1)))*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n - 2)*Simp[a*b*(n - 2) + b^2*(m + n - 2)*Csc[e + f*x] + a*b*m*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0] && LtQ[-1, m, 2] && LtQ[1, n, 3] && NeQ[m + n - 1, 0] && (IntegerQ[n] || IntegersQ[2*m, 2*n])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)/Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := a*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[d*Csc[e + f*x]], x] + (b/d)*Int[Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f}, x] && NeQ[a^2 - b^2, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := Sin[e + f*x]^n*(d*Csc[e + f*x])^n*Int[(b + a*Sin[e + f*x])^m/Sin[e + f*x]^(m + n), x] /; FreeQ[{a, b, d, e, f, n}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Unintegrable[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, m, n}, x]
Int[((d_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((a_.) + (b_.)*sec[(e_.) + (f_.)*(x_)])^(p_), x_Symbol] := (d*Cos[e + f*x])^FracPart[m]*(Sec[e + f*x]/d)^FracPart[m]*Int[(a + b*Sec[e + f*x])^p/(Sec[e + f*x]/d)^m, x] /; FreeQ[{a, b, d, e, f, m, p}, x] &&  !IntegerQ[m] &&  !IntegerQ[p]

(* ::Subsection::Closed:: *)
(* 4.3.1.3 (d sin)^n (a+b sec)^m *)
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := Int[(g*Cos[e + f*x])^p*((b + a*Sin[e + f*x])^m/Sin[e + f*x]^m), x] /; FreeQ[{a, b, e, f, g, p}, x] && IntegerQ[m]
Int[cos[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-(f*b^(p - 1))^(-1))*Subst[Int[(-a + b*x)^((p - 1)/2)*((a + b*x)^(m + (p - 1)/2)/x^(p + 1)), x], x, Csc[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && IntegerQ[(p - 1)/2] && EqQ[a^2 - b^2, 0]
Int[cos[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := (-f^(-1))*Subst[Int[(-1 + x)^((p - 1)/2)*(1 + x)^((p - 1)/2)*((a + b*x)^m/x^(p + 1)), x], x, Csc[e + f*x]] /; FreeQ[{a, b, e, f, m}, x] && IntegerQ[(p - 1)/2] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)/cos[(e_.) + (f_.)*(x_)]^2, x_Symbol] := Tan[e + f*x]*((a + b*Csc[e + f*x])^m/f) + b*m*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m - 1), x] /; FreeQ[{a, b, e, f, m}, x]
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := Sin[e + f*x]^FracPart[m]*((a + b*Csc[e + f*x])^FracPart[m]/(b + a*Sin[e + f*x])^FracPart[m])*Int[(g*Cos[e + f*x])^p*((b + a*Sin[e + f*x])^m/Sin[e + f*x]^m), x] /; FreeQ[{a, b, e, f, g, m, p}, x] && (EqQ[a^2 - b^2, 0] || IntegersQ[2*m, p])
Int[((g_.)*cos[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := Unintegrable[(g*Cos[e + f*x])^p*(a + b*Csc[e + f*x])^m, x] /; FreeQ[{a, b, e, f, g, m, p}, x]
Int[((g_.)*sec[(e_.) + (f_.)*(x_)])^(p_)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.), x_Symbol] := g^IntPart[p]*(g*Sec[e + f*x])^FracPart[p]*Cos[e + f*x]^FracPart[p]*Int[(a + b*Csc[e + f*x])^m/Cos[e + f*x]^p, x] /; FreeQ[{a, b, e, f, g, m, p}, x] &&  !IntegerQ[p]

(* ::Subsection::Closed:: *)
(* 4.3.1.4 (d tan)^n (a+b sec)^m *)
Int[cot[(c_.) + (d_.)*(x_)]^(m_.)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := (1/(a^(m - n - 1)*b^n*d))*Subst[Int[(a - b*x)^((m - 1)/2)*((a + b*x)^((m - 1)/2 + n)/x^(m + n)), x], x, Sin[c + d*x]] /; FreeQ[{a, b, c, d}, x] && IntegerQ[(m - 1)/2] && EqQ[a^2 - b^2, 0] && IntegerQ[n]
Int[cot[(c_.) + (d_.)*(x_)]^(m_.)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-(d*b^(m - 1))^(-1))*Subst[Int[(-a + b*x)^((m - 1)/2)*((a + b*x)^((m - 1)/2 + n)/x), x], x, Csc[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && IntegerQ[(m - 1)/2] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[n]
Int[((e_.)*cot[(c_.) + (d_.)*(x_)])^(m_)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)]), x_Symbol] := (-e)*(e*Cot[c + d*x])^(m - 1)*((a*m + b*(m - 1)*Csc[c + d*x])/(d*m*(m - 1))) - (e^2/m)*Int[(e*Cot[c + d*x])^(m - 2)*(a*m + b*(m - 1)*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d, e}, x] && GtQ[m, 1]
Int[((e_.)*cot[(c_.) + (d_.)*(x_)])^(m_)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)]), x_Symbol] := (-(e*Cot[c + d*x])^(m + 1))*((a + b*Csc[c + d*x])/(d*e*(m + 1))) - (1/(e^2*(m + 1)))*Int[(e*Cot[c + d*x])^(m + 2)*(a*(m + 1) + b*(m + 2)*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d, e}, x] && LtQ[m, -1]
Int[((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])/cot[(c_.) + (d_.)*(x_)], x_Symbol] := Int[(b + a*Sin[c + d*x])/Cos[c + d*x], x] /; FreeQ[{a, b, c, d}, x]
Int[((e_.)*cot[(c_.) + (d_.)*(x_)])^(m_.)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)]), x_Symbol] := a*Int[(e*Cot[c + d*x])^m, x] + b*Int[(e*Cot[c + d*x])^m*Csc[c + d*x], x] /; FreeQ[{a, b, c, d, e, m}, x]
Int[cot[(c_.) + (d_.)*(x_)]^(m_.)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-((-1)^((m - 1)/2)/(d*b^(m - 1))))*Subst[Int[(b^2 - x^2)^((m - 1)/2)*((a + x)^n/x), x], x, b*Csc[c + d*x]] /; FreeQ[{a, b, c, d, n}, x] && IntegerQ[(m - 1)/2] && NeQ[a^2 - b^2, 0]
Int[((e_.)*cot[(c_.) + (d_.)*(x_)])^(m_)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Int[ExpandIntegrand[(e*Cot[c + d*x])^m, (a + b*Csc[c + d*x])^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && IGtQ[n, 0]
Int[cot[(c_.) + (d_.)*(x_)]^(m_.)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := -2*(a^(m/2 + n + 1/2)/d)*Subst[Int[x^m*((2 + a*x^2)^(m/2 + n - 1/2)/(1 + a*x^2)), x], x, Cot[c + d*x]/Sqrt[a + b*Csc[c + d*x]]] /; FreeQ[{a, b, c, d}, x] && EqQ[a^2 - b^2, 0] && IntegerQ[m/2] && IntegerQ[n - 1/2]
Int[((e_.)*cot[(c_.) + (d_.)*(x_)])^(m_)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (a^(2*n)*Int[(e*Cot[c + d*x])^(m + 2*n)/(-a + b*Csc[c + d*x])^n, x])/e^(2*n) /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[a^2 - b^2, 0] && ILtQ[n, 0]
Int[((e_.)*cot[(c_.) + (d_.)*(x_)])^(m_)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := (-2^(m + n + 1))*(e*Cot[c + d*x])^(m + 1)*((a + b*Csc[c + d*x])^n/(d*e*(m + 1)))*(a/(a + b*Csc[c + d*x]))^(m + n + 1)*AppellF1[(m + 1)/2, m + n, 1, (m + 3)/2, -((a - b*Csc[c + d*x])/(a + b*Csc[c + d*x])), (a - b*Csc[c + d*x])/(a + b*Csc[c + d*x])] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[a^2 - b^2, 0] &&  !IntegerQ[n]
Int[Sqrt[(e_.)*cot[(c_.) + (d_.)*(x_)]]/((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)]), x_Symbol] := (1/a)*Int[Sqrt[e*Cot[c + d*x]], x] - (b/a)*Int[Sqrt[e*Cot[c + d*x]]/(b + a*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2, 0]
Int[((e_.)*cot[(c_.) + (d_.)*(x_)])^(m_)/((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)]), x_Symbol] := (-(e^2/b^2))*Int[(e*Cot[c + d*x])^(m - 2)*(a - b*Csc[c + d*x]), x] + e^2*((a^2 - b^2)/b^2)*Int[(e*Cot[c + d*x])^(m - 2)/(a + b*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m - 1/2, 0]
Int[1/(Sqrt[(e_.)*cot[(c_.) + (d_.)*(x_)]]*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[1/Sqrt[e*Cot[c + d*x]], x] - (b/a)*Int[1/(Sqrt[e*Cot[c + d*x]]*(b + a*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2, 0]
Int[((e_.)*cot[(c_.) + (d_.)*(x_)])^(m_)/((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)]), x_Symbol] := (1/(a^2 - b^2))*Int[(e*Cot[c + d*x])^m*(a - b*Csc[c + d*x]), x] + (b^2/(e^2*(a^2 - b^2)))*Int[(e*Cot[c + d*x])^(m + 2)/(a + b*Csc[c + d*x]), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m + 1/2, 0]
Int[cot[(c_.) + (d_.)*(x_)]^2*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Int[(-1 + Csc[c + d*x]^2)*(a + b*Csc[c + d*x])^n, x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 - b^2, 0]
Int[cot[(c_.) + (d_.)*(x_)]^(m_)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Int[ExpandIntegrand[(a + b*Csc[c + d*x])^n, (-1 + Csc[c + d*x]^2)^(m/2), x], x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 - b^2, 0] && IGtQ[m/2, 0] && IntegerQ[n - 1/2]
Int[cot[(c_.) + (d_.)*(x_)]^(m_)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Int[ExpandIntegrand[(a + b*Csc[c + d*x])^n, (-1 + Sec[c + d*x]^2)^(-(m/2)), x], x] /; FreeQ[{a, b, c, d, n}, x] && NeQ[a^2 - b^2, 0] && ILtQ[m/2, 0] && IntegerQ[n - 1/2] && EqQ[m, -2]
Int[((e_.)*cot[(c_.) + (d_.)*(x_)])^(m_)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Int[ExpandIntegrand[(e*Cot[c + d*x])^m, (a + b*Csc[c + d*x])^n, x], x] /; FreeQ[{a, b, c, d, e, m}, x] && NeQ[a^2 - b^2, 0] && IGtQ[n, 0]
Int[cot[(c_.) + (d_.)*(x_)]^(m_.)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_), x_Symbol] := Int[Cos[c + d*x]^m*((b + a*Sin[c + d*x])^n/Sin[c + d*x]^(m + n)), x] /; FreeQ[{a, b, c, d}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[n] && IntegerQ[m] && (IntegerQ[m/2] || LeQ[m, 1])
Int[((e_.)*cot[(c_.) + (d_.)*(x_)])^(m_.)*((a_.) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := Unintegrable[(e*Cot[c + d*x])^m*(a + b*Csc[c + d*x])^n, x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[((e_.)*cot[(c_.) + (d_.)*(x_)])^(m_)*((a_) + (b_.)*sec[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := (e*Cot[c + d*x])^m*Tan[c + d*x]^m*Int[(a + b*Sec[c + d*x])^n/Tan[c + d*x]^m, x] /; FreeQ[{a, b, c, d, e, m, n}, x] &&  !IntegerQ[m]
Int[((e_.)*tan[(c_.) + (d_.)*(x_)]^(p_))^(m_)*((a_) + (b_.)*sec[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := ((e*Tan[c + d*x]^p)^m/(e*Tan[c + d*x])^(m*p))*Int[(e*Tan[c + d*x])^(m*p)*(a + b*Sec[c + d*x])^n, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] &&  !IntegerQ[m]
Int[((e_.)*cot[(c_.) + (d_.)*(x_)]^(p_))^(m_)*((a_) + (b_.)*csc[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := ((e*Cot[c + d*x]^p)^m/(e*Cot[c + d*x])^(m*p))*Int[(e*Cot[c + d*x])^(m*p)*(a + b*Csc[c + d*x])^n, x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] &&  !IntegerQ[m]

(* ::Subsection::Closed:: *)
(* 4.3.2.1 (a+b sec)^m (c+d sec)^n *)
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := c^n*Int[ExpandTrig[(1 + (d/c)*csc[e + f*x])^n, (a + b*csc[e + f*x])^m, x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[m, 0] && ILtQ[n, 0] && LtQ[m + n, 2]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := ((-a)*c)^m*Int[Cot[e + f*x]^(2*m)*(c + d*Csc[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && RationalQ[n] &&  !(IntegerQ[n] && GtQ[m - n, 0])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := ((-a)*c)^(m + 1/2)*(Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]))*Int[Cot[e + f*x]^(2*m), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m + 1/2]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := 2*a*c*Cot[e + f*x]*((c + d*Csc[e + f*x])^(n - 1)/(f*(2*n - 1)*Sqrt[a + b*Csc[e + f*x]])) + c*Int[Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && GtQ[n, 1/2]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := -2*a*Cot[e + f*x]*((c + d*Csc[e + f*x])^n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]])) + (1/c)*Int[Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[n, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := -4*a^2*Cot[e + f*x]*((c + d*Csc[e + f*x])^n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]])) + (a/c)*Int[Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[n, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := -2*a^2*Cot[e + f*x]*((c + d*Csc[e + f*x])^n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]])) + a*Int[Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] &&  !LeQ[n, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(5/2)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := -8*a^3*Cot[e + f*x]*((c + d*Csc[e + f*x])^n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]])) + (a^2/c^2)*Int[Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^(n + 2), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && LtQ[n, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-a)*c*(Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]))*Subst[Int[(b + a*x)^(m - 1/2)*((d + c*x)^(n - 1/2)/x^(m + n)), x], x, Sin[e + f*x]] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m - 1/2] && EqQ[m + n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a*c*(Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]))*Subst[Int[(a + b*x)^(m - 1/2)*((c + d*x)^(n - 1/2)/x), x], x, Csc[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := a*c*x + b*d*Int[Csc[e + f*x]^2, x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := a*c*x + (b*c + a*d)*Int[Csc[e + f*x], x] + b*d*Int[Csc[e + f*x]^2, x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[b*c + a*d, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := c*Int[Sqrt[a + b*Csc[e + f*x]], x] + d*Int[Sqrt[a + b*Csc[e + f*x]]*Csc[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := a*c*Int[1/Sqrt[a + b*Csc[e + f*x]], x] + Int[Csc[e + f*x]*((b*c + a*d + b*d*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b)*d*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m - 1)/(f*m)) + (1/m)*Int[(a + b*Csc[e + f*x])^(m - 1)*Simp[a*c*m + (b*c*m + a*d*(2*m - 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && GtQ[m, 1] && EqQ[a^2 - b^2, 0] && IntegerQ[2*m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b)*d*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m - 1)/(f*m)) + (1/m)*Int[(a + b*Csc[e + f*x])^(m - 2)*Simp[a^2*c*m + (b^2*d*(m - 1) + 2*a*b*c*m + a^2*d*m)*Csc[e + f*x] + b*(b*c*m + a*d*(2*m - 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && GtQ[m, 1] && NeQ[a^2 - b^2, 0] && IntegerQ[2*m]
Int[((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := c*(x/a) - ((b*c - a*d)/a)*Int[Csc[e + f*x]/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := (c/a)*Int[Sqrt[a + b*Csc[e + f*x]], x] - ((b*c - a*d)/a)*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := c*Int[1/Sqrt[a + b*Csc[e + f*x]], x] + d*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(b*c - a*d))*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(b*f*(2*m + 1))) + (1/(a^2*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*Simp[a*c*(2*m + 1) - (b*c - a*d)*(m + 1)*Csc[e + f*x], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && LtQ[m, -1] && EqQ[a^2 - b^2, 0] && IntegerQ[2*m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := b*(b*c - a*d)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(a*f*(m + 1)*(a^2 - b^2))) + (1/(a*(m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*Simp[c*(a^2 - b^2)*(m + 1) - (a*(b*c - a*d)*(m + 1))*Csc[e + f*x] + b*(b*c - a*d)*(m + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && LtQ[m, -1] && NeQ[a^2 - b^2, 0] && IntegerQ[2*m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := c*Int[(a + b*Csc[e + f*x])^m, x] + d*Int[(a + b*Csc[e + f*x])^m*Csc[e + f*x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && NeQ[b*c - a*d, 0] &&  !IntegerQ[2*m]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (1/c)*Int[Sqrt[a + b*Csc[e + f*x]], x] - (d/c)*Int[Csc[e + f*x]*(Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (a/c)*Int[1/Sqrt[a + b*Csc[e + f*x]], x] + ((b*c - a*d)/c)*Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (a/c)*Int[Sqrt[a + b*Csc[e + f*x]], x] + ((b*c - a*d)/c)*Int[Csc[e + f*x]*(Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (1/(c*d))*Int[(a^2*d + b^2*c*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] - ((b*c - a*d)^2/(c*d))*Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/(c*(b*c - a*d)))*Int[(b*c - a*d - b*d*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] + (d^2/(c*(b*c - a*d)))*Int[Csc[e + f*x]*(Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[1/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/c)*Int[1/Sqrt[a + b*Csc[e + f*x]], x] - (d/c)*Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := Sqrt[a + b*Csc[e + f*x]]*(Sqrt[c + d*Csc[e + f*x]]/Cot[e + f*x])*Int[Cot[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := c*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]], x] + d*Int[Csc[e + f*x]*(Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := (1/c)*Int[Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]], x] - (d/c)*Int[Csc[e + f*x]*(Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := -2*(a/f)*Subst[Int[1/(1 + a*c*x^2), x], x, Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := (a/c)*Int[Sqrt[c + d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] + ((b*c - a*d)/c)*Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := 2*((a + b*Csc[e + f*x])/(c*f*Rt[(a + b)/(c + d), 2]*Cot[e + f*x]))*Sqrt[(b*c - a*d)*((1 + Csc[e + f*x])/((c - d)*(a + b*Csc[e + f*x])))]*Sqrt[(-(b*c - a*d))*((1 - Csc[e + f*x])/((c + d)*(a + b*Csc[e + f*x])))]*EllipticPi[a*((c + d)/(c*(a + b))), ArcSin[Rt[(a + b)/(c + d), 2]*(Sqrt[c + d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]])], (a - b)*((c + d)/((a + b)*(c - d)))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[1/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := (Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]))*Int[1/Cot[e + f*x], x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[1/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := (1/a)*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]], x] - (b/a)*Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(3/2), x_Symbol] := (1/c)*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]], x] - (d/c)*Int[Csc[e + f*x]*(Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x])^(3/2)), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[c^2 - d^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^2*(Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[a - b*Csc[e + f*x]]))*Subst[Int[(a + b*x)^(m - 1/2)*((c + d*x)^n/(x*Sqrt[a - b*x])), x], x, Csc[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && IntegerQ[m - 1/2]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[(b + a*Sin[e + f*x])^m*((d + c*Sin[e + f*x])^n/Sin[e + f*x]^(m + n)), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && IntegerQ[m] && IntegerQ[n] && LeQ[-2, m + n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Sqrt[d + c*Sin[e + f*x]]*(Sqrt[a + b*Csc[e + f*x]]/(Sqrt[b + a*Sin[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]))*Int[(b + a*Sin[e + f*x])^m*((d + c*Sin[e + f*x])^n/Sin[e + f*x]^(m + n)), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && IntegerQ[m + 1/2] && IntegerQ[n + 1/2] && LeQ[-2, m + n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Sin[e + f*x]^(m + n)*(a + b*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^n/((b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n))*Int[(b + a*Sin[e + f*x])^m*((d + c*Sin[e + f*x])^n/Sin[e + f*x]^Simplify[m + n]), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && EqQ[m + n, 0] &&  !IntegerQ[2*m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[ExpandTrig[(a + b*csc[e + f*x])^m, (c + d*csc[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := Unintegrable[(a + b*Csc[e + f*x])^m*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[((a_.) + (b_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)/sec[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d^m*Int[(b + a*Cos[e + f*x])^m*(d*Cos[e + f*x])^(n - m), x] /; FreeQ[{a, b, d, e, f, n}, x] &&  !IntegerQ[n] && IntegerQ[m]
Int[((a_.) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)/csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := d^m*Int[(b + a*Sin[e + f*x])^m*(d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, d, e, f, n}, x] &&  !IntegerQ[n] && IntegerQ[m]
Int[((a_.) + (b_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((c_.)*((d_.)*sec[(e_.) + (f_.)*(x_)])^(p_))^(n_), x_Symbol] := c^IntPart[n]*((c*(d*Sec[e + f*x])^p)^FracPart[n]/(d*Sec[e + f*x])^(p*FracPart[n]))*Int[(a + b*Sec[e + f*x])^m*(d*Sec[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[n]
Int[((a_.) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_.)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(p_))^(n_), x_Symbol] := c^IntPart[n]*((c*(d*Csc[e + f*x])^p)^FracPart[n]/(d*Csc[e + f*x])^(p*FracPart[n]))*Int[(a + b*Cos[e + f*x])^m*(d*Cos[e + f*x])^(n*p), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[n]

(* ::Subsection::Closed:: *)
(* 4.3.2.2 (g sec)^p (a+b sec)^m (c+d sec)^n *)
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := b*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^n/(a*f*(2*m + 1))) /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && NeQ[2*m + 1, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := b*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^n/(a*f*(2*m + 1))) + ((m + n + 1)/(a*(2*m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && ILtQ[m + n + 1, 0] && NeQ[2*m + 1, 0] &&  !LtQ[n, 0] &&  !(IGtQ[n + 1/2, 0] && LtQ[n + 1/2, -(m + n)])
Int[csc[(e_.) + (f_.)*(x_)]*(Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := a*c*Log[1 + (b/a)*Csc[e + f*x]]*(Cot[e + f*x]/(b*f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]])) /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := 2*a*c*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(b*f*(2*m + 1)*Sqrt[c + d*Csc[e + f*x]])) /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[m, -2^(-1)]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := 2*a*c*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^(n - 1)/(b*f*(2*m + 1))) - d*((2*n - 1)/(b*(2*m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(c + d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[n - 1/2, 0] && LtQ[m, -2^(-1)]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (-d)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^(n - 1)/(f*(m + n))) + c*((2*n - 1)/(m + n))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m*(c + d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f, m}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[n - 1/2, 0] &&  !LtQ[m, -2^(-1)] &&  !(IGtQ[m - 1/2, 0] && LtQ[m, n])
Int[csc[(e_.) + (f_.)*(x_)]*(((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.)/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*d*Cot[e + f*x]*((c + d*Csc[e + f*x])^(n - 1)/(f*(2*n - 1)*Sqrt[a + b*Csc[e + f*x]])) + 2*c*((2*n - 1)/(2*n - 1))*Int[Csc[e + f*x]*((c + d*Csc[e + f*x])^(n - 1)/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[n, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := 2*a*c*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^(n - 1)/(b*f*(2*m + 1))) - d*((2*n - 1)/(b*(2*m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(c + d*Csc[e + f*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IGtQ[n, 0] && LtQ[m, -2^(-1)] && IntegerQ[2*m]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := ((-a)*c)^m*Int[ExpandTrig[csc[e + f*x]*cot[e + f*x]^(2*m), (c + d*csc[e + f*x])^(n - m), x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegersQ[m, n] && GeQ[n - m, 0] && GtQ[m*n, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := ((-a)*c)^(m + 1/2)*(Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]))*Int[Csc[e + f*x]*Cot[e + f*x]^(2*m), x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m + 1/2]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := b*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^n/(a*f*(2*m + 1))) + ((m + n + 1)/(a*(2*m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && ((ILtQ[m, 0] && ILtQ[n - 1/2, 0]) || (ILtQ[m - 1/2, 0] && ILtQ[n - 1/2, 0] && LtQ[m, n]))
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*c*(Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]))*Subst[Int[(a + b*x)^(m - 1/2)*(c + d*x)^(n - 1/2), x], x, Csc[e + f*x]] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := ((-a)*c)^m*Int[ExpandTrig[(g*csc[e + f*x])^p*cot[e + f*x]^(2*m), (c + d*csc[e + f*x])^(n - m), x], x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegersQ[m, n] && GeQ[n - m, 0] && GtQ[m*n, 0]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(m_), x_Symbol] := ((-a)*c)^(m + 1/2)*(Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]))*Int[(g*Csc[e + f*x])^p*Cot[e + f*x]^(2*m), x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m + 1/2]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a*c*g*(Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]))*Subst[Int[(g*x)^(p - 1)*(a + b*x)^(m - 1/2)*(c + d*x)^(n - 1/2), x], x, Csc[e + f*x]] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[(g_.)*csc[(e_.) + (f_.)*(x_)]]*(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := -2*b*(g/f)*Subst[Int[1/(b*c + a*d - c*g*x^2), x], x, b*(Cot[e + f*x]/(Sqrt[g*Csc[e + f*x]]*Sqrt[a + b*Csc[e + f*x]]))] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[Sqrt[(g_.)*csc[(e_.) + (f_.)*(x_)]]*(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (a/c)*Int[Sqrt[g*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] + ((b*c - a*d)/(c*g))*Int[(g*Csc[e + f*x])^(3/2)/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := -2*(b/f)*Subst[Int[1/(b*c + a*d + d*x^2), x], x, b*(Cot[e + f*x]/Sqrt[a + b*Csc[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (-Sqrt[a + b*Csc[e + f*x]])*(Sqrt[c/(c + d*Csc[e + f*x])]/(d*f*Sqrt[c*d*((a + b*Csc[e + f*x])/((b*c + a*d)*(c + d*Csc[e + f*x])))]))*EllipticE[ArcSin[c*(Cot[e + f*x]/(c + d*Csc[e + f*x]))], -((b*c - a*d)/(b*c + a*d))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (b/d)*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] - ((b*c - a*d)/d)*Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)*(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (g/d)*Int[Sqrt[g*Csc[e + f*x]]*Sqrt[a + b*Csc[e + f*x]], x] - c*(g/d)*Int[Sqrt[g*Csc[e + f*x]]*(Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)*(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (b/d)*Int[(g*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] - ((b*c - a*d)/d)*Int[(g*Csc[e + f*x])^(3/2)/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (b/(b*c - a*d))*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] - (d/(b*c - a*d))*Int[Csc[e + f*x]*(Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[csc[(e_.) + (f_.)*(x_)]/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := -2*(Cot[e + f*x]/(f*(c + d)*Sqrt[a + b*Csc[e + f*x]]*Sqrt[-Cot[e + f*x]^2]))*Sqrt[(a + b*Csc[e + f*x])/(a + b)]*EllipticPi[2*(d/(c + d)), ArcSin[Sqrt[1 - Csc[e + f*x]]/Sqrt[2]], 2*(b/(a + b))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (-a)*(g/(b*c - a*d))*Int[Sqrt[g*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] + c*(g/(b*c - a*d))*Int[Sqrt[g*Csc[e + f*x]]*(Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := g*Sqrt[g*Csc[e + f*x]]*(Sqrt[b + a*Sin[e + f*x]]/Sqrt[a + b*Csc[e + f*x]])*Int[1/(Sqrt[b + a*Sin[e + f*x]]*(d + c*Sin[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]^2/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (-(a/(b*c - a*d)))*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] + (c/(b*c - a*d))*Int[Csc[e + f*x]*(Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && (EqQ[a^2 - b^2, 0] || EqQ[c^2 - d^2, 0])
Int[csc[(e_.) + (f_.)*(x_)]^2/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (1/d)*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] - (c/d)*Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(5/2)/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (-c^2)*(g^2/(d*(b*c - a*d)))*Int[Sqrt[g*Csc[e + f*x]]*(Sqrt[a + b*Csc[e + f*x]]/(c + d*Csc[e + f*x])), x] + (g^2/(d*(b*c - a*d)))*Int[Sqrt[g*Csc[e + f*x]]*((a*c + (b*c - a*d)*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(5/2)/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (g/d)*Int[(g*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] - c*(g/d)*Int[(g*Csc[e + f*x])^(3/2)/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*(b/f)*Subst[Int[1/(1 - b*d*x^2), x], x, Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := (-((b*c - a*d)/d))*Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]), x] + (b/d)*Int[Csc[e + f*x]*(Sqrt[c + d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && EqQ[c^2 - d^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*((a + b*Csc[e + f*x])/(d*f*Sqrt[(a + b)/(c + d)]*Cot[e + f*x]))*Sqrt[(-(b*c - a*d))*((1 - Csc[e + f*x])/((c + d)*(a + b*Csc[e + f*x])))]*Sqrt[(b*c - a*d)*((1 + Csc[e + f*x])/((c - d)*(a + b*Csc[e + f*x])))]*EllipticPi[b*((c + d)/(d*(a + b))), ArcSin[Sqrt[(a + b)/(c + d)]*(Sqrt[c + d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]])], (a - b)*((c + d)/((a + b)*(c - d)))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*(a/(b*f))*Subst[Int[1/(2 + (a*c - b*d)*x^2), x], x, Cot[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]])] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*((c + d*Csc[e + f*x])/(f*(b*c - a*d)*Rt[(c + d)/(a + b), 2]*Cot[e + f*x]))*Sqrt[(b*c - a*d)*((1 - Csc[e + f*x])/((a + b)*(c + d*Csc[e + f*x])))]*Sqrt[(-(b*c - a*d))*((1 + Csc[e + f*x])/((a - b)*(c + d*Csc[e + f*x])))]*EllipticF[ArcSin[Rt[(c + d)/(a + b), 2]*(Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]])], (a + b)*((c - d)/((a - b)*(c + d)))] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]^2/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(c_) + (d_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := (-(a/b))*Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]), x] + (1/b)*Int[Csc[e + f*x]*(Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]]), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0]
Int[csc[(e_.) + (f_.)*(x_)]*(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]/((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(3/2)), x_Symbol] := ((a - b)/(c - d))*Int[Csc[e + f*x]/(Sqrt[a + b*Csc[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]), x] + ((b*c - a*d)/(c - d))*Int[Csc[e + f*x]*((1 + Csc[e + f*x])/(Sqrt[a + b*Csc[e + f*x]]*(c + d*Csc[e + f*x])^(3/2))), x] /; FreeQ[{a, b, c, d, e, f}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^2*g*(Cot[e + f*x]/(f*Sqrt[a + b*Csc[e + f*x]]*Sqrt[a - b*Csc[e + f*x]]))*Subst[Int[(g*x)^(p - 1)*(a + b*x)^(m - 1/2)*((c + d*x)^n/Sqrt[a - b*x]), x], x, Csc[e + f*x]] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && (EqQ[p, 1] || IntegerQ[m - 1/2])
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (1/g^(m + n))*Int[(g*Csc[e + f*x])^(m + n + p)*(b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && NeQ[b*c - a*d, 0] && IntegerQ[m] && IntegerQ[n]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (g*Csc[e + f*x])^(m + p)*((c + d*Csc[e + f*x])^n/(g^m*(d + c*Sin[e + f*x])^n))*Int[(b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[m + n + p, 0] && IntegerQ[m]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := (g*Csc[e + f*x])^p*(a + b*Csc[e + f*x])^m*((c + d*Csc[e + f*x])^n/((b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n))*Int[(b + a*Sin[e + f*x])^m*(d + c*Sin[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] && EqQ[m + n + p, 0] &&  !IntegerQ[m]
Int[csc[(e_.) + (f_.)*(x_)]^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Sqrt[d + c*Sin[e + f*x]]*(Sqrt[a + b*Csc[e + f*x]]/(Sqrt[b + a*Sin[e + f*x]]*Sqrt[c + d*Csc[e + f*x]]))*Int[(b + a*Sin[e + f*x])^m*((d + c*Sin[e + f*x])^n/Sin[e + f*x]^(m + n + p)), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && NeQ[b*c - a*d, 0] && IntegerQ[m - 1/2] && IntegerQ[n - 1/2] && IntegerQ[p] && LeQ[-2, m + n + p, -1]
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Int[ExpandTrig[(g*csc[e + f*x])^p*(a + b*csc[e + f*x])^m*(c + d*csc[e + f*x])^n, x], x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && NeQ[b*c - a*d, 0] && (IntegersQ[m, n] || IntegersQ[m, p] || IntegersQ[n, p])
Int[((g_.)*csc[(e_.) + (f_.)*(x_)])^(p_.)*((a_.) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((c_.) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := Unintegrable[(g*Csc[e + f*x])^p*(a + b*Csc[e + f*x])^m*(c + d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x]
Int[sec[(e_.) + (f_.)*(x_)]*(((A_) + (B_.)*sec[(e_.) + (f_.)*(x_)])/(Sqrt[(a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*sec[(e_.) + (f_.)*(x_)])^(3/2))), x_Symbol] := 2*A*(1 + Sec[e + f*x])*(Sqrt[(b*c - a*d)*((1 - Sec[e + f*x])/((a + b)*(c + d*Sec[e + f*x])))]/(f*(b*c - a*d)*Rt[(c + d)/(a + b), 2]*Tan[e + f*x]*Sqrt[(-(b*c - a*d))*((1 + Sec[e + f*x])/((a - b)*(c + d*Sec[e + f*x])))]))*EllipticE[ArcSin[Rt[(c + d)/(a + b), 2]*(Sqrt[a + b*Sec[e + f*x]]/Sqrt[c + d*Sec[e + f*x]])], (a + b)*((c - d)/((a - b)*(c + d)))] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[A, B]
Int[csc[(e_.) + (f_.)*(x_)]*(((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)])/(Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(3/2))), x_Symbol] := -2*A*(1 + Csc[e + f*x])*(Sqrt[(b*c - a*d)*((1 - Csc[e + f*x])/((a + b)*(c + d*Csc[e + f*x])))]/(f*(b*c - a*d)*Rt[(c + d)/(a + b), 2]*Cot[e + f*x]*Sqrt[(-(b*c - a*d))*((1 + Csc[e + f*x])/((a - b)*(c + d*Csc[e + f*x])))]))*EllipticE[ArcSin[Rt[(c + d)/(a + b), 2]*(Sqrt[a + b*Csc[e + f*x]]/Sqrt[c + d*Csc[e + f*x]])], (a + b)*((c - d)/((a - b)*(c + d)))] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && NeQ[b*c - a*d, 0] && NeQ[a^2 - b^2, 0] && NeQ[c^2 - d^2, 0] && EqQ[A, B]

(* ::Subsection::Closed:: *)
(* 4.3.3.1 (a+b sec)^m (d sec)^n (A+B sec) *)
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := A*a*Cot[e + f*x]*((d*Csc[e + f*x])^n/(f*n)) + (1/(d*n))*Int[(d*Csc[e + f*x])^(n + 1)*Simp[n*(B*a + A*b) + (B*b*n + A*a*(n + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && LeQ[n, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b)*B*Cot[e + f*x]*((d*Csc[e + f*x])^n/(f*(n + 1))) + (1/(n + 1))*Int[(d*Csc[e + f*x])^n*Simp[A*a*(n + 1) + B*b*n + (A*b + B*a)*(n + 1)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] &&  !LeQ[n, -1]
Int[csc[(e_.) + (f_.)*(x_)]*(((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)])/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (B/b)*Int[Csc[e + f*x], x] + ((A*b - a*B)/b)*Int[Csc[e + f*x]/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f, A, B}, x] && NeQ[A*b - a*B, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-B)*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(f*(m + 1))) /; FreeQ[{a, b, A, B, e, f, m}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && EqQ[a*B*m + A*b*(m + 1), 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (A*b - a*B)*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(a*f*(2*m + 1))) + ((a*B*m + A*b*(m + 1))/(a*b*(2*m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, A, B, e, f}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && NeQ[a*B*m + A*b*(m + 1), 0] && LtQ[m, -2^(-1)]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-B)*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(f*(m + 1))) + ((a*B*m + A*b*(m + 1))/(b*(m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m, x] /; FreeQ[{a, b, A, B, e, f, m}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && NeQ[a*B*m + A*b*(m + 1), 0] &&  !LtQ[m, -2^(-1)]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-B)*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(f*(m + 1))) + (1/(m + 1))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*Simp[b*B*m + a*A*(m + 1) + (a*B*m + A*b*(m + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, A, B, e, f}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && GtQ[m, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(A*b - a*B))*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(f*(m + 1)*(a^2 - b^2))) + (1/((m + 1)*(a^2 - b^2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*Simp[(a*A - b*B)*(m + 1) - (A*b - a*B)*(m + 2)*Csc[e + f*x], x], x] /; FreeQ[{a, b, A, B, e, f}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[(e_.) + (f_.)*(x_)]*(((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)])/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := -2*(A*b - a*B)*Rt[a + b*(B/A), 2]*Sqrt[b*((1 - Csc[e + f*x])/(a + b))]*(Sqrt[(-b)*((1 + Csc[e + f*x])/(a - b))]/(b^2*f*Cot[e + f*x]))*EllipticE[ArcSin[Sqrt[a + b*Csc[e + f*x]]/Rt[a + b*(B/A), 2]], (a*A + b*B)/(a*A - b*B)] /; FreeQ[{a, b, e, f, A, B}, x] && NeQ[a^2 - b^2, 0] && EqQ[A^2 - B^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*(((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)])/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := (A - B)*Int[Csc[e + f*x]/Sqrt[a + b*Csc[e + f*x]], x] + B*Int[Csc[e + f*x]*((1 + Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, e, f, A, B}, x] && NeQ[a^2 - b^2, 0] && NeQ[A^2 - B^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := 2*Sqrt[2]*A*(a + b*Csc[e + f*x])^m*(A - B*Csc[e + f*x])*(Sqrt[(A + B*Csc[e + f*x])/A]/(B*f*Cot[e + f*x]*(A*((a + b*Csc[e + f*x])/(a*A + b*B)))^m))*AppellF1[1/2, -(1/2), -m, 3/2, (A - B*Csc[e + f*x])/(2*A), (b*(A - B*Csc[e + f*x]))/(A*b + a*B)] /; FreeQ[{a, b, A, B, e, f}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && EqQ[A^2 - B^2, 0] &&  !IntegerQ[2*m]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := ((A*b - a*B)/b)*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m, x] + (B/b)*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, A, B, e, f, m}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(A*b - a*B))*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(b*f*(2*m + 1))) + (1/(b^2*(2*m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*Simp[A*b*m - a*B*m + b*B*(2*m + 1)*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := a*(A*b - a*B)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 - b^2))) - (1/(b*(m + 1)*(a^2 - b^2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*Simp[b*(A*b - a*B)*(m + 1) - (a*A*b*(m + 2) - B*(a^2 + b^2*(m + 1)))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-B)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 2))) + (1/(b*(m + 2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m*Simp[b*B*(m + 1) + (A*b*(m + 2) - a*B)*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] &&  !LtQ[m, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*n)) /; FreeQ[{a, b, d, e, f, A, B, m, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && EqQ[a*A*m - b*B*n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(A*b - a*B))*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(b*f*(2*m + 1))) + ((a*A*m + b*B*(m + 1))/(a^2*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] && LeQ[m, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*n)) - ((a*A*m - b*B*n)/(b*d*n))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, A, B, m, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && EqQ[m + n + 1, 0] &&  !LeQ[m, -1]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := -2*b*B*Cot[e + f*x]*((d*Csc[e + f*x])^n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]])) /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && EqQ[A*b*(2*n + 1) + 2*a*B*n, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := A*b^2*Cot[e + f*x]*((d*Csc[e + f*x])^n/(a*f*n*Sqrt[a + b*Csc[e + f*x]])) + ((A*b*(2*n + 1) + 2*a*B*n)/(2*a*d*n))*Int[Sqrt[a + b*Csc[e + f*x]]*(d*Csc[e + f*x])^(n + 1), x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && NeQ[A*b*(2*n + 1) + 2*a*B*n, 0] && LtQ[n, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := -2*b*B*Cot[e + f*x]*((d*Csc[e + f*x])^n/(f*(2*n + 1)*Sqrt[a + b*Csc[e + f*x]])) + ((A*b*(2*n + 1) + 2*a*B*n)/(b*(2*n + 1)))*Int[Sqrt[a + b*Csc[e + f*x]]*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && NeQ[A*b*(2*n + 1) + 2*a*B*n, 0] &&  !LtQ[n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := a*A*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*((d*Csc[e + f*x])^n/(f*n)) - (b/(a*d*n))*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n + 1)*Simp[a*A*(m - n - 1) - b*B*n - (a*B*n + A*b*(m + n))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && GtQ[m, 1/2] && LtQ[n, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b)*B*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*((d*Csc[e + f*x])^n/(f*(m + n))) + (1/(d*(m + n)))*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^n*Simp[a*A*d*(m + n) + B*(b*d*n) + (A*b*d*(m + n) + a*B*d*(2*m + n - 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && GtQ[m, 1/2] &&  !LtQ[n, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := d*(A*b - a*B)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^(n - 1)/(a*f*(2*m + 1))) - (1/(a*b*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)*Simp[A*(a*d*(n - 1)) - B*(b*d*(n - 1)) - d*(a*B*(m - n + 1) + A*b*(m + n))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)] && GtQ[n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-(A*b - a*B))*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(b*f*(2*m + 1))) - (1/(a^2*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n*Simp[b*B*n - a*A*(2*m + n + 1) + (A*b - a*B)*(m + n + 1)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)] &&  !GtQ[n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-B)*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^(n - 1)/(f*(m + n))) + (d/(b*(m + n)))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n - 1)*Simp[b*B*(n - 1) + (A*b*(m + n) + a*B*m)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && GtQ[n, 1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*n)) - (1/(b*d*n))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)*Simp[a*A*m - b*B*n - A*b*(m + n + 1)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0] && LtQ[n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := ((A*b - a*B)/b)*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n, x] + (B/b)*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n, x] /; FreeQ[{a, b, d, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] && EqQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := a*A*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*((d*Csc[e + f*x])^n/(f*n)) + (1/(d*n))*Int[(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^(n + 1)*Simp[a*(a*B*n - A*b*(m - n - 1)) + (2*a*b*B*n + A*(b^2*n + a^2*(1 + n)))*Csc[e + f*x] + b*(b*B*n + a*A*(m + n))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && GtQ[m, 1] && LeQ[n, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-b)*B*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m - 1)*((d*Csc[e + f*x])^n/(f*(m + n))) + (1/(m + n))*Int[(a + b*Csc[e + f*x])^(m - 2)*(d*Csc[e + f*x])^n*Simp[a^2*A*(m + n) + a*b*B*n + (a*(2*A*b + a*B)*(m + n) + b^2*B*(m + n - 1))*Csc[e + f*x] + b*(A*b*(m + n) + a*B*(2*m + n - 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && GtQ[m, 1] &&  !(IGtQ[n, 1] &&  !IntegerQ[m])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-d)*(A*b - a*B)*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^(n - 1)/(f*(m + 1)*(a^2 - b^2))) + (1/((m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)*Simp[d*(n - 1)*(A*b - a*B) + d*(a*A - b*B)*(m + 1)*Csc[e + f*x] - d*(A*b - a*B)*(m + n + 1)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && LtQ[0, n, 1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := a*d^2*(A*b - a*B)*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^(n - 2)/(b*f*(m + 1)*(a^2 - b^2))) - (d/(b*(m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 2)*Simp[a*d*(A*b - a*B)*(n - 2) + b*d*(A*b - a*B)*(m + 1)*Csc[e + f*x] - (a*A*b*d*(m + n) - d*B*(a^2*(n - 1) + b^2*(m + 1)))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[n, 1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := b*(A*b - a*B)*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^n/(a*f*(m + 1)*(a^2 - b^2))) + (1/(a*(m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n*Simp[A*(a^2*(m + 1) - b^2*(m + n + 1)) + a*b*B*n - a*(A*b - a*B)*(m + 1)*Csc[e + f*x] + b*(A*b - a*B)*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] &&  !(ILtQ[m + 1/2, 0] && ILtQ[n, 0])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-B)*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^(n - 1)/(f*(m + n))) + (d/(m + n))*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n - 1)*Simp[a*B*(n - 1) + (b*B*(m + n - 1) + a*A*(m + n))*Csc[e + f*x] + (a*B*m + A*b*(m + n))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[0, m, 1] && GtQ[n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*n)) - (1/(d*n))*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n + 1)*Simp[A*b*m - a*B*n - (b*B*n + a*A*(n + 1))*Csc[e + f*x] - A*b*(m + n + 1)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LtQ[0, m, 1] && LeQ[n, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (-B)*d^2*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^(n - 2)/(b*f*(m + n))) + (d^2/(b*(m + n)))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n - 2)*Simp[a*B*(n - 2) + B*b*(m + n - 1)*Csc[e + f*x] + (A*b*(m + n) - a*B*(n - 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && GtQ[n, 1] && NeQ[m + n, 0] &&  !IGtQ[m, 1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^n/(a*f*n)) + (1/(a*d*n))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)*Simp[a*B*n - A*b*(m + n + 1) + A*a*(n + 1)*Csc[e + f*x] + A*b*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, m}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0] && LeQ[n, -1]
Int[((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)])/(Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := (A/a)*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[d*Csc[e + f*x]], x] - ((A*b - a*B)/(a*d))*Int[Sqrt[d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
Int[Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]*(((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)])/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := A*Int[Sqrt[d*Csc[e + f*x]]/Sqrt[a + b*Csc[e + f*x]], x] + (B/d)*Int[(d*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
Int[Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]*(((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)])/Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := (B/d)*Int[Sqrt[a + b*Csc[e + f*x]]*Sqrt[d*Csc[e + f*x]], x] + A*Int[Sqrt[a + b*Csc[e + f*x]]/Sqrt[d*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f, A, B}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*(((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)])/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := (A/a)*Int[(d*Csc[e + f*x])^n, x] - ((A*b - a*B)/(a*d))*Int[(d*Csc[e + f*x])^(n + 1)/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, A, B, n}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.)*((A_) + (B_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := Unintegrable[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n*(A + B*Csc[e + f*x]), x] /; FreeQ[{a, b, d, e, f, A, B, m, n}, x] && NeQ[A*b - a*B, 0] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)])^(p_.), x_Symbol] := ((-a)*c)^m*Int[Cos[e + f*x]^(2*m)*(d + c*Sin[e + f*x])^(n - m)*((B + A*Sin[e + f*x])^p/Sin[e + f*x]^(m + n + p)), x] /; FreeQ[{a, b, c, d, e, f, A, B, n, p}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegersQ[m, n, p]

(* ::Subsection::Closed:: *)
(* 4.3.4.1 (a+b sec)^m (A+B sec+C sec^2) *)
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (1/b^2)*Int[(a + b*Csc[e + f*x])^(m + 1)*Simp[b*B - a*C + b*C*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[A*b^2 - a*b*B + a^2*C, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (C/b^2)*Int[(a + b*Csc[e + f*x])^(m + 1)*Simp[-a + b*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A*b^2 + a^2*C, 0]
Int[((b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((A_) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*Cot[e + f*x]*((b*Csc[e + f*x])^m/(f*m)) /; FreeQ[{b, e, f, A, C, m}, x] && EqQ[C*m + A*(m + 1), 0]
Int[csc[(e_.) + (f_.)*(x_)]^(m_.)*((A_) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := Int[(C + A*Sin[e + f*x]^2)/Sin[e + f*x]^(m + 2), x] /; FreeQ[{e, f, A, C}, x] && NeQ[C*m + A*(m + 1), 0] && ILtQ[(m + 1)/2, 0]
Int[((b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((A_) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*Cot[e + f*x]*((b*Csc[e + f*x])^m/(f*m)) + ((C*m + A*(m + 1))/(b^2*m))*Int[(b*Csc[e + f*x])^(m + 2), x] /; FreeQ[{b, e, f, A, C}, x] && NeQ[C*m + A*(m + 1), 0] && LeQ[m, -1]
Int[((b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((A_) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cot[e + f*x]*((b*Csc[e + f*x])^m/(f*(m + 1))) + ((C*m + A*(m + 1))/(m + 1))*Int[(b*Csc[e + f*x])^m, x] /; FreeQ[{b, e, f, A, C, m}, x] && NeQ[C*m + A*(m + 1), 0] &&  !LeQ[m, -1]
Int[((b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (B/b)*Int[(b*Csc[e + f*x])^(m + 1), x] + Int[(b*Csc[e + f*x])^m*(A + C*Csc[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m}, x]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-b)*C*Csc[e + f*x]*(Cot[e + f*x]/(2*f)) + (1/2)*Int[Simp[2*A*a + (2*B*a + b*(2*A + C))*Csc[e + f*x] + 2*(a*C + B*b)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B, C}, x]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-b)*C*Csc[e + f*x]*(Cot[e + f*x]/(2*f)) + (1/2)*Int[Simp[2*A*a + b*(2*A + C)*Csc[e + f*x] + 2*a*C*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, C}, x]
Int[((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2)/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (C/b)*Int[Csc[e + f*x], x] + (1/b)*Int[(A*b + (b*B - a*C)*Csc[e + f*x])/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f, A, B, C}, x]
Int[((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2)/((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]), x_Symbol] := (C/b)*Int[Csc[e + f*x], x] + (1/b)*Int[(A*b - a*C*Csc[e + f*x])/(a + b*Csc[e + f*x]), x] /; FreeQ[{a, b, e, f, A, C}, x]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(a*A - b*B + a*C))*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(a*f*(2*m + 1))) + (1/(a*b*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*Simp[A*b*(2*m + 1) + (b*B*(m + 1) - a*(A*(m + 1) - C*m))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-a)*(A + C)*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(a*f*(2*m + 1))) + (1/(a*b*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*Simp[A*b*(2*m + 1) - a*(A*(m + 1) - C*m)*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(f*(m + 1))) + (1/(b*(m + 1)))*Int[(a + b*Csc[e + f*x])^m*Simp[A*b*(m + 1) + (a*C*m + b*B*(m + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(f*(m + 1))) + (1/(b*(m + 1)))*Int[(a + b*Csc[e + f*x])^m*Simp[A*b*(m + 1) + a*C*m*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(f*(m + 1))) + (1/(m + 1))*Int[(a + b*Csc[e + f*x])^(m - 1)*Simp[a*A*(m + 1) + ((A*b + a*B)*(m + 1) + b*C*m)*Csc[e + f*x] + (b*B*(m + 1) + a*C*m)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0] && IGtQ[2*m, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cot[e + f*x]*((a + b*Csc[e + f*x])^m/(f*(m + 1))) + (1/(m + 1))*Int[(a + b*Csc[e + f*x])^(m - 1)*Simp[a*A*(m + 1) + (A*b*(m + 1) + b*C*m)*Csc[e + f*x] + a*C*m*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[a^2 - b^2, 0] && IGtQ[2*m, 0]
Int[((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2)/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := Int[(A + (B - C)*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] + C*Int[Csc[e + f*x]*((1 + Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0]
Int[((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2)/Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]], x_Symbol] := Int[(A - C*Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]], x] + C*Int[Csc[e + f*x]*((1 + Csc[e + f*x])/Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A*b^2 - a*b*B + a^2*C)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(a*f*(m + 1)*(a^2 - b^2))) + (1/(a*(m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*Simp[A*(a^2 - b^2)*(m + 1) - a*(A*b - a*B + b*C)*(m + 1)*Csc[e + f*x] + (A*b^2 - a*b*B + a^2*C)*(m + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A*b^2 + a^2*C)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(a*f*(m + 1)*(a^2 - b^2))) + (1/(a*(m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*Simp[A*(a^2 - b^2)*(m + 1) - a*b*(A + C)*(m + 1)*Csc[e + f*x] + (A*b^2 + a^2*C)*(m + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[a^2 - b^2, 0] && IntegerQ[2*m] && LtQ[m, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (1/b)*Int[(a + b*Csc[e + f*x])^m*(A*b + (b*B - a*C)*Csc[e + f*x]), x] + (C/b)*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && NeQ[a^2 - b^2, 0] &&  !IntegerQ[2*m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (1/b)*Int[(a + b*Csc[e + f*x])^m*(A*b - a*C*Csc[e + f*x]), x] + (C/b)*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1), x] /; FreeQ[{a, b, e, f, A, C, m}, x] && NeQ[a^2 - b^2, 0] &&  !IntegerQ[2*m]
Int[((b_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*sec[(e_.) + (f_.)*(x_)] + (C_.)*sec[(e_.) + (f_.)*(x_)]^2), x_Symbol] := b^2*Int[(b*Cos[e + f*x])^(m - 2)*(C + B*Cos[e + f*x] + A*Cos[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m}, x] &&  !IntegerQ[m]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := b^2*Int[(b*Sin[e + f*x])^(m - 2)*(C + B*Sin[e + f*x] + A*Sin[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m}, x] &&  !IntegerQ[m]
Int[((b_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*sec[(e_.) + (f_.)*(x_)]^2), x_Symbol] := b^2*Int[(b*Cos[e + f*x])^(m - 2)*(C + A*Cos[e + f*x]^2), x] /; FreeQ[{b, e, f, A, C, m}, x] &&  !IntegerQ[m]
Int[((b_.)*sin[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := b^2*Int[(b*Sin[e + f*x])^(m - 2)*(C + A*Sin[e + f*x]^2), x] /; FreeQ[{b, e, f, A, C, m}, x] &&  !IntegerQ[m]
Int[((a_.)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(p_))^(m_)*((A_.) + (B_.)*sec[(e_.) + (f_.)*(x_)] + (C_.)*sec[(e_.) + (f_.)*(x_)]^2), x_Symbol] := a^IntPart[m]*((a*(b*Sec[e + f*x])^p)^FracPart[m]/(b*Sec[e + f*x])^(p*FracPart[m]))*Int[(b*Sec[e + f*x])^(m*p)*(A + B*Sec[e + f*x] + C*Sec[e + f*x]^2), x] /; FreeQ[{a, b, e, f, A, B, C, m, p}, x] &&  !IntegerQ[m]
Int[((a_.)*((b_.)*csc[(e_.) + (f_.)*(x_)])^(p_))^(m_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := a^IntPart[m]*((a*(b*Csc[e + f*x])^p)^FracPart[m]/(b*Csc[e + f*x])^(p*FracPart[m]))*Int[(b*Csc[e + f*x])^(m*p)*(A + B*Csc[e + f*x] + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, e, f, A, B, C, m, p}, x] &&  !IntegerQ[m]
Int[((a_.)*((b_.)*sec[(e_.) + (f_.)*(x_)])^(p_))^(m_)*((A_.) + (C_.)*sec[(e_.) + (f_.)*(x_)]^2), x_Symbol] := a^IntPart[m]*((a*(b*Sec[e + f*x])^p)^FracPart[m]/(b*Sec[e + f*x])^(p*FracPart[m]))*Int[(b*Sec[e + f*x])^(m*p)*(A + C*Sec[e + f*x]^2), x] /; FreeQ[{a, b, e, f, A, C, m, p}, x] &&  !IntegerQ[m]
Int[((a_.)*((b_.)*csc[(e_.) + (f_.)*(x_)])^(p_))^(m_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := a^IntPart[m]*((a*(b*Csc[e + f*x])^p)^FracPart[m]/(b*Csc[e + f*x])^(p*FracPart[m]))*Int[(b*Csc[e + f*x])^(m*p)*(A + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, e, f, A, C, m, p}, x] &&  !IntegerQ[m]

(* ::Subsection::Closed:: *)
(* 4.3.4.2 (a+b sec)^m (d sec)^n (A+B sec+C sec^2) *)
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*a*Cot[e + f*x]*((d*Csc[e + f*x])^n/(f*n)) + (1/(d*n))*Int[(d*Csc[e + f*x])^(n + 1)*Simp[n*(B*a + A*b) + (n*(a*C + B*b) + A*a*(n + 1))*Csc[e + f*x] + b*C*n*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && LtQ[n, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*a*Cot[e + f*x]*((d*Csc[e + f*x])^n/(f*n)) + (1/(d*n))*Int[(d*Csc[e + f*x])^(n + 1)*Simp[A*b*n + a*(C*n + A*(n + 1))*Csc[e + f*x] + b*C*n*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C}, x] && LtQ[n, -1]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-b)*C*Csc[e + f*x]*Cot[e + f*x]*((d*Csc[e + f*x])^n/(f*(n + 2))) + (1/(n + 2))*Int[(d*Csc[e + f*x])^n*Simp[A*a*(n + 2) + (B*a*(n + 2) + b*(C*(n + 1) + A*(n + 2)))*Csc[e + f*x] + (a*C + B*b)*(n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] &&  !LtQ[n, -1]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.)*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-b)*C*Csc[e + f*x]*Cot[e + f*x]*((d*Csc[e + f*x])^n/(f*(n + 2))) + (1/(n + 2))*Int[(d*Csc[e + f*x])^n*Simp[A*a*(n + 2) + b*(C*(n + 1) + A*(n + 2))*Csc[e + f*x] + a*C*(n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] &&  !LtQ[n, -1]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(a*A - b*B + a*C))*Cot[e + f*x]*Csc[e + f*x]*((a + b*Csc[e + f*x])^m/(a*f*(2*m + 1))) - (1/(a*b*(2*m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*Simp[a*B - b*C - 2*A*b*(m + 1) - (b*B*(m + 2) - a*(A*(m + 2) - C*(m - 1)))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && LtQ[m, -1] && EqQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(A + C))*Cot[e + f*x]*Csc[e + f*x]*((a + b*Csc[e + f*x])^m/(f*(2*m + 1))) - (1/(a*b*(2*m + 1)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*Simp[(-b)*C - 2*A*b*(m + 1) + a*(A*(m + 2) - C*(m - 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && LtQ[m, -1] && EqQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(A*b^2 - a*b*B + a^2*C))*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 - b^2))) + (1/(b*(m + 1)*(a^2 - b^2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*Simp[b*(a*A - b*B + a*C)*(m + 1) - (A*b^2 - a*b*B + a^2*C + b*(A*b - a*B + b*C)*(m + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && LtQ[m, -1] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(A*b^2 + a^2*C))*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 1)*(a^2 - b^2))) + (1/(b*(m + 1)*(a^2 - b^2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*Simp[a*b*(A + C)*(m + 1) - (A*b^2 + a^2*C + b*(A*b + b*C)*(m + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && LtQ[m, -1] && NeQ[a^2 - b^2, 0]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 2))) + (1/(b*(m + 2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m*Simp[b*A*(m + 2) + b*C*(m + 1) + (b*B*(m + 2) - a*C)*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] &&  !LtQ[m, -1]
Int[csc[(e_.) + (f_.)*(x_)]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 2))) + (1/(b*(m + 2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m*Simp[b*A*(m + 2) + b*C*(m + 1) - a*C*Csc[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] &&  !LtQ[m, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-(a*A - b*B + a*C))*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(a*f*(2*m + 1))) - (1/(a*b*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n*Simp[a*B*n - b*C*n - A*b*(2*m + n + 1) - (b*B*(m + n + 1) - a*(A*(m + n + 1) - C*(m - n)))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-a)*(A + C)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(a*f*(2*m + 1))) + (1/(a*b*(2*m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n*Simp[b*C*n + A*b*(2*m + n + 1) - (a*(A*(m + n + 1) - C*(m - n)))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] && EqQ[a^2 - b^2, 0] && LtQ[m, -2^(-1)]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*n)) - (1/(b*d*n))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)*Simp[a*A*m - b*B*n - b*(A*(m + n + 1) + C*n)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, C, m}, x] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)] && (LtQ[n, -2^(-1)] || EqQ[m + n + 1, 0])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*n)) - (1/(b*d*n))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)*Simp[a*A*m - b*(A*(m + n + 1) + C*n)*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, C, m}, x] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)] && (LtQ[n, -2^(-1)] || EqQ[m + n + 1, 0])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*(m + n + 1))) + (1/(b*(m + n + 1)))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n*Simp[A*b*(m + n + 1) + b*C*n + (a*C*m + b*B*(m + n + 1))*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, B, C, m, n}, x] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)] &&  !LtQ[n, -2^(-1)] && NeQ[m + n + 1, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*(m + n + 1))) + (1/(b*(m + n + 1)))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n*Simp[A*b*(m + n + 1) + b*C*n + a*C*m*Csc[e + f*x], x], x] /; FreeQ[{a, b, d, e, f, A, C, m, n}, x] && EqQ[a^2 - b^2, 0] &&  !LtQ[m, -2^(-1)] &&  !LtQ[n, -2^(-1)] && NeQ[m + n + 1, 0]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := a*(A*b^2 - a*b*B + a^2*C)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(b^2*f*(m + 1)*(a^2 - b^2))) - (1/(b^2*(m + 1)*(a^2 - b^2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*Simp[b*(m + 1)*((-a)*(b*B - a*C) + A*b^2) + (b*B*(a^2 + b^2*(m + 1)) - a*(A*b^2*(m + 2) + C*(a^2 + b^2*(m + 1))))*Csc[e + f*x] - b*C*(m + 1)*(a^2 - b^2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := a*(A*b^2 + a^2*C)*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(b^2*f*(m + 1)*(a^2 - b^2))) - (1/(b^2*(m + 1)*(a^2 - b^2)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*Simp[b*(m + 1)*(a^2*C + A*b^2) - a*(A*b^2*(m + 2) + C*(a^2 + b^2*(m + 1)))*Csc[e + f*x] - b*C*(m + 1)*(a^2 - b^2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, C}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Csc[e + f*x]*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 3))) + (1/(b*(m + 3)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m*Simp[a*C + b*(C*(m + 2) + A*(m + 3))*Csc[e + f*x] - (2*a*C - b*B*(m + 3))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && NeQ[a^2 - b^2, 0] &&  !LtQ[m, -1]
Int[csc[(e_.) + (f_.)*(x_)]^2*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Csc[e + f*x]*Cot[e + f*x]*((a + b*Csc[e + f*x])^(m + 1)/(b*f*(m + 3))) + (1/(b*(m + 3)))*Int[Csc[e + f*x]*(a + b*Csc[e + f*x])^m*Simp[a*C + b*(C*(m + 2) + A*(m + 3))*Csc[e + f*x] - 2*a*C*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && NeQ[a^2 - b^2, 0] &&  !LtQ[m, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*n)) - (1/(d*n))*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n + 1)*Simp[A*b*m - a*B*n - (b*B*n + a*(C*n + A*(n + 1)))*Csc[e + f*x] - b*(C*n + A*(m + n + 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && LeQ[n, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*n)) - (1/(d*n))*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^(n + 1)*Simp[A*b*m - a*(C*n + A*(n + 1))*Csc[e + f*x] - b*(C*n + A*(m + n + 1))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] && LeQ[n, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*(m + n + 1))) + (1/(m + n + 1))*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^n*Simp[a*A*(m + n + 1) + a*C*n + ((A*b + a*B)*(m + n + 1) + b*C*(m + n))*Csc[e + f*x] + (b*B*(m + n + 1) + a*C*m)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] &&  !LeQ[n, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*Cot[e + f*x]*(a + b*Csc[e + f*x])^m*((d*Csc[e + f*x])^n/(f*(m + n + 1))) + (1/(m + n + 1))*Int[(a + b*Csc[e + f*x])^(m - 1)*(d*Csc[e + f*x])^n*Simp[a*A*(m + n + 1) + a*C*n + b*(A*(m + n + 1) + C*(m + n))*Csc[e + f*x] + a*C*m*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] && NeQ[a^2 - b^2, 0] && GtQ[m, 0] &&  !LeQ[n, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-d)*(A*b^2 - a*b*B + a^2*C)*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^(n - 1)/(b*f*(a^2 - b^2)*(m + 1))) + (d/(b*(a^2 - b^2)*(m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)*Simp[A*b^2*(n - 1) - a*(b*B - a*C)*(n - 1) + b*(a*A - b*B + a*C)*(m + 1)*Csc[e + f*x] - (b*(A*b - a*B)*(m + n + 1) + C*(a^2*n + b^2*(m + 1)))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-d)*(A*b^2 + a^2*C)*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^(n - 1)/(b*f*(a^2 - b^2)*(m + 1))) + (d/(b*(a^2 - b^2)*(m + 1)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^(n - 1)*Simp[A*b^2*(n - 1) + a^2*C*(n - 1) + a*b*(A + C)*(m + 1)*Csc[e + f*x] - (A*b^2*(m + n + 1) + C*(a^2*n + b^2*(m + 1)))*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] && GtQ[n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A*b^2 - a*b*B + a^2*C)*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^n/(a*f*(m + 1)*(a^2 - b^2))) + (1/(a*(m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n*Simp[a*(a*A - b*B + a*C)*(m + 1) - (A*b^2 - a*b*B + a^2*C)*(m + n + 1) - a*(A*b - a*B + b*C)*(m + 1)*Csc[e + f*x] + (A*b^2 - a*b*B + a^2*C)*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] &&  !(ILtQ[m + 1/2, 0] && ILtQ[n, 0])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (A*b^2 + a^2*C)*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^n/(a*f*(m + 1)*(a^2 - b^2))) + (1/(a*(m + 1)*(a^2 - b^2)))*Int[(a + b*Csc[e + f*x])^(m + 1)*(d*Csc[e + f*x])^n*Simp[a^2*(A + C)*(m + 1) - (A*b^2 + a^2*C)*(m + n + 1) - a*b*(A + C)*(m + 1)*Csc[e + f*x] + (A*b^2 + a^2*C)*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] && NeQ[a^2 - b^2, 0] && LtQ[m, -1] &&  !(ILtQ[m + 1/2, 0] && ILtQ[n, 0])
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^(n - 1)/(b*f*(m + n + 1))) + (d/(b*(m + n + 1)))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n - 1)*Simp[a*C*(n - 1) + (A*b*(m + n + 1) + b*C*(m + n))*Csc[e + f*x] + (b*B*(m + n + 1) - a*C*n)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C, m}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := (-C)*d*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^(n - 1)/(b*f*(m + n + 1))) + (d/(b*(m + n + 1)))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n - 1)*Simp[a*C*(n - 1) + (A*b*(m + n + 1) + b*C*(m + n))*Csc[e + f*x] - a*C*n*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C, m}, x] && NeQ[a^2 - b^2, 0] && GtQ[n, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^n/(a*f*n)) + (1/(a*d*n))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)*Simp[a*B*n - A*b*(m + n + 1) + a*(A + A*n + C*n)*Csc[e + f*x] + A*b*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, B, C, m}, x] && NeQ[a^2 - b^2, 0] && LeQ[n, -1]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := A*Cot[e + f*x]*(a + b*Csc[e + f*x])^(m + 1)*((d*Csc[e + f*x])^n/(a*f*n)) + (1/(a*d*n))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n + 1)*Simp[(-A)*b*(m + n + 1) + a*(A + A*n + C*n)*Csc[e + f*x] + A*b*(m + n + 2)*Csc[e + f*x]^2, x], x] /; FreeQ[{a, b, d, e, f, A, C, m}, x] && NeQ[a^2 - b^2, 0] && LeQ[n, -1]
Int[((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2)/(Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := ((A*b^2 - a*b*B + a^2*C)/(a^2*d^2))*Int[(d*Csc[e + f*x])^(3/2)/(a + b*Csc[e + f*x]), x] + (1/a^2)*Int[(a*A - (A*b - a*B)*Csc[e + f*x])/Sqrt[d*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0]
Int[((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2)/(Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]*((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])), x_Symbol] := ((A*b^2 + a^2*C)/(a^2*d^2))*Int[(d*Csc[e + f*x])^(3/2)/(a + b*Csc[e + f*x]), x] + (1/a^2)*Int[(a*A - A*b*Csc[e + f*x])/Sqrt[d*Csc[e + f*x]], x] /; FreeQ[{a, b, d, e, f, A, C}, x] && NeQ[a^2 - b^2, 0]
Int[((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2)/(Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := (C/d^2)*Int[(d*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] + Int[(A + B*Csc[e + f*x])/(Sqrt[d*Csc[e + f*x]]*Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, d, e, f, A, B, C}, x] && NeQ[a^2 - b^2, 0]
Int[((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2)/(Sqrt[(d_.)*csc[(e_.) + (f_.)*(x_)]]*Sqrt[(a_) + (b_.)*csc[(e_.) + (f_.)*(x_)]]), x_Symbol] := (C/d^2)*Int[(d*Csc[e + f*x])^(3/2)/Sqrt[a + b*Csc[e + f*x]], x] + A*Int[1/(Sqrt[d*Csc[e + f*x]]*Sqrt[a + b*Csc[e + f*x]]), x] /; FreeQ[{a, b, d, e, f, A, C}, x] && NeQ[a^2 - b^2, 0]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := Unintegrable[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n*(A + B*Csc[e + f*x] + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, B, C, m, n}, x]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(n_.)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := Unintegrable[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^n*(A + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, C, m, n}, x]
Int[((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)*cos[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*sec[(e_.) + (f_.)*(x_)] + (C_.)*sec[(e_.) + (f_.)*(x_)]^2), x_Symbol] := d^(m + 2)*Int[(b + a*Cos[e + f*x])^m*(d*Cos[e + f*x])^(n - m - 2)*(C + B*Cos[e + f*x] + A*Cos[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] &&  !IntegerQ[n] && IntegerQ[m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := d^(m + 2)*Int[(b + a*Sin[e + f*x])^m*(d*Sin[e + f*x])^(n - m - 2)*(C + B*Sin[e + f*x] + A*Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, B, C, n}, x] &&  !IntegerQ[n] && IntegerQ[m]
Int[((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)*cos[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*sec[(e_.) + (f_.)*(x_)]^2), x_Symbol] := d^(m + 2)*Int[(b + a*Cos[e + f*x])^m*(d*Cos[e + f*x])^(n - m - 2)*(C + A*Cos[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] &&  !IntegerQ[n] && IntegerQ[m]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((d_.)*sin[(e_.) + (f_.)*(x_)])^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := d^(m + 2)*Int[(b + a*Sin[e + f*x])^m*(d*Sin[e + f*x])^(n - m - 2)*(C + A*Sin[e + f*x]^2), x] /; FreeQ[{a, b, d, e, f, A, C, n}, x] &&  !IntegerQ[n] && IntegerQ[m]
Int[((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((c_.)*((d_.)*sec[(e_.) + (f_.)*(x_)])^(p_))^(n_)*((A_.) + (B_.)*sec[(e_.) + (f_.)*(x_)] + (C_.)*sec[(e_.) + (f_.)*(x_)]^2), x_Symbol] := c^IntPart[n]*((c*(d*Sec[e + f*x])^p)^FracPart[n]/(d*Sec[e + f*x])^(p*FracPart[n]))*Int[(a + b*Sec[e + f*x])^m*(d*Sec[e + f*x])^(n*p)*(A + B*Sec[e + f*x] + C*Sec[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n, p}, x] &&  !IntegerQ[n]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_.)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(p_))^(n_)*((A_.) + (B_.)*csc[(e_.) + (f_.)*(x_)] + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := c^IntPart[n]*((c*(d*Csc[e + f*x])^p)^FracPart[n]/(d*Csc[e + f*x])^(p*FracPart[n]))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n*p)*(A + B*Csc[e + f*x] + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, B, C, m, n, p}, x] &&  !IntegerQ[n]
Int[((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((c_.)*((d_.)*sec[(e_.) + (f_.)*(x_)])^(p_))^(n_)*((A_.) + (C_.)*sec[(e_.) + (f_.)*(x_)]^2), x_Symbol] := c^IntPart[n]*((c*(d*Sec[e + f*x])^p)^FracPart[n]/(d*Sec[e + f*x])^(p*FracPart[n]))*Int[(a + b*Sec[e + f*x])^m*(d*Sec[e + f*x])^(n*p)*(A + C*Sec[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n, p}, x] &&  !IntegerQ[n]
Int[((a_) + (b_.)*csc[(e_.) + (f_.)*(x_)])^(m_.)*((c_.)*((d_.)*csc[(e_.) + (f_.)*(x_)])^(p_))^(n_)*((A_.) + (C_.)*csc[(e_.) + (f_.)*(x_)]^2), x_Symbol] := c^IntPart[n]*((c*(d*Csc[e + f*x])^p)^FracPart[n]/(d*Csc[e + f*x])^(p*FracPart[n]))*Int[(a + b*Csc[e + f*x])^m*(d*Csc[e + f*x])^(n*p)*(A + C*Csc[e + f*x]^2), x] /; FreeQ[{a, b, c, d, e, f, A, C, m, n, p}, x] &&  !IntegerQ[n]

(* ::Subsection::Closed:: *)
(* 4.3.7 (d trig)^m (a+b (c sec)^n)^p *)
Int[(u_.)*((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := b^p*Int[ActivateTrig[u*tan[e + f*x]^(2*p)], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a + b, 0] && IntegerQ[p]
Int[(u_.)*((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := Int[ActivateTrig[u*(b*tan[e + f*x]^2)^p], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a + b, 0]
Int[((b_.)*sec[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, b*(ff/f)*Subst[Int[(b + b*ff^2*x^2)^(p - 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{b, e, f, p}, x] &&  !IntegerQ[p]
Int[((b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := b^IntPart[p]*((b*(c*Sec[e + f*x])^n)^FracPart[p]/(c*Sec[e + f*x])^(n*FracPart[p]))*Int[(c*Sec[e + f*x])^(n*p), x] /; FreeQ[{b, c, e, f, n, p}, x] &&  !IntegerQ[p]
Int[tan[(e_.) + (f_.)*(x_)]^(m_.)*((b_.)*sec[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := (b/(2*f))*Subst[Int[(-1 + x)^((m - 1)/2)*(b*x)^(p - 1), x], x, Sec[e + f*x]^2] /; FreeQ[{b, e, f, p}, x] &&  !IntegerQ[p] && IntegerQ[(m - 1)/2]
Int[(u_.)*((b_.)*sec[(e_.) + (f_.)*(x_)]^(n_))^(p_), x_Symbol] := With[{ff = FreeFactors[Sec[e + f*x], x]}, (b*ff^n)^IntPart[p]*((b*Sec[e + f*x]^n)^FracPart[p]/(Sec[e + f*x]/ff)^(n*FracPart[p]))*Int[ActivateTrig[u]*(Sec[e + f*x]/ff)^(n*p), x]] /; FreeQ[{b, e, f, n, p}, x] &&  !IntegerQ[p] && IntegerQ[n] && (EqQ[u, 1] || MatchQ[u, ((d_.)*(trig_)[e + f*x])^(m_.) /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[(u_.)*((b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := b^IntPart[p]*((b*(c*Sec[e + f*x])^n)^FracPart[p]/(c*Sec[e + f*x])^(n*FracPart[p]))*Int[ActivateTrig[u]*(c*Sec[e + f*x])^(n*p), x] /; FreeQ[{b, c, e, f, n, p}, x] &&  !IntegerQ[p] &&  !IntegerQ[n] && (EqQ[u, 1] || MatchQ[u, ((d_.)*(trig_)[e + f*x])^(m_.) /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[1/((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^2), x_Symbol] := x/a - (b/a)*Int[1/(b + a*Cos[e + f*x]^2), x] /; FreeQ[{a, b, e, f}, x] && NeQ[a + b, 0]
Int[((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^2)^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(a + b + b*ff^2*x^2)^p/(1 + ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && NeQ[a + b, 0] && NeQ[p, -1]
Int[((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^4)^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(a + b + 2*b*ff^2*x^2 + b*ff^4*x^4)^p/(1 + ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[2*p]
Int[((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^(n_))^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(a + b*(1 + ff^2*x^2)^(n/2))^p/(1 + ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[n/2] && IGtQ[p, -2]
Int[((a_) + (b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := Unintegrable[(a + b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, e, f, n, p}, x]
Int[sin[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff^(m + 1)/f)*Subst[Int[x^m*(ExpandToSum[a + b*(1 + ff^2*x^2)^(n/2), x]^p/(1 + ff^2*x^2)^(m/2 + 1)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && IntegerQ[n/2]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, (-(ff/f))*Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*((b + a*(ff*x)^n)^p/(ff*x)^(n*p)), x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n] && IntegerQ[p]
Int[sin[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Cos[e + f*x], x]}, (1/(f*ff^m))*Subst[Int[(-1 + ff^2*x^2)^((m - 1)/2)*((a + b*(c*ff*x)^n)^p/x^(m + 1)), x], x, Sec[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && IntegerQ[(m - 1)/2] && (GtQ[m, 0] || EqQ[n, 2] || EqQ[n, 4])
Int[((d_.)*sin[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Unintegrable[(d*Sin[e + f*x])^m*(a + b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[((d_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^(n_.))^(p_.), x_Symbol] := d^(n*p)*Int[(d*Cos[e + f*x])^(m - n*p)*(b + a*Cos[e + f*x]^n)^p, x] /; FreeQ[{a, b, d, e, f, m, n, p}, x] &&  !IntegerQ[m] && IntegersQ[n, p]
Int[((d_.)*cos[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := (d*Cos[e + f*x])^FracPart[m]*(Sec[e + f*x]/d)^FracPart[m]*Int[(a + b*(c*Sec[e + f*x])^n)^p/(Sec[e + f*x]/d)^m, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[m]
Int[tan[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := Module[{ff = FreeFactors[Cos[e + f*x], x]}, (-(f*ff^(m + n*p - 1))^(-1))*Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*((b + a*(ff*x)^n)^p/x^(m + n*p)), x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f, n}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n] && IntegerQ[p]
Int[tan[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Sec[e + f*x], x]}, (1/f)*Subst[Int[(-1 + ff^2*x^2)^((m - 1)/2)*((a + b*(c*ff*x)^n)^p/x), x], x, Sec[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && IntegerQ[(m - 1)/2] && (GtQ[m, 0] || EqQ[n, 2] || EqQ[n, 4] || IGtQ[p, 0] || IntegersQ[2*n, p])
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*sec[(e_.) + (f_.)*(x_)]^2)^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, b*(ff/f)*Subst[Int[(d*ff*x)^m*(b + b*ff^2*x^2)^(p - 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{b, d, e, f, m, p}, x]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^(n_))^(p_.), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(d*ff*x)^m*((a + b*(1 + ff^2*x^2)^(n/2))^p/(1 + ff^2*x^2)), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] && IntegerQ[n/2] && (IntegerQ[m/2] || EqQ[n, 2])
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := d*(d*Tan[e + f*x])^(m - 1)*((b*(c*Sec[e + f*x])^n)^p/(f*(p*n + m - 1))) - d^2*((m - 1)/(p*n + m - 1))*Int[(d*Tan[e + f*x])^(m - 2)*(b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{b, c, d, e, f, p, n}, x] && GtQ[m, 1] && NeQ[p*n + m - 1, 0] && IntegersQ[2*p*n, 2*m]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_)*((b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := (d*Tan[e + f*x])^(m + 1)*((b*(c*Sec[e + f*x])^n)^p/(d*f*(m + 1))) - ((p*n + m + 1)/(d^2*(m + 1)))*Int[(d*Tan[e + f*x])^(m + 2)*(b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{b, c, d, e, f, p, n}, x] && LtQ[m, -1] && NeQ[p*n + m + 1, 0] && IntegersQ[2*p*n, 2*m]
Int[((d_.)*tan[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Unintegrable[(d*Tan[e + f*x])^m*(a + b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[((d_.)*cot[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := (d*Cot[e + f*x])^FracPart[m]*(Tan[e + f*x]/d)^FracPart[m]*Int[(a + b*(c*Sec[e + f*x])^n)^p/(Tan[e + f*x]/d)^m, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[m]
Int[sec[(e_.) + (f_.)*(x_)]^(m_)*((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^(n_))^(p_), x_Symbol] := With[{ff = FreeFactors[Tan[e + f*x], x]}, (ff/f)*Subst[Int[(1 + ff^2*x^2)^(m/2 - 1)*ExpandToSum[a + b*(1 + ff^2*x^2)^(n/2), x]^p, x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && IntegerQ[n/2]
Int[sec[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^(n_))^(p_), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (ff/f)*Subst[Int[ExpandToSum[b + a*(1 - ff^2*x^2)^(n/2), x]^p/(1 - ff^2*x^2)^((m + n*p + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[sec[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^(n_))^(p_), x_Symbol] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (ff/f)*Subst[Int[(a + b/(1 - ff^2*x^2)^(n/2))^p/(1 - ff^2*x^2)^((m + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] &&  !IntegerQ[p]
Int[sec[(e_.) + (f_.)*(x_)]^(m_.)*((a_) + (b_.)*sec[(e_.) + (f_.)*(x_)]^(n_))^(p_), x_Symbol] := Int[ExpandTrig[sec[e + f*x]^m*(a + b*sec[e + f*x]^n)^p, x], x] /; FreeQ[{a, b, e, f}, x] && IntegersQ[m, n, p]
Int[((d_.)*sec[(e_.) + (f_.)*(x_)])^(m_.)*((a_) + (b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_.), x_Symbol] := Unintegrable[(d*Sec[e + f*x])^m*(a + b*(c*Sec[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[((d_.)*csc[(e_.) + (f_.)*(x_)])^(m_)*((a_) + (b_.)*((c_.)*sec[(e_.) + (f_.)*(x_)])^(n_))^(p_), x_Symbol] := (d*Csc[e + f*x])^FracPart[m]*(Sin[e + f*x]/d)^FracPart[m]*Int[(a + b*(c*Sec[e + f*x])^n)^p/(Sin[e + f*x]/d)^m, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] &&  !IntegerQ[m]

(* ::Subsection::Closed:: *)
(* 4.3.9 trig^m (a+b sec^n+c sec^(2 n))^p *)
Int[((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*csc[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := (1/(4^p*c^p))*Int[(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Sec[d + e*x]^n + c*Sec[d + e*x]^(2*n))^p/(b + 2*c*Sec[d + e*x]^n)^(2*p))*Int[u*(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*csc[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Csc[d + e*x]^n + c*Csc[d + e*x]^(2*n))^p/(b + 2*c*Csc[d + e*x]^n)^(2*p))*Int[u*(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[1/((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_.)), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*(c/q)*Int[1/(b - q + 2*c*Sec[d + e*x]^n), x] - 2*(c/q)*Int[1/(b + q + 2*c*Sec[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[1/((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*csc[(d_.) + (e_.)*(x_)]^(n2_.)), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*(c/q)*Int[1/(b - q + 2*c*Csc[d + e*x]^n), x] - 2*(c/q)*Int[1/(b + q + 2*c*Csc[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[sin[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{f = FreeFactors[Cos[d + e*x], x]}, (-(f/e))*Subst[Int[(1 - f^2*x^2)^((m - 1)/2)*((b + a*(f*x)^n)^p/(f*x)^(n*p)), x], x, Cos[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegersQ[n, p]
Int[cos[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*csc[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{f = FreeFactors[Sin[d + e*x], x]}, (f/e)*Subst[Int[(1 - f^2*x^2)^((m - 1)/2)*((b + a*(f*x)^n)^p/(f*x)^(n*p)), x], x, Sin[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegersQ[n, p]
Int[sin[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, (f^(m + 1)/e)*Subst[Int[x^m*(ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)^(m/2 + 1)), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[cos[(d_.) + (e_.)*(x_)]^(m_)*((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*csc[(d_.) + (e_.)*(x_)]^(n2_))^(p_.), x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, (-(f^(m + 1)/e))*Subst[Int[x^m*(ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)^(m/2 + 1)), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[sec[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := (1/(4^p*c^p))*Int[Sec[d + e*x]^m*(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[csc[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*csc[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := (1/(4^p*c^p))*Int[Csc[d + e*x]^m*(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[sec[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Sec[d + e*x]^n + c*Sec[d + e*x]^(2*n))^p/(b + 2*c*Sec[d + e*x]^n)^(2*p))*Int[Sec[d + e*x]^m*(b + 2*c*Sec[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[csc[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*csc[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := ((a + b*Csc[d + e*x]^n + c*Csc[d + e*x]^(2*n))^p/(b + 2*c*Csc[d + e*x]^n)^(2*p))*Int[Csc[d + e*x]^m*(b + 2*c*Csc[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[p]
Int[sec[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := Int[ExpandTrig[sec[d + e*x]^m*(a + b*sec[d + e*x]^n + c*sec[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegersQ[m, n, p]
Int[csc[(d_.) + (e_.)*(x_)]^(m_.)*((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*csc[(d_.) + (e_.)*(x_)]^(n2_.))^(p_), x_Symbol] := Int[ExpandTrig[csc[d + e*x]^m*(a + b*csc[d + e*x]^n + c*csc[d + e*x]^(2*n))^p, x], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegersQ[m, n, p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_) + (b_.)*sec[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Module[{f = FreeFactors[Cos[d + e*x], x]}, (-(e*f^(m + n*p - 1))^(-1))*Subst[Int[(1 - f^2*x^2)^((m - 1)/2)*((c + b*(f*x)^n + c*(f*x)^(2*n))^p/x^(m + 2*n*p)), x], x, Cos[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n] && IntegerQ[p]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_) + (b_.)*csc[(d_.) + (e_.)*(x_)]^(n_.) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Module[{f = FreeFactors[Sin[d + e*x], x]}, (1/(e*f^(m + n*p - 1)))*Subst[Int[(1 - f^2*x^2)^((m - 1)/2)*((c + b*(f*x)^n + c*(f*x)^(2*n))^p/x^(m + 2*n*p)), x], x, Sin[d + e*x]/f]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n] && IntegerQ[p]
Int[tan[(d_.) + (e_.)*(x_)]^(m_.)*((a_) + (b_.)*sec[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Module[{f = FreeFactors[Tan[d + e*x], x]}, (f^(m + 1)/e)*Subst[Int[x^m*(ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)), x], x, Tan[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[cot[(d_.) + (e_.)*(x_)]^(m_.)*((a_) + (b_.)*csc[(d_.) + (e_.)*(x_)]^(n_) + (c_.)*sec[(d_.) + (e_.)*(x_)]^(n2_.))^(p_.), x_Symbol] := Module[{f = FreeFactors[Cot[d + e*x], x]}, (-(f^(m + 1)/e))*Subst[Int[x^m*(ExpandToSum[a + b*(1 + f^2*x^2)^(n/2) + c*(1 + f^2*x^2)^n, x]^p/(1 + f^2*x^2)), x], x, Cot[d + e*x]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[m/2] && IntegerQ[n/2]
Int[((A_) + (B_.)*sec[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*sec[(d_.) + (e_.)*(x_)] + (c_.)*sec[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := (1/(4^n*c^n))*Int[(A + B*Sec[d + e*x])*(b + 2*c*Sec[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[((A_) + (B_.)*csc[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*csc[(d_.) + (e_.)*(x_)] + (c_.)*csc[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := (1/(4^n*c^n))*Int[(A + B*Csc[d + e*x])*(b + 2*c*Csc[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[((A_) + (B_.)*sec[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*sec[(d_.) + (e_.)*(x_)] + (c_.)*sec[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := ((a + b*Sec[d + e*x] + c*Sec[d + e*x]^2)^n/(b + 2*c*Sec[d + e*x])^(2*n))*Int[(A + B*Sec[d + e*x])*(b + 2*c*Sec[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[n]
Int[((A_) + (B_.)*csc[(d_.) + (e_.)*(x_)])*((a_) + (b_.)*csc[(d_.) + (e_.)*(x_)] + (c_.)*csc[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := ((a + b*Csc[d + e*x] + c*Csc[d + e*x]^2)^n/(b + 2*c*Csc[d + e*x])^(2*n))*Int[(A + B*Csc[d + e*x])*(b + 2*c*Csc[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] &&  !IntegerQ[n]
Int[((A_) + (B_.)*sec[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)] + (c_.)*sec[(d_.) + (e_.)*(x_)]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/(b + q + 2*c*Sec[d + e*x]), x] + (B - (b*B - 2*A*c)/q)*Int[1/(b - q + 2*c*Sec[d + e*x]), x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[((A_) + (B_.)*csc[(d_.) + (e_.)*(x_)])/((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)] + (c_.)*csc[(d_.) + (e_.)*(x_)]^2), x_Symbol] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)*Int[1/(b + q + 2*c*Csc[d + e*x]), x] + (B - (b*B - 2*A*c)/q)*Int[1/(b - q + 2*c*Csc[d + e*x]), x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[((A_) + (B_.)*sec[(d_.) + (e_.)*(x_)])*((a_.) + (b_.)*sec[(d_.) + (e_.)*(x_)] + (c_.)*sec[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := Int[ExpandTrig[(A + B*sec[d + e*x])*(a + b*sec[d + e*x] + c*sec[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[((A_) + (B_.)*csc[(d_.) + (e_.)*(x_)])*((a_.) + (b_.)*csc[(d_.) + (e_.)*(x_)] + (c_.)*csc[(d_.) + (e_.)*(x_)]^2)^(n_), x_Symbol] := Int[ExpandTrig[(A + B*csc[d + e*x])*(a + b*csc[d + e*x] + c*csc[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]

(* ::Subsection::Closed:: *)
(* 4.1 Sine normalization rules *)
Int[(u_)*((c_.)*tan[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*sin[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Tan[a + b*x])^m*((d*Cos[a + b*x])^m/(d*Sin[a + b*x])^m)*Int[ActivateTrig[u]*((d*Sin[a + b*x])^(m + n)/(d*Cos[a + b*x])^m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x] &&  !IntegerQ[m]
Int[(u_)*((c_.)*tan[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*cos[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Tan[a + b*x])^m*((d*Cos[a + b*x])^m/(d*Sin[a + b*x])^m)*Int[ActivateTrig[u]*((d*Sin[a + b*x])^m/(d*Cos[a + b*x])^(m - n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x] &&  !IntegerQ[m]
Int[(u_)*((c_.)*cot[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*sin[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Cot[a + b*x])^m*((d*Sin[a + b*x])^m/(d*Cos[a + b*x])^m)*Int[ActivateTrig[u]*((d*Cos[a + b*x])^m/(d*Sin[a + b*x])^(m - n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x] &&  !IntegerQ[m]
Int[(u_)*((c_.)*cot[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*cos[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Cot[a + b*x])^m*((d*Sin[a + b*x])^m/(d*Cos[a + b*x])^m)*Int[ActivateTrig[u]*((d*Cos[a + b*x])^(m + n)/(d*Sin[a + b*x])^m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x] &&  !IntegerQ[m]
Int[(u_)*((c_.)*sec[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*cos[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Sec[a + b*x])^m*(d*Cos[a + b*x])^m*Int[ActivateTrig[u]*(d*Cos[a + b*x])^(n - m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x]
Int[(u_)*((c_.)*sec[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*cos[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Csc[a + b*x])^m*(d*Sin[a + b*x])^m*Int[ActivateTrig[u]*(d*Sin[a + b*x])^(n - m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSineIntegrandQ[u, x]
Int[(u_)*((c_.)*tan[(a_.) + (b_.)*(x_)])^(m_.), x_Symbol] := (c*Tan[a + b*x])^m*((c*Cos[a + b*x])^m/(c*Sin[a + b*x])^m)*Int[ActivateTrig[u]*((c*Sin[a + b*x])^m/(c*Cos[a + b*x])^m), x] /; FreeQ[{a, b, c, m}, x] &&  !IntegerQ[m] && KnownSineIntegrandQ[u, x]
Int[(u_)*((c_.)*cot[(a_.) + (b_.)*(x_)])^(m_.), x_Symbol] := (c*Cot[a + b*x])^m*((c*Sin[a + b*x])^m/(c*Cos[a + b*x])^m)*Int[ActivateTrig[u]*((c*Cos[a + b*x])^m/(c*Sin[a + b*x])^m), x] /; FreeQ[{a, b, c, m}, x] &&  !IntegerQ[m] && KnownSineIntegrandQ[u, x]
Int[(u_)*((c_.)*sec[(a_.) + (b_.)*(x_)])^(m_.), x_Symbol] := (c*Sec[a + b*x])^m*(c*Cos[a + b*x])^m*Int[ActivateTrig[u]/(c*Cos[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] &&  !IntegerQ[m] && KnownSineIntegrandQ[u, x]
Int[(u_)*((c_.)*csc[(a_.) + (b_.)*(x_)])^(m_.), x_Symbol] := (c*Csc[a + b*x])^m*(c*Sin[a + b*x])^m*Int[ActivateTrig[u]/(c*Sin[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] &&  !IntegerQ[m] && KnownSineIntegrandQ[u, x]
Int[(u_)*((c_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (B_.)*csc[(a_.) + (b_.)*(x_)]), x_Symbol] := c*Int[ActivateTrig[u]*(c*Sin[a + b*x])^(n - 1)*(B + A*Sin[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownSineIntegrandQ[u, x]
Int[(u_)*((c_.)*cos[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (B_.)*sec[(a_.) + (b_.)*(x_)]), x_Symbol] := c*Int[ActivateTrig[u]*(c*Cos[a + b*x])^(n - 1)*(B + A*Cos[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownSineIntegrandQ[u, x]
Int[(u_)*((A_) + (B_.)*csc[(a_.) + (b_.)*(x_)]), x_Symbol] := Int[ActivateTrig[u]*((B + A*Sin[a + b*x])/Sin[a + b*x]), x] /; FreeQ[{a, b, A, B}, x] && KnownSineIntegrandQ[u, x]
Int[(u_)*((A_) + (B_.)*sec[(a_.) + (b_.)*(x_)]), x_Symbol] := Int[ActivateTrig[u]*((B + A*Cos[a + b*x])/Cos[a + b*x]), x] /; FreeQ[{a, b, A, B}, x] && KnownSineIntegrandQ[u, x]
Int[(u_.)*((c_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((A_.) + (B_.)*csc[(a_.) + (b_.)*(x_)] + (C_.)*csc[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Sin[a + b*x])^(n - 2)*(C + B*Sin[a + b*x] + A*Sin[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownSineIntegrandQ[u, x]
Int[(u_.)*((c_.)*cos[(a_.) + (b_.)*(x_)])^(n_.)*((A_.) + (B_.)*sec[(a_.) + (b_.)*(x_)] + (C_.)*sec[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Cos[a + b*x])^(n - 2)*(C + B*Cos[a + b*x] + A*Cos[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownSineIntegrandQ[u, x]
Int[(u_.)*((c_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (C_.)*csc[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Sin[a + b*x])^(n - 2)*(C + A*Sin[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownSineIntegrandQ[u, x]
Int[(u_.)*((c_.)*cos[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (C_.)*sec[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Cos[a + b*x])^(n - 2)*(C + A*Cos[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownSineIntegrandQ[u, x]
Int[(u_)*((A_.) + (B_.)*csc[(a_.) + (b_.)*(x_)] + (C_.)*csc[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + B*Sin[a + b*x] + A*Sin[a + b*x]^2)/Sin[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C}, x] && KnownSineIntegrandQ[u, x]
Int[(u_)*((A_.) + (B_.)*sec[(a_.) + (b_.)*(x_)] + (C_.)*sec[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + B*Cos[a + b*x] + A*Cos[a + b*x]^2)/Cos[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C}, x] && KnownSineIntegrandQ[u, x]
Int[(u_)*((A_) + (C_.)*csc[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + A*Sin[a + b*x]^2)/Sin[a + b*x]^2), x] /; FreeQ[{a, b, A, C}, x] && KnownSineIntegrandQ[u, x]
Int[(u_)*((A_) + (C_.)*sec[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + A*Cos[a + b*x]^2)/Cos[a + b*x]^2), x] /; FreeQ[{a, b, A, C}, x] && KnownSineIntegrandQ[u, x]
Int[(u_)*((A_.) + (B_.)*sin[(a_.) + (b_.)*(x_)] + (C_.)*csc[(a_.) + (b_.)*(x_)]), x_Symbol] := Int[ActivateTrig[u]*((C + A*Sin[a + b*x] + B*Sin[a + b*x]^2)/Sin[a + b*x]), x] /; FreeQ[{a, b, A, B, C}, x]
Int[(u_)*((A_.) + (B_.)*cos[(a_.) + (b_.)*(x_)] + (C_.)*sec[(a_.) + (b_.)*(x_)]), x_Symbol] := Int[ActivateTrig[u]*((C + A*Cos[a + b*x] + B*Cos[a + b*x]^2)/Cos[a + b*x]), x] /; FreeQ[{a, b, A, B, C}, x]
Int[(u_)*((A_.)*sin[(a_.) + (b_.)*(x_)]^(n_.) + (B_.)*sin[(a_.) + (b_.)*(x_)]^(n1_) + (C_.)*sin[(a_.) + (b_.)*(x_)]^(n2_)), x_Symbol] := Int[ActivateTrig[u]*Sin[a + b*x]^n*(A + B*Sin[a + b*x] + C*Sin[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]
Int[(u_)*((A_.)*cos[(a_.) + (b_.)*(x_)]^(n_.) + (B_.)*cos[(a_.) + (b_.)*(x_)]^(n1_) + (C_.)*cos[(a_.) + (b_.)*(x_)]^(n2_)), x_Symbol] := Int[ActivateTrig[u]*Cos[a + b*x]^n*(A + B*Cos[a + b*x] + C*Cos[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]

(* ::Subsection::Closed:: *)
(* 4.2 Tangent normalization rules *)
Int[(u_)*((c_.)*cot[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*tan[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Cot[a + b*x])^m*(d*Tan[a + b*x])^m*Int[ActivateTrig[u]*(d*Tan[a + b*x])^(n - m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownTangentIntegrandQ[u, x]
Int[(u_)*((c_.)*tan[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*cos[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Tan[a + b*x])^m*((d*Cos[a + b*x])^m/(d*Sin[a + b*x])^m)*Int[ActivateTrig[u]*((d*Sin[a + b*x])^m/(d*Cos[a + b*x])^(m - n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownCotangentIntegrandQ[u, x]
Int[(u_)*((c_.)*cot[(a_.) + (b_.)*(x_)])^(m_.), x_Symbol] := (c*Cot[a + b*x])^m*(c*Tan[a + b*x])^m*Int[ActivateTrig[u]/(c*Tan[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] &&  !IntegerQ[m] && KnownTangentIntegrandQ[u, x]
Int[(u_)*((c_.)*tan[(a_.) + (b_.)*(x_)])^(m_.), x_Symbol] := (c*Cot[a + b*x])^m*(c*Tan[a + b*x])^m*Int[ActivateTrig[u]/(c*Cot[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] &&  !IntegerQ[m] && KnownCotangentIntegrandQ[u, x]
Int[(u_)*((c_.)*tan[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (B_.)*cot[(a_.) + (b_.)*(x_)]), x_Symbol] := c*Int[ActivateTrig[u]*(c*Tan[a + b*x])^(n - 1)*(B + A*Tan[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownTangentIntegrandQ[u, x]
Int[(u_)*((c_.)*cot[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (B_.)*tan[(a_.) + (b_.)*(x_)]), x_Symbol] := c*Int[ActivateTrig[u]*(c*Cot[a + b*x])^(n - 1)*(B + A*Cot[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownCotangentIntegrandQ[u, x]
Int[(u_)*((A_) + (B_.)*cot[(a_.) + (b_.)*(x_)]), x_Symbol] := Int[ActivateTrig[u]*((B + A*Tan[a + b*x])/Tan[a + b*x]), x] /; FreeQ[{a, b, A, B}, x] && KnownTangentIntegrandQ[u, x]
Int[(u_)*((A_) + (B_.)*tan[(a_.) + (b_.)*(x_)]), x_Symbol] := Int[ActivateTrig[u]*((B + A*Cot[a + b*x])/Cot[a + b*x]), x] /; FreeQ[{a, b, A, B}, x] && KnownCotangentIntegrandQ[u, x]
Int[(u_.)*((c_.)*tan[(a_.) + (b_.)*(x_)])^(n_.)*((A_.) + (B_.)*cot[(a_.) + (b_.)*(x_)] + (C_.)*cot[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Tan[a + b*x])^(n - 2)*(C + B*Tan[a + b*x] + A*Tan[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownTangentIntegrandQ[u, x]
Int[(u_.)*((c_.)*cot[(a_.) + (b_.)*(x_)])^(n_.)*((A_.) + (B_.)*tan[(a_.) + (b_.)*(x_)] + (C_.)*tan[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Cot[a + b*x])^(n - 2)*(C + B*Cot[a + b*x] + A*Cot[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownCotangentIntegrandQ[u, x]
Int[(u_.)*((c_.)*tan[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (C_.)*cot[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Tan[a + b*x])^(n - 2)*(C + A*Tan[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownTangentIntegrandQ[u, x]
Int[(u_.)*((c_.)*cot[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (C_.)*tan[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Cot[a + b*x])^(n - 2)*(C + A*Cot[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownCotangentIntegrandQ[u, x]
Int[(u_)*((A_.) + (B_.)*cot[(a_.) + (b_.)*(x_)] + (C_.)*cot[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + B*Tan[a + b*x] + A*Tan[a + b*x]^2)/Tan[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C}, x] && KnownTangentIntegrandQ[u, x]
Int[(u_)*((A_.) + (B_.)*tan[(a_.) + (b_.)*(x_)] + (C_.)*tan[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + B*Cot[a + b*x] + A*Cot[a + b*x]^2)/Cot[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C}, x] && KnownCotangentIntegrandQ[u, x]
Int[(u_)*((A_) + (C_.)*cot[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + A*Tan[a + b*x]^2)/Tan[a + b*x]^2), x] /; FreeQ[{a, b, A, C}, x] && KnownTangentIntegrandQ[u, x]
Int[(u_)*((A_) + (C_.)*tan[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + A*Cot[a + b*x]^2)/Cot[a + b*x]^2), x] /; FreeQ[{a, b, A, C}, x] && KnownCotangentIntegrandQ[u, x]
Int[(u_)*((A_.) + (B_.)*tan[(a_.) + (b_.)*(x_)] + (C_.)*cot[(a_.) + (b_.)*(x_)]), x_Symbol] := Int[ActivateTrig[u]*((C + A*Tan[a + b*x] + B*Tan[a + b*x]^2)/Tan[a + b*x]), x] /; FreeQ[{a, b, A, B, C}, x]
Int[(u_)*((A_.)*tan[(a_.) + (b_.)*(x_)]^(n_.) + (B_.)*tan[(a_.) + (b_.)*(x_)]^(n1_) + (C_.)*tan[(a_.) + (b_.)*(x_)]^(n2_)), x_Symbol] := Int[ActivateTrig[u]*Tan[a + b*x]^n*(A + B*Tan[a + b*x] + C*Tan[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]
Int[(u_)*((A_.)*cot[(a_.) + (b_.)*(x_)]^(n_.) + (B_.)*cot[(a_.) + (b_.)*(x_)]^(n1_) + (C_.)*cot[(a_.) + (b_.)*(x_)]^(n2_)), x_Symbol] := Int[ActivateTrig[u]*Cot[a + b*x]^n*(A + B*Cot[a + b*x] + C*Cot[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]

(* ::Subsection::Closed:: *)
(* 4.3 Secant normalization rules *)
Int[(u_)*((c_.)*sin[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*csc[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Sin[a + b*x])^m*(d*Csc[a + b*x])^m*Int[ActivateTrig[u]*(d*Csc[a + b*x])^(n - m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((c_.)*cos[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*sec[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Cos[a + b*x])^m*(d*Sec[a + b*x])^m*Int[ActivateTrig[u]*(d*Sec[a + b*x])^(n - m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((c_.)*tan[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*sec[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Tan[a + b*x])^m*((d*Csc[a + b*x])^m/(d*Sec[a + b*x])^m)*Int[ActivateTrig[u]*((d*Sec[a + b*x])^(m + n)/(d*Csc[a + b*x])^m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x] &&  !IntegerQ[m]
Int[(u_)*((c_.)*tan[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*csc[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Tan[a + b*x])^m*((d*Csc[a + b*x])^m/(d*Sec[a + b*x])^m)*Int[ActivateTrig[u]*((d*Sec[a + b*x])^m/(d*Csc[a + b*x])^(m - n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x] &&  !IntegerQ[m]
Int[(u_)*((c_.)*cot[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*sec[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Cot[a + b*x])^m*((d*Sec[a + b*x])^m/(d*Csc[a + b*x])^m)*Int[ActivateTrig[u]*((d*Csc[a + b*x])^m/(d*Sec[a + b*x])^(m - n)), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x] &&  !IntegerQ[m]
Int[(u_)*((c_.)*cot[(a_.) + (b_.)*(x_)])^(m_.)*((d_.)*csc[(a_.) + (b_.)*(x_)])^(n_.), x_Symbol] := (c*Cot[a + b*x])^m*((d*Sec[a + b*x])^m/(d*Csc[a + b*x])^m)*Int[ActivateTrig[u]*((d*Csc[a + b*x])^(m + n)/(d*Sec[a + b*x])^m), x] /; FreeQ[{a, b, c, d, m, n}, x] && KnownSecantIntegrandQ[u, x] &&  !IntegerQ[m]
Int[(u_)*((c_.)*sin[(a_.) + (b_.)*(x_)])^(m_.), x_Symbol] := (c*Csc[a + b*x])^m*(c*Sin[a + b*x])^m*Int[ActivateTrig[u]/(c*Csc[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] &&  !IntegerQ[m] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((c_.)*cos[(a_.) + (b_.)*(x_)])^(m_.), x_Symbol] := (c*Cos[a + b*x])^m*(c*Sec[a + b*x])^m*Int[ActivateTrig[u]/(c*Sec[a + b*x])^m, x] /; FreeQ[{a, b, c, m}, x] &&  !IntegerQ[m] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((c_.)*tan[(a_.) + (b_.)*(x_)])^(m_.), x_Symbol] := (c*Tan[a + b*x])^m*((c*Csc[a + b*x])^m/(c*Sec[a + b*x])^m)*Int[ActivateTrig[u]*((c*Sec[a + b*x])^m/(c*Csc[a + b*x])^m), x] /; FreeQ[{a, b, c, m}, x] &&  !IntegerQ[m] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((c_.)*cot[(a_.) + (b_.)*(x_)])^(m_.), x_Symbol] := (c*Cot[a + b*x])^m*((c*Sec[a + b*x])^m/(c*Csc[a + b*x])^m)*Int[ActivateTrig[u]*((c*Csc[a + b*x])^m/(c*Sec[a + b*x])^m), x] /; FreeQ[{a, b, c, m}, x] &&  !IntegerQ[m] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((c_.)*sec[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (B_.)*cos[(a_.) + (b_.)*(x_)]), x_Symbol] := c*Int[ActivateTrig[u]*(c*Sec[a + b*x])^(n - 1)*(B + A*Sec[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((c_.)*csc[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (B_.)*sin[(a_.) + (b_.)*(x_)]), x_Symbol] := c*Int[ActivateTrig[u]*(c*Csc[a + b*x])^(n - 1)*(B + A*Csc[a + b*x]), x] /; FreeQ[{a, b, c, A, B, n}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((A_) + (B_.)*cos[(a_.) + (b_.)*(x_)]), x_Symbol] := Int[ActivateTrig[u]*((B + A*Sec[a + b*x])/Sec[a + b*x]), x] /; FreeQ[{a, b, A, B}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((A_) + (B_.)*sin[(a_.) + (b_.)*(x_)]), x_Symbol] := Int[ActivateTrig[u]*((B + A*Csc[a + b*x])/Csc[a + b*x]), x] /; FreeQ[{a, b, A, B}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_.)*((c_.)*sec[(a_.) + (b_.)*(x_)])^(n_.)*((A_.) + (B_.)*cos[(a_.) + (b_.)*(x_)] + (C_.)*cos[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Sec[a + b*x])^(n - 2)*(C + B*Sec[a + b*x] + A*Sec[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_.)*((c_.)*csc[(a_.) + (b_.)*(x_)])^(n_.)*((A_.) + (B_.)*sin[(a_.) + (b_.)*(x_)] + (C_.)*sin[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Csc[a + b*x])^(n - 2)*(C + B*Csc[a + b*x] + A*Csc[a + b*x]^2), x] /; FreeQ[{a, b, c, A, B, C, n}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_.)*((c_.)*sec[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (C_.)*cos[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Sec[a + b*x])^(n - 2)*(C + A*Sec[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_.)*((c_.)*csc[(a_.) + (b_.)*(x_)])^(n_.)*((A_) + (C_.)*sin[(a_.) + (b_.)*(x_)]^2), x_Symbol] := c^2*Int[ActivateTrig[u]*(c*Csc[a + b*x])^(n - 2)*(C + A*Csc[a + b*x]^2), x] /; FreeQ[{a, b, c, A, C, n}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((A_.) + (B_.)*cos[(a_.) + (b_.)*(x_)] + (C_.)*cos[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + B*Sec[a + b*x] + A*Sec[a + b*x]^2)/Sec[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((A_.) + (B_.)*sin[(a_.) + (b_.)*(x_)] + (C_.)*sin[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + B*Csc[a + b*x] + A*Csc[a + b*x]^2)/Csc[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((A_) + (C_.)*cos[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + A*Sec[a + b*x]^2)/Sec[a + b*x]^2), x] /; FreeQ[{a, b, A, C}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((A_) + (C_.)*sin[(a_.) + (b_.)*(x_)]^2), x_Symbol] := Int[ActivateTrig[u]*((C + A*Csc[a + b*x]^2)/Csc[a + b*x]^2), x] /; FreeQ[{a, b, A, C}, x] && KnownSecantIntegrandQ[u, x]
Int[(u_)*((A_.)*sec[(a_.) + (b_.)*(x_)]^(n_.) + (B_.)*sec[(a_.) + (b_.)*(x_)]^(n1_) + (C_.)*sec[(a_.) + (b_.)*(x_)]^(n2_)), x_Symbol] := Int[ActivateTrig[u]*Sec[a + b*x]^n*(A + B*Sec[a + b*x] + C*Sec[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]
Int[(u_)*((A_.)*csc[(a_.) + (b_.)*(x_)]^(n_.) + (B_.)*csc[(a_.) + (b_.)*(x_)]^(n1_) + (C_.)*csc[(a_.) + (b_.)*(x_)]^(n2_)), x_Symbol] := Int[ActivateTrig[u]*Csc[a + b*x]^n*(A + B*Csc[a + b*x] + C*Csc[a + b*x]^2), x] /; FreeQ[{a, b, A, B, C, n}, x] && EqQ[n1, n + 1] && EqQ[n2, n + 2]

(* ::Subsection::Closed:: *)
(* 4.4.1 (c trig)^m (d trig)^n *)
Int[sin[(a_.) + (b_.)*(x_)]*sin[(c_.) + (d_.)*(x_)], x_Symbol] := Sin[a - c + (b - d)*x]/(2*(b - d)) - Sin[a + c + (b + d)*x]/(2*(b + d)) /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[cos[(a_.) + (b_.)*(x_)]*cos[(c_.) + (d_.)*(x_)], x_Symbol] := Sin[a - c + (b - d)*x]/(2*(b - d)) + Sin[a + c + (b + d)*x]/(2*(b + d)) /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[sin[(a_.) + (b_.)*(x_)]*cos[(c_.) + (d_.)*(x_)], x_Symbol] := -(Cos[a - c + (b - d)*x]/(2*(b - d))) - Cos[a + c + (b + d)*x]/(2*(b + d)) /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[cos[(a_.) + (b_.)*(x_)]^2*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (1/2)*Int[(g*Sin[c + d*x])^p, x] + (1/2)*Int[Cos[c + d*x]*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IGtQ[p/2, 0]
Int[sin[(a_.) + (b_.)*(x_)]^2*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (1/2)*Int[(g*Sin[c + d*x])^p, x] - (1/2)*Int[Cos[c + d*x]*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IGtQ[p/2, 0]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_.)*sin[(c_.) + (d_.)*(x_)]^(p_.), x_Symbol] := (2^p/e^p)*Int[(e*Cos[a + b*x])^(m + p)*Sin[a + b*x]^p, x] /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IntegerQ[p]
Int[((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*sin[(c_.) + (d_.)*(x_)]^(p_.), x_Symbol] := (2^p/f^p)*Int[Cos[a + b*x]^p*(f*Sin[a + b*x])^(n + p), x] /; FreeQ[{a, b, c, d, f, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IntegerQ[p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := e^2*(e*Cos[a + b*x])^(m - 2)*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1))) /; FreeQ[{a, b, c, d, e, g, m, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && EqQ[m + p - 1, 0]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-e^2)*(e*Sin[a + b*x])^(m - 2)*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1))) /; FreeQ[{a, b, c, d, e, g, m, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && EqQ[m + p - 1, 0]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-(e*Cos[a + b*x])^m)*((g*Sin[c + d*x])^(p + 1)/(b*g*m)) /; FreeQ[{a, b, c, d, e, g, m, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && EqQ[m + 2*p + 2, 0]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (e*Sin[a + b*x])^m*((g*Sin[c + d*x])^(p + 1)/(b*g*m)) /; FreeQ[{a, b, c, d, e, g, m, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && EqQ[m + 2*p + 2, 0]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := e^2*(e*Cos[a + b*x])^(m - 2)*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1))) + e^4*((m + p - 1)/(4*g^2*(p + 1)))*Int[(e*Cos[a + b*x])^(m - 4)*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 2] && LtQ[p, -1] && (GtQ[m, 3] || EqQ[p, -3/2]) && IntegersQ[2*m, 2*p]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-e^2)*(e*Sin[a + b*x])^(m - 2)*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1))) + e^4*((m + p - 1)/(4*g^2*(p + 1)))*Int[(e*Sin[a + b*x])^(m - 4)*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 2] && LtQ[p, -1] && (GtQ[m, 3] || EqQ[p, -3/2]) && IntegersQ[2*m, 2*p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (e*Cos[a + b*x])^m*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1))) + e^2*((m + 2*p + 2)/(4*g^2*(p + 1)))*Int[(e*Cos[a + b*x])^(m - 2)*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 1] && LtQ[p, -1] && NeQ[m + 2*p + 2, 0] && (LtQ[p, -2] || EqQ[m, 2]) && IntegersQ[2*m, 2*p]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-(e*Sin[a + b*x])^m)*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1))) + e^2*((m + 2*p + 2)/(4*g^2*(p + 1)))*Int[(e*Sin[a + b*x])^(m - 2)*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 1] && LtQ[p, -1] && NeQ[m + 2*p + 2, 0] && (LtQ[p, -2] || EqQ[m, 2]) && IntegersQ[2*m, 2*p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := e^2*(e*Cos[a + b*x])^(m - 2)*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(m + 2*p))) + e^2*((m + p - 1)/(m + 2*p))*Int[(e*Cos[a + b*x])^(m - 2)*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 1] && NeQ[m + 2*p, 0] && IntegersQ[2*m, 2*p]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-e^2)*(e*Sin[a + b*x])^(m - 2)*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(m + 2*p))) + e^2*((m + p - 1)/(m + 2*p))*Int[(e*Sin[a + b*x])^(m - 2)*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 1] && NeQ[m + 2*p, 0] && IntegersQ[2*m, 2*p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-(e*Cos[a + b*x])^m)*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(m + p + 1))) + ((m + 2*p + 2)/(e^2*(m + p + 1)))*Int[(e*Cos[a + b*x])^(m + 2)*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && LtQ[m, -1] && NeQ[m + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*p]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (e*Sin[a + b*x])^m*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(m + p + 1))) + ((m + 2*p + 2)/(e^2*(m + p + 1)))*Int[(e*Sin[a + b*x])^(m + 2)*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && LtQ[m, -1] && NeQ[m + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*p]
Int[cos[(a_.) + (b_.)*(x_)]*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := 2*Sin[a + b*x]*((g*Sin[c + d*x])^p/(d*(2*p + 1))) + 2*p*(g/(2*p + 1))*Int[Sin[a + b*x]*(g*Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[p, 0] && IntegerQ[2*p]
Int[sin[(a_.) + (b_.)*(x_)]*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := -2*Cos[a + b*x]*((g*Sin[c + d*x])^p/(d*(2*p + 1))) + 2*p*(g/(2*p + 1))*Int[Cos[a + b*x]*(g*Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[p, 0] && IntegerQ[2*p]
Int[cos[(a_.) + (b_.)*(x_)]*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := Cos[a + b*x]*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1))) + ((2*p + 3)/(2*g*(p + 1)))*Int[Sin[a + b*x]*(g*Sin[c + d*x])^(p + 1), x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && LtQ[p, -1] && IntegerQ[2*p]
Int[sin[(a_.) + (b_.)*(x_)]*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-Sin[a + b*x])*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(p + 1))) + ((2*p + 3)/(2*g*(p + 1)))*Int[Cos[a + b*x]*(g*Sin[c + d*x])^(p + 1), x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && LtQ[p, -1] && IntegerQ[2*p]
Int[cos[(a_.) + (b_.)*(x_)]/Sqrt[sin[(c_.) + (d_.)*(x_)]], x_Symbol] := -(ArcSin[Cos[a + b*x] - Sin[a + b*x]]/d) + Log[Cos[a + b*x] + Sin[a + b*x] + Sqrt[Sin[c + d*x]]]/d /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2]
Int[sin[(a_.) + (b_.)*(x_)]/Sqrt[sin[(c_.) + (d_.)*(x_)]], x_Symbol] := -(ArcSin[Cos[a + b*x] - Sin[a + b*x]]/d) - Log[Cos[a + b*x] + Sin[a + b*x] + Sqrt[Sin[c + d*x]]]/d /; FreeQ[{a, b, c, d}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2]
Int[((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_)/cos[(a_.) + (b_.)*(x_)], x_Symbol] := 2*g*Int[Sin[a + b*x]*(g*Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && IntegerQ[2*p]
Int[((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_)/sin[(a_.) + (b_.)*(x_)], x_Symbol] := 2*g*Int[Cos[a + b*x]*(g*Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && IntegerQ[2*p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := ((g*Sin[c + d*x])^p/((e*Cos[a + b*x])^p*Sin[a + b*x]^p))*Int[(e*Cos[a + b*x])^(m + p)*Sin[a + b*x]^p, x] /; FreeQ[{a, b, c, d, e, g, m, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p]
Int[((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := ((g*Sin[c + d*x])^p/(Cos[a + b*x]^p*(f*Sin[a + b*x])^p))*Int[Cos[a + b*x]^p*(f*Sin[a + b*x])^(n + p), x] /; FreeQ[{a, b, c, d, f, g, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p]
Int[cos[(a_.) + (b_.)*(x_)]^2*sin[(a_.) + (b_.)*(x_)]^2*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (1/4)*Int[(g*Sin[c + d*x])^p, x] - (1/4)*Int[Cos[c + d*x]^2*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IGtQ[p/2, 0]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_.)*((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*sin[(c_.) + (d_.)*(x_)]^(p_.), x_Symbol] := (2^p/(e^p*f^p))*Int[(e*Cos[a + b*x])^(m + p)*(f*Sin[a + b*x])^(n + p), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] && IntegerQ[p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_.)*((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := e*(e*Cos[a + b*x])^(m - 1)*(f*Sin[a + b*x])^(n + 1)*((g*Sin[c + d*x])^p/(b*f*(n + p + 1))) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && EqQ[m + p + 1, 0]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*cos[(a_.) + (b_.)*(x_)])^(n_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-e)*(e*Sin[a + b*x])^(m - 1)*(f*Cos[a + b*x])^(n + 1)*((g*Sin[c + d*x])^p/(b*f*(n + p + 1))) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && EqQ[m + p + 1, 0]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_.)*((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-(e*Cos[a + b*x])^(m + 1))*(f*Sin[a + b*x])^(n + 1)*((g*Sin[c + d*x])^p/(b*e*f*(m + p + 1))) /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && EqQ[m + n + 2*p + 2, 0] && NeQ[m + p + 1, 0]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := e^2*(e*Cos[a + b*x])^(m - 2)*(f*Sin[a + b*x])^n*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(n + p + 1))) + e^4*((m + p - 1)/(4*g^2*(n + p + 1)))*Int[(e*Cos[a + b*x])^(m - 4)*(f*Sin[a + b*x])^n*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 3] && LtQ[p, -1] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*cos[(a_.) + (b_.)*(x_)])^(n_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-e^2)*(e*Sin[a + b*x])^(m - 2)*(f*Cos[a + b*x])^n*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(n + p + 1))) + e^4*((m + p - 1)/(4*g^2*(n + p + 1)))*Int[(e*Sin[a + b*x])^(m - 4)*(f*Cos[a + b*x])^n*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 3] && LtQ[p, -1] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (e*Cos[a + b*x])^m*(f*Sin[a + b*x])^n*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(n + p + 1))) + e^2*((m + n + 2*p + 2)/(4*g^2*(n + p + 1)))*Int[(e*Cos[a + b*x])^(m - 2)*(f*Sin[a + b*x])^n*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 1] && LtQ[p, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p] && (LtQ[p, -2] || EqQ[m, 2] || EqQ[m, 3])
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*cos[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-(e*Sin[a + b*x])^m)*(f*Cos[a + b*x])^n*((g*Sin[c + d*x])^(p + 1)/(2*b*g*(n + p + 1))) + e^2*((m + n + 2*p + 2)/(4*g^2*(n + p + 1)))*Int[(e*Sin[a + b*x])^(m - 2)*(f*Cos[a + b*x])^n*(g*Sin[c + d*x])^(p + 2), x] /; FreeQ[{a, b, c, d, e, f, g, n}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 1] && LtQ[p, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p] && (LtQ[p, -2] || EqQ[m, 2] || EqQ[m, 3])
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := e*(e*Cos[a + b*x])^(m - 1)*(f*Sin[a + b*x])^(n + 1)*((g*Sin[c + d*x])^p/(b*f*(n + p + 1))) + e^2*((m + p - 1)/(f^2*(n + p + 1)))*Int[(e*Cos[a + b*x])^(m - 2)*(f*Sin[a + b*x])^(n + 2)*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 1] && LtQ[n, -1] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*cos[(a_.) + (b_.)*(x_)])^(n_)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-e)*(e*Sin[a + b*x])^(m - 1)*(f*Cos[a + b*x])^(n + 1)*((g*Sin[c + d*x])^p/(b*f*(n + p + 1))) + e^2*((m + p - 1)/(f^2*(n + p + 1)))*Int[(e*Sin[a + b*x])^(m - 2)*(f*Cos[a + b*x])^(n + 2)*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 1] && LtQ[n, -1] && NeQ[n + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := e*(e*Cos[a + b*x])^(m - 1)*(f*Sin[a + b*x])^(n + 1)*((g*Sin[c + d*x])^p/(b*f*(m + n + 2*p))) + e^2*((m + p - 1)/(m + n + 2*p))*Int[(e*Cos[a + b*x])^(m - 2)*(f*Sin[a + b*x])^n*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 1] && NeQ[m + n + 2*p, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*cos[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-e)*(e*Sin[a + b*x])^(m - 1)*(f*Cos[a + b*x])^(n + 1)*((g*Sin[c + d*x])^p/(b*f*(m + n + 2*p))) + e^2*((m + p - 1)/(m + n + 2*p))*Int[(e*Sin[a + b*x])^(m - 2)*(f*Cos[a + b*x])^n*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && GtQ[m, 1] && NeQ[m + n + 2*p, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-f)*(e*Cos[a + b*x])^(m + 1)*(f*Sin[a + b*x])^(n - 1)*((g*Sin[c + d*x])^p/(b*e*(m + n + 2*p))) + 2*f*g*((n + p - 1)/(e*(m + n + 2*p)))*Int[(e*Cos[a + b*x])^(m + 1)*(f*Sin[a + b*x])^(n - 1)*(g*Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && LtQ[m, -1] && GtQ[n, 0] && GtQ[p, 0] && NeQ[m + n + 2*p, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*cos[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := f*(e*Sin[a + b*x])^(m + 1)*(f*Cos[a + b*x])^(n - 1)*((g*Sin[c + d*x])^p/(b*e*(m + n + 2*p))) + 2*f*g*((n + p - 1)/(e*(m + n + 2*p)))*Int[(e*Sin[a + b*x])^(m + 1)*(f*Cos[a + b*x])^(n - 1)*(g*Sin[c + d*x])^(p - 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && LtQ[m, -1] && GtQ[n, 0] && GtQ[p, 0] && NeQ[m + n + 2*p, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-(e*Cos[a + b*x])^(m + 1))*(f*Sin[a + b*x])^(n + 1)*((g*Sin[c + d*x])^p/(b*e*f*(m + p + 1))) + f*((m + n + 2*p + 2)/(2*e*g*(m + p + 1)))*Int[(e*Cos[a + b*x])^(m + 1)*(f*Sin[a + b*x])^(n - 1)*(g*Sin[c + d*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && LtQ[m, -1] && GtQ[n, 0] && LtQ[p, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*cos[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (e*Sin[a + b*x])^(m + 1)*(f*Cos[a + b*x])^(n + 1)*((g*Sin[c + d*x])^p/(b*e*f*(m + p + 1))) + f*((m + n + 2*p + 2)/(2*e*g*(m + p + 1)))*Int[(e*Sin[a + b*x])^(m + 1)*(f*Cos[a + b*x])^(n - 1)*(g*Sin[c + d*x])^(p + 1), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && LtQ[m, -1] && GtQ[n, 0] && LtQ[p, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (-(e*Cos[a + b*x])^(m + 1))*(f*Sin[a + b*x])^(n + 1)*((g*Sin[c + d*x])^p/(b*e*f*(m + p + 1))) + ((m + n + 2*p + 2)/(e^2*(m + p + 1)))*Int[(e*Cos[a + b*x])^(m + 2)*(f*Sin[a + b*x])^n*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && LtQ[m, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*sin[(a_.) + (b_.)*(x_)])^(m_)*((f_.)*cos[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := (e*Sin[a + b*x])^(m + 1)*(f*Cos[a + b*x])^(n + 1)*((g*Sin[c + d*x])^p/(b*e*f*(m + p + 1))) + ((m + n + 2*p + 2)/(e^2*(m + p + 1)))*Int[(e*Sin[a + b*x])^(m + 2)*(f*Cos[a + b*x])^n*(g*Sin[c + d*x])^p, x] /; FreeQ[{a, b, c, d, e, f, g, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p] && LtQ[m, -1] && NeQ[m + n + 2*p + 2, 0] && NeQ[m + p + 1, 0] && IntegersQ[2*m, 2*n, 2*p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_.)*((f_.)*sin[(a_.) + (b_.)*(x_)])^(n_.)*((g_.)*sin[(c_.) + (d_.)*(x_)])^(p_), x_Symbol] := ((g*Sin[c + d*x])^p/((e*Cos[a + b*x])^p*(f*Sin[a + b*x])^p))*Int[(e*Cos[a + b*x])^(m + p)*(f*Sin[a + b*x])^(n + p), x] /; FreeQ[{a, b, c, d, e, f, g, m, n, p}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, 2] &&  !IntegerQ[p]
Int[((e_.)*cos[(a_.) + (b_.)*(x_)])^(m_.)*sin[(c_.) + (d_.)*(x_)], x_Symbol] := (-(m + 2))*(e*Cos[a + b*x])^(m + 1)*(Cos[(m + 1)*(a + b*x)]/(d*e*(m + 1))) /; FreeQ[{a, b, c, d, e, m}, x] && EqQ[b*c - a*d, 0] && EqQ[d/b, Abs[m + 2]]

(* ::Subsection::Closed:: *)
(* 4.4.3 Inert trig functions *)
Int[((a_.)*(F_)[(c_.) + (d_.)*(x_)]^(p_))^(n_), x_Symbol] := With[{v = ActivateTrig[F[c + d*x]]}, a^IntPart[n]*(v/NonfreeFactors[v, x])^(p*IntPart[n])*((a*v^p)^FracPart[n]/NonfreeFactors[v, x]^(p*FracPart[n]))*Int[NonfreeFactors[v, x]^(n*p), x]] /; FreeQ[{a, c, d, n, p}, x] && InertTrigQ[F] &&  !IntegerQ[n] && IntegerQ[p]
Int[((a_.)*((b_.)*(F_)[(c_.) + (d_.)*(x_)])^(p_))^(n_.), x_Symbol] := With[{v = ActivateTrig[F[c + d*x]]}, a^IntPart[n]*((a*(b*v)^p)^FracPart[n]/(b*v)^(p*FracPart[n]))*Int[(b*v)^(n*p), x]] /; FreeQ[{a, b, c, d, n, p}, x] && InertTrigQ[F] &&  !IntegerQ[n] &&  !IntegerQ[p]
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[1, Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Cos] || EqQ[F, cos])
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, (-(d/(b*c)))*Subst[Int[SubstFor[1, Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Sin] || EqQ[F, sin])
Int[(u_)*Cosh[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[1, Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x]
Int[(u_)*Sinh[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[1, Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x]
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, (1/(b*c))*Subst[Int[SubstFor[1/x, Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Cot] || EqQ[F, cot])
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, (-(b*c)^(-1))*Subst[Int[SubstFor[1/x, Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Tan] || EqQ[F, tan])
Int[(u_)*Coth[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, (1/(b*c))*Subst[Int[SubstFor[1/x, Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x]
Int[(u_)*Tanh[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, (1/(b*c))*Subst[Int[SubstFor[1/x, Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x]
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^2, x_Symbol] := With[{d = FreeFactors[Tan[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[1, Tan[c*(a + b*x)]/d, u, x], x], x, Tan[c*(a + b*x)]/d] /; FunctionOfQ[Tan[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u] && (EqQ[F, Sec] || EqQ[F, sec])
Int[(u_)/cos[(c_.)*((a_.) + (b_.)*(x_))]^2, x_Symbol] := With[{d = FreeFactors[Tan[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[1, Tan[c*(a + b*x)]/d, u, x], x], x, Tan[c*(a + b*x)]/d] /; FunctionOfQ[Tan[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u]
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^2, x_Symbol] := With[{d = FreeFactors[Cot[c*(a + b*x)], x]}, (-(d/(b*c)))*Subst[Int[SubstFor[1, Cot[c*(a + b*x)]/d, u, x], x], x, Cot[c*(a + b*x)]/d] /; FunctionOfQ[Cot[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u] && (EqQ[F, Csc] || EqQ[F, csc])
Int[(u_)/sin[(c_.)*((a_.) + (b_.)*(x_))]^2, x_Symbol] := With[{d = FreeFactors[Cot[c*(a + b*x)], x]}, (-(d/(b*c)))*Subst[Int[SubstFor[1, Cot[c*(a + b*x)]/d, u, x], x], x, Cot[c*(a + b*x)]/d] /; FunctionOfQ[Cot[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u]
Int[(u_)*Sech[(c_.)*((a_.) + (b_.)*(x_))]^2, x_Symbol] := With[{d = FreeFactors[Tanh[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[1, Tanh[c*(a + b*x)]/d, u, x], x], x, Tanh[c*(a + b*x)]/d] /; FunctionOfQ[Tanh[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u]
Int[(u_)*Csch[(c_.)*((a_.) + (b_.)*(x_))]^2, x_Symbol] := With[{d = FreeFactors[Coth[c*(a + b*x)], x]}, (-(d/(b*c)))*Subst[Int[SubstFor[1, Coth[c*(a + b*x)]/d, u, x], x], x, Coth[c*(a + b*x)]/d] /; FunctionOfQ[Coth[c*(a + b*x)]/d, u, x, True]] /; FreeQ[{a, b, c}, x] && NonsumQ[u]
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^(n_.), x_Symbol] := With[{d = FreeFactors[Tan[c*(a + b*x)], x]}, (1/(b*c*d^(n - 1)))*Subst[Int[SubstFor[1/(x^n*(1 + d^2*x^2)), Tan[c*(a + b*x)]/d, u, x], x], x, Tan[c*(a + b*x)]/d] /; FunctionOfQ[Tan[c*(a + b*x)]/d, u, x, True] && TryPureTanSubst[ActivateTrig[u]*Cot[c*(a + b*x)]^n, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n] && (EqQ[F, Cot] || EqQ[F, cot])
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^(n_.), x_Symbol] := With[{d = FreeFactors[Cot[c*(a + b*x)], x]}, (-(b*c*d^(n - 1))^(-1))*Subst[Int[SubstFor[1/(x^n*(1 + d^2*x^2)), Cot[c*(a + b*x)]/d, u, x], x], x, Cot[c*(a + b*x)]/d] /; FunctionOfQ[Cot[c*(a + b*x)]/d, u, x, True] && TryPureTanSubst[ActivateTrig[u]*Tan[c*(a + b*x)]^n, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n] && (EqQ[F, Tan] || EqQ[F, tan])
Int[(u_)*Coth[(c_.)*((a_.) + (b_.)*(x_))]^(n_.), x_Symbol] := With[{d = FreeFactors[Tanh[c*(a + b*x)], x]}, (1/(b*c*d^(n - 1)))*Subst[Int[SubstFor[1/(x^n*(1 - d^2*x^2)), Tanh[c*(a + b*x)]/d, u, x], x], x, Tanh[c*(a + b*x)]/d] /; FunctionOfQ[Tanh[c*(a + b*x)]/d, u, x, True] && TryPureTanSubst[ActivateTrig[u]*Coth[c*(a + b*x)]^n, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n]
Int[(u_)*Tanh[(c_.)*((a_.) + (b_.)*(x_))]^(n_.), x_Symbol] := With[{d = FreeFactors[Coth[c*(a + b*x)], x]}, (1/(b*c*d^(n - 1)))*Subst[Int[SubstFor[1/(x^n*(1 - d^2*x^2)), Coth[c*(a + b*x)]/d, u, x], x], x, Coth[c*(a + b*x)]/d] /; FunctionOfQ[Coth[c*(a + b*x)]/d, u, x, True] && TryPureTanSubst[ActivateTrig[u]*Tanh[c*(a + b*x)]^n, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[n]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, ShowStep["", "Int[F[Cot[a+b*x]],x]", "-1/b*Subst[Int[F[x]/(1+x^2),x],x,Cot[a+b*x]]", Hold[With[{d = FreeFactors[Cot[v], x]}, Dist[-(d/Coefficient[v, x, 1]), Subst[Int[SubstFor[1/(1 + d^2*x^2), Cot[v]/d, u, x], x], x, Cot[v]/d], x]]]] /;  !FalseQ[v] && FunctionOfQ[NonfreeFactors[Cot[v], x], u, x, True] && TryPureTanSubst[ActivateTrig[u], x]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, With[{d = FreeFactors[Cot[v], x]}, Dist[-(d/Coefficient[v, x, 1]), Subst[Int[SubstFor[1/(1 + d^2*x^2), Cot[v]/d, u, x], x], x, Cot[v]/d], x]] /;  !FalseQ[v] && FunctionOfQ[NonfreeFactors[Cot[v], x], u, x, True] && TryPureTanSubst[ActivateTrig[u], x]]]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, ShowStep["", "Int[F[Tan[a+b*x]],x]", "1/b*Subst[Int[F[x]/(1+x^2),x],x,Tan[a+b*x]]", Hold[With[{d = FreeFactors[Tan[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v]/d, u, x], x], x, Tan[v]/d], x]]]] /;  !FalseQ[v] && FunctionOfQ[NonfreeFactors[Tan[v], x], u, x, True] && TryPureTanSubst[ActivateTrig[u], x]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, With[{d = FreeFactors[Tan[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v]/d, u, x], x], x, Tan[v]/d], x]] /;  !FalseQ[v] && FunctionOfQ[NonfreeFactors[Tan[v], x], u, x, True] && TryPureTanSubst[ActivateTrig[u], x]]]
Int[(F_)[(a_.) + (b_.)*(x_)]^(p_.)*(G_)[(c_.) + (d_.)*(x_)]^(q_.), x_Symbol] := Int[ExpandTrigReduce[ActivateTrig[F[a + b*x]^p*G[c + d*x]^q], x], x] /; FreeQ[{a, b, c, d}, x] && (EqQ[F, sin] || EqQ[F, cos]) && (EqQ[G, sin] || EqQ[G, cos]) && IGtQ[p, 0] && IGtQ[q, 0]
Int[(F_)[(a_.) + (b_.)*(x_)]^(p_.)*(G_)[(c_.) + (d_.)*(x_)]^(q_.)*(H_)[(e_.) + (f_.)*(x_)]^(r_.), x_Symbol] := Int[ExpandTrigReduce[ActivateTrig[F[a + b*x]^p*G[c + d*x]^q*H[e + f*x]^r], x], x] /; FreeQ[{a, b, c, d, e, f}, x] && (EqQ[F, sin] || EqQ[F, cos]) && (EqQ[G, sin] || EqQ[G, cos]) && (EqQ[H, sin] || EqQ[H, cos]) && IGtQ[p, 0] && IGtQ[q, 0] && IGtQ[r, 0]
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[1, Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Cos] || EqQ[F, cos])
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, (-(d/(b*c)))*Subst[Int[SubstFor[1, Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Sin] || EqQ[F, sin])
Int[(u_)*Cosh[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[1, Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x]
Int[(u_)*Sinh[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[1, Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x]
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, (1/(b*c))*Subst[Int[SubstFor[1/x, Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Cot] || EqQ[F, cot])
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, (-(b*c)^(-1))*Subst[Int[SubstFor[1/x, Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && (EqQ[F, Tan] || EqQ[F, tan])
Int[(u_)*Coth[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, (1/(b*c))*Subst[Int[SubstFor[1/x, Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x]
Int[(u_)*Tanh[(c_.)*((a_.) + (b_.)*(x_))], x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, (1/(b*c))*Subst[Int[SubstFor[1/x, Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x]
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[(1 - d^2*x^2)^((n - 1)/2), Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Cos] || EqQ[F, cos])
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[(1 - d^2*x^2)^((-n - 1)/2), Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Sec] || EqQ[F, sec])
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, (-(d/(b*c)))*Subst[Int[SubstFor[(1 - d^2*x^2)^((n - 1)/2), Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Sin] || EqQ[F, sin])
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, (-(d/(b*c)))*Subst[Int[SubstFor[(1 - d^2*x^2)^((-n - 1)/2), Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Csc] || EqQ[F, csc])
Int[(u_)*Cosh[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[(1 + d^2*x^2)^((n - 1)/2), Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[(u_)*Sech[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[(1 + d^2*x^2)^((-n - 1)/2), Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[(u_)*Sinh[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[(-1 + d^2*x^2)^((n - 1)/2), Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[(u_)*Csch[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, (d/(b*c))*Subst[Int[SubstFor[(-1 + d^2*x^2)^((-n - 1)/2), Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Sin[c*(a + b*x)], x]}, (1/(b*c*d^(n - 1)))*Subst[Int[SubstFor[(1 - d^2*x^2)^((n - 1)/2)/x^n, Sin[c*(a + b*x)]/d, u, x], x], x, Sin[c*(a + b*x)]/d] /; FunctionOfQ[Sin[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Cot] || EqQ[F, cot])
Int[(u_)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Cos[c*(a + b*x)], x]}, (-(b*c*d^(n - 1))^(-1))*Subst[Int[SubstFor[(1 - d^2*x^2)^((n - 1)/2)/x^n, Cos[c*(a + b*x)]/d, u, x], x], x, Cos[c*(a + b*x)]/d] /; FunctionOfQ[Cos[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Tan] || EqQ[F, tan])
Int[(u_)*Coth[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Sinh[c*(a + b*x)], x]}, (1/(b*c*d^(n - 1)))*Subst[Int[SubstFor[(1 + d^2*x^2)^((n - 1)/2)/x^n, Sinh[c*(a + b*x)]/d, u, x], x], x, Sinh[c*(a + b*x)]/d] /; FunctionOfQ[Sinh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[(u_)*Tanh[(c_.)*((a_.) + (b_.)*(x_))]^(n_), x_Symbol] := With[{d = FreeFactors[Cosh[c*(a + b*x)], x]}, (1/(b*c*d^(n - 1)))*Subst[Int[SubstFor[(-1 + d^2*x^2)^((n - 1)/2)/x^n, Cosh[c*(a + b*x)]/d, u, x], x], x, Cosh[c*(a + b*x)]/d] /; FunctionOfQ[Cosh[c*(a + b*x)]/d, u, x]] /; FreeQ[{a, b, c}, x] && IntegerQ[(n - 1)/2] && NonsumQ[u]
Int[(u_)*((v_) + (d_.)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^(n_.)), x_Symbol] := With[{e = FreeFactors[Sin[c*(a + b*x)], x]}, Int[ActivateTrig[u*v], x] + d*Int[ActivateTrig[u]*Cos[c*(a + b*x)]^n, x] /; FunctionOfQ[Sin[c*(a + b*x)]/e, u, x]] /; FreeQ[{a, b, c, d}, x] &&  !FreeQ[v, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Cos] || EqQ[F, cos])
Int[(u_)*((v_) + (d_.)*(F_)[(c_.)*((a_.) + (b_.)*(x_))]^(n_.)), x_Symbol] := With[{e = FreeFactors[Cos[c*(a + b*x)], x]}, Int[ActivateTrig[u*v], x] + d*Int[ActivateTrig[u]*Sin[c*(a + b*x)]^n, x] /; FunctionOfQ[Cos[c*(a + b*x)]/e, u, x]] /; FreeQ[{a, b, c, d}, x] &&  !FreeQ[v, x] && IntegerQ[(n - 1)/2] && NonsumQ[u] && (EqQ[F, Sin] || EqQ[F, sin])
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, ShowStep["", "Int[F[Sin[a+b*x]]*Cos[a+b*x],x]", "Subst[Int[F[x],x],x,Sin[a+b*x]]/b", Hold[With[{d = FreeFactors[Sin[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1, Sin[v]/d, u/Cos[v], x], x], x, Sin[v]/d], x]]]] /;  !FalseQ[v] && FunctionOfQ[NonfreeFactors[Sin[v], x], u/Cos[v], x]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, With[{d = FreeFactors[Sin[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1, Sin[v]/d, u/Cos[v], x], x], x, Sin[v]/d], x]] /;  !FalseQ[v] && FunctionOfQ[NonfreeFactors[Sin[v], x], u/Cos[v], x]]]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, ShowStep["", "Int[F[Cos[a+b*x]]*Sin[a+b*x],x]", "-Subst[Int[F[x],x],x,Cos[a+b*x]]/b", Hold[With[{d = FreeFactors[Cos[v], x]}, Dist[-(d/Coefficient[v, x, 1]), Subst[Int[SubstFor[1, Cos[v]/d, u/Sin[v], x], x], x, Cos[v]/d], x]]]] /;  !FalseQ[v] && FunctionOfQ[NonfreeFactors[Cos[v], x], u/Sin[v], x]] /; SimplifyFlag, Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, With[{d = FreeFactors[Cos[v], x]}, Dist[-(d/Coefficient[v, x, 1]), Subst[Int[SubstFor[1, Cos[v]/d, u/Sin[v], x], x], x, Cos[v]/d], x]] /;  !FalseQ[v] && FunctionOfQ[NonfreeFactors[Cos[v], x], u/Sin[v], x]]]
Int[(u_.)*((a_.) + (b_.)*cos[(d_.) + (e_.)*(x_)]^2 + (c_.)*sin[(d_.) + (e_.)*(x_)]^2)^(p_.), x_Symbol] := (a + c)^p*Int[ActivateTrig[u], x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[b - c, 0]
Int[(u_.)*((a_.) + (b_.)*tan[(d_.) + (e_.)*(x_)]^2 + (c_.)*sec[(d_.) + (e_.)*(x_)]^2)^(p_.), x_Symbol] := (a + c)^p*Int[ActivateTrig[u], x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[b + c, 0]
Int[(u_.)*((a_.) + (b_.)*cot[(d_.) + (e_.)*(x_)]^2 + (c_.)*csc[(d_.) + (e_.)*(x_)]^2)^(p_.), x_Symbol] := (a + c)^p*Int[ActivateTrig[u], x] /; FreeQ[{a, b, c, d, e, p}, x] && EqQ[b + c, 0]
Int[(u_)/(y_), x_Symbol] := With[{q = DerivativeDivides[ActivateTrig[y], ActivateTrig[u], x]}, q*Log[RemoveContent[ActivateTrig[y], x]] /;  !FalseQ[q]] /;  !InertTrigFreeQ[u]
Int[(u_)/((y_)*(w_)), x_Symbol] := With[{q = DerivativeDivides[ActivateTrig[y*w], ActivateTrig[u], x]}, q*Log[RemoveContent[ActivateTrig[y*w], x]] /;  !FalseQ[q]] /;  !InertTrigFreeQ[u]
Int[(u_)*(y_)^(m_.), x_Symbol] := With[{q = DerivativeDivides[ActivateTrig[y], ActivateTrig[u], x]}, q*(ActivateTrig[y^(m + 1)]/(m + 1)) /;  !FalseQ[q]] /; FreeQ[m, x] && NeQ[m, -1] &&  !InertTrigFreeQ[u]
Int[(u_)*(y_)^(m_.)*(z_)^(n_.), x_Symbol] := With[{q = DerivativeDivides[ActivateTrig[y*z], ActivateTrig[u*z^(n - m)], x]}, q*(ActivateTrig[y^(m + 1)*z^(m + 1)]/(m + 1)) /;  !FalseQ[q]] /; FreeQ[{m, n}, x] && NeQ[m, -1] &&  !InertTrigFreeQ[u]
Int[(u_.)*((a_.)*(F_)[(c_.) + (d_.)*(x_)]^(p_))^(n_), x_Symbol] := With[{v = ActivateTrig[F[c + d*x]]}, a^IntPart[n]*(v/NonfreeFactors[v, x])^(p*IntPart[n])*((a*v^p)^FracPart[n]/NonfreeFactors[v, x]^(p*FracPart[n]))*Int[ActivateTrig[u]*NonfreeFactors[v, x]^(n*p), x]] /; FreeQ[{a, c, d, n, p}, x] && InertTrigQ[F] &&  !IntegerQ[n] && IntegerQ[p]
Int[(u_.)*((a_.)*((b_.)*(F_)[(c_.) + (d_.)*(x_)])^(p_))^(n_.), x_Symbol] := With[{v = ActivateTrig[F[c + d*x]]}, a^IntPart[n]*((a*(b*v)^p)^FracPart[n]/(b*v)^(p*FracPart[n]))*Int[ActivateTrig[u]*(b*v)^(n*p), x]] /; FreeQ[{a, b, c, d, n, p}, x] && InertTrigQ[F] &&  !IntegerQ[n] &&  !IntegerQ[p]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, ShowStep["", "Int[F[Tan[a+b*x]],x]", "1/b*Subst[Int[F[x]/(1+x^2),x],x,Tan[a+b*x]]", Hold[With[{d = FreeFactors[Tan[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v]/d, u, x], x], x, Tan[v]/d], x]]]] /;  !FalseQ[v] && FunctionOfQ[NonfreeFactors[Tan[v], x], u, x]] /; SimplifyFlag && InverseFunctionFreeQ[u, x] &&  !MatchQ[u, (v_.)*((c_.)*tan[w_]^(n_.)*tan[z_]^(n_.))^(p_.) /; FreeQ[{c, p}, x] && IntegerQ[n] && LinearQ[w, x] && EqQ[z, 2*w]], Int[u_, x_Symbol] := With[{v = FunctionOfTrig[u, x]}, With[{d = FreeFactors[Tan[v], x]}, Dist[d/Coefficient[v, x, 1], Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v]/d, u, x], x], x, Tan[v]/d], x]] /;  !FalseQ[v] && FunctionOfQ[NonfreeFactors[Tan[v], x], u, x]] /; InverseFunctionFreeQ[u, x] &&  !MatchQ[u, (v_.)*((c_.)*tan[w_]^(n_.)*tan[z_]^(n_.))^(p_.) /; FreeQ[{c, p}, x] && IntegerQ[n] && LinearQ[w, x] && EqQ[z, 2*w]]]
Int[(u_)*((c_.)*sin[v_])^(m_), x_Symbol] := With[{w = FunctionOfTrig[u*(Sin[v/2]^(2*m)/(c*Tan[v/2])^m), x]}, (c*Sin[v])^m*((c*Tan[v/2])^m/Sin[v/2]^(2*m))*Int[u*(Sin[v/2]^(2*m)/(c*Tan[v/2])^m), x] /;  !FalseQ[w] && FunctionOfQ[NonfreeFactors[Tan[w], x], u*(Sin[v/2]^(2*m)/(c*Tan[v/2])^m), x]] /; FreeQ[c, x] && LinearQ[v, x] && IntegerQ[m + 1/2] &&  !SumQ[u] && InverseFunctionFreeQ[u, x]
Int[(u_.)*((a_.)*tan[(c_.) + (d_.)*(x_)]^(n_.) + (b_.)*sec[(c_.) + (d_.)*(x_)]^(n_.))^(p_), x_Symbol] := Int[ActivateTrig[u]*Sec[c + d*x]^(n*p)*(b + a*Sin[c + d*x]^n)^p, x] /; FreeQ[{a, b, c, d}, x] && IntegersQ[n, p]
Int[(u_.)*((a_.)*cot[(c_.) + (d_.)*(x_)]^(n_.) + (b_.)*csc[(c_.) + (d_.)*(x_)]^(n_.))^(p_), x_Symbol] := Int[ActivateTrig[u]*Csc[c + d*x]^(n*p)*(b + a*Cos[c + d*x]^n)^p, x] /; FreeQ[{a, b, c, d}, x] && IntegersQ[n, p]
Int[(u_)*((a_)*(F_)[(c_.) + (d_.)*(x_)]^(p_.) + (b_.)*(F_)[(c_.) + (d_.)*(x_)]^(q_.))^(n_.), x_Symbol] := Int[ActivateTrig[u*F[c + d*x]^(n*p)*(a + b*F[c + d*x]^(q - p))^n], x] /; FreeQ[{a, b, c, d, p, q}, x] && InertTrigQ[F] && IntegerQ[n] && PosQ[q - p]
Int[(u_)*((a_)*(F_)[(d_.) + (e_.)*(x_)]^(p_.) + (b_.)*(F_)[(d_.) + (e_.)*(x_)]^(q_.) + (c_.)*(F_)[(d_.) + (e_.)*(x_)]^(r_.))^(n_.), x_Symbol] := Int[ActivateTrig[u*F[d + e*x]^(n*p)*(a + b*F[d + e*x]^(q - p) + c*F[d + e*x]^(r - p))^n], x] /; FreeQ[{a, b, c, d, e, p, q, r}, x] && InertTrigQ[F] && IntegerQ[n] && PosQ[q - p] && PosQ[r - p]
Int[(u_)*((a_) + (b_.)*(F_)[(d_.) + (e_.)*(x_)]^(p_.) + (c_.)*(F_)[(d_.) + (e_.)*(x_)]^(q_.))^(n_.), x_Symbol] := Int[ActivateTrig[u*F[d + e*x]^(n*p)*(b + a/F[d + e*x]^p + c*F[d + e*x]^(q - p))^n], x] /; FreeQ[{a, b, c, d, e, p, q}, x] && InertTrigQ[F] && IntegerQ[n] && NegQ[p]
Int[(u_.)*((a_.)*cos[(c_.) + (d_.)*(x_)] + (b_.)*sin[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := Int[ActivateTrig[u]*(a/E^((a/b)*(c + d*x)))^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[a^2 + b^2, 0]
Int[u_, x_Symbol] := Int[TrigSimplify[u], x] /; TrigSimplifyQ[u]
Int[(u_.)*((a_)*(v_))^(p_), x_Symbol] := With[{uu = ActivateTrig[u], vv = ActivateTrig[v]}, a^IntPart[p]*((a*vv)^FracPart[p]/vv^FracPart[p])*Int[uu*vv^p, x]] /; FreeQ[{a, p}, x] &&  !IntegerQ[p] &&  !InertTrigFreeQ[v]
Int[(u_.)*((v_)^(m_))^(p_), x_Symbol] := With[{uu = ActivateTrig[u], vv = ActivateTrig[v]}, ((vv^m)^FracPart[p]/vv^(m*FracPart[p]))*Int[uu*vv^(m*p), x]] /; FreeQ[{m, p}, x] &&  !IntegerQ[p] &&  !InertTrigFreeQ[v]
Int[(u_.)*((v_)^(m_.)*(w_)^(n_.))^(p_), x_Symbol] := With[{uu = ActivateTrig[u], vv = ActivateTrig[v], ww = ActivateTrig[w]}, ((vv^m*ww^n)^FracPart[p]/(vv^(m*FracPart[p])*ww^(n*FracPart[p])))*Int[uu*vv^(m*p)*ww^(n*p), x]] /; FreeQ[{m, n, p}, x] &&  !IntegerQ[p] && ( !InertTrigFreeQ[v] ||  !InertTrigFreeQ[w])
Int[u_, x_Symbol] := With[{v = ExpandTrig[u, x]}, Int[v, x] /; SumQ[v]] /;  !InertTrigFreeQ[u]
If[TrueQ[$LoadShowSteps], Int[u_, x_Symbol] := With[{w = Block[{$ShowSteps = False, $StepCounter = Null}, Int[SubstFor[1/(1 + FreeFactors[Tan[FunctionOfTrig[u, x]/2], x]^2*x^2), Tan[FunctionOfTrig[u, x]/2]/FreeFactors[Tan[FunctionOfTrig[u, x]/2], x], u, x], x]]}, ShowStep["", "Int[F[Sin[a+b*x],Cos[a+b*x]],x]", "2/b*Subst[Int[1/(1+x^2)*F[2*x/(1+x^2),(1-x^2)/(1+x^2)],x],x,Tan[(a+b*x)/2]]", Hold[Module[{v = FunctionOfTrig[u, x], d}, d = FreeFactors[Tan[v/2], x]; Dist[2*(d/Coefficient[v, x, 1]), Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v/2]/d, u, x], x], x, Tan[v/2]/d], x]]]] /; CalculusFreeQ[w, x]] /; SimplifyFlag && InverseFunctionFreeQ[u, x] &&  !FalseQ[FunctionOfTrig[u, x]], Int[u_, x_Symbol] := With[{w = Block[{$ShowSteps = False, $StepCounter = Null}, Int[SubstFor[1/(1 + FreeFactors[Tan[FunctionOfTrig[u, x]/2], x]^2*x^2), Tan[FunctionOfTrig[u, x]/2]/FreeFactors[Tan[FunctionOfTrig[u, x]/2], x], u, x], x]]}, Module[{v = FunctionOfTrig[u, x], d}, d = FreeFactors[Tan[v/2], x]; Dist[2*(d/Coefficient[v, x, 1]), Subst[Int[SubstFor[1/(1 + d^2*x^2), Tan[v/2]/d, u, x], x], x, Tan[v/2]/d], x]] /; CalculusFreeQ[w, x]] /; InverseFunctionFreeQ[u, x] &&  !FalseQ[FunctionOfTrig[u, x]]]
Int[u_, x_Symbol] := With[{v = ActivateTrig[u]}, CannotIntegrate[v, x]] /;  !InertTrigFreeQ[u]

(* ::Subsection::Closed:: *)
(* 4.4.5 (c+d x)^m trig(a+b x)^n trig(a+b x)^p *)
Int[((c_.) + (d_.)*(x_))^(m_.)*Sin[(a_.) + (b_.)*(x_)]^(n_.)*Cos[(a_.) + (b_.)*(x_)], x_Symbol] := (c + d*x)^m*(Sin[a + b*x]^(n + 1)/(b*(n + 1))) - d*(m/(b*(n + 1)))*Int[(c + d*x)^(m - 1)*Sin[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[((c_.) + (d_.)*(x_))^(m_.)*Sin[(a_.) + (b_.)*(x_)]*Cos[(a_.) + (b_.)*(x_)]^(n_.), x_Symbol] := (-(c + d*x)^m)*(Cos[a + b*x]^(n + 1)/(b*(n + 1))) + d*(m/(b*(n + 1)))*Int[(c + d*x)^(m - 1)*Cos[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[((c_.) + (d_.)*(x_))^(m_.)*Sin[(a_.) + (b_.)*(x_)]^(n_.)*Cos[(a_.) + (b_.)*(x_)]^(p_.), x_Symbol] := Int[ExpandTrigReduce[(c + d*x)^m, Sin[a + b*x]^n*Cos[a + b*x]^p, x], x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && IGtQ[p, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*Sin[(a_.) + (b_.)*(x_)]^(n_.)*Tan[(a_.) + (b_.)*(x_)]^(p_.), x_Symbol] := -Int[(c + d*x)^m*Sin[a + b*x]^n*Tan[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Sin[a + b*x]^(n - 2)*Tan[a + b*x]^p, x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && IGtQ[p, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*Cos[(a_.) + (b_.)*(x_)]^(n_.)*Cot[(a_.) + (b_.)*(x_)]^(p_.), x_Symbol] := -Int[(c + d*x)^m*Cos[a + b*x]^n*Cot[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Cos[a + b*x]^(n - 2)*Cot[a + b*x]^p, x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[n, 0] && IGtQ[p, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*Sec[(a_.) + (b_.)*(x_)]^(n_.)*Tan[(a_.) + (b_.)*(x_)]^(p_.), x_Symbol] := (c + d*x)^m*(Sec[a + b*x]^n/(b*n)) - d*(m/(b*n))*Int[(c + d*x)^(m - 1)*Sec[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[p, 1] && GtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*Csc[(a_.) + (b_.)*(x_)]^(n_.)*Cot[(a_.) + (b_.)*(x_)]^(p_.), x_Symbol] := (-(c + d*x)^m)*(Csc[a + b*x]^n/(b*n)) + d*(m/(b*n))*Int[(c + d*x)^(m - 1)*Csc[a + b*x]^n, x] /; FreeQ[{a, b, c, d, n}, x] && EqQ[p, 1] && GtQ[m, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*Sec[(a_.) + (b_.)*(x_)]^2*Tan[(a_.) + (b_.)*(x_)]^(n_.), x_Symbol] := (c + d*x)^m*(Tan[a + b*x]^(n + 1)/(b*(n + 1))) - d*(m/(b*(n + 1)))*Int[(c + d*x)^(m - 1)*Tan[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[((c_.) + (d_.)*(x_))^(m_.)*Csc[(a_.) + (b_.)*(x_)]^2*Cot[(a_.) + (b_.)*(x_)]^(n_.), x_Symbol] := (-(c + d*x)^m)*(Cot[a + b*x]^(n + 1)/(b*(n + 1))) + d*(m/(b*(n + 1)))*Int[(c + d*x)^(m - 1)*Cot[a + b*x]^(n + 1), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[((c_.) + (d_.)*(x_))^(m_.)*Sec[(a_.) + (b_.)*(x_)]*Tan[(a_.) + (b_.)*(x_)]^(p_), x_Symbol] := -Int[(c + d*x)^m*Sec[a + b*x]*Tan[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Sec[a + b*x]^3*Tan[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[p/2, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*Sec[(a_.) + (b_.)*(x_)]^(n_.)*Tan[(a_.) + (b_.)*(x_)]^(p_), x_Symbol] := -Int[(c + d*x)^m*Sec[a + b*x]^n*Tan[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Sec[a + b*x]^(n + 2)*Tan[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p/2, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*Csc[(a_.) + (b_.)*(x_)]*Cot[(a_.) + (b_.)*(x_)]^(p_), x_Symbol] := -Int[(c + d*x)^m*Csc[a + b*x]*Cot[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Csc[a + b*x]^3*Cot[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m}, x] && IGtQ[p/2, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*Csc[(a_.) + (b_.)*(x_)]^(n_.)*Cot[(a_.) + (b_.)*(x_)]^(p_), x_Symbol] := -Int[(c + d*x)^m*Csc[a + b*x]^n*Cot[a + b*x]^(p - 2), x] + Int[(c + d*x)^m*Csc[a + b*x]^(n + 2)*Cot[a + b*x]^(p - 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && IGtQ[p/2, 0]
Int[((c_.) + (d_.)*(x_))^(m_.)*Sec[(a_.) + (b_.)*(x_)]^(n_.)*Tan[(a_.) + (b_.)*(x_)]^(p_.), x_Symbol] := Module[{u = IntHide[Sec[a + b*x]^n*Tan[a + b*x]^p, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[(c + d*x)^(m - 1)*u, x]] /; FreeQ[{a, b, c, d, n, p}, x] && IGtQ[m, 0] && (IntegerQ[n/2] || IntegerQ[(p - 1)/2])
Int[((c_.) + (d_.)*(x_))^(m_.)*Csc[(a_.) + (b_.)*(x_)]^(n_.)*Cot[(a_.) + (b_.)*(x_)]^(p_.), x_Symbol] := Module[{u = IntHide[Csc[a + b*x]^n*Cot[a + b*x]^p, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[(c + d*x)^(m - 1)*u, x]] /; FreeQ[{a, b, c, d, n, p}, x] && IGtQ[m, 0] && (IntegerQ[n/2] || IntegerQ[(p - 1)/2])
Int[((c_.) + (d_.)*(x_))^(m_.)*Csc[(a_.) + (b_.)*(x_)]^(n_.)*Sec[(a_.) + (b_.)*(x_)]^(n_.), x_Symbol] := 2^n*Int[(c + d*x)^m*Csc[2*a + 2*b*x]^n, x] /; FreeQ[{a, b, c, d, m}, x] && IntegerQ[n] && RationalQ[m]
Int[((c_.) + (d_.)*(x_))^(m_.)*Csc[(a_.) + (b_.)*(x_)]^(n_.)*Sec[(a_.) + (b_.)*(x_)]^(p_.), x_Symbol] := Module[{u = IntHide[Csc[a + b*x]^n*Sec[a + b*x]^p, x]}, Dist[(c + d*x)^m, u, x] - d*m*Int[(c + d*x)^(m - 1)*u, x]] /; FreeQ[{a, b, c, d}, x] && IntegersQ[n, p] && GtQ[m, 0] && NeQ[n, p]
Int[(u_)^(m_.)*(F_)[v_]^(n_.)*(G_)[w_]^(p_.), x_Symbol] := Int[ExpandToSum[u, x]^m*F[ExpandToSum[v, x]]^n*G[ExpandToSum[v, x]]^p, x] /; FreeQ[{m, n, p}, x] && TrigQ[F] && TrigQ[G] && EqQ[v, w] && LinearQ[{u, v, w}, x] &&  !LinearMatchQ[{u, v, w}, x]
Int[((e_.) + (f_.)*(x_))^(m_.)*Cos[(c_.) + (d_.)*(x_)]*((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := (e + f*x)^m*((a + b*Sin[c + d*x])^(n + 1)/(b*d*(n + 1))) - f*(m/(b*d*(n + 1)))*Int[(e + f*x)^(m - 1)*(a + b*Sin[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[((e_.) + (f_.)*(x_))^(m_.)*Sin[(c_.) + (d_.)*(x_)]*((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := (-(e + f*x)^m)*((a + b*Cos[c + d*x])^(n + 1)/(b*d*(n + 1))) + f*(m/(b*d*(n + 1)))*Int[(e + f*x)^(m - 1)*(a + b*Cos[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[((e_.) + (f_.)*(x_))^(m_.)*Sec[(c_.) + (d_.)*(x_)]^2*((a_) + (b_.)*Tan[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := (e + f*x)^m*((a + b*Tan[c + d*x])^(n + 1)/(b*d*(n + 1))) - f*(m/(b*d*(n + 1)))*Int[(e + f*x)^(m - 1)*(a + b*Tan[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[((e_.) + (f_.)*(x_))^(m_.)*Csc[(c_.) + (d_.)*(x_)]^2*((a_) + (b_.)*Cot[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := (-(e + f*x)^m)*((a + b*Cot[c + d*x])^(n + 1)/(b*d*(n + 1))) + f*(m/(b*d*(n + 1)))*Int[(e + f*x)^(m - 1)*(a + b*Cot[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[((e_.) + (f_.)*(x_))^(m_.)*Sec[(c_.) + (d_.)*(x_)]*Tan[(c_.) + (d_.)*(x_)]*((a_) + (b_.)*Sec[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := (e + f*x)^m*((a + b*Sec[c + d*x])^(n + 1)/(b*d*(n + 1))) - f*(m/(b*d*(n + 1)))*Int[(e + f*x)^(m - 1)*(a + b*Sec[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[((e_.) + (f_.)*(x_))^(m_.)*Csc[(c_.) + (d_.)*(x_)]*Cot[(c_.) + (d_.)*(x_)]*((a_) + (b_.)*Csc[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := (-(e + f*x)^m)*((a + b*Csc[c + d*x])^(n + 1)/(b*d*(n + 1))) + f*(m/(b*d*(n + 1)))*Int[(e + f*x)^(m - 1)*(a + b*Csc[c + d*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && NeQ[n, -1]
Int[((e_.) + (f_.)*(x_))^(m_.)*Sin[(a_.) + (b_.)*(x_)]^(p_.)*Sin[(c_.) + (d_.)*(x_)]^(q_.), x_Symbol] := Int[ExpandTrigReduce[(e + f*x)^m, Sin[a + b*x]^p*Sin[c + d*x]^q, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IGtQ[q, 0] && IntegerQ[m]
Int[((e_.) + (f_.)*(x_))^(m_.)*Cos[(a_.) + (b_.)*(x_)]^(p_.)*Cos[(c_.) + (d_.)*(x_)]^(q_.), x_Symbol] := Int[ExpandTrigReduce[(e + f*x)^m, Cos[a + b*x]^p*Cos[c + d*x]^q, x], x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[p, 0] && IGtQ[q, 0] && IntegerQ[m]
Int[((e_.) + (f_.)*(x_))^(m_.)*Sin[(a_.) + (b_.)*(x_)]^(p_.)*Cos[(c_.) + (d_.)*(x_)]^(q_.), x_Symbol] := Int[ExpandTrigReduce[(e + f*x)^m, Sin[a + b*x]^p*Cos[c + d*x]^q, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[p, 0] && IGtQ[q, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(F_)[(a_.) + (b_.)*(x_)]^(p_.)*(G_)[(c_.) + (d_.)*(x_)]^(q_.), x_Symbol] := Int[ExpandTrigExpand[(e + f*x)^m*G[c + d*x]^q, F, c + d*x, p, b/d, x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && MemberQ[{Sin, Cos}, F] && MemberQ[{Sec, Csc}, G] && IGtQ[p, 0] && IGtQ[q, 0] && EqQ[b*c - a*d, 0] && IGtQ[b/d, 1]

(* ::Subsection::Closed:: *)
(* 4.4.6 F^(c (a+b x)) trig(d+e x)^n *)
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sin[(d_.) + (e_.)*(x_)], x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))*(Sin[d + e*x]/(e^2 + b^2*c^2*Log[F]^2)) - e*F^(c*(a + b*x))*(Cos[d + e*x]/(e^2 + b^2*c^2*Log[F]^2)) /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2 + b^2*c^2*Log[F]^2, 0]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Cos[(d_.) + (e_.)*(x_)], x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))*(Cos[d + e*x]/(e^2 + b^2*c^2*Log[F]^2)) + e*F^(c*(a + b*x))*(Sin[d + e*x]/(e^2 + b^2*c^2*Log[F]^2)) /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2 + b^2*c^2*Log[F]^2, 0]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sin[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))*(Sin[d + e*x]^n/(e^2*n^2 + b^2*c^2*Log[F]^2)) - e*n*F^(c*(a + b*x))*Cos[d + e*x]*(Sin[d + e*x]^(n - 1)/(e^2*n^2 + b^2*c^2*Log[F]^2)) + ((n*(n - 1)*e^2)/(e^2*n^2 + b^2*c^2*Log[F]^2))*Int[F^(c*(a + b*x))*Sin[d + e*x]^(n - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*n^2 + b^2*c^2*Log[F]^2, 0] && GtQ[n, 1]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Cos[(d_.) + (e_.)*(x_)]^(m_), x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))*(Cos[d + e*x]^m/(e^2*m^2 + b^2*c^2*Log[F]^2)) + e*m*F^(c*(a + b*x))*Sin[d + e*x]*(Cos[d + e*x]^(m - 1)/(e^2*m^2 + b^2*c^2*Log[F]^2)) + ((m*(m - 1)*e^2)/(e^2*m^2 + b^2*c^2*Log[F]^2))*Int[F^(c*(a + b*x))*Cos[d + e*x]^(m - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*m^2 + b^2*c^2*Log[F]^2, 0] && GtQ[m, 1]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sin[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := (-b)*c*Log[F]*F^(c*(a + b*x))*(Sin[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2))) + F^(c*(a + b*x))*Cos[d + e*x]*(Sin[d + e*x]^(n + 1)/(e*(n + 1))) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[e^2*(n + 2)^2 + b^2*c^2*Log[F]^2, 0] && NeQ[n, -1] && NeQ[n, -2]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Cos[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := (-b)*c*Log[F]*F^(c*(a + b*x))*(Cos[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2))) - F^(c*(a + b*x))*Sin[d + e*x]*(Cos[d + e*x]^(n + 1)/(e*(n + 1))) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[e^2*(n + 2)^2 + b^2*c^2*Log[F]^2, 0] && NeQ[n, -1] && NeQ[n, -2]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sin[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := (-b)*c*Log[F]*F^(c*(a + b*x))*(Sin[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2))) + F^(c*(a + b*x))*Cos[d + e*x]*(Sin[d + e*x]^(n + 1)/(e*(n + 1))) + ((e^2*(n + 2)^2 + b^2*c^2*Log[F]^2)/(e^2*(n + 1)*(n + 2)))*Int[F^(c*(a + b*x))*Sin[d + e*x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*(n + 2)^2 + b^2*c^2*Log[F]^2, 0] && LtQ[n, -1] && NeQ[n, -2]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Cos[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := (-b)*c*Log[F]*F^(c*(a + b*x))*(Cos[d + e*x]^(n + 2)/(e^2*(n + 1)*(n + 2))) - F^(c*(a + b*x))*Sin[d + e*x]*(Cos[d + e*x]^(n + 1)/(e*(n + 1))) + ((e^2*(n + 2)^2 + b^2*c^2*Log[F]^2)/(e^2*(n + 1)*(n + 2)))*Int[F^(c*(a + b*x))*Cos[d + e*x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*(n + 2)^2 + b^2*c^2*Log[F]^2, 0] && LtQ[n, -1] && NeQ[n, -2]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sin[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := E^(I*n*(d + e*x))*(Sin[d + e*x]^n/(-1 + E^(2*I*(d + e*x)))^n)*Int[F^(c*(a + b*x))*((-1 + E^(2*I*(d + e*x)))^n/E^(I*n*(d + e*x))), x] /; FreeQ[{F, a, b, c, d, e, n}, x] &&  !IntegerQ[n]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Cos[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := E^(I*n*(d + e*x))*(Cos[d + e*x]^n/(1 + E^(2*I*(d + e*x)))^n)*Int[F^(c*(a + b*x))*((1 + E^(2*I*(d + e*x)))^n/E^(I*n*(d + e*x))), x] /; FreeQ[{F, a, b, c, d, e, n}, x] &&  !IntegerQ[n]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Tan[(d_.) + (e_.)*(x_)]^(n_.), x_Symbol] := I^n*Int[ExpandIntegrand[F^(c*(a + b*x))*((1 - E^(2*I*(d + e*x)))^n/(1 + E^(2*I*(d + e*x)))^n), x], x] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Cot[(d_.) + (e_.)*(x_)]^(n_.), x_Symbol] := (-I)^n*Int[ExpandIntegrand[F^(c*(a + b*x))*((1 + E^(2*I*(d + e*x)))^n/(1 - E^(2*I*(d + e*x)))^n), x], x] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sec[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))*(Sec[d + e*x]^n/(e^2*n^2 + b^2*c^2*Log[F]^2)) - e*n*F^(c*(a + b*x))*Sec[d + e*x]^(n + 1)*(Sin[d + e*x]/(e^2*n^2 + b^2*c^2*Log[F]^2)) + e^2*n*((n + 1)/(e^2*n^2 + b^2*c^2*Log[F]^2))*Int[F^(c*(a + b*x))*Sec[d + e*x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*n^2 + b^2*c^2*Log[F]^2, 0] && LtQ[n, -1]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Csc[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := b*c*Log[F]*F^(c*(a + b*x))*(Csc[d + e*x]^n/(e^2*n^2 + b^2*c^2*Log[F]^2)) + e*n*F^(c*(a + b*x))*Csc[d + e*x]^(n + 1)*(Cos[d + e*x]/(e^2*n^2 + b^2*c^2*Log[F]^2)) + e^2*n*((n + 1)/(e^2*n^2 + b^2*c^2*Log[F]^2))*Int[F^(c*(a + b*x))*Csc[d + e*x]^(n + 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[e^2*n^2 + b^2*c^2*Log[F]^2, 0] && LtQ[n, -1]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sec[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := (-b)*c*Log[F]*F^(c*(a + b*x))*(Sec[d + e*x]^(n - 2)/(e^2*(n - 1)*(n - 2))) + F^(c*(a + b*x))*Sec[d + e*x]^(n - 1)*(Sin[d + e*x]/(e*(n - 1))) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[b^2*c^2*Log[F]^2 + e^2*(n - 2)^2, 0] && NeQ[n, 1] && NeQ[n, 2]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Csc[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := (-b)*c*Log[F]*F^(c*(a + b*x))*(Csc[d + e*x]^(n - 2)/(e^2*(n - 1)*(n - 2))) + F^(c*(a + b*x))*Csc[d + e*x]^(n - 1)*(Cos[d + e*x]/(e*(n - 1))) /; FreeQ[{F, a, b, c, d, e, n}, x] && EqQ[b^2*c^2*Log[F]^2 + e^2*(n - 2)^2, 0] && NeQ[n, 1] && NeQ[n, 2]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sec[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := (-b)*c*Log[F]*F^(c*(a + b*x))*(Sec[d + e*x]^(n - 2)/(e^2*(n - 1)*(n - 2))) + F^(c*(a + b*x))*Sec[d + e*x]^(n - 1)*(Sin[d + e*x]/(e*(n - 1))) + ((e^2*(n - 2)^2 + b^2*c^2*Log[F]^2)/(e^2*(n - 1)*(n - 2)))*Int[F^(c*(a + b*x))*Sec[d + e*x]^(n - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[b^2*c^2*Log[F]^2 + e^2*(n - 2)^2, 0] && GtQ[n, 1] && NeQ[n, 2]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Csc[(d_.) + (e_.)*(x_)]^(n_), x_Symbol] := (-b)*c*Log[F]*F^(c*(a + b*x))*(Csc[d + e*x]^(n - 2)/(e^2*(n - 1)*(n - 2))) - F^(c*(a + b*x))*Csc[d + e*x]^(n - 1)*(Cos[d + e*x]/(e*(n - 1))) + ((e^2*(n - 2)^2 + b^2*c^2*Log[F]^2)/(e^2*(n - 1)*(n - 2)))*Int[F^(c*(a + b*x))*Csc[d + e*x]^(n - 2), x] /; FreeQ[{F, a, b, c, d, e}, x] && NeQ[b^2*c^2*Log[F]^2 + e^2*(n - 2)^2, 0] && GtQ[n, 1] && NeQ[n, 2]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sec[(d_.) + (k_.)*Pi + (e_.)*(x_)]^(n_.), x_Symbol] := 2^n*E^(I*k*n*Pi)*E^(I*n*(d + e*x))*(F^(c*(a + b*x))/(I*e*n + b*c*Log[F]))*Hypergeometric2F1[n, n/2 - I*b*c*(Log[F]/(2*e)), 1 + n/2 - I*b*c*(Log[F]/(2*e)), (-E^(2*I*k*Pi))*E^(2*I*(d + e*x))] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[4*k] && IntegerQ[n]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sec[(d_.) + (e_.)*(x_)]^(n_.), x_Symbol] := 2^n*E^(I*n*(d + e*x))*(F^(c*(a + b*x))/(I*e*n + b*c*Log[F]))*Hypergeometric2F1[n, n/2 - I*b*c*(Log[F]/(2*e)), 1 + n/2 - I*b*c*(Log[F]/(2*e)), -E^(2*I*(d + e*x))] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Csc[(d_.) + (k_.)*Pi + (e_.)*(x_)]^(n_.), x_Symbol] := (-2*I)^n*E^(I*k*n*Pi)*E^(I*n*(d + e*x))*(F^(c*(a + b*x))/(I*e*n + b*c*Log[F]))*Hypergeometric2F1[n, n/2 - I*b*c*(Log[F]/(2*e)), 1 + n/2 - I*b*c*(Log[F]/(2*e)), E^(2*I*k*Pi)*E^(2*I*(d + e*x))] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[4*k] && IntegerQ[n]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Csc[(d_.) + (e_.)*(x_)]^(n_.), x_Symbol] := (-2*I)^n*E^(I*n*(d + e*x))*(F^(c*(a + b*x))/(I*e*n + b*c*Log[F]))*Hypergeometric2F1[n, n/2 - I*b*c*(Log[F]/(2*e)), 1 + n/2 - I*b*c*(Log[F]/(2*e)), E^(2*I*(d + e*x))] /; FreeQ[{F, a, b, c, d, e}, x] && IntegerQ[n]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sec[(d_.) + (e_.)*(x_)]^(n_.), x_Symbol] := (1 + E^(2*I*(d + e*x)))^n*(Sec[d + e*x]^n/E^(I*n*(d + e*x)))*Int[SimplifyIntegrand[F^(c*(a + b*x))*(E^(I*n*(d + e*x))/(1 + E^(2*I*(d + e*x)))^n), x], x] /; FreeQ[{F, a, b, c, d, e}, x] &&  !IntegerQ[n]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Csc[(d_.) + (e_.)*(x_)]^(n_.), x_Symbol] := (1 - E^(-2*I*(d + e*x)))^n*(Csc[d + e*x]^n/E^((-I)*n*(d + e*x)))*Int[SimplifyIntegrand[F^(c*(a + b*x))*(1/(E^(I*n*(d + e*x))*(1 - E^(-2*I*(d + e*x)))^n)), x], x] /; FreeQ[{F, a, b, c, d, e}, x] &&  !IntegerQ[n]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*((f_) + (g_.)*Sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := 2^n*f^n*Int[F^(c*(a + b*x))*Cos[d/2 + e*(x/2) - f*(Pi/(4*g))]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f^2 - g^2, 0] && ILtQ[n, 0]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*((f_) + (g_.)*Cos[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := 2^n*f^n*Int[F^(c*(a + b*x))*Cos[d/2 + e*(x/2)]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f - g, 0] && ILtQ[n, 0]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*((f_) + (g_.)*Cos[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := 2^n*f^n*Int[F^(c*(a + b*x))*Sin[d/2 + e*(x/2)]^(2*n), x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f + g, 0] && ILtQ[n, 0]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Cos[(d_.) + (e_.)*(x_)]^(m_.)*((f_) + (g_.)*Sin[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := g^n*Int[F^(c*(a + b*x))*Tan[f*(Pi/(4*g)) - d/2 - e*(x/2)]^m, x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f^2 - g^2, 0] && IntegersQ[m, n] && EqQ[m + n, 0]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sin[(d_.) + (e_.)*(x_)]^(m_.)*((f_) + (g_.)*Cos[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := f^n*Int[F^(c*(a + b*x))*Tan[d/2 + e*(x/2)]^m, x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f - g, 0] && IntegersQ[m, n] && EqQ[m + n, 0]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sin[(d_.) + (e_.)*(x_)]^(m_.)*((f_) + (g_.)*Cos[(d_.) + (e_.)*(x_)])^(n_.), x_Symbol] := f^n*Int[F^(c*(a + b*x))*Cot[d/2 + e*(x/2)]^m, x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && EqQ[f + g, 0] && IntegersQ[m, n] && EqQ[m + n, 0]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*(((h_) + (i_.)*Cos[(d_.) + (e_.)*(x_)])/((f_) + (g_.)*Sin[(d_.) + (e_.)*(x_)])), x_Symbol] := 2*i*Int[F^(c*(a + b*x))*(Cos[d + e*x]/(f + g*Sin[d + e*x])), x] + Int[F^(c*(a + b*x))*((h - i*Cos[d + e*x])/(f + g*Sin[d + e*x])), x] /; FreeQ[{F, a, b, c, d, e, f, g, h, i}, x] && EqQ[f^2 - g^2, 0] && EqQ[h^2 - i^2, 0] && EqQ[g*h - f*i, 0]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*(((h_) + (i_.)*Sin[(d_.) + (e_.)*(x_)])/((f_) + (g_.)*Cos[(d_.) + (e_.)*(x_)])), x_Symbol] := 2*i*Int[F^(c*(a + b*x))*(Sin[d + e*x]/(f + g*Cos[d + e*x])), x] + Int[F^(c*(a + b*x))*((h - i*Sin[d + e*x])/(f + g*Cos[d + e*x])), x] /; FreeQ[{F, a, b, c, d, e, f, g, h, i}, x] && EqQ[f^2 - g^2, 0] && EqQ[h^2 - i^2, 0] && EqQ[g*h + f*i, 0]
Int[(F_)^((c_.)*(u_))*(G_)[v_]^(n_.), x_Symbol] := Int[F^(c*ExpandToSum[u, x])*G[ExpandToSum[v, x]]^n, x] /; FreeQ[{F, c, n}, x] && TrigQ[G] && LinearQ[{u, v}, x] &&  !LinearMatchQ[{u, v}, x]
Int[((f_.)*(x_))^(m_.)*(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sin[(d_.) + (e_.)*(x_)]^(n_.), x_Symbol] := Module[{u = IntHide[F^(c*(a + b*x))*Sin[d + e*x]^n, x]}, Dist[(f*x)^m, u, x] - f*m*Int[(f*x)^(m - 1)*u, x]] /; FreeQ[{F, a, b, c, d, e, f}, x] && IGtQ[n, 0] && GtQ[m, 0]
Int[((f_.)*(x_))^(m_.)*(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Cos[(d_.) + (e_.)*(x_)]^(n_.), x_Symbol] := Module[{u = IntHide[F^(c*(a + b*x))*Cos[d + e*x]^n, x]}, Dist[(f*x)^m, u, x] - f*m*Int[(f*x)^(m - 1)*u, x]] /; FreeQ[{F, a, b, c, d, e, f}, x] && IGtQ[n, 0] && GtQ[m, 0]
Int[((f_.)*(x_))^(m_)*(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sin[(d_.) + (e_.)*(x_)], x_Symbol] := ((f*x)^(m + 1)/(f*(m + 1)))*F^(c*(a + b*x))*Sin[d + e*x] - (e/(f*(m + 1)))*Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Cos[d + e*x], x] - b*c*(Log[F]/(f*(m + 1)))*Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Sin[d + e*x], x] /; FreeQ[{F, a, b, c, d, e, f, m}, x] && (LtQ[m, -1] || SumSimplerQ[m, 1])
Int[((f_.)*(x_))^(m_)*(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Cos[(d_.) + (e_.)*(x_)], x_Symbol] := ((f*x)^(m + 1)/(f*(m + 1)))*F^(c*(a + b*x))*Cos[d + e*x] + (e/(f*(m + 1)))*Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Sin[d + e*x], x] - b*c*(Log[F]/(f*(m + 1)))*Int[(f*x)^(m + 1)*F^(c*(a + b*x))*Cos[d + e*x], x] /; FreeQ[{F, a, b, c, d, e, f, m}, x] && (LtQ[m, -1] || SumSimplerQ[m, 1])
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sin[(d_.) + (e_.)*(x_)]^(m_.)*Cos[(f_.) + (g_.)*(x_)]^(n_.), x_Symbol] := Int[ExpandTrigReduce[F^(c*(a + b*x)), Sin[d + e*x]^m*Cos[f + g*x]^n, x], x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(x_)^(p_.)*(F_)^((c_.)*((a_.) + (b_.)*(x_)))*Sin[(d_.) + (e_.)*(x_)]^(m_.)*Cos[(f_.) + (g_.)*(x_)]^(n_.), x_Symbol] := Int[ExpandTrigReduce[x^p*F^(c*(a + b*x)), Sin[d + e*x]^m*Cos[f + g*x]^n, x], x] /; FreeQ[{F, a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[(F_)^((c_.)*((a_.) + (b_.)*(x_)))*(G_)[(d_.) + (e_.)*(x_)]^(m_.)*(H_)[(d_.) + (e_.)*(x_)]^(n_.), x_Symbol] := Int[ExpandTrigToExp[F^(c*(a + b*x)), G[d + e*x]^m*H[d + e*x]^n, x], x] /; FreeQ[{F, a, b, c, d, e}, x] && IGtQ[m, 0] && IGtQ[n, 0] && TrigQ[G] && TrigQ[H]
Int[(F_)^(u_)*Sin[v_]^(n_.), x_Symbol] := Int[ExpandTrigToExp[F^u, Sin[v]^n, x], x] /; FreeQ[F, x] && (LinearQ[u, x] || PolyQ[u, x, 2]) && (LinearQ[v, x] || PolyQ[v, x, 2]) && IGtQ[n, 0]
Int[(F_)^(u_)*Cos[v_]^(n_.), x_Symbol] := Int[ExpandTrigToExp[F^u, Cos[v]^n, x], x] /; FreeQ[F, x] && (LinearQ[u, x] || PolyQ[u, x, 2]) && (LinearQ[v, x] || PolyQ[v, x, 2]) && IGtQ[n, 0]
Int[(F_)^(u_)*Sin[v_]^(m_.)*Cos[v_]^(n_.), x_Symbol] := Int[ExpandTrigToExp[F^u, Sin[v]^m*Cos[v]^n, x], x] /; FreeQ[F, x] && (LinearQ[u, x] || PolyQ[u, x, 2]) && (LinearQ[v, x] || PolyQ[v, x, 2]) && IGtQ[m, 0] && IGtQ[n, 0]

(* ::Subsection::Closed:: *)
(* 4.4.7 u trig(a+b log(c x^n))^p *)
Int[Sin[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])], x_Symbol] := x*(Sin[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 + 1)) - b*d*n*x*(Cos[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 + 1)) /; FreeQ[{a, b, c, d, n}, x] && NeQ[b^2*d^2*n^2 + 1, 0]
Int[Cos[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])], x_Symbol] := x*(Cos[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 + 1)) + b*d*n*x*(Sin[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2 + 1)) /; FreeQ[{a, b, c, d, n}, x] && NeQ[b^2*d^2*n^2 + 1, 0]
Int[Sin[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_), x_Symbol] := x*(Sin[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*n^2*p^2 + 1)) - b*d*n*p*x*Cos[d*(a + b*Log[c*x^n])]*(Sin[d*(a + b*Log[c*x^n])]^(p - 1)/(b^2*d^2*n^2*p^2 + 1)) + b^2*d^2*n^2*p*((p - 1)/(b^2*d^2*n^2*p^2 + 1))*Int[Sin[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 + 1, 0]
Int[Cos[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_), x_Symbol] := x*(Cos[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*n^2*p^2 + 1)) + b*d*n*p*x*Cos[d*(a + b*Log[c*x^n])]^(p - 1)*(Sin[d*(a + b*Log[c*x^n])]/(b^2*d^2*n^2*p^2 + 1)) + b^2*d^2*n^2*p*((p - 1)/(b^2*d^2*n^2*p^2 + 1))*Int[Cos[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 + 1, 0]
Int[Sin[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := (1/(2^p*b^p*d^p*p^p))*Int[ExpandIntegrand[(E^(a*b*d^2*p)/x^p^(-1) - x^(1/p)/E^(a*b*d^2*p))^p, x], x] /; FreeQ[{a, b, d}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 + 1, 0]
Int[Cos[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := (1/2^p)*Int[ExpandIntegrand[(E^(a*b*d^2*p)/x^p^(-1) + x^(1/p)/E^(a*b*d^2*p))^p, x], x] /; FreeQ[{a, b, d}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 + 1, 0]
Int[Sin[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_), x_Symbol] := Sin[d*(a + b*Log[x])]^p*(x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p)*Int[(1 - E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p), x] /; FreeQ[{a, b, d, p}, x] &&  !IntegerQ[p]
Int[Cos[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_), x_Symbol] := Cos[d*(a + b*Log[x])]^p*(x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p)*Int[(1 + E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p), x] /; FreeQ[{a, b, d, p}, x] &&  !IntegerQ[p]
Int[Sin[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_.), x_Symbol] := (x/(n*(c*x^n)^(1/n)))*Subst[Int[x^(1/n - 1)*Sin[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Cos[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_.), x_Symbol] := (x/(n*(c*x^n)^(1/n)))*Subst[Int[x^(1/n - 1)*Cos[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[((e_.)*(x_))^(m_.)*Sin[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])], x_Symbol] := (m + 1)*(e*x)^(m + 1)*(Sin[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 + e*(m + 1)^2)) - b*d*n*(e*x)^(m + 1)*(Cos[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 + e*(m + 1)^2)) /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b^2*d^2*n^2 + (m + 1)^2, 0]
Int[((e_.)*(x_))^(m_.)*Cos[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])], x_Symbol] := (m + 1)*(e*x)^(m + 1)*(Cos[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 + e*(m + 1)^2)) + b*d*n*(e*x)^(m + 1)*(Sin[d*(a + b*Log[c*x^n])]/(b^2*d^2*e*n^2 + e*(m + 1)^2)) /; FreeQ[{a, b, c, d, e, m, n}, x] && NeQ[b^2*d^2*n^2 + (m + 1)^2, 0]
Int[((e_.)*(x_))^(m_.)*Sin[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_), x_Symbol] := (m + 1)*(e*x)^(m + 1)*(Sin[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*e*n^2*p^2 + e*(m + 1)^2)) - b*d*n*p*(e*x)^(m + 1)*Cos[d*(a + b*Log[c*x^n])]*(Sin[d*(a + b*Log[c*x^n])]^(p - 1)/(b^2*d^2*e*n^2*p^2 + e*(m + 1)^2)) + b^2*d^2*n^2*p*((p - 1)/(b^2*d^2*n^2*p^2 + (m + 1)^2))*Int[(e*x)^m*Sin[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 + (m + 1)^2, 0]
Int[((e_.)*(x_))^(m_.)*Cos[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_), x_Symbol] := (m + 1)*(e*x)^(m + 1)*(Cos[d*(a + b*Log[c*x^n])]^p/(b^2*d^2*e*n^2*p^2 + e*(m + 1)^2)) + b*d*n*p*(e*x)^(m + 1)*Sin[d*(a + b*Log[c*x^n])]*(Cos[d*(a + b*Log[c*x^n])]^(p - 1)/(b^2*d^2*e*n^2*p^2 + e*(m + 1)^2)) + b^2*d^2*n^2*p*((p - 1)/(b^2*d^2*n^2*p^2 + (m + 1)^2))*Int[(e*x)^m*Cos[d*(a + b*Log[c*x^n])]^(p - 2), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && IGtQ[p, 1] && NeQ[b^2*d^2*n^2*p^2 + (m + 1)^2, 0]
Int[((e_.)*(x_))^(m_.)*Sin[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := ((m + 1)^p/(2^p*b^p*d^p*p^p))*Int[ExpandIntegrand[(e*x)^m*(E^(a*b*d^2*(p/(m + 1)))/x^((m + 1)/p) - x^((m + 1)/p)/E^(a*b*d^2*(p/(m + 1))))^p, x], x] /; FreeQ[{a, b, d, e, m}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 + (m + 1)^2, 0]
Int[((e_.)*(x_))^(m_.)*Cos[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := (1/2^p)*Int[ExpandIntegrand[(e*x)^m*(E^(a*b*d^2*(p/(m + 1)))/x^((m + 1)/p) + x^((m + 1)/p)/E^(a*b*d^2*(p/(m + 1))))^p, x], x] /; FreeQ[{a, b, d, e, m}, x] && IGtQ[p, 0] && EqQ[b^2*d^2*p^2 + (m + 1)^2, 0]
Int[((e_.)*(x_))^(m_.)*Sin[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_), x_Symbol] := Sin[d*(a + b*Log[x])]^p*(x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p)*Int[(e*x)^m*((1 - E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p)), x] /; FreeQ[{a, b, d, e, m, p}, x] &&  !IntegerQ[p]
Int[((e_.)*(x_))^(m_.)*Cos[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_), x_Symbol] := Cos[d*(a + b*Log[x])]^p*(x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p)*Int[(e*x)^m*((1 + E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p)), x] /; FreeQ[{a, b, d, e, m, p}, x] &&  !IntegerQ[p]
Int[((e_.)*(x_))^(m_.)*Sin[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_.), x_Symbol] := ((e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n)))*Subst[Int[x^((m + 1)/n - 1)*Sin[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[((e_.)*(x_))^(m_.)*Cos[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_.), x_Symbol] := ((e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n)))*Subst[Int[x^((m + 1)/n - 1)*Cos[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[((h_.)*((e_.) + (f_.)*Log[(g_.)*(x_)^(m_.)]))^(q_.)*Sin[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])], x_Symbol] := (I*(1/((c*x^n)^(I*b*d)*(2/x^(I*b*d*n))))*Int[(h*(e + f*Log[g*x^m]))^q/x^(I*b*d*n), x])/E^(I*a*d) - I*E^(I*a*d)*((c*x^n)^(I*b*d)/(2*x^(I*b*d*n)))*Int[x^(I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, q}, x]
Int[((h_.)*((e_.) + (f_.)*Log[(g_.)*(x_)^(m_.)]))^(q_.)*Cos[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])], x_Symbol] := ((1/((c*x^n)^(I*b*d)*(2/x^(I*b*d*n))))*Int[(h*(e + f*Log[g*x^m]))^q/x^(I*b*d*n), x])/E^(I*a*d) + E^(I*a*d)*((c*x^n)^(I*b*d)/(2*x^(I*b*d*n)))*Int[x^(I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, m, n, q}, x]
Int[((i_.)*(x_))^(r_.)*((h_.)*((e_.) + (f_.)*Log[(g_.)*(x_)^(m_.)]))^(q_.)*Sin[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])], x_Symbol] := (I*(i*x)^r*(1/((c*x^n)^(I*b*d)*(2*x^(r - I*b*d*n))))*Int[x^(r - I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x])/E^(I*a*d) - I*E^(I*a*d)*(i*x)^r*((c*x^n)^(I*b*d)/(2*x^(r + I*b*d*n)))*Int[x^(r + I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, m, n, q, r}, x]
Int[((i_.)*(x_))^(r_.)*((h_.)*((e_.) + (f_.)*Log[(g_.)*(x_)^(m_.)]))^(q_.)*Cos[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])], x_Symbol] := ((i*x)^r*(1/((c*x^n)^(I*b*d)*(2*x^(r - I*b*d*n))))*Int[x^(r - I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x])/E^(I*a*d) + E^(I*a*d)*(i*x)^r*((c*x^n)^(I*b*d)/(2*x^(r + I*b*d*n)))*Int[x^(r + I*b*d*n)*(h*(e + f*Log[g*x^m]))^q, x] /; FreeQ[{a, b, c, d, e, f, g, h, i, m, n, q, r}, x]
Int[Sec[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := 2^p*E^(I*a*d*p)*Int[x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d}, x] && IntegerQ[p]
Int[Csc[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := (-2*I)^p*E^(I*a*d*p)*Int[x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d}, x] && IntegerQ[p]
Int[Sec[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := Sec[d*(a + b*Log[x])]^p*((1 + E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p))*Int[x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d, p}, x] &&  !IntegerQ[p]
Int[Csc[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := Csc[d*(a + b*Log[x])]^p*((1 - E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p))*Int[x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p, x] /; FreeQ[{a, b, d, p}, x] &&  !IntegerQ[p]
Int[Sec[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_.), x_Symbol] := (x/(n*(c*x^n)^(1/n)))*Subst[Int[x^(1/n - 1)*Sec[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Csc[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_.), x_Symbol] := (x/(n*(c*x^n)^(1/n)))*Subst[Int[x^(1/n - 1)*Csc[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[((e_.)*(x_))^(m_.)*Sec[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := 2^p*E^(I*a*d*p)*Int[(e*x)^m*(x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p), x] /; FreeQ[{a, b, d, e, m}, x] && IntegerQ[p]
Int[((e_.)*(x_))^(m_.)*Csc[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := (-2*I)^p*E^(I*a*d*p)*Int[(e*x)^m*(x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p), x] /; FreeQ[{a, b, d, e, m}, x] && IntegerQ[p]
Int[((e_.)*(x_))^(m_.)*Sec[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := Sec[d*(a + b*Log[x])]^p*((1 + E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p))*Int[(e*x)^m*(x^(I*b*d*p)/(1 + E^(2*I*a*d)*x^(2*I*b*d))^p), x] /; FreeQ[{a, b, d, e, m, p}, x] &&  !IntegerQ[p]
Int[((e_.)*(x_))^(m_.)*Csc[(d_.)*((a_.) + (b_.)*Log[x_])]^(p_.), x_Symbol] := Csc[d*(a + b*Log[x])]^p*((1 - E^(2*I*a*d)*x^(2*I*b*d))^p/x^(I*b*d*p))*Int[(e*x)^m*(x^(I*b*d*p)/(1 - E^(2*I*a*d)*x^(2*I*b*d))^p), x] /; FreeQ[{a, b, d, e, m, p}, x] &&  !IntegerQ[p]
Int[((e_.)*(x_))^(m_.)*Sec[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_.), x_Symbol] := ((e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n)))*Subst[Int[x^((m + 1)/n - 1)*Sec[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[((e_.)*(x_))^(m_.)*Csc[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])]^(p_.), x_Symbol] := ((e*x)^(m + 1)/(e*n*(c*x^n)^((m + 1)/n)))*Subst[Int[x^((m + 1)/n - 1)*Csc[d*(a + b*Log[x])]^p, x], x, c*x^n] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && (NeQ[c, 1] || NeQ[n, 1])
Int[Sin[(a_.)*(x_)*Log[(b_.)*(x_)]]*Log[(b_.)*(x_)], x_Symbol] := -(Cos[a*x*Log[b*x]]/a) - Int[Sin[a*x*Log[b*x]], x] /; FreeQ[{a, b}, x]
Int[Cos[(a_.)*(x_)*Log[(b_.)*(x_)]]*Log[(b_.)*(x_)], x_Symbol] := Sin[a*x*Log[b*x]]/a - Int[Cos[a*x*Log[b*x]], x] /; FreeQ[{a, b}, x]
Int[(x_)^(m_.)*Sin[(a_.)*(x_)^(n_.)*Log[(b_.)*(x_)]]*Log[(b_.)*(x_)], x_Symbol] := -(Cos[a*x^n*Log[b*x]]/(a*n)) - (1/n)*Int[x^m*Sin[a*x^n*Log[b*x]], x] /; FreeQ[{a, b, m, n}, x] && EqQ[m, n - 1]
Int[(x_)^(m_.)*Cos[(a_.)*(x_)^(n_.)*Log[(b_.)*(x_)]]*Log[(b_.)*(x_)], x_Symbol] := Sin[a*x^n*Log[b*x]]/(a*n) - (1/n)*Int[x^m*Cos[a*x^n*Log[b*x]], x] /; FreeQ[{a, b, m, n}, x] && EqQ[m, n - 1]

(* ::Subsection::Closed:: *)
(* 4.4.8 Active trig functions *)
Int[((e_.) + (f_.)*(x_))^(m_.)*(Sin[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/b)*Int[(e + f*x)^m*Sin[c + d*x]^(n - 1), x] - (a/b)*Int[(e + f*x)^m*(Sin[c + d*x]^(n - 1)/(a + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Cos[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/b)*Int[(e + f*x)^m*Cos[c + d*x]^(n - 1), x] - (a/b)*Int[(e + f*x)^m*(Cos[c + d*x]^(n - 1)/(a + b*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Cos[(c_.) + (d_.)*(x_)]/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (-I)*((e + f*x)^(m + 1)/(b*f*(m + 1))) + 2*Int[(e + f*x)^m*(E^(I*(c + d*x))/(a - I*b*E^(I*(c + d*x)))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[a^2 - b^2, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Sin[(c_.) + (d_.)*(x_)]/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := I*((e + f*x)^(m + 1)/(b*f*(m + 1))) - 2*I*Int[(e + f*x)^m*(E^(I*(c + d*x))/(a + b*E^(I*(c + d*x)))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && EqQ[a^2 - b^2, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Cos[(c_.) + (d_.)*(x_)]/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (-I)*((e + f*x)^(m + 1)/(b*f*(m + 1))) + Int[(e + f*x)^m*(E^(I*(c + d*x))/(a - Rt[a^2 - b^2, 2] - I*b*E^(I*(c + d*x)))), x] + Int[(e + f*x)^m*(E^(I*(c + d*x))/(a + Rt[a^2 - b^2, 2] - I*b*E^(I*(c + d*x)))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && PosQ[a^2 - b^2]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Sin[(c_.) + (d_.)*(x_)]/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := I*((e + f*x)^(m + 1)/(b*f*(m + 1))) - I*Int[(e + f*x)^m*(E^(I*(c + d*x))/(a - Rt[a^2 - b^2, 2] + b*E^(I*(c + d*x)))), x] - I*Int[(e + f*x)^m*(E^(I*(c + d*x))/(a + Rt[a^2 - b^2, 2] + b*E^(I*(c + d*x)))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && PosQ[a^2 - b^2]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Cos[(c_.) + (d_.)*(x_)]/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (-I)*((e + f*x)^(m + 1)/(b*f*(m + 1))) + I*Int[(e + f*x)^m*(E^(I*(c + d*x))/(I*a - Rt[-a^2 + b^2, 2] + b*E^(I*(c + d*x)))), x] + I*Int[(e + f*x)^m*(E^(I*(c + d*x))/(I*a + Rt[-a^2 + b^2, 2] + b*E^(I*(c + d*x)))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NegQ[a^2 - b^2]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Sin[(c_.) + (d_.)*(x_)]/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := I*((e + f*x)^(m + 1)/(b*f*(m + 1))) + Int[(e + f*x)^m*(E^(I*(c + d*x))/(I*a - Rt[-a^2 + b^2, 2] + I*b*E^(I*(c + d*x)))), x] + Int[(e + f*x)^m*(E^(I*(c + d*x))/(I*a + Rt[-a^2 + b^2, 2] + I*b*E^(I*(c + d*x)))), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NegQ[a^2 - b^2]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Cos[(c_.) + (d_.)*(x_)]^(n_)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Cos[c + d*x]^(n - 2), x] - (1/b)*Int[(e + f*x)^m*Cos[c + d*x]^(n - 2)*Sin[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[n, 1] && EqQ[a^2 - b^2, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Sin[(c_.) + (d_.)*(x_)]^(n_)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Sin[c + d*x]^(n - 2), x] - (1/b)*Int[(e + f*x)^m*Sin[c + d*x]^(n - 2)*Cos[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, m}, x] && IGtQ[n, 1] && EqQ[a^2 - b^2, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Cos[(c_.) + (d_.)*(x_)]^(n_)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (a/b^2)*Int[(e + f*x)^m*Cos[c + d*x]^(n - 2), x] - (1/b)*Int[(e + f*x)^m*Cos[c + d*x]^(n - 2)*Sin[c + d*x], x] - ((a^2 - b^2)/b^2)*Int[(e + f*x)^m*(Cos[c + d*x]^(n - 2)/(a + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[n, 1] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Sin[(c_.) + (d_.)*(x_)]^(n_)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (a/b^2)*Int[(e + f*x)^m*Sin[c + d*x]^(n - 2), x] - (1/b)*Int[(e + f*x)^m*Sin[c + d*x]^(n - 2)*Cos[c + d*x], x] - ((a^2 - b^2)/b^2)*Int[(e + f*x)^m*(Sin[c + d*x]^(n - 2)/(a + b*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[n, 1] && NeQ[a^2 - b^2, 0] && IGtQ[m, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Tan[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/b)*Int[(e + f*x)^m*Sec[c + d*x]*Tan[c + d*x]^(n - 1), x] - (a/b)*Int[(e + f*x)^m*Sec[c + d*x]*(Tan[c + d*x]^(n - 1)/(a + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Cot[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/b)*Int[(e + f*x)^m*Csc[c + d*x]*Cot[c + d*x]^(n - 1), x] - (a/b)*Int[(e + f*x)^m*Csc[c + d*x]*(Cot[c + d*x]^(n - 1)/(a + b*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Cot[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Cot[c + d*x]^n, x] - (b/a)*Int[(e + f*x)^m*Cos[c + d*x]*(Cot[c + d*x]^(n - 1)/(a + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Tan[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Tan[c + d*x]^n, x] - (b/a)*Int[(e + f*x)^m*Sin[c + d*x]*(Tan[c + d*x]^(n - 1)/(a + b*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Sec[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Sec[c + d*x]^(n + 2), x] - (1/b)*Int[(e + f*x)^m*Sec[c + d*x]^(n + 1)*Tan[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && EqQ[a^2 - b^2, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Csc[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Csc[c + d*x]^(n + 2), x] - (1/b)*Int[(e + f*x)^m*Csc[c + d*x]^(n + 1)*Cot[c + d*x], x] /; FreeQ[{a, b, c, d, e, f, n}, x] && IGtQ[m, 0] && EqQ[a^2 - b^2, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Sec[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (-(b^2/(a^2 - b^2)))*Int[(e + f*x)^m*(Sec[c + d*x]^(n - 2)/(a + b*Sin[c + d*x])), x] + (1/(a^2 - b^2))*Int[(e + f*x)^m*Sec[c + d*x]^n*(a - b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[a^2 - b^2, 0] && IGtQ[n, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Csc[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (-(b^2/(a^2 - b^2)))*Int[(e + f*x)^m*(Csc[c + d*x]^(n - 2)/(a + b*Cos[c + d*x])), x] + (1/(a^2 - b^2))*Int[(e + f*x)^m*Csc[c + d*x]^n*(a - b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && NeQ[a^2 - b^2, 0] && IGtQ[n, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Csc[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Csc[c + d*x]^n, x] - (b/a)*Int[(e + f*x)^m*(Csc[c + d*x]^(n - 1)/(a + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*(Sec[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Sec[c + d*x]^n, x] - (b/a)*Int[(e + f*x)^m*(Sec[c + d*x]^(n - 1)/(a + b*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*((F_)[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := Unintegrable[(e + f*x)^m*(F[c + d*x]^n/(a + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && TrigQ[F]
Int[((e_.) + (f_.)*(x_))^(m_.)*((F_)[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := Unintegrable[(e + f*x)^m*(F[c + d*x]^n/(a + b*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && TrigQ[F]
Int[((e_.) + (f_.)*(x_))^(m_.)*Cos[(c_.) + (d_.)*(x_)]^(p_.)*(Sin[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/b)*Int[(e + f*x)^m*Cos[c + d*x]^p*Sin[c + d*x]^(n - 1), x] - (a/b)*Int[(e + f*x)^m*Cos[c + d*x]^p*(Sin[c + d*x]^(n - 1)/(a + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*Sin[(c_.) + (d_.)*(x_)]^(p_.)*(Cos[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/b)*Int[(e + f*x)^m*Sin[c + d*x]^p*Cos[c + d*x]^(n - 1), x] - (a/b)*Int[(e + f*x)^m*Sin[c + d*x]^p*(Cos[c + d*x]^(n - 1)/(a + b*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*Cos[(c_.) + (d_.)*(x_)]^(p_.)*(Tan[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/b)*Int[(e + f*x)^m*Cos[c + d*x]^(p - 1)*Tan[c + d*x]^(n - 1), x] - (a/b)*Int[(e + f*x)^m*Cos[c + d*x]^(p - 1)*(Tan[c + d*x]^(n - 1)/(a + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*Sin[(c_.) + (d_.)*(x_)]^(p_.)*(Cot[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/b)*Int[(e + f*x)^m*Sin[c + d*x]^(p - 1)*Cot[c + d*x]^(n - 1), x] - (a/b)*Int[(e + f*x)^m*Sin[c + d*x]^(p - 1)*(Cot[c + d*x]^(n - 1)/(a + b*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*Cos[(c_.) + (d_.)*(x_)]^(p_.)*(Cot[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Cos[c + d*x]^p*Cot[c + d*x]^n, x] - (b/a)*Int[(e + f*x)^m*Cos[c + d*x]^(p + 1)*(Cot[c + d*x]^(n - 1)/(a + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*Sin[(c_.) + (d_.)*(x_)]^(p_.)*(Tan[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Sin[c + d*x]^p*Tan[c + d*x]^n, x] - (b/a)*Int[(e + f*x)^m*Sin[c + d*x]^(p + 1)*(Tan[c + d*x]^(n - 1)/(a + b*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*Cos[(c_.) + (d_.)*(x_)]^(p_.)*(Csc[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Cos[c + d*x]^p*Csc[c + d*x]^n, x] - (b/a)*Int[(e + f*x)^m*Cos[c + d*x]^p*(Csc[c + d*x]^(n - 1)/(a + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*Sin[(c_.) + (d_.)*(x_)]^(p_.)*(Sec[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := (1/a)*Int[(e + f*x)^m*Sin[c + d*x]^p*Sec[c + d*x]^n, x] - (b/a)*Int[(e + f*x)^m*Sin[c + d*x]^p*(Sec[c + d*x]^(n - 1)/(a + b*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && IGtQ[m, 0] && IGtQ[n, 0] && IGtQ[p, 0]
Int[((e_.) + (f_.)*(x_))^(m_.)*Cos[(c_.) + (d_.)*(x_)]^(p_.)*((F_)[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])), x_Symbol] := Unintegrable[(e + f*x)^m*Cos[c + d*x]^p*(F[c + d*x]^n/(a + b*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && TrigQ[F]
Int[((e_.) + (f_.)*(x_))^(m_.)*Sin[(c_.) + (d_.)*(x_)]^(p_.)*((F_)[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])), x_Symbol] := Unintegrable[(e + f*x)^m*Sin[c + d*x]^p*(F[c + d*x]^n/(a + b*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && TrigQ[F]
Int[((e_.) + (f_.)*(x_))^(m_.)*((F_)[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Sec[(c_.) + (d_.)*(x_)])), x_Symbol] := Int[(e + f*x)^m*Cos[c + d*x]*(F[c + d*x]^n/(b + a*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && TrigQ[F] && IntegersQ[m, n]
Int[((e_.) + (f_.)*(x_))^(m_.)*((F_)[(c_.) + (d_.)*(x_)]^(n_.)/((a_) + (b_.)*Csc[(c_.) + (d_.)*(x_)])), x_Symbol] := Int[(e + f*x)^m*Sin[c + d*x]*(F[c + d*x]^n/(b + a*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && TrigQ[F] && IntegersQ[m, n]
Int[((e_.) + (f_.)*(x_))^(m_.)*(F_)[(c_.) + (d_.)*(x_)]^(n_.)*((G_)[(c_.) + (d_.)*(x_)]^(p_.)/((a_) + (b_.)*Sec[(c_.) + (d_.)*(x_)])), x_Symbol] := Int[(e + f*x)^m*Cos[c + d*x]*F[c + d*x]^n*(G[c + d*x]^p/(b + a*Cos[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && TrigQ[F] && TrigQ[G] && IntegersQ[m, n, p]
Int[((e_.) + (f_.)*(x_))^(m_.)*(F_)[(c_.) + (d_.)*(x_)]^(n_.)*((G_)[(c_.) + (d_.)*(x_)]^(p_.)/((a_) + (b_.)*Csc[(c_.) + (d_.)*(x_)])), x_Symbol] := Int[(e + f*x)^m*Sin[c + d*x]*F[c + d*x]^n*(G[c + d*x]^p/(b + a*Sin[c + d*x])), x] /; FreeQ[{a, b, c, d, e, f}, x] && TrigQ[F] && TrigQ[G] && IntegersQ[m, n, p]
Int[Sin[(a_.) + (b_.)*(x_)]^(p_.)*Sin[(c_.) + (d_.)*(x_)]^(q_.), x_Symbol] := (1/2^(p + q))*Int[ExpandIntegrand[(I/E^(I*(c + d*x)) - I*E^(I*(c + d*x)))^q, (I/E^(I*(a + b*x)) - I*E^(I*(a + b*x)))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] &&  !IntegerQ[q]
Int[Cos[(a_.) + (b_.)*(x_)]^(p_.)*Cos[(c_.) + (d_.)*(x_)]^(q_.), x_Symbol] := (1/2^(p + q))*Int[ExpandIntegrand[(E^((-I)*(c + d*x)) + E^(I*(c + d*x)))^q, (E^((-I)*(a + b*x)) + E^(I*(a + b*x)))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] &&  !IntegerQ[q]
Int[Sin[(a_.) + (b_.)*(x_)]^(p_.)*Cos[(c_.) + (d_.)*(x_)]^(q_.), x_Symbol] := (1/2^(p + q))*Int[ExpandIntegrand[(E^((-I)*(c + d*x)) + E^(I*(c + d*x)))^q, (I/E^(I*(a + b*x)) - I*E^(I*(a + b*x)))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] &&  !IntegerQ[q]
Int[Cos[(a_.) + (b_.)*(x_)]^(p_.)*Sin[(c_.) + (d_.)*(x_)]^(q_.), x_Symbol] := (1/2^(p + q))*Int[ExpandIntegrand[(I/E^(I*(c + d*x)) - I*E^(I*(c + d*x)))^q, (E^((-I)*(a + b*x)) + E^(I*(a + b*x)))^p, x], x] /; FreeQ[{a, b, c, d, q}, x] && IGtQ[p, 0] &&  !IntegerQ[q]
Int[Sin[(a_.) + (b_.)*(x_)]*Tan[(c_.) + (d_.)*(x_)], x_Symbol] := Int[1/(E^(I*(a + b*x))*2) - E^(I*(a + b*x))/2 - 1/(E^(I*(a + b*x))*(1 + E^(2*I*(c + d*x)))) + E^(I*(a + b*x))/(1 + E^(2*I*(c + d*x))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Cos[(a_.) + (b_.)*(x_)]*Cot[(c_.) + (d_.)*(x_)], x_Symbol] := Int[I*(1/(E^(I*(a + b*x))*2)) + I*(E^(I*(a + b*x))/2) - I*(1/(E^(I*(a + b*x))*(1 - E^(2*I*(c + d*x))))) - I*(E^(I*(a + b*x))/(1 - E^(2*I*(c + d*x)))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Sin[(a_.) + (b_.)*(x_)]*Cot[(c_.) + (d_.)*(x_)], x_Symbol] := Int[-(1/(E^(I*(a + b*x))*2)) + E^(I*(a + b*x))/2 + 1/(E^(I*(a + b*x))*(1 - E^(2*I*(c + d*x)))) - E^(I*(a + b*x))/(1 - E^(2*I*(c + d*x))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Cos[(a_.) + (b_.)*(x_)]*Tan[(c_.) + (d_.)*(x_)], x_Symbol] := Int[(-I)*(1/(E^(I*(a + b*x))*2)) - I*(E^(I*(a + b*x))/2) + I*(1/(E^(I*(a + b*x))*(1 + E^(2*I*(c + d*x))))) + I*(E^(I*(a + b*x))/(1 + E^(2*I*(c + d*x)))), x] /; FreeQ[{a, b, c, d}, x] && NeQ[b^2 - d^2, 0]
Int[Sin[(a_.)/((c_.) + (d_.)*(x_))]^(n_.), x_Symbol] := (-d^(-1))*Subst[Int[Sin[a*x]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, c, d}, x] && IGtQ[n, 0]
Int[Cos[(a_.)/((c_.) + (d_.)*(x_))]^(n_.), x_Symbol] := (-d^(-1))*Subst[Int[Cos[a*x]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, c, d}, x] && IGtQ[n, 0]
Int[Sin[(e_.)*(((a_.) + (b_.)*(x_))/((c_.) + (d_.)*(x_)))]^(n_.), x_Symbol] := (-d^(-1))*Subst[Int[Sin[b*(e/d) - e*(b*c - a*d)*(x/d)]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, b, c, d}, x] && IGtQ[n, 0] && NeQ[b*c - a*d, 0]
Int[Cos[(e_.)*(((a_.) + (b_.)*(x_))/((c_.) + (d_.)*(x_)))]^(n_.), x_Symbol] := (-d^(-1))*Subst[Int[Cos[b*(e/d) - e*(b*c - a*d)*(x/d)]^n/x^2, x], x, 1/(c + d*x)] /; FreeQ[{a, b, c, d}, x] && IGtQ[n, 0] && NeQ[b*c - a*d, 0]
Int[Sin[u_]^(n_.), x_Symbol] := Module[{lst = QuotientOfLinearsParts[u, x]}, Int[Sin[(lst[[1]] + lst[[2]]*x)/(lst[[3]] + lst[[4]]*x)]^n, x]] /; IGtQ[n, 0] && QuotientOfLinearsQ[u, x]
Int[Cos[u_]^(n_.), x_Symbol] := Module[{lst = QuotientOfLinearsParts[u, x]}, Int[Cos[(lst[[1]] + lst[[2]]*x)/(lst[[3]] + lst[[4]]*x)]^n, x]] /; IGtQ[n, 0] && QuotientOfLinearsQ[u, x]
Int[(u_.)*Sin[v_]^(p_.)*Sin[w_]^(q_.), x_Symbol] := Int[u*Sin[v]^(p + q), x] /; EqQ[w, v]
Int[(u_.)*Cos[v_]^(p_.)*Cos[w_]^(q_.), x_Symbol] := Int[u*Cos[v]^(p + q), x] /; EqQ[w, v]
Int[Sin[v_]^(p_.)*Sin[w_]^(q_.), x_Symbol] := Int[ExpandTrigReduce[Sin[v]^p*Sin[w]^q, x], x] /; ((PolynomialQ[v, x] && PolynomialQ[w, x]) || (BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])) && IGtQ[p, 0] && IGtQ[q, 0]
Int[Cos[v_]^(p_.)*Cos[w_]^(q_.), x_Symbol] := Int[ExpandTrigReduce[Cos[v]^p*Cos[w]^q, x], x] /; ((PolynomialQ[v, x] && PolynomialQ[w, x]) || (BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x])) && IGtQ[p, 0] && IGtQ[q, 0]
Int[(x_)^(m_.)*Sin[v_]^(p_.)*Sin[w_]^(q_.), x_Symbol] := Int[ExpandTrigReduce[x^m, Sin[v]^p*Sin[w]^q, x], x] /; IGtQ[m, 0] && IGtQ[p, 0] && IGtQ[q, 0] && ((PolynomialQ[v, x] && PolynomialQ[w, x]) || (BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x]))
Int[(x_)^(m_.)*Cos[v_]^(p_.)*Cos[w_]^(q_.), x_Symbol] := Int[ExpandTrigReduce[x^m, Cos[v]^p*Cos[w]^q, x], x] /; IGtQ[m, 0] && IGtQ[p, 0] && IGtQ[q, 0] && ((PolynomialQ[v, x] && PolynomialQ[w, x]) || (BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x]))
Int[(u_.)*Sin[v_]^(p_.)*Cos[w_]^(p_.), x_Symbol] := (1/2^p)*Int[u*Sin[2*v]^p, x] /; EqQ[w, v] && IntegerQ[p]
Int[Sin[v_]^(p_.)*Cos[w_]^(q_.), x_Symbol] := Int[ExpandTrigReduce[Sin[v]^p*Cos[w]^q, x], x] /; IGtQ[p, 0] && IGtQ[q, 0] && ((PolynomialQ[v, x] && PolynomialQ[w, x]) || (BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x]))
Int[(x_)^(m_.)*Sin[v_]^(p_.)*Cos[w_]^(q_.), x_Symbol] := Int[ExpandTrigReduce[x^m, Sin[v]^p*Cos[w]^q, x], x] /; IGtQ[m, 0] && IGtQ[p, 0] && IGtQ[q, 0] && ((PolynomialQ[v, x] && PolynomialQ[w, x]) || (BinomialQ[{v, w}, x] && IndependentQ[Cancel[v/w], x]))
Int[Sin[v_]*Tan[w_]^(n_.), x_Symbol] := -Int[Cos[v]*Tan[w]^(n - 1), x] + Cos[v - w]*Int[Sec[w]*Tan[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Cos[v_]*Cot[w_]^(n_.), x_Symbol] := -Int[Sin[v]*Cot[w]^(n - 1), x] + Cos[v - w]*Int[Csc[w]*Cot[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Sin[v_]*Cot[w_]^(n_.), x_Symbol] := Int[Cos[v]*Cot[w]^(n - 1), x] + Sin[v - w]*Int[Csc[w]*Cot[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Cos[v_]*Tan[w_]^(n_.), x_Symbol] := Int[Sin[v]*Tan[w]^(n - 1), x] - Sin[v - w]*Int[Sec[w]*Tan[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Sin[v_]*Sec[w_]^(n_.), x_Symbol] := Cos[v - w]*Int[Tan[w]*Sec[w]^(n - 1), x] + Sin[v - w]*Int[Sec[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Cos[v_]*Csc[w_]^(n_.), x_Symbol] := Cos[v - w]*Int[Cot[w]*Csc[w]^(n - 1), x] - Sin[v - w]*Int[Csc[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Sin[v_]*Csc[w_]^(n_.), x_Symbol] := Sin[v - w]*Int[Cot[w]*Csc[w]^(n - 1), x] + Cos[v - w]*Int[Csc[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[Cos[v_]*Sec[w_]^(n_.), x_Symbol] := (-Sin[v - w])*Int[Tan[w]*Sec[w]^(n - 1), x] + Cos[v - w]*Int[Sec[w]^(n - 1), x] /; GtQ[n, 0] && FreeQ[v - w, x] && NeQ[w, v]
Int[((e_.) + (f_.)*(x_))^(m_.)*((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)]*Cos[(c_.) + (d_.)*(x_)])^(n_.), x_Symbol] := Int[(e + f*x)^m*(a + b*(Sin[2*c + 2*d*x]/2))^n, x] /; FreeQ[{a, b, c, d, e, f, m, n}, x]
Int[(x_)^(m_.)*((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)]^2)^(n_), x_Symbol] := (1/2^n)*Int[x^m*(2*a + b - b*Cos[2*c + 2*d*x])^n, x] /; FreeQ[{a, b, c, d}, x] && NeQ[a + b, 0] && IGtQ[m, 0] && ILtQ[n, 0] && (EqQ[n, -1] || (EqQ[m, 1] && EqQ[n, -2]))
Int[(x_)^(m_.)*((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)]^2)^(n_), x_Symbol] := (1/2^n)*Int[x^m*(2*a + b + b*Cos[2*c + 2*d*x])^n, x] /; FreeQ[{a, b, c, d}, x] && NeQ[a + b, 0] && IGtQ[m, 0] && ILtQ[n, 0] && (EqQ[n, -1] || (EqQ[m, 1] && EqQ[n, -2]))
Int[((f_.) + (g_.)*(x_))^(m_.)/((a_.) + (b_.)*Cos[(d_.) + (e_.)*(x_)]^2 + (c_.)*Sin[(d_.) + (e_.)*(x_)]^2), x_Symbol] := 2*Int[(f + g*x)^m/(2*a + b + c + (b - c)*Cos[2*d + 2*e*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && NeQ[a + b, 0] && NeQ[a + c, 0]
Int[((f_.) + (g_.)*(x_))^(m_.)*(Sec[(d_.) + (e_.)*(x_)]^2/((b_) + (c_.)*Tan[(d_.) + (e_.)*(x_)]^2)), x_Symbol] := 2*Int[(f + g*x)^m/(b + c + (b - c)*Cos[2*d + 2*e*x]), x] /; FreeQ[{b, c, d, e, f, g}, x] && IGtQ[m, 0]
Int[((f_.) + (g_.)*(x_))^(m_.)*(Sec[(d_.) + (e_.)*(x_)]^2/((b_.) + (a_.)*Sec[(d_.) + (e_.)*(x_)]^2 + (c_.)*Tan[(d_.) + (e_.)*(x_)]^2)), x_Symbol] := 2*Int[(f + g*x)^m/(2*a + b + c + (b - c)*Cos[2*d + 2*e*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && NeQ[a + b, 0] && NeQ[a + c, 0]
Int[((f_.) + (g_.)*(x_))^(m_.)*(Csc[(d_.) + (e_.)*(x_)]^2/((c_) + (b_.)*Cot[(d_.) + (e_.)*(x_)]^2)), x_Symbol] := 2*Int[(f + g*x)^m/(b + c + (b - c)*Cos[2*d + 2*e*x]), x] /; FreeQ[{b, c, d, e, f, g}, x] && IGtQ[m, 0]
Int[((f_.) + (g_.)*(x_))^(m_.)*(Csc[(d_.) + (e_.)*(x_)]^2/((c_.) + (b_.)*Cot[(d_.) + (e_.)*(x_)]^2 + (a_.)*Csc[(d_.) + (e_.)*(x_)]^2)), x_Symbol] := 2*Int[(f + g*x)^m/(2*a + b + c + (b - c)*Cos[2*d + 2*e*x]), x] /; FreeQ[{a, b, c, d, e, f, g}, x] && IGtQ[m, 0] && NeQ[a + b, 0] && NeQ[a + c, 0]
Int[((e_.) + (f_.)*(x_))*(((A_) + (B_.)*Sin[(c_.) + (d_.)*(x_)])/((a_) + (b_.)*Sin[(c_.) + (d_.)*(x_)])^2), x_Symbol] := (-B)*(e + f*x)*(Cos[c + d*x]/(a*d*(a + b*Sin[c + d*x]))) + B*(f/(a*d))*Int[Cos[c + d*x]/(a + b*Sin[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && EqQ[a*A - b*B, 0]
Int[((e_.) + (f_.)*(x_))*(((A_) + (B_.)*Cos[(c_.) + (d_.)*(x_)])/((a_) + (b_.)*Cos[(c_.) + (d_.)*(x_)])^2), x_Symbol] := B*(e + f*x)*(Sin[c + d*x]/(a*d*(a + b*Cos[c + d*x]))) - B*(f/(a*d))*Int[Sin[c + d*x]/(a + b*Cos[c + d*x]), x] /; FreeQ[{a, b, c, d, e, f, A, B}, x] && EqQ[a*A - b*B, 0]
Int[(x_)^2/((c_.)*Sin[(a_.)*(x_)] + (d_.)*(x_)*Cos[(a_.)*(x_)])^2, x_Symbol] := x/(a*d*Sin[a*x]*(c*Sin[a*x] + d*x*Cos[a*x])) + (1/d^2)*Int[1/Sin[a*x]^2, x] /; FreeQ[{a, c, d}, x] && EqQ[a*c + d, 0]
Int[(x_)^2/((c_.)*Cos[(a_.)*(x_)] + (d_.)*(x_)*Sin[(a_.)*(x_)])^2, x_Symbol] := -(x/(a*d*Cos[a*x]*(c*Cos[a*x] + d*x*Sin[a*x]))) + (1/d^2)*Int[1/Cos[a*x]^2, x] /; FreeQ[{a, c, d}, x] && EqQ[a*c - d, 0]
Int[Sin[(a_.)*(x_)]^2/((c_.)*Sin[(a_.)*(x_)] + (d_.)*(x_)*Cos[(a_.)*(x_)])^2, x_Symbol] := 1/(d^2*x) + Sin[a*x]/(a*d*x*(d*x*Cos[a*x] + c*Sin[a*x])) /; FreeQ[{a, c, d}, x] && EqQ[a*c + d, 0]
Int[Cos[(a_.)*(x_)]^2/((c_.)*Cos[(a_.)*(x_)] + (d_.)*(x_)*Sin[(a_.)*(x_)])^2, x_Symbol] := 1/(d^2*x) - Cos[a*x]/(a*d*x*(d*x*Sin[a*x] + c*Cos[a*x])) /; FreeQ[{a, c, d}, x] && EqQ[a*c - d, 0]
Int[((b_.)*(x_))^(m_)*(Sin[(a_.)*(x_)]^(n_)/((c_.)*Sin[(a_.)*(x_)] + (d_.)*(x_)*Cos[(a_.)*(x_)])^2), x_Symbol] := b*(b*x)^(m - 1)*(Sin[a*x]^(n - 1)/(a*d*(c*Sin[a*x] + d*x*Cos[a*x]))) - b^2*((n - 1)/d^2)*Int[(b*x)^(m - 2)*Sin[a*x]^(n - 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[a*c + d, 0] && EqQ[m, 2 - n]
Int[((b_.)*(x_))^(m_)*(Cos[(a_.)*(x_)]^(n_)/((c_.)*Cos[(a_.)*(x_)] + (d_.)*(x_)*Sin[(a_.)*(x_)])^2), x_Symbol] := (-b)*(b*x)^(m - 1)*(Cos[a*x]^(n - 1)/(a*d*(c*Cos[a*x] + d*x*Sin[a*x]))) - b^2*((n - 1)/d^2)*Int[(b*x)^(m - 2)*Cos[a*x]^(n - 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[a*c - d, 0] && EqQ[m, 2 - n]
Int[((b_.)*(x_))^(m_.)*(Csc[(a_.)*(x_)]^(n_.)/((c_.)*Sin[(a_.)*(x_)] + (d_.)*(x_)*Cos[(a_.)*(x_)])^2), x_Symbol] := b*(b*x)^(m - 1)*(Csc[a*x]^(n + 1)/(a*d*(c*Sin[a*x] + d*x*Cos[a*x]))) + b^2*((n + 1)/d^2)*Int[(b*x)^(m - 2)*Csc[a*x]^(n + 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[a*c + d, 0] && EqQ[m, n + 2]
Int[((b_.)*(x_))^(m_.)*(Sec[(a_.)*(x_)]^(n_.)/((c_.)*Cos[(a_.)*(x_)] + (d_.)*(x_)*Sin[(a_.)*(x_)])^2), x_Symbol] := (-b)*(b*x)^(m - 1)*(Sec[a*x]^(n + 1)/(a*d*(c*Cos[a*x] + d*x*Sin[a*x]))) + b^2*((n + 1)/d^2)*Int[(b*x)^(m - 2)*Sec[a*x]^(n + 2), x] /; FreeQ[{a, b, c, d, m, n}, x] && EqQ[a*c - d, 0] && EqQ[m, n + 2]
Int[((g_.) + (h_.)*(x_))^(p_.)*((a_) + (b_.)*Sin[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*Sin[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^m*c^m*Int[(g + h*x)^p*Cos[e + f*x]^(2*m)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && IGtQ[n - m, 0]
Int[((g_.) + (h_.)*(x_))^(p_.)*((a_) + (b_.)*Cos[(e_.) + (f_.)*(x_)])^(m_.)*((c_) + (d_.)*Cos[(e_.) + (f_.)*(x_)])^(n_.), x_Symbol] := a^m*c^m*Int[(g + h*x)^p*Sin[e + f*x]^(2*m)*(c + d*Cos[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[m] && IGtQ[n - m, 0]
Int[((g_.) + (h_.)*(x_))^(p_.)*((a_) + (b_.)*Sin[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*Sin[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^IntPart[m]*c^IntPart[m]*(a + b*Sin[e + f*x])^FracPart[m]*((c + d*Sin[e + f*x])^FracPart[m]/Cos[e + f*x]^(2*FracPart[m]))*Int[(g + h*x)^p*Cos[e + f*x]^(2*m)*(c + d*Sin[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[p] && IntegerQ[2*m] && IGeQ[n - m, 0]
Int[((g_.) + (h_.)*(x_))^(p_.)*((a_) + (b_.)*Cos[(e_.) + (f_.)*(x_)])^(m_)*((c_) + (d_.)*Cos[(e_.) + (f_.)*(x_)])^(n_), x_Symbol] := a^IntPart[m]*c^IntPart[m]*(a + b*Cos[e + f*x])^FracPart[m]*((c + d*Cos[e + f*x])^FracPart[m]/Sin[e + f*x]^(2*FracPart[m]))*Int[(g + h*x)^p*Sin[e + f*x]^(2*m)*(c + d*Cos[e + f*x])^(n - m), x] /; FreeQ[{a, b, c, d, e, f, g, h}, x] && EqQ[b*c + a*d, 0] && EqQ[a^2 - b^2, 0] && IntegerQ[p] && IntegerQ[2*m] && IGeQ[n - m, 0]
Int[Sec[v_]^(m_.)*((a_) + (b_.)*Tan[v_])^(n_.), x_Symbol] := Int[(a*Cos[v] + b*Sin[v])^n, x] /; FreeQ[{a, b}, x] && IntegerQ[(m - 1)/2] && EqQ[m + n, 0]
Int[Csc[v_]^(m_.)*((a_) + (b_.)*Cot[v_])^(n_.), x_Symbol] := Int[(b*Cos[v] + a*Sin[v])^n, x] /; FreeQ[{a, b}, x] && IntegerQ[(m - 1)/2] && EqQ[m + n, 0]
Int[(u_.)*Sin[(a_.) + (b_.)*(x_)]^(m_.)*Sin[(c_.) + (d_.)*(x_)]^(n_.), x_Symbol] := Int[ExpandTrigReduce[u, Sin[a + b*x]^m*Sin[c + d*x]^n, x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[(u_.)*Cos[(a_.) + (b_.)*(x_)]^(m_.)*Cos[(c_.) + (d_.)*(x_)]^(n_.), x_Symbol] := Int[ExpandTrigReduce[u, Cos[a + b*x]^m*Cos[c + d*x]^n, x], x] /; FreeQ[{a, b, c, d}, x] && IGtQ[m, 0] && IGtQ[n, 0]
Int[Sec[(a_.) + (b_.)*(x_)]*Sec[(c_) + (d_.)*(x_)], x_Symbol] := (-Csc[(b*c - a*d)/d])*Int[Tan[a + b*x], x] + Csc[(b*c - a*d)/b]*Int[Tan[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[Csc[(a_.) + (b_.)*(x_)]*Csc[(c_) + (d_.)*(x_)], x_Symbol] := Csc[(b*c - a*d)/b]*Int[Cot[a + b*x], x] - Csc[(b*c - a*d)/d]*Int[Cot[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[Tan[(a_.) + (b_.)*(x_)]*Tan[(c_) + (d_.)*(x_)], x_Symbol] := (-b)*(x/d) + (b/d)*Cos[(b*c - a*d)/d]*Int[Sec[a + b*x]*Sec[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[Cot[(a_.) + (b_.)*(x_)]*Cot[(c_) + (d_.)*(x_)], x_Symbol] := (-b)*(x/d) + Cos[(b*c - a*d)/d]*Int[Csc[a + b*x]*Csc[c + d*x], x] /; FreeQ[{a, b, c, d}, x] && EqQ[b^2 - d^2, 0] && NeQ[b*c - a*d, 0]
Int[(u_.)*((a_.)*Cos[v_] + (b_.)*Sin[v_])^(n_.), x_Symbol] := Int[u*(a/E^((a/b)*v))^n, x] /; FreeQ[{a, b, n}, x] && EqQ[a^2 + b^2, 0]
Int[Sin[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])^2], x_Symbol] := (I/2)*Int[E^((-I)*d*(a + b*Log[c*x^n])^2), x] - (I/2)*Int[E^(I*d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, n}, x]
Int[Cos[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])^2], x_Symbol] := (1/2)*Int[E^((-I)*d*(a + b*Log[c*x^n])^2), x] + (1/2)*Int[E^(I*d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, n}, x]
Int[((e_.)*(x_))^(m_.)*Sin[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])^2], x_Symbol] := (I/2)*Int[(e*x)^m/E^(I*d*(a + b*Log[c*x^n])^2), x] - (I/2)*Int[(e*x)^m*E^(I*d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, e, m, n}, x]
Int[((e_.)*(x_))^(m_.)*Cos[(d_.)*((a_.) + (b_.)*Log[(c_.)*(x_)^(n_.)])^2], x_Symbol] := (1/2)*Int[(e*x)^m/E^(I*d*(a + b*Log[c*x^n])^2), x] + (1/2)*Int[(e*x)^m*E^(I*d*(a + b*Log[c*x^n])^2), x] /; FreeQ[{a, b, c, d, e, m, n}, x]